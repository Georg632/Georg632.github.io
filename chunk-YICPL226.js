import{a as v3,b as qa,c as Fo,d as Mo,e as To,f as Io,g as Ao,h as Oo,i as Lo,m as w3}from"./chunk-4QSPEVSD.js";import{a as b3,b as y3,c as S3,d as x3,e as E3,f as R3,g as P3}from"./chunk-ZSFJYLL4.js";import{$ as Oh,$a as it,$b as Na,$c as Rs,$d as wn,A as Qi,B as _c,Ba as Ue,C as hn,Cc as U2,D as w2,Da as de,Dc as j2,E as Ih,Eb as D2,Ec as q2,F as Jn,Fa as te,Fc as $2,G as Dc,Ga as Eo,Gb as Hh,Gc as K2,H as pn,Ha as Ro,Hc as Y2,I as b2,Ia as y0,J as ce,Ja as R2,K as ue,Ka as Ic,Kc as Ua,L as he,La as S0,Lc as Do,M as y2,Ma as zr,Mc as X2,N as C0,Na as At,Nb as F2,Nc as J2,O as So,Ob as mn,Oc as Q2,Od as p3,P as S2,Pa as Vr,Pb as vn,Pd as f3,Q as $,Qa as ge,Qc as Z2,Qd as hi,R as Ni,Ra as Qe,Rc as e3,S as xe,Sa as qe,Sb as M2,T as ht,Ta as Ac,U as Aa,Ua as Po,V as Ah,Va as Gr,Vb as Rt,Vc as t3,W as xo,Wa as ko,Wb as zh,X as ci,Xb as Zn,Xc as i3,Yb as _o,Yc as tr,Zc as n3,Zd as Cn,_ as L,_a as Wr,_b as er,a as w,ab as Bh,ac as Ba,ad as r3,b as T,ba as w0,bb as Oc,bd as Gh,be as ir,c as g2,ca as b0,cb as x0,cc as Bn,cd as Hc,ce as g3,d as xt,da as Fc,db as P2,dc as Vh,dd as o3,e as vt,ea as Oa,eb as k2,ec as Ha,ed as s3,ee as m3,f as ft,fa as Ae,fb as be,fc as T2,fd as P0,fe as zn,g as Ia,ga as Mc,gb as ye,gc as za,gd as Hn,h as Pc,ha as Pi,hc as Va,hd as zc,i as yt,ia as x2,ic as I2,id as a3,ie as ja,j as m2,ja as fn,jb as Ie,jc as Ga,jd as l3,k as Fh,ka as Qn,kc as Wa,kd as c3,l as je,lb as Nn,lc as di,m as Ye,ma as Es,mb as Ce,mc as ui,md as d3,n as xs,na as Ve,nb as De,nc as A2,o as v2,oa as Ge,ob as _2,oc as O2,p as Ri,pa as Lh,pc as L2,pe as Wh,q as Mh,qa as E2,qb as E0,qc as N2,qe as Uh,r as yo,ra as On,rb as Lc,re as C3,s as C2,sa as Ln,sc as B2,sd as u3,se as Vc,t as tt,ta as ve,tb as Nc,tc as H2,td as h3,u as Th,ua as A,ub as H,v as v0,va as I,vb as Bc,vc as z2,w as Je,wa as le,wb as R0,xa as La,xc as V2,y as kc,ya as Tc,yc as G2,z as Ji,za as Nh,zb as gn,zc as W2}from"./chunk-B3X53TXO.js";var Gc=vt((wde,k3)=>{"use strict";k3.exports=function(t){if(typeof t!="number"||Number.isNaN(t))throw new TypeError(`Expected a number, got ${typeof t}`);let i=t<0,n=Math.abs(t);if(i&&(n=-n),n===0)return"0 B";let r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.min(Math.floor(Math.log(n)/Math.log(1024)),r.length-1),s=Number(n/1024**o),a=r[o];return`${s>=10||s%1===0?Math.round(s):s.toFixed(1)} ${a}`}});var dx=vt((ehe,cx)=>{"use strict";function lx(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}lx.prototype.match=function(e){var t=!0,i=this.parts,n,r=i.length,o;if(typeof e=="string"||e instanceof String)if(!this.hasWild&&this.text!=e)t=!1;else{for(o=(e||"").split(this.separator),n=0;t&&n<r;n++)i[n]!=="*"&&(n<o.length?t=i[n]===o[n]:t=!1);t=t&&o}else if(typeof e.splice=="function")for(t=[],n=e.length;n--;)this.match(e[n])&&(t[t.length]=e[n]);else if(typeof e=="object"){t={};for(var s in e)this.match(s)&&(t[s]=e[s])}return t};cx.exports=function(e,t,i){var n=new lx(e,i||/[\/\.]/);return typeof t<"u"?n.match(t):n}});var hx=vt((the,ux)=>{"use strict";var KI=dx(),YI=/[\/\+\.]/;ux.exports=function(e,t){function i(n){var r=KI(n,e,YI);return r&&r.length>=2}return t?i(t.split(";")[0]):i}});var np=vt((uhe,vx)=>{"use strict";function QI(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}vx.exports=QI});var wx=vt((hhe,Cx)=>{"use strict";var ZI=typeof global=="object"&&global&&global.Object===Object&&global;Cx.exports=ZI});var ev=vt((phe,bx)=>{"use strict";var eA=wx(),tA=typeof self=="object"&&self&&self.Object===Object&&self,iA=eA||tA||Function("return this")();bx.exports=iA});var Sx=vt((fhe,yx)=>{"use strict";var nA=ev(),rA=function(){return nA.Date.now()};yx.exports=rA});var Ex=vt((ghe,xx)=>{"use strict";var oA=/\s/;function sA(e){for(var t=e.length;t--&&oA.test(e.charAt(t)););return t}xx.exports=sA});var Px=vt((mhe,Rx)=>{"use strict";var aA=Ex(),lA=/^\s+/;function cA(e){return e&&e.slice(0,aA(e)+1).replace(lA,"")}Rx.exports=cA});var tv=vt((vhe,kx)=>{"use strict";var dA=ev(),uA=dA.Symbol;kx.exports=uA});var Mx=vt((Che,Fx)=>{"use strict";var _x=tv(),Dx=Object.prototype,hA=Dx.hasOwnProperty,pA=Dx.toString,sd=_x?_x.toStringTag:void 0;function fA(e){var t=hA.call(e,sd),i=e[sd];try{e[sd]=void 0;var n=!0}catch{}var r=pA.call(e);return n&&(t?e[sd]=i:delete e[sd]),r}Fx.exports=fA});var Ix=vt((whe,Tx)=>{"use strict";var gA=Object.prototype,mA=gA.toString;function vA(e){return mA.call(e)}Tx.exports=vA});var Nx=vt((bhe,Lx)=>{"use strict";var Ax=tv(),CA=Mx(),wA=Ix(),bA="[object Null]",yA="[object Undefined]",Ox=Ax?Ax.toStringTag:void 0;function SA(e){return e==null?e===void 0?yA:bA:Ox&&Ox in Object(e)?CA(e):wA(e)}Lx.exports=SA});var Hx=vt((yhe,Bx)=>{"use strict";function xA(e){return e!=null&&typeof e=="object"}Bx.exports=xA});var Vx=vt((She,zx)=>{"use strict";var EA=Nx(),RA=Hx(),PA="[object Symbol]";function kA(e){return typeof e=="symbol"||RA(e)&&EA(e)==PA}zx.exports=kA});var jx=vt((xhe,Ux)=>{"use strict";var _A=Px(),Gx=np(),DA=Vx(),Wx=NaN,FA=/^[-+]0x[0-9a-f]+$/i,MA=/^0b[01]+$/i,TA=/^0o[0-7]+$/i,IA=parseInt;function AA(e){if(typeof e=="number")return e;if(DA(e))return Wx;if(Gx(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Gx(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=_A(e);var i=MA.test(e);return i||TA.test(e)?IA(e.slice(2),i?2:8):FA.test(e)?Wx:+e}Ux.exports=AA});var rp=vt((Ehe,$x)=>{"use strict";var OA=np(),iv=Sx(),qx=jx(),LA="Expected a function",NA=Math.max,BA=Math.min;function HA(e,t,i){var n,r,o,s,a,l,c=0,d=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(LA);t=qx(t)||0,OA(i)&&(d=!!i.leading,u="maxWait"in i,o=u?NA(qx(i.maxWait)||0,t):o,h="trailing"in i?!!i.trailing:h);function p(x){var P=n,F=r;return n=r=void 0,c=x,s=e.apply(F,P),s}function f(x){return c=x,a=setTimeout(v,t),d?p(x):s}function g(x){var P=x-l,F=x-c,N=t-P;return u?BA(N,o-F):N}function m(x){var P=x-l,F=x-c;return l===void 0||P>=t||P<0||u&&F>=o}function v(){var x=iv();if(m(x))return C(x);a=setTimeout(v,g(x))}function C(x){return a=void 0,h&&n?p(x):(n=r=void 0,s)}function b(){a!==void 0&&clearTimeout(a),c=0,n=l=r=a=void 0}function S(){return a===void 0?s:C(iv())}function E(){var x=iv(),P=m(x);if(n=arguments,r=this,l=x,P){if(a===void 0)return f(l);if(u)return clearTimeout(a),a=setTimeout(v,t),p(l)}return a===void 0&&(a=setTimeout(v,t)),s}return E.cancel=b,E.flush=S,E}$x.exports=HA});var Yx=vt((Rhe,Kx)=>{"use strict";var zA=rp(),VA=np(),GA="Expected a function";function WA(e,t,i){var n=!0,r=!0;if(typeof e!="function")throw new TypeError(GA);return VA(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),zA(e,t,{leading:n,maxWait:t,trailing:r})}Kx.exports=WA});var Jx=vt((Phe,Xx)=>{"use strict";Xx.exports=function(){var t={},i=t._fns={};t.emit=function(s,a,l,c,d,u,h){var p=n(s);p.length&&r(s,p,[a,l,c,d,u,h])},t.on=function(s,a){i[s]||(i[s]=[]),i[s].push(a)},t.once=function(s,a){function l(){a.apply(this,arguments),t.off(s,l)}this.on(s,l)},t.off=function(s,a){var l=[];if(s&&a){var c=this._fns[s],d=0,u=c?c.length:0;for(d;d<u;d++)c[d]!==a&&l.push(c[d])}l.length?this._fns[s]=l:delete this._fns[s]};function n(o){var s=i[o]?i[o]:[],a=o.indexOf(":"),l=a===-1?[o]:[o.substring(0,a),o.substring(a+1)],c=Object.keys(i),d=0,u=c.length;for(d;d<u;d++){var h=c[d];if(h==="*"&&(s=s.concat(i[h])),l.length===2&&l[0]===h){s=s.concat(i[h]);break}}return s}function r(o,s,a){var l=0,c=s.length;for(l;l<c&&s[l];l++)s[l].event=o,s[l].apply(s[l],a)}return t}});var iE=vt((sv,av)=>{"use strict";(function(e,t){typeof sv=="object"&&typeof av<"u"?av.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.Compressor=t())})(sv,function(){"use strict";function e(z,O){var W=Object.keys(z);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(z);O&&(ee=ee.filter(function(Se){return Object.getOwnPropertyDescriptor(z,Se).enumerable})),W.push.apply(W,ee)}return W}function t(z){for(var O=1;O<arguments.length;O++){var W=arguments[O]!=null?arguments[O]:{};O%2?e(Object(W),!0).forEach(function(ee){o(z,ee,W[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors(W)):e(Object(W)).forEach(function(ee){Object.defineProperty(z,ee,Object.getOwnPropertyDescriptor(W,ee))})}return z}function i(z,O){if(!(z instanceof O))throw new TypeError("Cannot call a class as a function")}function n(z,O){for(var W=0;W<O.length;W++){var ee=O[W];ee.enumerable=ee.enumerable||!1,ee.configurable=!0,"value"in ee&&(ee.writable=!0),Object.defineProperty(z,l(ee.key),ee)}}function r(z,O,W){return O&&n(z.prototype,O),W&&n(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z}function o(z,O,W){return O=l(O),O in z?Object.defineProperty(z,O,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[O]=W,z}function s(){return s=Object.assign?Object.assign.bind():function(z){for(var O=1;O<arguments.length;O++){var W=arguments[O];for(var ee in W)Object.prototype.hasOwnProperty.call(W,ee)&&(z[ee]=W[ee])}return z},s.apply(this,arguments)}function a(z,O){if(typeof z!="object"||z===null)return z;var W=z[Symbol.toPrimitive];if(W!==void 0){var ee=W.call(z,O||"default");if(typeof ee!="object")return ee;throw new TypeError("@@toPrimitive must return a primitive value.")}return(O==="string"?String:Number)(z)}function l(z){var O=a(z,"string");return typeof O=="symbol"?O:String(O)}var c={exports:{}};(function(z){typeof window>"u"||(function(O){var W=O.HTMLCanvasElement&&O.HTMLCanvasElement.prototype,ee=O.Blob&&(function(){try{return!!new Blob}catch{return!1}})(),Se=ee&&O.Uint8Array&&(function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}})(),Ee=O.BlobBuilder||O.WebKitBlobBuilder||O.MozBlobBuilder||O.MSBlobBuilder,ut=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,et=(ee||Ee)&&O.atob&&O.ArrayBuffer&&O.Uint8Array&&function(He){var ze,Et,Ft,Yi,Ht,Le,Xi,Jt,Fa;if(ze=He.match(ut),!ze)throw new Error("invalid data URI");for(Et=ze[2]?ze[1]:"text/plain"+(ze[3]||";charset=US-ASCII"),Ft=!!ze[4],Yi=He.slice(ze[0].length),Ft?Ht=atob(Yi):Ht=decodeURIComponent(Yi),Le=new ArrayBuffer(Ht.length),Xi=new Uint8Array(Le),Jt=0;Jt<Ht.length;Jt+=1)Xi[Jt]=Ht.charCodeAt(Jt);return ee?new Blob([Se?Xi:Le],{type:Et}):(Fa=new Ee,Fa.append(Le),Fa.getBlob(Et))};O.HTMLCanvasElement&&!W.toBlob&&(W.mozGetAsFile?W.toBlob=function(He,ze,Et){var Ft=this;setTimeout(function(){Et&&W.toDataURL&&et?He(et(Ft.toDataURL(ze,Et))):He(Ft.mozGetAsFile("blob",ze))})}:W.toDataURL&&et&&(W.msToBlob?W.toBlob=function(He,ze,Et){var Ft=this;setTimeout(function(){(ze&&ze!=="image/png"||Et)&&W.toDataURL&&et?He(et(Ft.toDataURL(ze,Et))):He(Ft.msToBlob(ze))})}:W.toBlob=function(He,ze,Et){var Ft=this;setTimeout(function(){He(et(Ft.toDataURL(ze,Et)))})})),z.exports?z.exports=et:O.dataURLtoBlob=et})(window)})(c);var d=c.exports,u=function(O){return typeof Blob>"u"?!1:O instanceof Blob||Object.prototype.toString.call(O)==="[object Blob]"},h={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},p=typeof window<"u"&&typeof window.document<"u",f=p?window:{},g=function(O){return O>0&&O<1/0},m=Array.prototype.slice;function v(z){return Array.from?Array.from(z):m.call(z)}var C=/^image\/.+$/;function b(z){return C.test(z)}function S(z){var O=b(z)?z.substr(6):"";return O==="jpeg"&&(O="jpg"),".".concat(O)}var E=String.fromCharCode;function x(z,O,W){var ee="",Se;for(W+=O,Se=O;Se<W;Se+=1)ee+=E(z.getUint8(Se));return ee}var P=f.btoa;function F(z,O){for(var W=[],ee=8192,Se=new Uint8Array(z);Se.length>0;)W.push(E.apply(null,v(Se.subarray(0,ee)))),Se=Se.subarray(ee);return"data:".concat(O,";base64,").concat(P(W.join("")))}function N(z){var O=new DataView(z),W;try{var ee,Se,Ee;if(O.getUint8(0)===255&&O.getUint8(1)===216)for(var ut=O.byteLength,et=2;et+1<ut;){if(O.getUint8(et)===255&&O.getUint8(et+1)===225){Se=et;break}et+=1}if(Se){var He=Se+4,ze=Se+10;if(x(O,He,4)==="Exif"){var Et=O.getUint16(ze);if(ee=Et===18761,(ee||Et===19789)&&O.getUint16(ze+2,ee)===42){var Ft=O.getUint32(ze+4,ee);Ft>=8&&(Ee=ze+Ft)}}}if(Ee){var Yi=O.getUint16(Ee,ee),Ht,Le;for(Le=0;Le<Yi;Le+=1)if(Ht=Ee+Le*12+2,O.getUint16(Ht,ee)===274){Ht+=8,W=O.getUint16(Ht,ee),O.setUint16(Ht,1,ee);break}}}catch{W=1}return W}function Y(z){var O=0,W=1,ee=1;switch(z){case 2:W=-1;break;case 3:O=-180;break;case 4:ee=-1;break;case 5:O=90,ee=-1;break;case 6:O=90;break;case 7:O=90,W=-1;break;case 8:O=-90;break}return{rotate:O,scaleX:W,scaleY:ee}}var X=/\.\d*(?:0|9){12}\d*$/;function Z(z){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return X.test(z)?Math.round(z*O)/O:z}function me(z){var O=z.aspectRatio,W=z.height,ee=z.width,Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",Ee=g(ee),ut=g(W);if(Ee&&ut){var et=W*O;(Se==="contain"||Se==="none")&&et>ee||Se==="cover"&&et<ee?W=ee/O:ee=W*O}else Ee?W=ee/O:ut&&(ee=W*O);return{width:ee,height:W}}function oe(z){for(var O=v(new Uint8Array(z)),W=O.length,ee=[],Se=0;Se+3<W;){var Ee=O[Se],ut=O[Se+1];if(Ee===255&&ut===218)break;if(Ee===255&&ut===216)Se+=2;else{var et=O[Se+2]*256+O[Se+3],He=Se+et+2,ze=O.slice(Se,He);ee.push(ze),Se=He}}return ee.reduce(function(Et,Ft){return Ft[0]===255&&Ft[1]===225?Et.concat(Ft):Et},[])}function re(z,O){var W=v(new Uint8Array(z));if(W[2]!==255||W[3]!==224)return z;var ee=W[4]*256+W[5],Se=[255,216].concat(O,W.slice(4+ee));return new Uint8Array(Se)}var _=f.ArrayBuffer,k=f.FileReader,D=f.URL||f.webkitURL,V=/\.\w+$/,U=f.Compressor,G=(function(){function z(O,W){i(this,z),this.file=O,this.exif=[],this.image=new Image,this.options=t(t({},h),W),this.aborted=!1,this.result=null,this.init()}return r(z,[{key:"init",value:function(){var W=this,ee=this.file,Se=this.options;if(!u(ee)){this.fail(new Error("The first argument must be a File or Blob object."));return}var Ee=ee.type;if(!b(Ee)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!D||!k){this.fail(new Error("The current browser does not support image compression."));return}_||(Se.checkOrientation=!1,Se.retainExif=!1);var ut=Ee==="image/jpeg",et=ut&&Se.checkOrientation,He=ut&&Se.retainExif;if(D&&!et&&!He)this.load({url:D.createObjectURL(ee)});else{var ze=new k;this.reader=ze,ze.onload=function(Et){var Ft=Et.target,Yi=Ft.result,Ht={},Le=1;et&&(Le=N(Yi),Le>1&&s(Ht,Y(Le))),He&&(W.exif=oe(Yi)),et||He?!D||Le>1?Ht.url=F(Yi,Ee):Ht.url=D.createObjectURL(ee):Ht.url=Yi,W.load(Ht)},ze.onabort=function(){W.fail(new Error("Aborted to read the image with FileReader."))},ze.onerror=function(){W.fail(new Error("Failed to read the image with FileReader."))},ze.onloadend=function(){W.reader=null},et||He?ze.readAsArrayBuffer(ee):ze.readAsDataURL(ee)}}},{key:"load",value:function(W){var ee=this,Se=this.file,Ee=this.image;Ee.onload=function(){ee.draw(t(t({},W),{},{naturalWidth:Ee.naturalWidth,naturalHeight:Ee.naturalHeight}))},Ee.onabort=function(){ee.fail(new Error("Aborted to load the image."))},Ee.onerror=function(){ee.fail(new Error("Failed to load the image."))},f.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(f.navigator.userAgent)&&(Ee.crossOrigin="anonymous"),Ee.alt=Se.name,Ee.src=W.url}},{key:"draw",value:function(W){var ee=this,Se=W.naturalWidth,Ee=W.naturalHeight,ut=W.rotate,et=ut===void 0?0:ut,He=W.scaleX,ze=He===void 0?1:He,Et=W.scaleY,Ft=Et===void 0?1:Et,Yi=this.file,Ht=this.image,Le=this.options,Xi=document.createElement("canvas"),Jt=Xi.getContext("2d"),Fa=Math.abs(et)%180===90,h0=(Le.resize==="contain"||Le.resize==="cover")&&g(Le.width)&&g(Le.height),bc=Math.max(Le.maxWidth,0)||1/0,yc=Math.max(Le.maxHeight,0)||1/0,Sc=Math.max(Le.minWidth,0)||0,xc=Math.max(Le.minHeight,0)||0,Ma=Se/Ee,ai=Le.width,li=Le.height;if(Fa){var JS=[yc,bc];bc=JS[0],yc=JS[1];var QS=[xc,Sc];Sc=QS[0],xc=QS[1];var ZS=[li,ai];ai=ZS[0],li=ZS[1]}h0&&(Ma=ai/li);var e2=me({aspectRatio:Ma,width:bc,height:yc},"contain");bc=e2.width,yc=e2.height;var t2=me({aspectRatio:Ma,width:Sc,height:xc},"cover");if(Sc=t2.width,xc=t2.height,h0){var i2=me({aspectRatio:Ma,width:ai,height:li},Le.resize);ai=i2.width,li=i2.height}else{var n2=me({aspectRatio:Ma,width:ai,height:li}),r2=n2.width;ai=r2===void 0?Se:r2;var o2=n2.height;li=o2===void 0?Ee:o2}ai=Math.floor(Z(Math.min(Math.max(ai,Sc),bc))),li=Math.floor(Z(Math.min(Math.max(li,xc),yc)));var vI=-ai/2,CI=-li/2,wI=ai,bI=li,p0=[];if(h0){var s2=0,a2=0,f0=Se,g0=Ee,l2=me({aspectRatio:Ma,width:Se,height:Ee},{contain:"cover",cover:"contain"}[Le.resize]);f0=l2.width,g0=l2.height,s2=(Se-f0)/2,a2=(Ee-g0)/2,p0.push(s2,a2,f0,g0)}if(p0.push(vI,CI,wI,bI),Fa){var c2=[li,ai];ai=c2[0],li=c2[1]}Xi.width=ai,Xi.height=li,b(Le.mimeType)||(Le.mimeType=Yi.type);var d2="transparent";Yi.size>Le.convertSize&&Le.convertTypes.indexOf(Le.mimeType)>=0&&(Le.mimeType="image/jpeg");var u2=Le.mimeType==="image/jpeg";if(u2&&(d2="#fff"),Jt.fillStyle=d2,Jt.fillRect(0,0,ai,li),Le.beforeDraw&&Le.beforeDraw.call(this,Jt,Xi),!this.aborted&&(Jt.save(),Jt.translate(ai/2,li/2),Jt.rotate(et*Math.PI/180),Jt.scale(ze,Ft),Jt.drawImage.apply(Jt,[Ht].concat(p0)),Jt.restore(),Le.drew&&Le.drew.call(this,Jt,Xi),!this.aborted)){var h2=function(Ec){if(!ee.aborted){var p2=function(Rc){return ee.done({naturalWidth:Se,naturalHeight:Ee,result:Rc})};if(Ec&&u2&&Le.retainExif&&ee.exif&&ee.exif.length>0){var f2=function(Rc){return p2(d(F(re(Rc,ee.exif),Le.mimeType)))};if(Ec.arrayBuffer)Ec.arrayBuffer().then(f2).catch(function(){ee.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var Ta=new k;ee.reader=Ta,Ta.onload=function(m0){var Rc=m0.target;f2(Rc.result)},Ta.onabort=function(){ee.fail(new Error("Aborted to read the compressed image with FileReader."))},Ta.onerror=function(){ee.fail(new Error("Failed to read the compressed image with FileReader."))},Ta.onloadend=function(){ee.reader=null},Ta.readAsArrayBuffer(Ec)}}else p2(Ec)}};Xi.toBlob?Xi.toBlob(h2,Le.mimeType,Le.quality):h2(d(Xi.toDataURL(Le.mimeType,Le.quality)))}}},{key:"done",value:function(W){var ee=W.naturalWidth,Se=W.naturalHeight,Ee=W.result,ut=this.file,et=this.image,He=this.options;if(D&&et.src.indexOf("blob:")===0&&D.revokeObjectURL(et.src),Ee)if(He.strict&&!He.retainExif&&Ee.size>ut.size&&He.mimeType===ut.type&&!(He.width>ee||He.height>Se||He.minWidth>ee||He.minHeight>Se||He.maxWidth<ee||He.maxHeight<Se))Ee=ut;else{var ze=new Date;Ee.lastModified=ze.getTime(),Ee.lastModifiedDate=ze,Ee.name=ut.name,Ee.name&&Ee.type!==ut.type&&(Ee.name=Ee.name.replace(V,S(Ee.type)))}else Ee=ut;this.result=Ee,He.success&&He.success.call(this,Ee)}},{key:"fail",value:function(W){var ee=this.options;if(ee.error)ee.error.call(this,W);else throw W}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=U,z}},{key:"setDefaults",value:function(W){s(h,W)}}]),z})();return G})});var ki=vt((cpe,lp)=>{"use strict";(function(){"use strict";var e={}.hasOwnProperty;function t(){for(var r="",o=0;o<arguments.length;o++){var s=arguments[o];s&&(r=n(r,i(s)))}return r}function i(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return t.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var o="";for(var s in r)e.call(r,s)&&r[s]&&(o=n(o,s));return o}function n(r,o){return o?r?r+" "+o:r+o:r}typeof lp<"u"&&lp.exports?(t.default=t,lp.exports=t):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return t}):window.classNames=t})()});var CE=vt((Wpe,fv)=>{"use strict";var d9=Object.prototype.hasOwnProperty,_i="~";function ad(){}Object.create&&(ad.prototype=Object.create(null),new ad().__proto__||(_i=!1));function u9(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function vE(e,t,i,n,r){if(typeof i!="function")throw new TypeError("The listener must be a function");var o=new u9(i,n||e,r),s=_i?_i+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],o]:e._events[s].push(o):(e._events[s]=o,e._eventsCount++),e}function dp(e,t){--e._eventsCount===0?e._events=new ad:delete e._events[t]}function fi(){this._events=new ad,this._eventsCount=0}fi.prototype.eventNames=function(){var t=[],i,n;if(this._eventsCount===0)return t;for(n in i=this._events)d9.call(i,n)&&t.push(_i?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(i)):t};fi.prototype.listeners=function(t){var i=_i?_i+t:t,n=this._events[i];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,s=new Array(o);r<o;r++)s[r]=n[r].fn;return s};fi.prototype.listenerCount=function(t){var i=_i?_i+t:t,n=this._events[i];return n?n.fn?1:n.length:0};fi.prototype.emit=function(t,i,n,r,o,s){var a=_i?_i+t:t;if(!this._events[a])return!1;var l=this._events[a],c=arguments.length,d,u;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,i),!0;case 3:return l.fn.call(l.context,i,n),!0;case 4:return l.fn.call(l.context,i,n,r),!0;case 5:return l.fn.call(l.context,i,n,r,o),!0;case 6:return l.fn.call(l.context,i,n,r,o,s),!0}for(u=1,d=new Array(c-1);u<c;u++)d[u-1]=arguments[u];l.fn.apply(l.context,d)}else{var h=l.length,p;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,i);break;case 3:l[u].fn.call(l[u].context,i,n);break;case 4:l[u].fn.call(l[u].context,i,n,r);break;default:if(!d)for(p=1,d=new Array(c-1);p<c;p++)d[p-1]=arguments[p];l[u].fn.apply(l[u].context,d)}}return!0};fi.prototype.on=function(t,i,n){return vE(this,t,i,n,!1)};fi.prototype.once=function(t,i,n){return vE(this,t,i,n,!0)};fi.prototype.removeListener=function(t,i,n,r){var o=_i?_i+t:t;if(!this._events[o])return this;if(!i)return dp(this,o),this;var s=this._events[o];if(s.fn)s.fn===i&&(!r||s.once)&&(!n||s.context===n)&&dp(this,o);else{for(var a=0,l=[],c=s.length;a<c;a++)(s[a].fn!==i||r&&!s[a].once||n&&s[a].context!==n)&&l.push(s[a]);l.length?this._events[o]=l.length===1?l[0]:l:dp(this,o)}return this};fi.prototype.removeAllListeners=function(t){var i;return t?(i=_i?_i+t:t,this._events[i]&&dp(this,i)):(this._events=new ad,this._eventsCount=0),this};fi.prototype.off=fi.prototype.removeListener;fi.prototype.addListener=fi.prototype.on;fi.prefixed=_i;fi.EventEmitter=fi;typeof fv<"u"&&(fv.exports=fi)});var c4=vt(($0e,l4)=>{"use strict";l4.exports=function(t,i){if(i=i.split(":")[0],t=+t,!t)return!1;switch(i){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}});var h4=vt(lC=>{"use strict";var ZO=Object.prototype.hasOwnProperty,eL;function d4(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch{return null}}function u4(e){try{return encodeURIComponent(e)}catch{return null}}function tL(e){for(var t=/([^=?#&]+)=?([^&]*)/g,i={},n;n=t.exec(e);){var r=d4(n[1]),o=d4(n[2]);r===null||o===null||r in i||(i[r]=o)}return i}function iL(e,t){t=t||"";var i=[],n,r;typeof t!="string"&&(t="?");for(r in e)if(ZO.call(e,r)){if(n=e[r],!n&&(n===null||n===eL||isNaN(n))&&(n=""),r=u4(r),n=u4(n),r===null||n===null)continue;i.push(r+"="+n)}return i.length?t+i.join("&"):""}lC.stringify=iL;lC.parse=tL});var b4=vt((Y0e,w4)=>{"use strict";var f4=c4(),Tp=h4(),nL=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,g4=/[\n\r\t]/g,rL=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,m4=/:\d+$/,oL=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,sL=/^[a-zA-Z]:/;function dC(e){return(e||"").toString().replace(nL,"")}var cC=[["#","hash"],["?","query"],function(t,i){return lr(i.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p4={hash:1,query:1};function v4(e){var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t={};var i=t.location||{};e=e||i;var n={},r=typeof e,o;if(e.protocol==="blob:")n=new cr(unescape(e.pathname),{});else if(r==="string"){n=new cr(e,{});for(o in p4)delete n[o]}else if(r==="object"){for(o in e)o in p4||(n[o]=e[o]);n.slashes===void 0&&(n.slashes=rL.test(e.href))}return n}function lr(e){return e==="file:"||e==="ftp:"||e==="http:"||e==="https:"||e==="ws:"||e==="wss:"}function C4(e,t){e=dC(e),e=e.replace(g4,""),t=t||{};var i=oL.exec(e),n=i[1]?i[1].toLowerCase():"",r=!!i[2],o=!!i[3],s=0,a;return r?o?(a=i[2]+i[3]+i[4],s=i[2].length+i[3].length):(a=i[2]+i[4],s=i[2].length):o?(a=i[3]+i[4],s=i[3].length):a=i[4],n==="file:"?s>=2&&(a=a.slice(2)):lr(n)?a=i[4]:n?r&&(a=a.slice(2)):s>=2&&lr(t.protocol)&&(a=i[4]),{protocol:n,slashes:r||lr(n),slashesCount:s,rest:a}}function aL(e,t){if(e==="")return t;for(var i=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=i.length,r=i[n-1],o=!1,s=0;n--;)i[n]==="."?i.splice(n,1):i[n]===".."?(i.splice(n,1),s++):s&&(n===0&&(o=!0),i.splice(n,1),s--);return o&&i.unshift(""),(r==="."||r==="..")&&i.push(""),i.join("/")}function cr(e,t,i){if(e=dC(e),e=e.replace(g4,""),!(this instanceof cr))return new cr(e,t,i);var n,r,o,s,a,l,c=cC.slice(),d=typeof t,u=this,h=0;for(d!=="object"&&d!=="string"&&(i=t,t=null),i&&typeof i!="function"&&(i=Tp.parse),t=v4(t),r=C4(e||"",t),n=!r.protocol&&!r.slashes,u.slashes=r.slashes||n&&t.slashes,u.protocol=r.protocol||t.protocol||"",e=r.rest,(r.protocol==="file:"&&(r.slashesCount!==2||sL.test(e))||!r.slashes&&(r.protocol||r.slashesCount<2||!lr(u.protocol)))&&(c[3]=[/(.*)/,"pathname"]);h<c.length;h++){if(s=c[h],typeof s=="function"){e=s(e,u);continue}o=s[0],l=s[1],o!==o?u[l]=e:typeof o=="string"?(a=o==="@"?e.lastIndexOf(o):e.indexOf(o),~a&&(typeof s[2]=="number"?(u[l]=e.slice(0,a),e=e.slice(a+s[2])):(u[l]=e.slice(a),e=e.slice(0,a)))):(a=o.exec(e))&&(u[l]=a[1],e=e.slice(0,a.index)),u[l]=u[l]||n&&s[3]&&t[l]||"",s[4]&&(u[l]=u[l].toLowerCase())}i&&(u.query=i(u.query)),n&&t.slashes&&u.pathname.charAt(0)!=="/"&&(u.pathname!==""||t.pathname!=="")&&(u.pathname=aL(u.pathname,t.pathname)),u.pathname.charAt(0)!=="/"&&lr(u.protocol)&&(u.pathname="/"+u.pathname),f4(u.port,u.protocol)||(u.host=u.hostname,u.port=""),u.username=u.password="",u.auth&&(a=u.auth.indexOf(":"),~a?(u.username=u.auth.slice(0,a),u.username=encodeURIComponent(decodeURIComponent(u.username)),u.password=u.auth.slice(a+1),u.password=encodeURIComponent(decodeURIComponent(u.password))):u.username=encodeURIComponent(decodeURIComponent(u.auth)),u.auth=u.password?u.username+":"+u.password:u.username),u.origin=u.protocol!=="file:"&&lr(u.protocol)&&u.host?u.protocol+"//"+u.host:"null",u.href=u.toString()}function lL(e,t,i){var n=this;switch(e){case"query":typeof t=="string"&&t.length&&(t=(i||Tp.parse)(t)),n[e]=t;break;case"port":n[e]=t,f4(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,m4.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!i;break;case"pathname":case"hash":if(t){var r=e==="pathname"?"/":"#";n[e]=t.charAt(0)!==r?r+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var o=t.indexOf(":");~o?(n.username=t.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var s=0;s<cC.length;s++){var a=cC[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&lr(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function cL(e){(!e||typeof e!="function")&&(e=Tp.stringify);var t,i=this,n=i.host,r=i.protocol;r&&r.charAt(r.length-1)!==":"&&(r+=":");var o=r+(i.protocol&&i.slashes||lr(i.protocol)?"//":"");return i.username?(o+=i.username,i.password&&(o+=":"+i.password),o+="@"):i.password?(o+=":"+i.password,o+="@"):i.protocol!=="file:"&&lr(i.protocol)&&!n&&i.pathname!=="/"&&(o+="@"),(n[n.length-1]===":"||m4.test(i.hostname)&&!i.port)&&(n+=":"),o+=n+i.pathname,t=typeof i.query=="object"?e(i.query):i.query,t&&(o+=t.charAt(0)!=="?"?"?"+t:t),i.hash&&(o+=i.hash),o}cr.prototype={set:lL,toString:cL};cr.extractProtocol=C4;cr.location=v4;cr.trimLeft=dC;cr.qs=Tp;w4.exports=cr});var lv=ft(Gc(),1);function $a(e,t){return Object.hasOwn(e,t)}var yI=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function SI(e,t,i){let n=yI.exec(e),r=t.mimeType??n?.[1]??"plain/text",o;if(n?.[2]!=null){let s=atob(decodeURIComponent(n[3])),a=new Uint8Array(s.length);for(let l=0;l<s.length;l++)a[l]=s.charCodeAt(l);o=[a]}else n?.[3]!=null&&(o=[decodeURIComponent(n[3])]);return i?new File(o,t.name||"",{type:r}):new Blob(o,{type:r})}var k0=SI;function Wc(e,t,i,n){return i===0||e===t?e:n===0?t:e+(t-e)*2**(-n/i)}var Uc=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];var _0=class extends Error{cause;isNetworkError;request;constructor(t,i=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=t,this.isNetworkError=!0,this.request=i}},D0=_0;var xI=e=>"error"in e&&!!e.error,EI=e=>e.progress.uploadComplete;function F0(e){return e.filter(t=>!xI(t)&&!EI(t))}function M0(e){return e.filter(t=>!t.progress?.uploadStarted||!t.isRestored)}function jc(e){return typeof e!="object"||e===null||!("nodeType"in e)?!1:e.nodeType===Node.ELEMENT_NODE}function RI(e){if(typeof e=="string"){let t=document.querySelectorAll(e);return t.length===0?null:Array.from(t)}return typeof e=="object"&&jc(e)?[e]:null}var jh=RI;function PI(e,t=document){return typeof e=="string"?t.querySelector(e):jc(e)?e:null}var T0=PI;function Vn(e){let t=e.lastIndexOf(".");return t===-1||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}var I0={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function Ka(e){if(e.type)return e.type;let t=e.name?Vn(e.name).extension?.toLowerCase():null;return t&&t in I0?I0[t]:"application/octet-stream"}function kI(e){return e.charCodeAt(0).toString(32)}function _3(e){let t="";return e.replace(/[^A-Z0-9]/gi,i=>(t+=`-${kI(i)}`,"/"))+t}function A0(e,t){let i=t||"uppy";return typeof e.name=="string"&&(i+=`-${_3(e.name.toLowerCase())}`),e.type!==void 0&&(i+=`-${e.type}`),e.meta&&typeof e.meta.relativePath=="string"&&(i+=`-${_3(e.meta.relativePath.toLowerCase())}`),e.data?.size!==void 0&&(i+=`-${e.data.size}`),e.data.lastModified!==void 0&&(i+=`-${e.data.lastModified}`),i}function _I(e){return!e.isRemote||!e.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(e.remote.provider)}function qc(e,t){if(_I(e))return e.id;let i=Ka(e);return A0(T(w({},e),{type:i}),t)}function qh(e,t){return e===!0?Object.keys(t):Array.isArray(e)?e:[]}var Ur=Array.from;function O0(e){let t=Ur(e.files);return Promise.resolve(t)}function $h(e,t,i,{onSuccess:n}){e.readEntries(r=>{let o=[...t,...r];r.length?queueMicrotask(()=>{$h(e,o,i,{onSuccess:n})}):n(o)},r=>{i(r),n(t)})}function D3(e,t){return e==null?e:{kind:e.isFile?"file":e.isDirectory?"directory":void 0,name:e.name,getFile(){return new Promise((i,n)=>e.file(i,n))},async*values(){let i=e.createReader();yield*await new Promise(r=>{$h(i,[],t,{onSuccess:o=>r(o.map(s=>D3(s,t)))})})},isSameEntry:void 0}}async function*F3(e,t,i=void 0){let n=()=>`${t}/${e.name}`;if(e.kind==="file"){let r=await e.getFile();r!=null?(r.relativePath=t?n():null,yield r):i!=null&&(yield i)}else if(e.kind==="directory")for await(let r of e.values())yield*F3(r,t?n():e.name);else i!=null&&(yield i)}async function*L0(e,t){let i=await Promise.all(Array.from(e.items,async n=>{let r;return r??=D3(typeof n.getAsEntry=="function"?n.getAsEntry():n.webkitGetAsEntry(),t),{fileSystemHandle:r,lastResortFile:n.getAsFile()}}));for(let{lastResortFile:n,fileSystemHandle:r}of i)if(r!=null)try{yield*F3(r,"",n)}catch(o){n!=null?yield n:t(o)}else n!=null&&(yield n)}async function Kh(e,t){let i=t?.logDropError??Function.prototype;try{let n=[];for await(let r of L0(e,i))n.push(r);return n}catch{return O0(e)}}function DI(e){for(;e&&!e.dir;)e=e.parentNode;return e?.dir}var N0=DI;function B0(e){return e<10?`0${e}`:e.toString()}function Ps(){let e=new Date,t=B0(e.getHours()),i=B0(e.getMinutes()),n=B0(e.getSeconds());return`${t}:${i}:${n}`}function Yh(){if(typeof window>"u")return!1;let e=document.body;return!(e==null||window==null||!("draggable"in e)||!("ondragstart"in e)||!("ondrop"in e)||!("FormData"in window)||!("FileReader"in window))}function FI(e){return e?e.readyState===4&&e.status===0:!1}var H0=FI;function $c(e){return e.startsWith("blob:")}function Kc(e){return e?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(e):!1}function z0(e){let t=Math.floor(e/3600)%24,i=Math.floor(e/60)%60,n=Math.floor(e%60);return{hours:t,minutes:i,seconds:n}}function Xh(e){let t=z0(e),i=t.hours===0?"":`${t.hours}h`,n=t.minutes===0?"":`${t.hours===0?t.minutes:` ${t.minutes.toString(10).padStart(2,"0")}`}m`,r=t.hours!==0?"":`${t.minutes===0?t.seconds:` ${t.seconds.toString(10).padStart(2,"0")}`}s`;return`${i}${n}${r}`}function MI(e){return new Error("Cancelled",{cause:e})}function M3(e){if(e!=null){let t=()=>this.abort(e.reason);e.addEventListener("abort",t,{once:!0});let i=()=>{e.removeEventListener("abort",t)};this.then?.(i,i)}return this}var ks=class{#e=0;#t=[];#i=!1;#n;#r=1;#c;#s;limit;constructor(t){typeof t!="number"||t===0?this.limit=1/0:this.limit=t}#a(t){this.#e+=1;let i=!1,n;try{n=t()}catch(r){throw this.#e-=1,r}return{abort:r=>{i||(i=!0,this.#e-=1,n?.(r),this.#o())},done:()=>{i||(i=!0,this.#e-=1,this.#o())}}}#o(){queueMicrotask(()=>this.#p())}#p(){if(this.#i||this.#e>=this.limit||this.#t.length===0)return;let t=this.#t.shift();if(t==null)throw new Error("Invariant violation: next is null");let i=this.#a(t.fn);t.abort=i.abort,t.done=i.done}#l(t,i){let n={fn:t,priority:i?.priority||0,abort:()=>{this.#u(n)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},r=this.#t.findIndex(o=>n.priority>o.priority);return r===-1?this.#t.push(n):this.#t.splice(r,0,n),n}#u(t){let i=this.#t.indexOf(t);i!==-1&&this.#t.splice(i,1)}run(t,i){return!this.#i&&this.#e<this.limit?this.#a(t):this.#l(t,i)}wrapSyncFunction(t,i){return(...n)=>{let r=this.run(()=>(t(...n),queueMicrotask(()=>r.done()),()=>{}),i);return{abortOn:M3,abort(){r.abort()}}}}wrapPromiseFunction(t,i){return(...n)=>{let r,o=new Promise((s,a)=>{r=this.run(()=>{let l,c;try{c=Promise.resolve(t(...n))}catch(d){c=Promise.reject(d)}return c.then(d=>{l?a(l):(r.done(),s(d))},d=>{l?a(l):(r.done(),a(d))}),d=>{l=MI(d)}},i)});return o.abort=s=>{r.abort(s)},o.abortOn=M3,o}}resume(){this.#i=!1,clearTimeout(this.#n);for(let t=0;t<this.limit;t++)this.#o()}#d=()=>this.resume();pause(t=null){this.#i=!0,clearTimeout(this.#n),t!=null&&(this.#n=setTimeout(this.#d,t))}rateLimit(t){clearTimeout(this.#s),this.pause(t),this.limit>1&&Number.isFinite(this.limit)&&(this.#c=this.limit-1,this.limit=this.#r,this.#s=setTimeout(this.#h,t))}#h=()=>{if(this.#i){this.#s=setTimeout(this.#h,0);return}this.#r=this.limit,this.limit=Math.ceil((this.#c+this.#r)/2);for(let t=this.#r;t<=this.limit;t++)this.#o();this.#c-this.#r>3?this.#s=setTimeout(this.#h,2e3):this.#r=Math.floor(this.#r/2)};get isPaused(){return this.#i}},TI=Symbol("__queue");function Jh(e){return T(w({},e),{type:e.mimeType,extension:e.name?Vn(e.name).extension:null})}function II(e,t,i){let n=[];return e.forEach(r=>typeof r!="string"?n.push(r):t[Symbol.split](r).forEach((o,s,a)=>{o!==""&&n.push(o),s<a.length-1&&n.push(i)})),n}function T3(e,t){let i=/\$/g,n="$$$$",r=[e];if(t==null)return r;for(let o of Object.keys(t))if(o!=="_"){let s=t[o];typeof s=="string"&&(s=i[Symbol.replace](s,n)),r=II(r,new RegExp(`%\\{${o}\\}`,"g"),s)}return r}var AI=e=>{throw new Error(`missing string: ${e}`)},_s=class{locale;constructor(t,{onMissingKey:i=AI}={}){this.locale={strings:{},pluralize(n){return n===1?0:1}},Array.isArray(t)?t.forEach(this.#t,this):this.#t(t),this.#e=i}#e;#t(t){if(!t?.strings)return;let i=this.locale;Object.assign(this.locale,{strings:w(w({},i.strings),t.strings),pluralize:t.pluralize||i.pluralize})}translate(t,i){return this.translateArray(t,i).join("")}translateArray(t,i){let n=this.locale.strings[t];if(n==null&&(this.#e(t),n=t),typeof n=="object"){if(i&&typeof i.smart_count<"u"){let o=this.locale.pluralize(i.smart_count);return T3(n[o],i)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof n!="string")throw new Error("string was not a string");return T3(n,i)}};function Yc(e,t){if(t===0)return"";if(e.length<=t)return e;if(t<=4)return`${e.slice(0,t-1)}\u2026`;let i=t-3,n=Math.ceil(i/2),r=Math.floor(i/2);return e.slice(0,n)+"..."+e.slice(-r)}var Qc,at,N3,OI,Ds,I3,B3,H3,z3,U0,V0,G0,LI,Jc={},V3=[],NI=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Zc=Array.isArray;function nr(e,t){for(var i in t)e[i]=t[i];return e}function j0(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ed(e,t,i){var n,r,o,s={};for(o in t)o=="key"?n=t[o]:o=="ref"?r=t[o]:s[o]=t[o];if(arguments.length>2&&(s.children=arguments.length>3?Qc.call(arguments,2):i),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)s[o]===void 0&&(s[o]=e.defaultProps[o]);return Xc(e,s,n,r,null)}function Xc(e,t,i,n,r){var o={type:e,props:t,key:i,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++N3,__i:-1,__u:0};return r==null&&at.vnode!=null&&at.vnode(o),o}function G3(){return{current:null}}function Wt(e){return e.children}function pi(e,t){this.props=e,this.context=t}function Ya(e,t){if(t==null)return e.__?Ya(e.__,e.__i+1):null;for(var i;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null)return i.__e;return typeof e.type=="function"?Ya(e):null}function W3(e){var t,i;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null){e.__e=e.__c.base=i.__e;break}return W3(e)}}function A3(e){(!e.__d&&(e.__d=!0)&&Ds.push(e)&&!Zh.__r++||I3!=at.debounceRendering)&&((I3=at.debounceRendering)||B3)(Zh)}function Zh(){for(var e,t,i,n,r,o,s,a=1;Ds.length;)Ds.length>a&&Ds.sort(H3),e=Ds.shift(),a=Ds.length,e.__d&&(i=void 0,n=void 0,r=(n=(t=e).__v).__e,o=[],s=[],t.__P&&((i=nr({},n)).__v=n.__v+1,at.vnode&&at.vnode(i),q0(t.__P,i,n,t.__n,t.__P.namespaceURI,32&n.__u?[r]:null,o,r??Ya(n),!!(32&n.__u),s),i.__v=n.__v,i.__.__k[i.__i]=i,q3(o,i,s),n.__e=n.__=null,i.__e!=r&&W3(i)));Zh.__r=0}function U3(e,t,i,n,r,o,s,a,l,c,d){var u,h,p,f,g,m,v,C=n&&n.__k||V3,b=t.length;for(l=BI(i,t,C,l,b),u=0;u<b;u++)(p=i.__k[u])!=null&&(h=p.__i==-1?Jc:C[p.__i]||Jc,p.__i=u,m=q0(e,p,h,r,o,s,a,l,c,d),f=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&$0(h.ref,null,p),d.push(p.ref,p.__c||f,p)),g==null&&f!=null&&(g=f),(v=!!(4&p.__u))||h.__k===p.__k?l=j3(p,l,e,v):typeof p.type=="function"&&m!==void 0?l=m:f&&(l=f.nextSibling),p.__u&=-7);return i.__e=g,l}function BI(e,t,i,n,r){var o,s,a,l,c,d=i.length,u=d,h=0;for(e.__k=new Array(r),o=0;o<r;o++)(s=t[o])!=null&&typeof s!="boolean"&&typeof s!="function"?(typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?s=e.__k[o]=Xc(null,s,null,null,null):Zc(s)?s=e.__k[o]=Xc(Wt,{children:s},null,null,null):s.constructor==null&&s.__b>0?s=e.__k[o]=Xc(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):e.__k[o]=s,l=o+h,s.__=e,s.__b=e.__b+1,a=null,(c=s.__i=HI(s,i,l,u))!=-1&&(u--,(a=i[c])&&(a.__u|=2)),a==null||a.__v==null?(c==-1&&(r>d?h--:r<d&&h++),typeof s.type!="function"&&(s.__u|=4)):c!=l&&(c==l-1?h--:c==l+1?h++:(c>l?h--:h++,s.__u|=4))):e.__k[o]=null;if(u)for(o=0;o<d;o++)(a=i[o])!=null&&(2&a.__u)==0&&(a.__e==n&&(n=Ya(a)),K3(a,a));return n}function j3(e,t,i,n){var r,o;if(typeof e.type=="function"){for(r=e.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=e,t=j3(r[o],t,i,n));return t}e.__e!=t&&(n&&(t&&e.type&&!t.parentNode&&(t=Ya(e)),i.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function rr(e,t){return t=t||[],e==null||typeof e=="boolean"||(Zc(e)?e.some(function(i){rr(i,t)}):t.push(e)),t}function HI(e,t,i,n){var r,o,s,a=e.key,l=e.type,c=t[i],d=c!=null&&(2&c.__u)==0;if(c===null&&a==null||d&&a==c.key&&l==c.type)return i;if(n>(d?1:0)){for(r=i-1,o=i+1;r>=0||o<t.length;)if((c=t[s=r>=0?r--:o++])!=null&&(2&c.__u)==0&&a==c.key&&l==c.type)return s}return-1}function O3(e,t,i){t[0]=="-"?e.setProperty(t,i??""):e[t]=i==null?"":typeof i!="number"||NI.test(t)?i:i+"px"}function Qh(e,t,i,n,r){var o,s;e:if(t=="style")if(typeof i=="string")e.style.cssText=i;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)i&&t in i||O3(e.style,t,"");if(i)for(t in i)n&&i[t]==n[t]||O3(e.style,t,i[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(z3,"$1")),s=t.toLowerCase(),t=s in e||t=="onFocusOut"||t=="onFocusIn"?s.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=i,i?n?i.u=n.u:(i.u=U0,e.addEventListener(t,o?G0:V0,o)):e.removeEventListener(t,o?G0:V0,o);else{if(r=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=i??"";break e}catch{}typeof i=="function"||(i==null||i===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&i==1?"":i))}}function L3(e){return function(t){if(this.l){var i=this.l[t.type+e];if(t.t==null)t.t=U0++;else if(t.t<i.u)return;return i(at.event?at.event(t):t)}}}function q0(e,t,i,n,r,o,s,a,l,c){var d,u,h,p,f,g,m,v,C,b,S,E,x,P,F,N,Y,X=t.type;if(t.constructor!=null)return null;128&i.__u&&(l=!!(32&i.__u),o=[a=t.__e=i.__e]),(d=at.__b)&&d(t);e:if(typeof X=="function")try{if(v=t.props,C="prototype"in X&&X.prototype.render,b=(d=X.contextType)&&n[d.__c],S=d?b?b.props.value:d.__:n,i.__c?m=(u=t.__c=i.__c).__=u.__E:(C?t.__c=u=new X(v,S):(t.__c=u=new pi(v,S),u.constructor=X,u.render=VI),b&&b.sub(u),u.state||(u.state={}),u.__n=n,h=u.__d=!0,u.__h=[],u._sb=[]),C&&u.__s==null&&(u.__s=u.state),C&&X.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=nr({},u.__s)),nr(u.__s,X.getDerivedStateFromProps(v,u.__s))),p=u.props,f=u.state,u.__v=t,h)C&&X.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),C&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(C&&X.getDerivedStateFromProps==null&&v!==p&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(v,S),t.__v==i.__v||!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(v,u.__s,S)===!1){for(t.__v!=i.__v&&(u.props=v,u.state=u.__s,u.__d=!1),t.__e=i.__e,t.__k=i.__k,t.__k.some(function(Z){Z&&(Z.__=t)}),E=0;E<u._sb.length;E++)u.__h.push(u._sb[E]);u._sb=[],u.__h.length&&s.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(v,u.__s,S),C&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(p,f,g)})}if(u.context=S,u.props=v,u.__P=e,u.__e=!1,x=at.__r,P=0,C){for(u.state=u.__s,u.__d=!1,x&&x(t),d=u.render(u.props,u.state,u.context),F=0;F<u._sb.length;F++)u.__h.push(u._sb[F]);u._sb=[]}else do u.__d=!1,x&&x(t),d=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++P<25);u.state=u.__s,u.getChildContext!=null&&(n=nr(nr({},n),u.getChildContext())),C&&!h&&u.getSnapshotBeforeUpdate!=null&&(g=u.getSnapshotBeforeUpdate(p,f)),N=d,d!=null&&d.type===Wt&&d.key==null&&(N=$3(d.props.children)),a=U3(e,Zc(N)?N:[N],t,i,n,r,o,s,a,l,c),u.base=t.__e,t.__u&=-161,u.__h.length&&s.push(u),m&&(u.__E=u.__=null)}catch(Z){if(t.__v=null,l||o!=null)if(Z.then){for(t.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;o[o.indexOf(a)]=null,t.__e=a}else{for(Y=o.length;Y--;)j0(o[Y]);W0(t)}else t.__e=i.__e,t.__k=i.__k,Z.then||W0(t);at.__e(Z,t,i)}else o==null&&t.__v==i.__v?(t.__k=i.__k,t.__e=i.__e):a=t.__e=zI(i.__e,t,i,n,r,o,s,l,c);return(d=at.diffed)&&d(t),128&t.__u?void 0:a}function W0(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(W0)}function q3(e,t,i){for(var n=0;n<i.length;n++)$0(i[n],i[++n],i[++n]);at.__c&&at.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(o){o.call(r)})}catch(o){at.__e(o,r.__v)}})}function $3(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Zc(e)?e.map($3):nr({},e)}function zI(e,t,i,n,r,o,s,a,l){var c,d,u,h,p,f,g,m=i.props||Jc,v=t.props,C=t.type;if(C=="svg"?r="http://www.w3.org/2000/svg":C=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),o!=null){for(c=0;c<o.length;c++)if((p=o[c])&&"setAttribute"in p==!!C&&(C?p.localName==C:p.nodeType==3)){e=p,o[c]=null;break}}if(e==null){if(C==null)return document.createTextNode(v);e=document.createElementNS(r,C,v.is&&v),a&&(at.__m&&at.__m(t,o),a=!1),o=null}if(C==null)m===v||a&&e.data==v||(e.data=v);else{if(o=o&&Qc.call(e.childNodes),!a&&o!=null)for(m={},c=0;c<e.attributes.length;c++)m[(p=e.attributes[c]).name]=p.value;for(c in m)if(p=m[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=p;else if(!(c in v)){if(c=="value"&&"defaultValue"in v||c=="checked"&&"defaultChecked"in v)continue;Qh(e,c,null,p,r)}}for(c in v)p=v[c],c=="children"?h=p:c=="dangerouslySetInnerHTML"?d=p:c=="value"?f=p:c=="checked"?g=p:a&&typeof p!="function"||m[c]===p||Qh(e,c,p,m[c],r);if(d)a||u&&(d.__html==u.__html||d.__html==e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(u&&(e.innerHTML=""),U3(t.type=="template"?e.content:e,Zc(h)?h:[h],t,i,n,C=="foreignObject"?"http://www.w3.org/1999/xhtml":r,o,s,o?o[0]:i.__k&&Ya(i,0),a,l),o!=null)for(c=o.length;c--;)j0(o[c]);a||(c="value",C=="progress"&&f==null?e.removeAttribute("value"):f!=null&&(f!==e[c]||C=="progress"&&!f||C=="option"&&f!=m[c])&&Qh(e,c,f,m[c],r),c="checked",g!=null&&g!=e[c]&&Qh(e,c,g,m[c],r))}return e}function $0(e,t,i){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&t==null||(e.__u=e(t))}else e.current=t}catch(r){at.__e(r,i)}}function K3(e,t,i){var n,r;if(at.unmount&&at.unmount(e),(n=e.ref)&&(n.current&&n.current!=e.__e||$0(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){at.__e(o,t)}n.base=n.__P=null}if(n=e.__k)for(r=0;r<n.length;r++)n[r]&&K3(n[r],t,i||typeof e.type!="function");i||j0(e.__e),e.__c=e.__=e.__e=void 0}function VI(e,t,i){return this.constructor(e,i)}function K0(e,t,i){var n,r,o,s;t==document&&(t=document.documentElement),at.__&&at.__(e,t),r=(n=typeof i=="function")?null:i&&i.__k||t.__k,o=[],s=[],q0(t,e=(!n&&i||t).__k=ed(Wt,null,[e]),r||Jc,Jc,t.namespaceURI,!n&&i?[i]:r?null:t.firstChild?Qc.call(t.childNodes):null,o,!n&&i?i:r?r.__e:t.firstChild,n,s),q3(o,e,s)}function ep(e,t,i){var n,r,o,s,a=nr({},e.props);for(o in e.type&&e.type.defaultProps&&(s=e.type.defaultProps),t)o=="key"?n=t[o]:o=="ref"?r=t[o]:a[o]=t[o]===void 0&&s!=null?s[o]:t[o];return arguments.length>2&&(a.children=arguments.length>3?Qc.call(arguments,2):i),Xc(e.type,a,n||e.key,r||e.ref,null)}Qc=V3.slice,at={__e:function(e,t,i,n){for(var r,o,s;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(e)),s=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,n||{}),s=r.__d),s)return r.__E=r}catch(a){e=a}throw e}},N3=0,OI=function(e){return e!=null&&e.constructor==null},pi.prototype.setState=function(e,t){var i;i=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=nr({},this.state),typeof e=="function"&&(e=e(nr({},i),this.props)),e&&nr(i,e),e!=null&&this.__v&&(t&&this._sb.push(t),A3(this))},pi.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),A3(this))},pi.prototype.render=Wt,Ds=[],B3=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,H3=function(e,t){return e.__v.__b-t.__v.__b},Zh.__r=0,z3=/(PointerCapture)$|Capture$/i,U0=0,V0=L3(!1),G0=L3(!0),LI=0;var GI=0;function y(e,t,i,n,r,o){t||(t={});var s,a,l=t;if("ref"in l)for(a in l={},t)a=="ref"?s=t[a]:l[a]=t[a];var c={type:e,props:l,key:i,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--GI,__i:-1,__u:0,__source:r,__self:o};if(typeof e=="function"&&(s=e.defaultProps))for(a in s)l[a]===void 0&&(l[a]=s[a]);return at.vnode&&at.vnode(c),c}var td,Mt,Y0,Y3,id=0,nx=[],Ot=at,X3=Ot.__b,J3=Ot.__r,Q3=Ot.diffed,Z3=Ot.__c,ex=Ot.unmount,tx=Ot.__;function J0(e,t){Ot.__h&&Ot.__h(Mt,e,id||t),id=0;var i=Mt.__H||(Mt.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function Zi(e){return id=1,WI(ox,e)}function WI(e,t,i){var n=J0(td++,2);if(n.t=e,!n.__c&&(n.__=[i?i(t):ox(void 0,t),function(a){var l=n.__N?n.__N[0]:n.__[0],c=n.t(l,a);l!==c&&(n.__N=[c,n.__[1]],n.__c.setState({}))}],n.__c=Mt,!Mt.__f)){var r=function(a,l,c){if(!n.__c.__H)return!0;var d=n.__c.__H.__.filter(function(h){return!!h.__c});if(d.every(function(h){return!h.__N}))return!o||o.call(this,a,l,c);var u=n.__c.props!==a;return d.forEach(function(h){if(h.__N){var p=h.__[0];h.__=h.__N,h.__N=void 0,p!==h.__[0]&&(u=!0)}}),o&&o.call(this,a,l,c)||u};Mt.__f=!0;var o=Mt.shouldComponentUpdate,s=Mt.componentWillUpdate;Mt.componentWillUpdate=function(a,l,c){if(this.__e){var d=o;o=void 0,r(a,l,c),o=d}s&&s.call(this,a,l,c)},Mt.shouldComponentUpdate=r}return n.__N||n.__}function Gn(e,t){var i=J0(td++,3);!Ot.__s&&rx(i.__H,t)&&(i.__=e,i.u=t,Mt.__H.__h.push(i))}function or(e){return id=5,Fs(function(){return{current:e}},[])}function Fs(e,t){var i=J0(td++,7);return rx(i.__H,t)&&(i.__=e(),i.__H=t,i.__h=e),i.__}function Wn(e,t){return id=8,Fs(function(){return e},t)}function UI(){for(var e;e=nx.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(tp),e.__H.__h.forEach(X0),e.__H.__h=[]}catch(t){e.__H.__h=[],Ot.__e(t,e.__v)}}Ot.__b=function(e){Mt=null,X3&&X3(e)},Ot.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),tx&&tx(e,t)},Ot.__r=function(e){J3&&J3(e),td=0;var t=(Mt=e.__c).__H;t&&(Y0===Mt?(t.__h=[],Mt.__h=[],t.__.forEach(function(i){i.__N&&(i.__=i.__N),i.u=i.__N=void 0})):(t.__h.forEach(tp),t.__h.forEach(X0),t.__h=[],td=0)),Y0=Mt},Ot.diffed=function(e){Q3&&Q3(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(nx.push(t)!==1&&Y3===Ot.requestAnimationFrame||((Y3=Ot.requestAnimationFrame)||jI)(UI)),t.__H.__.forEach(function(i){i.u&&(i.__H=i.u),i.u=void 0})),Y0=Mt=null},Ot.__c=function(e,t){t.some(function(i){try{i.__h.forEach(tp),i.__h=i.__h.filter(function(n){return!n.__||X0(n)})}catch(n){t.some(function(r){r.__h&&(r.__h=[])}),t=[],Ot.__e(n,i.__v)}}),Z3&&Z3(e,t)},Ot.unmount=function(e){ex&&ex(e);var t,i=e.__c;i&&i.__H&&(i.__H.__.forEach(function(n){try{tp(n)}catch(r){t=r}}),i.__H=void 0,t&&Ot.__e(t,i.__v))};var ix=typeof requestAnimationFrame=="function";function jI(e){var t,i=function(){clearTimeout(n),ix&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(i,35);ix&&(t=requestAnimationFrame(i))}function tp(e){var t=Mt,i=e.__c;typeof i=="function"&&(e.__c=void 0,i()),Mt=t}function X0(e){var t=Mt;e.__c=e.__(),Mt=t}function rx(e,t){return!e||e.length!==t.length||t.some(function(i,n){return i!==e[n]})}function ox(e,t){return typeof t=="function"?t(e):t}var qI={position:"relative",width:"100%",minHeight:"100%"},$I={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};function Xa(s){var a=s,{data:e,rowHeight:t,renderRow:i,overscanCount:n=10,padding:r=4}=a,o=xt(a,["data","rowHeight","renderRow","overscanCount","padding"]);let l=or(null),[c,d]=Zi(0),[u,h]=Zi(0);Gn(()=>{function S(){l.current!=null&&u!==l.current.offsetHeight&&h(l.current.offsetHeight)}return S(),window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}},[u]);let p=Wn(()=>{l.current&&d(l.current.scrollTop)},[]),f=Math.floor(c/t),g=Math.floor(u/t);n&&(f=Math.max(0,f-f%n),g+=n);let m=f+g+r,v=e.slice(f,m),C=T(w({},qI),{height:e.length*t}),b=T(w({},$I),{top:f*t});return y("div",T(w({onScroll:p,ref:l},o),{children:y("div",{role:"presentation",style:C,children:y("div",{role:"presentation",style:b,children:v.map(i)})})}))}var jr=class{uppy;opts;id;defaultLocale;i18n;i18nArray;type;VERSION;constructor(t,i){this.uppy=t,this.opts=i??{}}getPluginState(){let{plugins:t}=this.uppy.getState();return t?.[this.id]||{}}setPluginState(t){let{plugins:i}=this.uppy.getState();this.uppy.setState({plugins:T(w({},i),{[this.id]:w(w({},i[this.id]),t)})})}setOptions(t){this.opts=w(w({},this.opts),t),this.setPluginState(void 0),this.i18nInit()}i18nInit(){let t=new _s([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.setPluginState(void 0)}addTarget(t){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(t){}afterUpdate(){}};var nd=class{#e;#t=[];constructor(t){this.#e=t}on(t,i){return this.#t.push([t,i]),this.#e.on(t,i)}remove(){for(let[t,i]of this.#t.splice(0))this.#e.off(t,i)}onFilePause(t,i){this.on("upload-pause",(n,r)=>{t===n?.id&&i(r)})}onFileRemove(t,i){this.on("file-removed",n=>{t===n.id&&i(n.id)})}onPause(t,i){this.on("upload-pause",(n,r)=>{t===n?.id&&i(r)})}onRetry(t,i){this.on("upload-retry",n=>{t===n?.id&&i()})}onRetryAll(t,i){this.on("retry-all",()=>{this.#e.getFile(t)&&i()})}onPauseAll(t,i){this.on("pause-all",()=>{this.#e.getFile(t)&&i()})}onCancelAll(t,i){this.on("cancel-all",(...n)=>{this.#e.getFile(t)&&i(...n)})}onResumeAll(t,i){this.on("resume-all",()=>{this.#e.getFile(t)&&i()})}};var sx={debug:()=>{},warn:()=>{},error:(...e)=>console.error(`[Uppy] [${Ps()}]`,...e)},ax={debug:(...e)=>console.debug(`[Uppy] [${Ps()}]`,...e),warn:(...e)=>console.warn(`[Uppy] [${Ps()}]`,...e),error:(...e)=>console.error(`[Uppy] [${Ps()}]`,...e)};var rd=ft(Gc(),1),px=ft(hx(),1),fx={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]},Bi=class extends Error{isUserFacing;file;constructor(t,i){super(t),this.isUserFacing=i?.isUserFacing??!0,i?.file&&(this.file=i.file)}isRestriction=!0},ip=class{getI18n;getOpts;constructor(t,i){this.getI18n=i,this.getOpts=()=>{let n=t();if(n.restrictions?.allowedFileTypes!=null&&!Array.isArray(n.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return n}}validateAggregateRestrictions(t,i){let{maxTotalFileSize:n,maxNumberOfFiles:r}=this.getOpts().restrictions;if(r&&t.filter(s=>!s.isGhost).length+i.length>r)throw new Bi(`${this.getI18n()("youCanOnlyUploadX",{smart_count:r})}`);if(n){let o=[...t,...i].reduce((s,a)=>s+(a.size??0),0);if(o>n)throw new Bi(this.getI18n()("aggregateExceedsSize",{sizeAllowed:(0,rd.default)(n),size:(0,rd.default)(o)}))}}validateSingleFile(t){let{maxFileSize:i,minFileSize:n,allowedFileTypes:r}=this.getOpts().restrictions;if(r&&!r.some(s=>s.includes("/")?t.type?(0,px.default)(t.type.replace(/;.*?$/,""),s):!1:s[0]==="."&&t.extension?t.extension.toLowerCase()===s.slice(1).toLowerCase():!1)){let s=r.join(", ");throw new Bi(this.getI18n()("youCanOnlyUploadFileTypes",{types:s}),{file:t})}if(i&&t.size!=null&&t.size>i)throw new Bi(this.getI18n()("exceedsSize",{size:(0,rd.default)(i),file:t.name??this.getI18n()("unnamed")}),{file:t});if(n&&t.size!=null&&t.size<n)throw new Bi(this.getI18n()("inferiorSize",{size:(0,rd.default)(n)}),{file:t})}validate(t,i){i.forEach(n=>{this.validateSingleFile(n)}),this.validateAggregateRestrictions(t,i)}validateMinNumberOfFiles(t){let{minNumberOfFiles:i}=this.getOpts().restrictions;if(i&&Object.keys(t).length<i)throw new Bi(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:i}))}getMissingRequiredMetaFields(t){let i=new Bi(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:t.name??this.getI18n()("unnamed")})),{requiredMetaFields:n}=this.getOpts().restrictions,r=[];for(let o of n)(!Object.hasOwn(t.meta,o)||t.meta[o]==="")&&r.push(o);return{missingFields:r,error:i}}};function XI(e){let t=null,i;return(...n)=>(i=n,t||(t=Promise.resolve().then(()=>(t=null,e(...i)))),t)}var Q0=class e extends jr{#e;isTargetDOMEl;el;parent;title;getTargetPlugin(t){let i;if(typeof t?.addTarget=="function")i=t,i instanceof e||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:i,UIPlugin:e}}));else if(typeof t=="function"){let n=t;this.uppy.iteratePlugins(r=>{r instanceof n&&(i=r)})}return i}mount(t,i){let n=i.id,r=T0(t);if(r){this.isTargetDOMEl=!0;let a=document.createElement("div");return a.classList.add("uppy-Root"),this.#e=XI(l=>{this.uppy.getPlugin(this.id)&&(K0(this.render(l,a),a),this.afterUpdate())}),this.uppy.log(`Installing ${n} to a DOM element '${t}'`),this.opts.replaceTargetContent&&(r.innerHTML=""),K0(this.render(this.uppy.getState(),a),a),this.el=a,r.appendChild(a),a.dir=this.opts.direction||N0(a)||"ltr",this.onMount(),this.el}let o=this.getTargetPlugin(t);if(o)return this.uppy.log(`Installing ${n} to ${o.id}`),this.parent=o,this.el=o.addTarget(i),this.onMount(),this.el;this.uppy.log(`Not installing ${n}`);let s=`Invalid target option given to ${n}.`;throw typeof t=="function"?s+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":s+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(s)}render(t,i){throw new Error("Extend the render method to add your plugin to a DOM element")}update(t){this.el!=null&&this.#e?.(t)}unmount(){this.isTargetDOMEl&&this.el?.remove(),this.onUnmount()}onMount(){}onUnmount(){}},od=Q0;var gx={name:"@uppy/store-default",description:"The default simple object-based store for Uppy.",version:"5.0.0",license:"MIT",main:"lib/index.js",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-store"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},devDependencies:{jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},exports:{".":"./lib/index.js","./package.json":"./package.json"},files:["src","lib","dist","CHANGELOG.md"]};var Z0=class{static VERSION=gx.version;state={};#e=new Set;getState(){return this.state}setState(t){let i=w({},this.state),n=w(w({},this.state),t);this.state=n,this.#t(i,n,t)}subscribe(t){return this.#e.add(t),()=>{this.#e.delete(t)}}#t(...t){this.#e.forEach(i=>{i(...t)})}},mx=Z0;var eE=ft(Yx(),1),tE=ft(Jx(),1);var UA="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var No=(e=21)=>{let t="",i=e|0;for(;i--;)t+=UA[Math.random()*64|0];return t};var Qx={name:"@uppy/core",description:"Core module for the extensible JavaScript file upload widget with support for drag&drop, resumable uploads, previews, restrictions, file processing/encoding, remote providers like Instagram, Dropbox, Google Drive, S3 and more :dog:",version:"5.2.0",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.min.css":"./dist/style.min.css","./css/style.css":"./dist/style.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/store-default":"^5.0.0","@uppy/utils":"^7.1.4",lodash:"^4.17.21","mime-match":"^1.0.2","namespace-emitter":"^2.0.1",nanoid:"^5.0.9",preact:"^10.5.13"},devDependencies:{"@types/deep-freeze":"^0",cssnano:"^7.0.7","deep-freeze":"^0.0.1",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"}};function nv(e,t){return t.name?t.name:e.split("/")[0]==="image"?`${e.split("/")[0]}.${e.split("/")[1]}`:"noname"}var Zx={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};function rv(e){if(e==null&&typeof navigator<"u"&&(e=navigator.userAgent),!e)return!0;let t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;let n=t[1].split(".",2),r=parseInt(n[0],10),o=parseInt(n[1],10);return r<15||r===15&&o<15063||r>18||r===18&&o>=18218}var op={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null},ov=class e{static VERSION=Qx.version;#e=Object.create(null);#t;#i;#n=(0,tE.default)();#r=new Set;#c=new Set;#s=new Set;defaultLocale;locale;opts;store;i18n;i18nArray;scheduledAutoProceed=null;wasOffline=!1;constructor(t){this.defaultLocale=Zx;let i={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:fx,meta:{},onBeforeFileAdded:(r,o)=>!Object.hasOwn(o,r.id),onBeforeUpload:r=>r,store:new mx,logger:sx,infoTimeout:5e3},n=w(w({},i),t);this.opts=T(w({},n),{restrictions:w(w({},i.restrictions),t?.restrictions)}),t?.logger&&t.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):t?.debug&&(this.opts.logger=ax),this.log(`Using Core v${e.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState(T(w({},op),{plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:rv(),individualCancellation:!0,resumableUploads:!1},meta:w({},this.opts.meta),info:[]})),this.#t=new ip(()=>this.opts,()=>this.i18n),this.#i=this.store.subscribe((r,o,s)=>{this.emit("state-update",r,o,s),this.updateAll(o)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),this.#C()}emit(t,...i){this.#n.emit(t,...i)}on(t,i){return this.#n.on(t,i),this}once(t,i){return this.#n.once(t,i),this}off(t,i){return this.#n.off(t,i),this}updateAll(t){this.iteratePlugins(i=>{i.update(t)})}setState(t){this.store.setState(t)}getState(){return this.store.getState()}patchFilesState(t){let i=this.getState().files;this.setState({files:w(w({},i),Object.fromEntries(Object.entries(t).map(([n,r])=>[n,w(w({},i[n]),r)])))})}setFileState(t,i){if(!this.getState().files[t])throw new Error(`Can\u2019t set state for ${t} (the file could have been removed)`);this.patchFilesState({[t]:i})}i18nInit(){let t=n=>this.log(`Missing i18n string: ${n}`,"error"),i=new _s([this.defaultLocale,this.opts.locale],{onMissingKey:t});this.i18n=i.translate.bind(i),this.i18nArray=i.translateArray.bind(i),this.locale=i.locale}setOptions(t){this.opts=T(w(w({},this.opts),t),{restrictions:w(w({},this.opts.restrictions),t?.restrictions)}),t.meta&&this.setMeta(t.meta),this.i18nInit(),t.locale&&this.iteratePlugins(i=>{i.setOptions(t)}),this.setState(void 0)}resetProgress(){let t={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},i=w({},this.getState().files),n=Object.create(null);Object.keys(i).forEach(r=>{n[r]=T(w({},i[r]),{progress:w(w({},i[r].progress),t),tus:void 0,transloadit:void 0})}),this.setState(w({files:n},op))}clear(){let{capabilities:t,currentUploads:i}=this.getState();if(Object.keys(i).length>0&&!t.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState(T(w({},op),{files:{}}))}addPreProcessor(t){this.#r.add(t)}removePreProcessor(t){return this.#r.delete(t)}addPostProcessor(t){this.#s.add(t)}removePostProcessor(t){return this.#s.delete(t)}addUploader(t){this.#c.add(t)}removeUploader(t){return this.#c.delete(t)}setMeta(t){let i=w(w({},this.getState().meta),t),n=w({},this.getState().files);Object.keys(n).forEach(r=>{n[r]=T(w({},n[r]),{meta:w(w({},n[r].meta),t)})}),this.log("Adding metadata:"),this.log(t),this.setState({meta:i,files:n})}setFileMeta(t,i){let n=w({},this.getState().files);if(!n[t]){this.log(`Was trying to set metadata for a file that has been removed: ${t}`);return}let r=w(w({},n[t].meta),i);n[t]=T(w({},n[t]),{meta:r}),this.setState({files:n})}getFile(t){return this.getState().files[t]}getFiles(){let{files:t}=this.getState();return Object.values(t)}getFilesByIds(t){return t.map(i=>this.getFile(i))}getObjectOfFilesPerState(){let{files:t,totalProgress:i,error:n}=this.getState(),r=Object.values(t),o=[],s=[],a=[],l=[],c=[],d=[],u=[],h=[],p=[];for(let f of r){let{progress:g}=f;!g.uploadComplete&&g.uploadStarted&&(o.push(f),f.isPaused||h.push(f)),g.uploadStarted||s.push(f),(g.uploadStarted||g.preprocess||g.postprocess)&&a.push(f),g.uploadStarted&&l.push(f),f.isPaused&&c.push(f),g.uploadComplete&&d.push(f),f.error&&u.push(f),(g.preprocess||g.postprocess)&&p.push(f)}return{newFiles:s,startedFiles:a,uploadStartedFiles:l,pausedFiles:c,completeFiles:d,erroredFiles:u,inProgressFiles:o,inProgressNotPausedFiles:h,processingFiles:p,isUploadStarted:l.length>0,isAllComplete:i===100&&d.length===r.length&&p.length===0,isAllErrored:!!n&&u.length===r.length,isAllPaused:o.length!==0&&c.length===o.length,isUploadInProgress:o.length>0,isSomeGhost:r.some(f=>f.isGhost)}}#a(t){for(let s of t)s.isRestriction?this.emit("restriction-failed",s.file,s):this.emit("error",s,s.file),this.log(s,"warning");let i=t.filter(s=>s.isUserFacing),n=4,r=i.slice(0,n),o=i.slice(n);r.forEach(({message:s,details:a=""})=>{this.info({message:s,details:a},"error",this.opts.infoTimeout)}),o.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:o.length})})}validateRestrictions(t,i=this.getFiles()){try{this.#t.validate(i,[t])}catch(n){return n}return null}validateSingleFile(t){try{this.#t.validateSingleFile(t)}catch(i){return i.message}return null}validateAggregateRestrictions(t){let i=this.getFiles();try{this.#t.validateAggregateRestrictions(i,t)}catch(n){return n.message}return null}#o(t){let{missingFields:i,error:n}=this.#t.getMissingRequiredMetaFields(t);return i.length>0?(this.setFileState(t.id,{missingRequiredMetaFields:i,error:n.message}),this.log(n.message),this.emit("restriction-failed",t,n),!1):(i.length===0&&t.missingRequiredMetaFields&&this.setFileState(t.id,{missingRequiredMetaFields:[]}),!0)}#p(t){let i=!0;for(let n of Object.values(t))this.#o(n)||(i=!1);return i}#l(t){let{allowNewUpload:i}=this.getState();if(i===!1){let n=new Bi(this.i18n("noMoreFilesAllowed"),{file:t});throw this.#a([n]),n}}checkIfFileAlreadyExists(t){let{files:i}=this.getState();return!!(i[t]&&!i[t].isGhost)}#u(t){let i=t instanceof File?{name:t.name,type:t.type,size:t.size,data:t,meta:{},isRemote:!1,source:void 0,preview:void 0}:t,n=Ka(i),r=nv(n,i),o=Vn(r).extension,s=qc(i,this.getID()),a=T(w({},i.meta),{name:r,type:n}),l=Number.isFinite(i.data.size)?i.data.size:null;return T(w({source:i.source||"",id:s,name:r,extension:o||"",meta:w(w({},this.getState().meta),a),type:n,progress:{percentage:0,bytesUploaded:!1,bytesTotal:l,uploadComplete:!1,uploadStarted:null},size:l,isGhost:!1},i.isRemote?{isRemote:!0,remote:i.remote,data:i.data}:{isRemote:!1,data:i.data}),{preview:i.preview})}#d(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(t=>{t.isRestriction||this.log(t.stack||t.message||t)})},4))}#h(t){let{files:i}=this.getState(),n=w({},i),r=[],o=[];for(let s of t)try{let a=this.#u(s);this.#l(a);let l=i[a.id],c=l?.isGhost;if(c&&!a.isRemote){if(a.data==null)throw new Error("File data is missing");a=T(w({},l),{isGhost:!1,data:a.data}),this.log(`Replaced the blob in the restored ghost file: ${a.name}, ${a.id}`)}let d=this.opts.onBeforeFileAdded(a,n);if(i=this.getState().files,n=w(w({},i),n),!d&&this.checkIfFileAlreadyExists(a.id))throw new Bi(this.i18n("noDuplicates",{fileName:a.name??this.i18n("unnamed")}),{file:a});if(d===!1&&!c)throw new Bi("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});typeof d=="object"&&d!==null&&(a=d),this.#t.validateSingleFile(a),n[a.id]=a,r.push(a)}catch(a){o.push(a)}try{this.#t.validateAggregateRestrictions(Object.values(i),r)}catch(s){return o.push(s),{nextFilesState:i,validFilesToAdd:[],errors:o}}return{nextFilesState:n,validFilesToAdd:r,errors:o}}addFile(t){let{nextFilesState:i,validFilesToAdd:n,errors:r}=this.#h([t]),o=r.filter(a=>a.isRestriction);if(this.#a(o),r.length>0)throw r[0];this.setState({files:i});let[s]=n;return this.emit("file-added",s),this.emit("files-added",n),this.log(`Added file: ${s.name}, ${s.id}, mime type: ${s.type}`),this.#d(),s.id}addFiles(t){let{nextFilesState:i,validFilesToAdd:n,errors:r}=this.#h(t),o=r.filter(a=>a.isRestriction);this.#a(o);let s=r.filter(a=>!a.isRestriction);if(s.length>0){let a=`Multiple errors occurred while adding files:
`;if(s.forEach(l=>{a+=`
 * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:s.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(s,a);{let l=new Error(a);throw l.errors=s,l}}this.setState({files:i}),n.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",n),n.length>5?this.log(`Added batch of ${n.length} files`):Object.values(n).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),n.length>0&&this.#d()}removeFiles(t){let{files:i,currentUploads:n}=this.getState(),r=w({},i),o=w({},n),s=Object.create(null);t.forEach(d=>{i[d]&&(s[d]=i[d],delete r[d])});function a(d){return s[d]===void 0}Object.keys(o).forEach(d=>{let u=n[d].fileIDs.filter(a);if(u.length===0){delete o[d];return}let{capabilities:h}=this.getState();if(u.length!==n[d].fileIDs.length&&!h.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");o[d]=T(w({},n[d]),{fileIDs:u})});let l={currentUploads:o,files:r};Object.keys(r).length===0&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),this.#m();let c=Object.keys(s);c.forEach(d=>{this.emit("file-removed",s[d])}),c.length>5?this.log(`Removed ${c.length} files`):this.log(`Removed files: ${c.join(", ")}`)}removeFile(t){this.removeFiles([t])}pauseResume(t){if(!this.getState().capabilities.resumableUploads||this.getFile(t).progress.uploadComplete)return;let i=this.getFile(t),r=!(i.isPaused||!1);return this.setFileState(t,{isPaused:r}),this.emit("upload-pause",i,r),r}pauseAll(){let t=w({},this.getState().files);Object.keys(t).filter(n=>!t[n].progress.uploadComplete&&t[n].progress.uploadStarted).forEach(n=>{let r=T(w({},t[n]),{isPaused:!0});t[n]=r}),this.setState({files:t}),this.emit("pause-all")}resumeAll(){let t=w({},this.getState().files);Object.keys(t).filter(n=>!t[n].progress.uploadComplete&&t[n].progress.uploadStarted).forEach(n=>{let r=T(w({},t[n]),{isPaused:!1,error:null});t[n]=r}),this.setState({files:t}),this.emit("resume-all")}#b(){let{files:t}=this.getState();return Object.keys(t).filter(i=>{let n=t[i];return n.error&&(!n.missingRequiredMetaFields||n.missingRequiredMetaFields.length===0)})}async#y(){let t=this.#b(),i=w({},this.getState().files);if(t.forEach(r=>{i[r]=T(w({},i[r]),{isPaused:!1,error:null})}),this.setState({files:i,error:null}),this.emit("retry-all",this.getFilesByIds(t)),t.length===0)return{successful:[],failed:[]};let n=this.#g(t,{forceAllowNewUpload:!0});return this.#x(n)}async retryAll(){let t=await this.#y();return this.emit("complete",t),t}cancelAll(){this.emit("cancel-all");let{files:t}=this.getState(),i=Object.keys(t);i.length&&this.removeFiles(i),this.setState(op)}retryUpload(t){this.setFileState(t,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(t));let i=this.#g([t],{forceAllowNewUpload:!0});return this.#x(i)}logout(){this.iteratePlugins(t=>{t.provider?.logout?.()})}#E=(t,i)=>{let n=t?this.getFile(t.id):void 0;if(t==null||!n){this.log(`Not setting progress for a file that has been removed: ${t?.id}`);return}if(n.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${t.id}`);return}let r={bytesTotal:i.bytesTotal,percentage:i.bytesTotal!=null&&Number.isFinite(i.bytesTotal)&&i.bytesTotal>0?Math.round(i.bytesUploaded/i.bytesTotal*100):void 0};n.progress.uploadStarted!=null?this.setFileState(t.id,{progress:T(w(w({},n.progress),r),{bytesUploaded:i.bytesUploaded})}):this.setFileState(t.id,{progress:w(w({},n.progress),r)}),this.#m()};#S(){let t=this.#R(),i=null;t!=null&&(i=Math.round(t*100),i>100?i=100:i<0&&(i=0)),this.emit("progress",i??0),this.setState({totalProgress:i??0})}#m=(0,eE.default)(()=>this.#S(),500,{leading:!0,trailing:!0});[Symbol.for("uppy test: updateTotalProgress")](){return this.#S()}#R(){let i=this.getFiles().filter(l=>l.progress.uploadStarted||l.progress.preprocess||l.progress.postprocess);if(i.length===0)return 0;if(i.every(l=>l.progress.uploadComplete))return 1;let n=l=>l.progress.bytesTotal!=null&&l.progress.bytesTotal!==0,r=i.filter(n),o=i.filter(l=>!n(l));if(r.every(l=>l.progress.uploadComplete)&&o.length>0&&!o.every(l=>l.progress.uploadComplete))return null;let s=r.reduce((l,c)=>l+(c.progress.bytesTotal??0),0),a=r.reduce((l,c)=>l+(c.progress.bytesUploaded||0),0);return s===0?0:a/s}#C(){let t=(r,o,s)=>{let a=r.message||"Unknown error";r.details&&(a+=` ${r.details}`),this.setState({error:a}),o!=null&&o.id in this.getState().files&&this.setFileState(o.id,{error:a,response:s})};this.on("error",t),this.on("upload-error",(r,o,s)=>{if(t(o,r,s),typeof o=="object"&&o.message){this.log(o.message,"error");let a=new Error(this.i18n("failedToUpload",{file:r?.name??""}));a.isUserFacing=!0,a.details=o.message,o.details&&(a.details+=` ${o.details}`),this.#a([a])}else this.#a([o])});let i=null;this.on("upload-stalled",(r,o)=>{let{message:s}=r,a=o.map(l=>l.meta.name).join(", ");i||(this.info({message:s,details:a},"warning",this.opts.infoTimeout),i=setTimeout(()=>{i=null},this.opts.infoTimeout)),this.log(`${s} ${a}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});let n=r=>{let o=r.filter(a=>{let l=a!=null&&this.getFile(a.id);return l||this.log(`Not setting progress for a file that has been removed: ${a?.id}`),l}),s=Object.fromEntries(o.map(a=>[a.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:a.size}}]));this.patchFilesState(s)};this.on("upload-start",n),this.on("upload-progress",this.#E),this.on("upload-success",(r,o)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let s=this.getFile(r.id).progress,a=this.#s.size>0;this.setFileState(r.id,{progress:T(w(T(w({},s),{postprocess:a?{mode:"indeterminate"}:void 0,uploadComplete:!0}),!a&&{complete:!0}),{percentage:100,bytesUploaded:s.bytesTotal}),response:o,uploadURL:o.uploadURL,isPaused:!1}),r.size==null&&this.setFileState(r.id,{size:o.bytesUploaded||s.bytesTotal}),this.#m()}),this.on("preprocess-progress",(r,o)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:T(w({},this.getFile(r.id).progress),{preprocess:o})})}),this.on("preprocess-complete",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let o=w({},this.getState().files);o[r.id]=T(w({},o[r.id]),{progress:w({},o[r.id].progress)}),delete o[r.id].progress.preprocess,this.setState({files:o})}),this.on("postprocess-progress",(r,o)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:T(w({},this.getState().files[r.id].progress),{postprocess:o})})}),this.on("postprocess-complete",r=>{let o=r&&this.getFile(r.id);if(o==null){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let l=o.progress,{postprocess:s}=l,a=xt(l,["postprocess"]);this.patchFilesState({[o.id]:{progress:T(w({},a),{complete:!0})}})}),this.on("restored",()=>{this.#m()}),this.on("dashboard:file-edit-complete",r=>{r&&this.#o(r)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",this.#f),window.addEventListener("offline",this.#f),setTimeout(this.#f,3e3))}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}#f=this.updateOnlineStatus.bind(this);getID(){return this.opts.id}use(t,...i){if(typeof t!="function"){let s=`Expected a plugin class, but got ${t===null?"null":typeof t}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(s)}let n=new t(this,...i),r=n.id;if(!r)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");let o=this.getPlugin(r);if(o){let s=`Already found a plugin named '${o.id}'. Tried to use: '${r}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(s)}return t.VERSION&&this.log(`Using ${r} v${t.VERSION}`),n.type in this.#e?this.#e[n.type].push(n):this.#e[n.type]=[n],n.install(),this.emit("plugin-added",n),this}getPlugin(t){for(let i of Object.values(this.#e)){let n=i.find(r=>r.id===t);if(n!=null)return n}}[Symbol.for("uppy test: getPlugins")](t){return this.#e[t]}iteratePlugins(t){Object.values(this.#e).flat(1).forEach(t)}removePlugin(t){this.log(`Removing plugin ${t.id}`),this.emit("plugin-remove",t),t.uninstall&&t.uninstall();let i=this.#e[t.type],n=i.findIndex(s=>s.id===t.id);n!==-1&&i.splice(n,1);let r=this.getState(),o={plugins:T(w({},r.plugins),{[t.id]:void 0})};this.setState(o)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),this.#i(),this.iteratePlugins(t=>{this.removePlugin(t)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",this.#f),window.removeEventListener("offline",this.#f))}hideInfo(){let{info:t}=this.getState();this.setState({info:t.slice(1)}),this.emit("info-hidden")}info(t,i="info",n=3e3){let r=typeof t=="object";this.setState({info:[...this.getState().info,{type:i,message:r?t.message:t,details:r?t.details:null}]}),setTimeout(()=>this.hideInfo(),n),this.emit("info-visible")}log(t,i){let{logger:n}=this.opts;switch(i){case"error":n.error(t);break;case"warning":n.warn(t);break;default:n.debug(t);break}}#w=new Map;registerRequestClient(t,i){this.#w.set(t,i)}getRequestClientForFile(t){if(!("remote"in t&&t.remote))throw new Error(`Tried to get RequestClient for a non-remote file ${t.id}`);let i=this.#w.get(t.remote.requestClientId);if(i==null)throw new Error(`requestClientId "${t.remote.requestClientId}" not registered for file "${t.id}"`);return i}async restore(t){this.log(`Core: Running restored upload "${t}"`);let i=await this.#x(t);return this.emit("complete",i),i}#g(t,i={}){let{forceAllowNewUpload:n=!1}=i,{allowNewUpload:r,currentUploads:o}=this.getState();if(!r&&!n)throw new Error("Cannot create a new upload: already uploading.");let s=No();return this.emit("upload",s,this.getFilesByIds(t)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:T(w({},o),{[s]:{fileIDs:t,step:0,result:{}}})}),s}[Symbol.for("uppy test: createUpload")](...t){return this.#g(...t)}#P(t){let{currentUploads:i}=this.getState();return i[t]}addResultData(t,i){if(!this.#P(t)){this.log(`Not setting result for an upload that has been removed: ${t}`);return}let{currentUploads:n}=this.getState(),r=T(w({},n[t]),{result:w(w({},n[t].result),i)});this.setState({currentUploads:T(w({},n),{[t]:r})})}#v(t){let r=this.getState().currentUploads,{[t]:i}=r,n=xt(r,[g2(t)]);this.setState({currentUploads:n})}async#x(t){let i=()=>{let{currentUploads:s}=this.getState();return s[t]},n=i();if(!n)throw new Error("Nonexistent upload");let r=[...this.#r,...this.#c,...this.#s];try{for(let s=n.step||0;s<r.length;s++){let a=r[s];this.setState({currentUploads:T(w({},this.getState().currentUploads),{[t]:T(w({},n),{step:s})})});let{fileIDs:l}=n;if(await a(l,t),n=i(),!n)break}}catch(s){throw this.#v(t),s}if(n){n.fileIDs.forEach(c=>{let d=this.getFile(c);d?.progress.postprocess&&this.emit("postprocess-complete",d)});let s=n.fileIDs.map(c=>this.getFile(c)),a=s.filter(c=>!c.error),l=s.filter(c=>c.error);this.addResultData(t,{successful:a,failed:l,uploadID:t}),n=i()}let o;return n&&(o=n.result,this.#v(t)),o==null&&(this.log(`Not setting result for an upload that has been removed: ${t}`),o={successful:[],failed:[],uploadID:t}),o}async upload(){this.#e.uploader?.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();if(this.#b().length>0){let r=await this.#y();if(!(this.getFiles().filter(s=>s.progress.uploadStarted==null).length>0))return this.emit("complete",r),r;({files:t}=this.getState())}let n=this.opts.onBeforeUpload(t);if(n===!1)throw new Error("Not starting the upload because onBeforeUpload returned false");n&&typeof n=="object"&&(t=n,this.setState({files:t}));try{if(this.#t.validateMinNumberOfFiles(t),!this.#p(t))throw new Bi(this.i18n("missingRequiredMetaField"));let{currentUploads:r}=this.getState(),o=Object.values(r).flatMap(c=>c.fileIDs),s=Object.keys(t).filter(c=>{let d=this.getFile(c);return d&&!d.progress.uploadStarted&&!o.includes(c)}),a=this.#g(s),l=await this.#x(a);return this.emit("complete",l),l}catch(r){throw this.#a([r]),r}}},sp=ov;var rE=ft(iE(),1);var nE={strings:{compressingImages:"Compressing images...",compressedX:"Saved %{size} by compressing images"}};var qA={quality:.6,limit:10},ap=class extends jr{#e;constructor(t,i){super(t,w(w({},qA),i)),this.id=this.opts.id||"Compressor",this.type="modifier",this.defaultLocale=nE,this.#e=new ks(this.opts.limit),this.i18nInit(),this.prepareUpload=this.prepareUpload.bind(this),this.compress=this.compress.bind(this)}compress(t){return new Promise((i,n)=>{new rE.default(t,T(w({},this.opts),{success:i,error:n}))})}async prepareUpload(t){let i=0,n=[],r=this.#e.wrapPromiseFunction(async s=>{try{if(s.data==null)throw new Error("File data is empty");let a=await this.compress(s.data),l=s.data.size-a.size;this.uppy.log(`[Image Compressor] Image ${s.id} compressed by ${(0,lv.default)(l)}`),i+=l;let{name:c,type:d,size:u}=a,h=Vn(c),f=`${Vn(s.meta.name).name}.${h.extension}`;this.uppy.setFileState(s.id,T(w(w(w(w({},c&&{name:c}),h.extension&&{extension:h.extension}),d&&{type:d}),u&&{size:u}),{data:a,meta:T(w({},s.meta),{type:d,name:f})})),n.push(s)}catch(a){this.uppy.log(`[Image Compressor] Failed to compress ${s.id}:`,"warning"),this.uppy.log(a,"warning")}}),o=t.map(s=>{let a=this.uppy.getFile(s);return this.uppy.emit("preprocess-progress",a,{mode:"indeterminate",message:this.i18n("compressingImages")}),a.isRemote||(a.data.type||(a.data=a.data.slice(0,a.data.size,a.type)),!a.type?.startsWith("image/"))?Promise.resolve():r(a)});await Promise.all(o),this.uppy.emit("compressor:complete",n),i>1024&&this.uppy.info(this.i18n("compressedX",{size:(0,lv.default)(i)}),"info");for(let s of t){let a=this.uppy.getFile(s);this.uppy.emit("preprocess-complete",a)}}install(){this.uppy.addPreProcessor(this.prepareUpload)}uninstall(){this.uppy.removePreProcessor(this.prepareUpload)}};function oE(e){let t=Wn(n=>{n.preventDefault(),e()},[e]),[i]=Zi(()=>{let n=document.createElement("form");return n.setAttribute("tabindex","-1"),n.id=No(),n});return Gn(()=>(document.body.appendChild(i),i.addEventListener("submit",t),()=>{i.removeEventListener("submit",t),document.body.removeChild(i)}),[i,t]),{formId:i.id}}function $A({value:e,onChange:t,onSubmit:i,inputLabel:n,i18n:r}){let{formId:o}=oE(i);return y("section",{className:"uppy-ProviderBrowser-searchFilter",children:[y("input",{className:"uppy-u-reset uppy-ProviderBrowser-searchFilterInput",type:"search","aria-label":n,placeholder:n,value:e,onInput:s=>t(s.target.value),form:o,"data-uppy-super-focusable":!0}),y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-ProviderBrowser-searchFilterIcon",width:"12",height:"12",viewBox:"0 0 12 12",children:y("path",{d:"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z"})}),e&&y("button",{className:"uppy-u-reset uppy-ProviderBrowser-searchFilterReset",type:"button","aria-label":r("resetFilter"),onClick:()=>t(""),children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",viewBox:"0 0 19 19",children:y("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"})})})]})}var sE=$A;function KA(){return y("svg",{width:"26",height:"26",viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg",children:y("g",{fill:"none","fill-rule":"evenodd",children:[y("circle",{fill:"#FFF",cx:"13",cy:"13",r:"13"}),y("path",{d:"M21.64 13.205c0-.639-.057-1.252-.164-1.841H13v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z",fill:"#4285F4","fill-rule":"nonzero"}),y("path",{d:"M13 22c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H4.957v2.332A8.997 8.997 0 0013 22z",fill:"#34A853","fill-rule":"nonzero"}),y("path",{d:"M7.964 14.71A5.41 5.41 0 017.682 13c0-.593.102-1.17.282-1.71V8.958H4.957A8.996 8.996 0 004 13c0 1.452.348 2.827.957 4.042l3.007-2.332z",fill:"#FBBC05","fill-rule":"nonzero"}),y("path",{d:"M13 7.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C17.463 4.891 15.426 4 13 4a8.997 8.997 0 00-8.043 4.958l3.007 2.332C8.672 9.163 10.656 7.58 13 7.58z",fill:"#EA4335","fill-rule":"nonzero"}),y("path",{d:"M4 4h18v18H4z"})]})})}function YA({pluginName:e,i18n:t,onAuth:i}){let n=e==="Google Drive",r=Wn(o=>{o.preventDefault(),i()},[i]);return y("form",{onSubmit:r,children:n?y("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn uppy-Provider-btn-google","data-uppy-super-focusable":!0,children:[y(KA,{}),t("signInWithGoogle")]}):y("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn","data-uppy-super-focusable":!0,children:t("authenticateWith",{pluginName:e})})})}var XA=({pluginName:e,i18n:t,onAuth:i})=>y(YA,{pluginName:e,i18n:t,onAuth:i});function cv({loading:e,pluginName:t,pluginIcon:i,i18n:n,handleAuth:r,renderForm:o=XA}){return y("div",{className:"uppy-Provider-auth",children:[y("div",{className:"uppy-Provider-authIcon",children:i()}),y("div",{className:"uppy-Provider-authTitle",children:n("authenticateWithTitle",{pluginName:t})}),o({pluginName:t,i18n:n,loading:e,onAuth:r})]})}var AE=ft(ki(),1),OE=ft(rp(),1);var aE={name:"@uppy/provider-views",description:"View library for Uppy remote provider plugins.",version:"5.2.2",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.min.css":"./dist/style.min.css","./css/style.css":"./dist/style.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@uppy/utils":"^7.1.5",classnames:"^2.2.6",lodash:"^4.17.21",nanoid:"^5.0.9","p-queue":"^8.0.0",preact:"^10.5.13"},devDependencies:{"@types/gapi":"^0.0.47","@types/google.accounts":"^0.0.14","@types/google.picker":"^0.0.42",cssnano:"^7.0.7",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.2.0"}};var lE=ft(ki(),1);function QA(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:11,height:14.5,viewBox:"0 0 44 58",children:y("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"})})}function ZA(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",style:{minWidth:16,marginRight:3},viewBox:"0 0 276.157 276.157",children:y("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"})})}function e9(){return y("svg",{"aria-hidden":"true",focusable:"false",style:{width:16,marginRight:4},viewBox:"0 0 58 58",children:[y("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),y("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"})]})}function Bo({itemIconString:e,alt:t=void 0}){if(e===null)return null;switch(e){case"file":return y(QA,{});case"folder":return y(ZA,{});case"video":return y(e9,{});default:return y("img",{src:e,alt:t,referrerPolicy:"no-referrer",loading:"lazy",width:16,height:16})}}function t9({file:e,toggleCheckbox:t,className:i,isDisabled:n,restrictionError:r,showTitles:o,children:s=null,i18n:a}){return y("li",{className:i,title:n&&r?r:void 0,children:[y("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox uppy-ProviderBrowserItem-checkbox--grid",onChange:t,name:"listitem",id:e.id,checked:e.status==="checked",disabled:n,"data-uppy-super-focusable":!0}),y("label",{htmlFor:e.id,"aria-label":e.data.name??a("unnamed"),className:"uppy-u-reset uppy-ProviderBrowserItem-inner",children:[y(Bo,{itemIconString:e.data.thumbnail||e.data.icon}),o&&(e.data.name??a("unnamed")),s]})]})}var dv=t9;function uv({file:e,openFolder:t,className:i,isDisabled:n,restrictionError:r,toggleCheckbox:o,showTitles:s,i18n:a}){return y("li",{className:i,title:e.status!=="checked"&&r?r:void 0,children:[y("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox",onChange:o,name:"listitem",id:e.id,checked:e.status==="checked","aria-label":e.data.isFolder?a("allFilesFromFolderNamed",{name:e.data.name??a("unnamed")}):null,disabled:n,"data-uppy-super-focusable":!0}),e.data.isFolder?y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowserItem-inner",onClick:()=>t(e.id),"aria-label":a("openFolderNamed",{name:e.data.name??a("unnamed")}),children:[y("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:y(Bo,{itemIconString:e.data.icon})}),s&&e.data.name?y("span",{className:"uppy-truncate-text",children:e.data.name}):a("unnamed")]}):y("label",{htmlFor:e.id,className:"uppy-u-reset uppy-ProviderBrowserItem-inner",children:[y("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:y(Bo,{itemIconString:e.data.icon})}),s&&y("span",{className:"uppy-truncate-text",children:e.data.name??a("unnamed")})]})]})}function hv(e){let{viewType:t,toggleCheckbox:i,showTitles:n,i18n:r,openFolder:o,file:s,utmSource:a}=e,l=s.type==="folder"?null:s.restrictionError,c=!!l&&s.status!=="checked",d={file:s,openFolder:o,toggleCheckbox:i,utmSource:a,i18n:r,viewType:t,showTitles:n,className:(0,lE.default)("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--disabled":c},{"uppy-ProviderBrowserItem--noPreview":s.data.icon==="video"},{"uppy-ProviderBrowserItem--is-checked":s.status==="checked"},{"uppy-ProviderBrowserItem--is-partial":s.status==="partial"}),isDisabled:c,restrictionError:l};switch(t){case"grid":return y(dv,w({},d));case"list":return y(uv,w({},d));case"unsplash":return y(dv,T(w({},d),{children:y("a",{href:`${s.data.author.url}?utm_source=${a}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",className:"uppy-ProviderBrowserItem-author",tabIndex:-1,children:s.data.author.name})}));default:throw new Error(`There is no such type ${t}`)}}function i9(e){let{displayedPartialTree:t,viewType:i,toggleCheckbox:n,handleScroll:r,showTitles:o,i18n:s,isLoading:a,openFolder:l,noResultsLabel:c,virtualList:d,utmSource:u}=e,[h,p]=Zi(!1);if(Gn(()=>{let g=v=>{v.key==="Shift"&&p(!1)},m=v=>{v.key==="Shift"&&p(!0)};return document.addEventListener("keyup",g),document.addEventListener("keydown",m),()=>{document.removeEventListener("keyup",g),document.removeEventListener("keydown",m)}},[]),a)return y("div",{className:"uppy-Provider-loading",children:typeof a=="string"?a:s("loading")});if(t.length===0)return y("div",{className:"uppy-Provider-empty",children:c});let f=g=>y(hv,{viewType:i,toggleCheckbox:m=>{m.stopPropagation(),m.preventDefault(),document.getSelection()?.removeAllRanges(),n(g,h)},showTitles:o,i18n:s,openFolder:l,file:g,utmSource:u},g.id);return d?y("div",{className:"uppy-ProviderBrowser-body",children:y(Xa,{className:"uppy-ProviderBrowser-list",data:t,renderRow:f,rowHeight:35.5})}):y("div",{className:"uppy-ProviderBrowser-body",children:y("ul",{className:"uppy-ProviderBrowser-list",onScroll:r,tabIndex:-1,children:t.map(f)})})}var cE=i9;var dE=ft(ki(),1);var n9=e=>e.filter(i=>i.type==="file"&&i.status==="checked"?!0:i.type==="folder"&&i.status==="checked"?!e.some(r=>r.type!=="root"&&r.parentId===i.id):!1).length,cp=n9;function pv({cancelSelection:e,donePicking:t,i18n:i,partialTree:n,validateAggregateRestrictions:r}){let o=Fs(()=>r(n),[n,r]),s=Fs(()=>cp(n),[n]);return s===0?null:y("div",{className:"uppy-ProviderBrowser-footer",children:[y("div",{className:"uppy-ProviderBrowser-footer-buttons",children:[y("button",{className:(0,dE.default)("uppy-u-reset uppy-c-btn uppy-c-btn-primary",{"uppy-c-btn--disabled":o}),disabled:!!o,onClick:t,type:"button",children:i("selectX",{smart_count:s})}),y("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onClick:e,type:"button",children:i("cancel")})]}),o&&y("div",{className:"uppy-ProviderBrowser-footer-error",children:o})]})}var r9=(e,t,i)=>{let n=e.name||e.id;return{id:e.id,source:t.id,name:n,type:e.mimeType,isRemote:!0,data:e,preview:e.thumbnail||void 0,meta:{authorName:e.author?.name,authorUrl:e.author?.url,relativePath:e.relDirPath||null,absolutePath:e.absDirPath},body:{fileId:e.id},remote:{companionUrl:t.opts.companionUrl,url:`${i.fileUrl(e.requestPath)}`,body:{fileId:e.id},providerName:i.name,provider:i.provider,requestClientId:i.provider}}},uE=r9;var o9=(e,t,i)=>{let n=e.map(s=>uE(s,t,i)),r=[],o=[];n.forEach(s=>{t.uppy.checkIfFileAlreadyExists(qc(s,t.uppy.getID()))?o.push(s):r.push(s)}),r.length>0&&t.uppy.info(t.uppy.i18n("addedNumFiles",{numFiles:r.length})),o.length>0&&t.uppy.info(`Not adding ${o.length} files because they already exist`),t.uppy.addFiles(r)},hE=o9;var s9=(e,t,i,n)=>{let r=t.findIndex(o=>o.id===n);if(r!==-1&&i){let o=t.findIndex(a=>a.id===e);return t.slice(Math.min(r,o),Math.max(r,o)+1).map(a=>a.id)}return[e]},pE=s9;var a9=e=>t=>{if(!t.isAuthError){if(t.name==="AbortError"){e.log("Aborting request","warning");return}e.log(t,"error"),t.name==="UserFacingApiError"&&e.info({message:e.i18n("companionError"),details:e.i18n(t.message)},"warning",5e3)}},Ms=a9;var l9=(e,t)=>{let i=e.find(r=>r.id===t),n=[];for(;n=[i,...n],i.type!=="root";){let r=i.parentId;i=e.find(o=>o.id===r)}return n},fE=l9;var gE=(e,t,i)=>{let n=t===null?"null":t;if(i[n])return i[n];let r=e.find(s=>s.id===t);if(r.type==="root")return[];let o=[...gE(e,r.parentId,i),r];return i[n]=o,o},c9=e=>{let t=Object.create(null);return e.filter(r=>r.type==="file"&&r.status==="checked").map(r=>{let o=gE(e,r.id,t),s=o.findIndex(d=>d.type==="folder"&&d.status==="checked"),a=o.slice(s),l=`/${o.map(d=>d.data.name).join("/")}`,c=a.length===1?void 0:a.map(d=>d.data.name).join("/");return T(w({},r.data),{absDirPath:l,relDirPath:c})})},mE=c9;var gv=ft(CE(),1);var ld=class extends Error{constructor(t){super(t),this.name="TimeoutError"}},mv=class extends Error{constructor(t){super(),this.name="AbortError",this.message=t}},wE=e=>globalThis.DOMException===void 0?new mv(e):new DOMException(e),bE=e=>{let t=e.reason===void 0?wE("This operation was aborted."):e.reason;return t instanceof Error?t:wE(t)};function vv(e,t){let{milliseconds:i,fallback:n,message:r,customTimers:o={setTimeout,clearTimeout}}=t,s,a,c=new Promise((d,u)=>{if(typeof i!="number"||Math.sign(i)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${i}\``);if(t.signal){let{signal:p}=t;p.aborted&&u(bE(p)),a=()=>{u(bE(p))},p.addEventListener("abort",a,{once:!0})}if(i===Number.POSITIVE_INFINITY){e.then(d,u);return}let h=new ld;s=o.setTimeout.call(void 0,()=>{if(n){try{d(n())}catch(p){u(p)}return}typeof e.cancel=="function"&&e.cancel(),r===!1?d():r instanceof Error?u(r):(h.message=r??`Promise timed out after ${i} milliseconds`,u(h))},i),(async()=>{try{d(await e)}catch(p){u(p)}})()}).finally(()=>{c.clear(),a&&t.signal&&t.signal.removeEventListener("abort",a)});return c.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},c}function Cv(e,t,i){let n=0,r=e.length;for(;r>0;){let o=Math.trunc(r/2),s=n+o;i(e[s],t)<=0?(n=++s,r-=o+1):r=o}return n}var up=class{#e=[];enqueue(t,i){i=w({priority:0},i);let n={priority:i.priority,id:i.id,run:t};if(this.size===0||this.#e[this.size-1].priority>=i.priority){this.#e.push(n);return}let r=Cv(this.#e,n,(o,s)=>s.priority-o.priority);this.#e.splice(r,0,n)}setPriority(t,i){let n=this.#e.findIndex(o=>o.id===t);if(n===-1)throw new ReferenceError(`No promise function with the id "${t}" exists in the queue.`);let[r]=this.#e.splice(n,1);this.enqueue(r.run,{priority:i,id:t})}dequeue(){return this.#e.shift()?.run}filter(t){return this.#e.filter(i=>i.priority===t.priority).map(i=>i.run)}get size(){return this.#e.length}};var hp=class extends gv.default{#e;#t;#i=0;#n;#r;#c=0;#s;#a;#o;#p;#l=0;#u;#d;#h;#b=1n;timeout;constructor(t){if(super(),t=w({carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:up},t),!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${t.intervalCap?.toString()??""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${t.interval?.toString()??""}\` (${typeof t.interval})`);this.#e=t.carryoverConcurrencyCount,this.#t=t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0,this.#n=t.intervalCap,this.#r=t.interval,this.#o=new t.queueClass,this.#p=t.queueClass,this.concurrency=t.concurrency,this.timeout=t.timeout,this.#h=t.throwOnTimeout===!0,this.#d=t.autoStart===!1}get#y(){return this.#t||this.#i<this.#n}get#E(){return this.#l<this.#u}#S(){this.#l--,this.#C(),this.emit("next")}#m(){this.#w(),this.#f(),this.#a=void 0}get#R(){let t=Date.now();if(this.#s===void 0){let i=this.#c-t;if(i<0)this.#i=this.#e?this.#l:0;else return this.#a===void 0&&(this.#a=setTimeout(()=>{this.#m()},i)),!0}return!1}#C(){if(this.#o.size===0)return this.#s&&clearInterval(this.#s),this.#s=void 0,this.emit("empty"),this.#l===0&&this.emit("idle"),!1;if(!this.#d){let t=!this.#R;if(this.#y&&this.#E){let i=this.#o.dequeue();return i?(this.emit("active"),i(),t&&this.#f(),!0):!1}}return!1}#f(){this.#t||this.#s!==void 0||(this.#s=setInterval(()=>{this.#w()},this.#r),this.#c=Date.now()+this.#r)}#w(){this.#i===0&&this.#l===0&&this.#s&&(clearInterval(this.#s),this.#s=void 0),this.#i=this.#e?this.#l:0,this.#g()}#g(){for(;this.#C(););}get concurrency(){return this.#u}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);this.#u=t,this.#g()}async#P(t){return new Promise((i,n)=>{t.addEventListener("abort",()=>{n(t.reason)},{once:!0})})}setPriority(t,i){this.#o.setPriority(t,i)}async add(t,i={}){return i.id??=(this.#b++).toString(),i=w({timeout:this.timeout,throwOnTimeout:this.#h},i),new Promise((n,r)=>{this.#o.enqueue(async()=>{this.#l++;try{i.signal?.throwIfAborted(),this.#i++;let o=t({signal:i.signal});i.timeout&&(o=vv(Promise.resolve(o),{milliseconds:i.timeout})),i.signal&&(o=Promise.race([o,this.#P(i.signal)]));let s=await o;n(s),this.emit("completed",s)}catch(o){if(o instanceof ld&&!i.throwOnTimeout){n();return}r(o),this.emit("error",o)}finally{this.#S()}},i),this.emit("add"),this.#C()})}async addAll(t,i){return Promise.all(t.map(async n=>this.add(n,i)))}start(){return this.#d?(this.#d=!1,this.#g(),this):this}pause(){this.#d=!0}clear(){this.#o=new this.#p}async onEmpty(){this.#o.size!==0&&await this.#v("empty")}async onSizeLessThan(t){this.#o.size<t||await this.#v("next",()=>this.#o.size<t)}async onIdle(){this.#l===0&&this.#o.size===0||await this.#v("idle")}async#v(t,i){return new Promise(n=>{let r=()=>{i&&!i()||(this.off(t,r),n())};this.on(t,r)})}get size(){return this.#o.size}sizeBy(t){return this.#o.filter(t).length}get pending(){return this.#l}get isPaused(){return this.#d}};var h9=e=>e.map(t=>w({},t)),pp=h9;var yE=async(e,t,i,n,r)=>{let o=[],s=i.cached?i.nextPagePath:i.id;for(;s;){let u=await n(s);o=o.concat(u.items),s=u.nextPagePath}let a=o.filter(u=>u.isFolder===!0),l=o.filter(u=>u.isFolder===!1),c=a.map(u=>({type:"folder",id:u.requestPath,cached:!1,nextPagePath:null,status:"checked",parentId:i.id,data:u})),d=l.map(u=>{let h=r(u);return{type:"file",id:u.requestPath,restrictionError:h,status:h?"unchecked":"checked",parentId:i.id,data:u}});i.cached=!0,i.nextPagePath=null,t.push(...d,...c),c.forEach(async u=>{e.add(()=>yE(e,t,u,n,r))})},p9=async(e,t,i,n)=>{let r=new hp({concurrency:6}),o=pp(e);return o.filter(a=>a.type==="folder"&&a.status==="checked"&&(a.cached===!1||a.nextPagePath)).forEach(a=>{r.add(()=>yE(r,o,a,t,i))}),r.on("completed",()=>{let a=o.filter(l=>l.type==="file"&&l.status==="checked").length;n(a)}),await r.onIdle(),o},SE=p9;var f9=(e,t,i,n,r)=>{let o=t.filter(f=>!e.find(g=>g.id===f.requestPath)),s=o.filter(f=>f.isFolder===!0),a=o.filter(f=>f.isFolder===!1),l=i.type==="folder"&&i.status==="checked",c=s.map(f=>({type:"folder",id:f.requestPath,cached:!1,nextPagePath:null,status:l?"checked":"unchecked",parentId:i.id,data:f})),d=a.map(f=>{let g=r(f);return{type:"file",id:f.requestPath,restrictionError:g,status:l&&!g?"checked":"unchecked",parentId:i.id,data:f}}),u=T(w({},i),{cached:!0,nextPagePath:n});return[...e.map(f=>f.id===u.id?u:f),...c,...d]},xE=f9;var g9=(e,t,i,n,r)=>{let o=e.find(f=>f.id===t),s=i.filter(f=>f.isFolder===!0),a=i.filter(f=>f.isFolder===!1),l=T(w({},o),{nextPagePath:n}),c=e.map(f=>f.id===l.id?l:f),d=l.type==="folder"&&l.status==="checked",u=s.map(f=>({type:"folder",id:f.requestPath,cached:!1,nextPagePath:null,status:d?"checked":"unchecked",parentId:l.id,data:f})),h=a.map(f=>{let g=r(f);return{type:"file",id:f.requestPath,restrictionError:g,status:d&&!g?"checked":"unchecked",parentId:l.id,data:f}});return[...c,...u,...h]},EE=g9;var RE=(e,t,i)=>{e.filter(r=>r.type!=="root"&&r.parentId===t).forEach(r=>{r.status=i&&!(r.type==="file"&&r.restrictionError)?"checked":"unchecked",RE(e,r.id,i)})},PE=(e,t)=>{let i=e.find(s=>s.id===t);if(i.type==="root")return;let n=e.filter(s=>s.type!=="root"&&s.parentId===i.id&&!(s.type==="file"&&s.restrictionError)),r=n.every(s=>s.status==="checked"),o=n.every(s=>s.status==="unchecked");r&&i.cached?i.status="checked":o?i.status="unchecked":i.status="partial",PE(e,i.parentId)},m9=(e,t)=>{let i=pp(e),n=i.filter(r=>r.type!=="root"&&t.includes(r.id));return n.forEach(r=>{let o=r.status==="checked"?"unchecked":"checked";r.type==="file"?r.status=r.restrictionError?"unchecked":o:r.status=o,RE(i,r.id,r.status==="checked")}),PE(i,n[0].parentId),i},kE=m9;var cd={afterOpenFolder:xE,afterScrollFolder:EE,afterToggleCheckbox:kE,afterFill:SE};var v9=e=>{let{scrollHeight:t,scrollTop:i,offsetHeight:n}=e.target;return t-(i+n)<50},_E=v9;var DE=ft(ki(),1);var C9=({i18n:e,item:t,toggleCheckbox:i,openFolder:n})=>{let r="restrictionError"in t&&t.restrictionError!=null&&t.status!=="checked";return y("li",{className:(0,DE.default)("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--disabled":r},{"uppy-ProviderBrowserItem--noPreview":t.data.icon==="video"},{"uppy-ProviderBrowserItem--is-checked":t.status==="checked"},{"uppy-ProviderBrowserItem--is-partial":t.status==="partial"}),title:("restrictionError"in t?t.restrictionError:void 0)??void 0,children:[y("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox",onChange:()=>i(t,!1),checked:t.status==="checked","aria-label":t.data.name??e("unnamed"),disabled:r,"data-uppy-super-focusable":!0}),y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowserItem-inner",disabled:r,"aria-label":t.data.name,onClick:()=>{t.data.isFolder&&n(t.id)},children:[y("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:y(Bo,{itemIconString:t.data.icon})}),t.data.name??e("unnamed")]})]})},FE=C9;var w9=({searchResults:e,toggleCheckbox:t,openFolder:i,i18n:n})=>e.length===0?y("div",{className:"uppy-Provider-empty",children:n("noFilesFound")}):y("div",{className:"uppy-ProviderBrowser-body",children:y("ul",{className:"uppy-ProviderBrowser-list",children:e.map(r=>y(FE,{i18n:n,item:r,toggleCheckbox:t,openFolder:i},r.id))})}),ME=w9;var TE=ft(ki(),1);function wv(e){let{openFolder:t,title:i,breadcrumbsIcon:n,breadcrumbs:r,i18n:o}=e;return y("div",{className:"uppy-Provider-breadcrumbs",children:[y("div",{className:"uppy-Provider-breadcrumbsIcon",children:n}),r.map((s,a)=>y(Wt,{children:[y("button",{type:"button",className:"uppy-u-reset uppy-c-btn",onClick:()=>t(s.id),children:s.type==="root"?i:s.data.name??o("unnamed")},s.id),r.length===a+1?"":" / "]}))]})}function bv({i18n:e,logout:t,username:i}){return y(Wt,{children:[i&&y("span",{className:"uppy-ProviderBrowser-user",children:i},"username"),y("button",{type:"button",onClick:t,className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowser-userLogout",children:e("logOut")},"logout")]})}function yv(e){return y("div",{className:"uppy-ProviderBrowser-header",children:y("div",{className:(0,TE.default)("uppy-ProviderBrowser-headerBar",!e.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple"),children:[e.showBreadcrumbs&&y(wv,{openFolder:e.openFolder,breadcrumbs:e.breadcrumbs,breadcrumbsIcon:e.pluginIcon?.(),title:e.title,i18n:e.i18n}),y(bv,{logout:e.logout,username:e.username,i18n:e.i18n})]})})}function dd(){return y("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:y("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}var IE=e=>({authenticated:void 0,partialTree:[{type:"root",id:e,cached:!1,nextPagePath:null}],currentFolderId:e,searchString:"",didFirstRender:!1,username:null,loading:!1}),fp=class e{static VERSION=aE.version;static[Symbol.for("uppy test: searchDebounceMs")];plugin;provider;opts;isHandlingScroll=!1;previousCheckbox=null;#e;constructor(t,i){this.plugin=t,this.provider=i.provider;let n={viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0,loadAllFiles:!1,virtualList:!1};this.opts=w(w({},n),i),this.openFolder=this.openFolder.bind(this),this.logout=this.logout.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleScroll=this.handleScroll.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.cancelSelection=this.cancelSelection.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.openSearchResultFolder=this.openSearchResultFolder.bind(this),this.clearSearchState=this.clearSearchState.bind(this),this.resetPluginState(),this.plugin.uppy.on("dashboard:close-panel",this.resetPluginState),this.plugin.uppy.registerRequestClient(this.provider.provider,this.provider);let r=Symbol.for("uppy test: searchDebounceMs"),o=e[r],s=o??500,a=o===0?{leading:!0,trailing:!0}:void 0;this.#e=(0,OE.default)(this.#n,s,a)}resetPluginState(){this.plugin.setPluginState(IE(this.plugin.rootFolderId))}tearDown(){}setLoading(t){this.plugin.setPluginState({loading:t})}get isLoading(){return this.plugin.getPluginState().loading}cancelSelection(){let{partialTree:t}=this.plugin.getPluginState(),i=t.map(n=>n.type==="root"?n:T(w({},n),{status:"unchecked"}));this.plugin.setPluginState({partialTree:i})}clearSearchState(){this.plugin.setPluginState({searchResults:void 0})}#t;async#i(t){this.#t?.abort();let i=new AbortController;this.#t=i;let n=()=>{i.abort()};try{this.plugin.uppy.on("dashboard:close-panel",n),this.plugin.uppy.on("cancel-all",n),await t(i.signal)}finally{this.plugin.uppy.off("dashboard:close-panel",n),this.plugin.uppy.off("cancel-all",n),this.#t=void 0}}async#n(){let{partialTree:t,currentFolderId:i,searchString:n}=this.plugin.getPluginState(),r=t.find(o=>o.id===i);if(n.trim()===""){this.#t?.abort(),this.clearSearchState();return}this.setLoading(!0),await this.#i(async o=>{let s=r.type==="root"?void 0:i,{items:a}=await this.provider.search(n,{signal:o,path:s}),{partialTree:l}=this.plugin.getPluginState(),c=[...l];for(let d of a){let h=decodeURIComponent(d.requestPath).split("/").filter(g=>g.length>0),p=this.plugin.rootFolderId,f;h.forEach((g,m,v)=>{let C=h.slice(0,m+1),b=encodeURIComponent(`/${C.join("/")}`),S=c.find(F=>F.id===b&&F.type!=="root");if(S){p=b,f=S.status==="checked";return}let E=m===v.length-1,x,P=f?"checked":"unchecked";if(E)if(d.isFolder)x={type:"folder",id:b,cached:!1,nextPagePath:null,status:P,parentId:p,data:d};else{let F=this.validateSingleFile(d);x={type:"file",id:b,restrictionError:F,status:F?"unchecked":P,parentId:p,data:d}}else x={type:"folder",id:b,cached:!1,nextPagePath:null,status:P,parentId:p,data:{name:decodeURIComponent(g),icon:"folder",isFolder:!0}};c.push(x),p=b,f=P==="checked"})}this.plugin.setPluginState({partialTree:c,searchResults:a.map(d=>d.requestPath)})}).catch(Ms(this.plugin.uppy)),this.setLoading(!1)}onSearchInput=t=>{this.plugin.setPluginState({searchString:t}),this.opts.supportsSearch&&this.#e()};async openSearchResultFolder(t){this.plugin.setPluginState({searchString:""}),await this.openFolder(t)}async openFolder(t){this.clearSearchState(),this.previousCheckbox=null;let{partialTree:i}=this.plugin.getPluginState(),n=i.find(r=>r.id===t);if(n.cached){this.plugin.setPluginState({currentFolderId:t,searchString:""});return}this.setLoading(!0),await this.#i(async r=>{let o=t,s=[];do{let{username:l,nextPagePath:c,items:d}=await this.provider.list(o,{signal:r});this.plugin.setPluginState({username:l}),o=c,s=s.concat(d),this.setLoading(this.plugin.uppy.i18n("loadedXFiles",{numFiles:s.length}))}while(this.opts.loadAllFiles&&o);let a=cd.afterOpenFolder(i,s,n,o,this.validateSingleFile);this.plugin.setPluginState({partialTree:a,currentFolderId:t,searchString:""})}).catch(Ms(this.plugin.uppy)),this.setLoading(!1)}async logout(){await this.#i(async t=>{let i=await this.provider.logout({signal:t});if(i.ok){if(!i.revoked){let n=this.plugin.uppy.i18n("companionUnauthorizeHint",{provider:this.plugin.title,url:i.manual_revoke_url});this.plugin.uppy.info(n,"info",7e3)}this.plugin.setPluginState(T(w({},IE(this.plugin.rootFolderId)),{authenticated:!1}))}}).catch(Ms(this.plugin.uppy))}async handleAuth(t){await this.#i(async i=>{this.setLoading(!0),await this.provider.login({authFormData:t,signal:i}),this.plugin.setPluginState({authenticated:!0}),await Promise.all([this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId)])}).catch(Ms(this.plugin.uppy)),this.setLoading(!1)}async handleScroll(t){let{partialTree:i,currentFolderId:n}=this.plugin.getPluginState(),r=i.find(o=>o.id===n);_E(t)&&!this.isHandlingScroll&&r.nextPagePath&&(this.isHandlingScroll=!0,await this.#i(async o=>{let{nextPagePath:s,items:a}=await this.provider.list(r.nextPagePath,{signal:o}),l=cd.afterScrollFolder(i,n,a,s,this.validateSingleFile);this.plugin.setPluginState({partialTree:l})}).catch(Ms(this.plugin.uppy)),this.isHandlingScroll=!1)}validateSingleFile=t=>{let i=Jh(t);return this.plugin.uppy.validateSingleFile(i)};async donePicking(){let{partialTree:t}=this.plugin.getPluginState();this.isLoading||(this.setLoading(!0),await this.#i(async i=>{let n=await cd.afterFill(t,s=>this.provider.list(s,{signal:i}),this.validateSingleFile,s=>{this.setLoading(this.plugin.uppy.i18n("addedNumFiles",{numFiles:s}))});if(this.validateAggregateRestrictions(n)){this.plugin.setPluginState({partialTree:n});return}let o=mE(n);hE(o,this.plugin,this.provider),this.resetPluginState()}).catch(Ms(this.plugin.uppy)),this.setLoading(!1))}toggleCheckbox(t,i){let{partialTree:n}=this.plugin.getPluginState(),r=pE(t.id,this.getDisplayedPartialTree(),i,this.previousCheckbox),o=cd.afterToggleCheckbox(n,r);this.plugin.setPluginState({partialTree:o}),this.previousCheckbox=t.id}getDisplayedPartialTree=()=>{let{partialTree:t,currentFolderId:i,searchString:n}=this.plugin.getPluginState(),r=t.filter(s=>s.type!=="root"&&s.parentId===i);return this.opts.supportsSearch||n.trim()===""?r:r.filter(s=>(s.data.name??this.plugin.uppy.i18n("unnamed")).toLowerCase().indexOf(n.trim().toLowerCase())!==-1)};getBreadcrumbs=()=>{let{partialTree:t,currentFolderId:i}=this.plugin.getPluginState();return fE(t,i)};getSelectedAmount=()=>{let{partialTree:t}=this.plugin.getPluginState();return cp(t)};validateAggregateRestrictions=t=>{let n=t.filter(r=>r.type==="file"&&r.status==="checked").map(r=>r.data);return this.plugin.uppy.validateAggregateRestrictions(n)};#r(){let{i18n:t}=this.plugin.uppy,{searchResults:i,partialTree:n}=this.plugin.getPluginState(),r=new Map;n.forEach(s=>{s.type!=="root"&&r.set(s.id,s)});let o=i.map(s=>{let a=r.get(s);if(a==null)throw new Error("Partial tree not complete");return a});return y(ME,{searchResults:o,openFolder:this.openSearchResultFolder,toggleCheckbox:this.toggleCheckbox,i18n:t})}render(t,i={}){let{didFirstRender:n}=this.plugin.getPluginState(),{i18n:r}=this.plugin.uppy;n||(this.plugin.setPluginState({didFirstRender:!0}),this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId));let o=w(w({},this.opts),i),{authenticated:s,loading:a}=this.plugin.getPluginState(),l=this.plugin.icon||dd;if(s===!1)return y(cv,{pluginName:this.plugin.title,pluginIcon:l,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,renderForm:o.renderAuthForm,loading:a});let{partialTree:c,username:d,searchString:u,searchResults:h}=this.plugin.getPluginState(),p=this.getBreadcrumbs();return y("div",{className:(0,AE.default)("uppy-ProviderBrowser",`uppy-ProviderBrowser-viewType--${o.viewType}`),children:[y(yv,{showBreadcrumbs:o.showBreadcrumbs,openFolder:this.openFolder,breadcrumbs:p,pluginIcon:l,title:this.plugin.title,logout:this.logout,username:d,i18n:r}),o.showFilter&&y(sE,{value:u,onChange:f=>this.onSearchInput(f),onSubmit:()=>{},inputLabel:r("filter"),i18n:r}),h?this.#r():y(cE,{toggleCheckbox:this.toggleCheckbox,displayedPartialTree:this.getDisplayedPartialTree(),openFolder:this.openFolder,virtualList:o.virtualList,noResultsLabel:r("noFilesFound"),handleScroll:this.handleScroll,viewType:o.viewType,showTitles:o.showTitles,i18n:this.plugin.uppy.i18n,isLoading:a,utmSource:"Companion"}),y(pv,{partialTree:c,donePicking:this.donePicking,cancelSelection:this.cancelSelection,i18n:r,validateAggregateRestrictions:this.validateAggregateRestrictions})]})}};function nt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var UE=typeof self<"u"?self:global,fd=typeof navigator<"u",b9=fd&&typeof HTMLImageElement>"u",LE=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),jE=UE.Buffer,qE=!!jE,y9=e=>e!==void 0;function $E(e){return e===void 0||(e instanceof Map?e.size===0:Object.values(e).filter(y9).length===0)}function Ut(e){let t=new Error(e);throw delete t.stack,t}function NE(e){let t=(function(i){let n=0;return i.ifd0.enabled&&(n+=1024),i.exif.enabled&&(n+=2048),i.makerNote&&(n+=2048),i.userComment&&(n+=1024),i.gps.enabled&&(n+=512),i.interop.enabled&&(n+=100),i.ifd1.enabled&&(n+=1024),n+2048})(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}var Sv=e=>String.fromCharCode.apply(null,e),BE=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0,Is=class e{static from(t,i){return t instanceof this&&t.le===i?t:new e(t,void 0,void 0,i)}constructor(t,i=0,n,r){if(typeof r=="boolean"&&(this.le=r),Array.isArray(t)&&(t=new Uint8Array(t)),t===0)this.byteOffset=0,this.byteLength=0;else if(t instanceof ArrayBuffer){n===void 0&&(n=t.byteLength-i);let o=new DataView(t,i,n);this._swapDataView(o)}else if(t instanceof Uint8Array||t instanceof DataView||t instanceof e){n===void 0&&(n=t.byteLength-i),(i+=t.byteOffset)+n>t.byteOffset+t.byteLength&&Ut("Creating view outside of available memory in ArrayBuffer");let o=new DataView(t.buffer,i,n);this._swapDataView(o)}else if(typeof t=="number"){let o=new DataView(new ArrayBuffer(t));this._swapDataView(o)}else Ut("Invalid input argument for BufferView: "+t)}_swapArrayBuffer(t){this._swapDataView(new DataView(t))}_swapBuffer(t){this._swapDataView(new DataView(t.buffer,t.byteOffset,t.byteLength))}_swapDataView(t){this.dataView=t,this.buffer=t.buffer,this.byteOffset=t.byteOffset,this.byteLength=t.byteLength}_lengthToEnd(t){return this.byteLength-t}set(t,i,n=e){return t instanceof DataView||t instanceof e?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||Ut("BufferView.set(): Invalid data argument."),this.toUint8().set(t,i),new n(this,i,t.byteLength)}subarray(t,i){return i=i||this._lengthToEnd(t),new e(this,t,i)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(t,i){return new Uint8Array(this.buffer,this.byteOffset+t,i)}getString(t=0,i=this.byteLength){return r=this.getUint8Array(t,i),BE?BE.decode(r):qE?Buffer.from(r).toString("utf8"):decodeURIComponent(escape(Sv(r)));var r}getLatin1String(t=0,i=this.byteLength){let n=this.getUint8Array(t,i);return Sv(n)}getUnicodeString(t=0,i=this.byteLength){let n=[];for(let r=0;r<i&&t+r<this.byteLength;r+=2)n.push(this.getUint16(t+r));return Sv(n)}getInt8(t){return this.dataView.getInt8(t)}getUint8(t){return this.dataView.getUint8(t)}getInt16(t,i=this.le){return this.dataView.getInt16(t,i)}getInt32(t,i=this.le){return this.dataView.getInt32(t,i)}getUint16(t,i=this.le){return this.dataView.getUint16(t,i)}getUint32(t,i=this.le){return this.dataView.getUint32(t,i)}getFloat32(t,i=this.le){return this.dataView.getFloat32(t,i)}getFloat64(t,i=this.le){return this.dataView.getFloat64(t,i)}getFloat(t,i=this.le){return this.dataView.getFloat32(t,i)}getDouble(t,i=this.le){return this.dataView.getFloat64(t,i)}getUintBytes(t,i,n){switch(i){case 1:return this.getUint8(t,n);case 2:return this.getUint16(t,n);case 4:return this.getUint32(t,n);case 8:return this.getUint64&&this.getUint64(t,n)}}getUint(t,i,n){switch(i){case 8:return this.getUint8(t,n);case 16:return this.getUint16(t,n);case 32:return this.getUint32(t,n);case 64:return this.getUint64&&this.getUint64(t,n)}}toString(t){return this.dataView.toString(t,this.constructor.name)}ensureChunk(){}};function Ev(e,t){Ut(`${e} '${t}' was not loaded, try using full build of exifr.`)}var gd=class extends Map{constructor(t){super(),this.kind=t}get(t,i){return this.has(t)||Ev(this.kind,t),i&&(t in i||(function(n,r){Ut(`Unknown ${n} '${r}'.`)})(this.kind,t),i[t].enabled||Ev(this.kind,t)),super.get(t)}keyList(){return Array.from(this.keys())}},wp=new gd("file parser"),en=new gd("segment parser"),Cd=new gd("file reader"),S9=UE.fetch;function HE(e,t){return(i=e).startsWith("data:")||i.length>1e4?Pv(e,t,"base64"):LE&&e.includes("://")?Rv(e,t,"url",gp):LE?Pv(e,t,"fs"):fd?Rv(e,t,"url",gp):void Ut("Invalid input argument");var i}async function Rv(e,t,i,n){return Cd.has(i)?Pv(e,t,i):n?(async function(r,o){let s=await o(r);return new Is(s)})(e,n):void Ut(`Parser ${i} is not loaded`)}async function Pv(e,t,i){let n=new(Cd.get(i))(e,t);return await n.read(),n}var gp=e=>S9(e).then(t=>t.arrayBuffer()),md=e=>new Promise((t,i)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=i,n.readAsArrayBuffer(e)}),kv=class extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}};function KE(e,t,i){let n=new kv;for(let[r,o]of i)n.set(r,o);if(Array.isArray(t))for(let r of t)e.set(r,n);else e.set(t,n);return n}function YE(e,t,i){let n,r=e.get(t);for(n of i)r.set(n[0],n[1])}var wd=new Map,Tv=new Map,Iv=new Map,Ja=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],bp=["jfif","xmp","icc","iptc","ihdr"],vd=["tiff",...bp],Lt=["ifd0","ifd1","exif","gps","interop"],Qa=[...vd,...Lt],Za=["makerNote","userComment"],yp=["translateKeys","translateValues","reviveValues","multiSegment"],el=[...yp,"sanitize","mergeOutput","silentErrors"],mp=class{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}},Ts=class extends mp{get needed(){return this.enabled||this.deps.size>0}constructor(t,i,n,r){if(super(),nt(this,"enabled",!1),nt(this,"skip",new Set),nt(this,"pick",new Set),nt(this,"deps",new Set),nt(this,"translateKeys",!1),nt(this,"translateValues",!1),nt(this,"reviveValues",!1),this.key=t,this.enabled=i,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=Lt.includes(t),this.canBeFiltered&&(this.dict=wd.get(t)),n!==void 0)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if(typeof n=="object"){if(this.enabled=!0,this.parse=n.parse!==!1,this.canBeFiltered){let{pick:o,skip:s}=n;o&&o.length>0&&this.translateTagSet(o,this.pick),s&&s.length>0&&this.translateTagSet(s,this.skip)}this.applyInheritables(n)}else n===!0||n===!1?this.parse=this.enabled=n:Ut(`Invalid options argument: ${n}`)}applyInheritables(t){let i,n;for(i of yp)n=t[i],n!==void 0&&(this[i]=n)}translateTagSet(t,i){if(this.dict){let n,r,{tagKeys:o,tagValues:s}=this.dict;for(n of t)typeof n=="string"?(r=s.indexOf(n),r===-1&&(r=o.indexOf(Number(n))),r!==-1&&i.add(Number(o[r]))):i.add(n)}else for(let n of t)i.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,vp(this.pick,this.deps)):this.enabled&&this.pick.size>0&&vp(this.pick,this.deps)}},Di={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},zE=new Map,As=class extends mp{static useCached(t){let i=zE.get(t);return i!==void 0||(i=new this(t),zE.set(t,i)),i}constructor(t){super(),t===!0?this.setupFromTrue():t===void 0?this.setupFromUndefined():Array.isArray(t)?this.setupFromArray(t):typeof t=="object"?this.setupFromObject(t):Ut(`Invalid options argument ${t}`),this.firstChunkSize===void 0&&(this.firstChunkSize=fd?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let t;for(t of Ja)this[t]=Di[t];for(t of el)this[t]=Di[t];for(t of Za)this[t]=Di[t];for(t of Qa)this[t]=new Ts(t,Di[t],void 0,this)}setupFromTrue(){let t;for(t of Ja)this[t]=Di[t];for(t of el)this[t]=Di[t];for(t of Za)this[t]=!0;for(t of Qa)this[t]=new Ts(t,!0,void 0,this)}setupFromArray(t){let i;for(i of Ja)this[i]=Di[i];for(i of el)this[i]=Di[i];for(i of Za)this[i]=Di[i];for(i of Qa)this[i]=new Ts(i,!1,void 0,this);this.setupGlobalFilters(t,void 0,Lt)}setupFromObject(t){let i;for(i of(Lt.ifd0=Lt.ifd0||Lt.image,Lt.ifd1=Lt.ifd1||Lt.thumbnail,Object.assign(this,t),Ja))this[i]=xv(t[i],Di[i]);for(i of el)this[i]=xv(t[i],Di[i]);for(i of Za)this[i]=xv(t[i],Di[i]);for(i of vd)this[i]=new Ts(i,Di[i],t[i],this);for(i of Lt)this[i]=new Ts(i,Di[i],t[i],this.tiff);this.setupGlobalFilters(t.pick,t.skip,Lt,Qa),t.tiff===!0?this.batchEnableWithBool(Lt,!0):t.tiff===!1?this.batchEnableWithUserValue(Lt,t):Array.isArray(t.tiff)?this.setupGlobalFilters(t.tiff,void 0,Lt):typeof t.tiff=="object"&&this.setupGlobalFilters(t.tiff.pick,t.tiff.skip,Lt)}batchEnableWithBool(t,i){for(let n of t)this[n].enabled=i}batchEnableWithUserValue(t,i){for(let n of t){let r=i[n];this[n].enabled=r!==!1&&r!==void 0}}setupGlobalFilters(t,i,n,r=n){if(t&&t.length){for(let s of r)this[s].enabled=!1;let o=VE(t,n);for(let[s,a]of o)vp(this[s].pick,a),this[s].enabled=!0}else if(i&&i.length){let o=VE(i,n);for(let[s,a]of o)vp(this[s].skip,a)}}filterNestedSegmentTags(){let{ifd0:t,exif:i,xmp:n,iptc:r,icc:o}=this;this.makerNote?i.deps.add(37500):i.skip.add(37500),this.userComment?i.deps.add(37510):i.skip.add(37510),n.enabled||t.skip.add(700),r.enabled||t.skip.add(33723),o.enabled||t.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:t,exif:i,gps:n,interop:r}=this;r.needed&&(i.deps.add(40965),t.deps.add(40965)),i.needed&&t.deps.add(34665),n.needed&&t.deps.add(34853),this.tiff.enabled=Lt.some(o=>this[o].enabled===!0)||this.makerNote||this.userComment;for(let o of Lt)this[o].finalizeFilters()}get onlyTiff(){return!bp.map(t=>this[t].enabled).some(t=>t===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let t of vd)this[t].enabled&&!en.has(t)&&Ev("segment parser",t)}};function VE(e,t){let i,n,r,o,s=[];for(r of t){for(o of(i=wd.get(r),n=[],i))(e.includes(o[0])||e.includes(o[1]))&&n.push(o[0]);n.length&&s.push([r,n])}return s}function xv(e,t){return e!==void 0?e:t!==void 0?t:void 0}function vp(e,t){for(let i of t)e.add(i)}nt(As,"default",Di);var tl=class{constructor(t){nt(this,"parsers",{}),nt(this,"output",{}),nt(this,"errors",[]),nt(this,"pushToErrors",i=>this.errors.push(i)),this.options=As.useCached(t)}async read(t){this.file=await(function(i,n){return typeof i=="string"?HE(i,n):fd&&!b9&&i instanceof HTMLImageElement?HE(i.src,n):i instanceof Uint8Array||i instanceof ArrayBuffer||i instanceof DataView?new Is(i):fd&&i instanceof Blob?Rv(i,n,"blob",md):void Ut("Invalid input argument")})(t,this.options)}setup(){if(this.fileParser)return;let{file:t}=this,i=t.getUint16(0);for(let[n,r]of wp)if(r.canHandle(t,i))return this.fileParser=new r(this.options,this.file,this.parsers),t[n]=!0;this.file.close&&this.file.close(),Ut("Unknown file format")}async parse(){let{output:t,errors:i}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),i.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&i.length>0&&(t.errors=i),$E(n=t)?void 0:n;var n}async executeParsers(){let{output:t}=this;await this.fileParser.parse();let i=Object.values(this.parsers).map(async n=>{let r=await n.parse();n.assignToOutput(t,r)});this.options.silentErrors&&(i=i.map(n=>n.catch(this.pushToErrors))),await Promise.all(i)}async extractThumbnail(){this.setup();let{options:t,file:i}=this,n=en.get("tiff",t);var r;if(i.tiff?r={start:0,type:"tiff"}:i.jpeg&&(r=await this.fileParser.getOrFindSegment("tiff")),r===void 0)return;let o=await this.fileParser.ensureSegmentChunk(r),s=this.parsers.tiff=new n(o,t,i),a=await s.extractThumbnail();return i.close&&i.close(),a}};async function XE(e,t){let i=new tl(t);return await i.read(e),i.parse()}var x9=Object.freeze({__proto__:null,parse:XE,Exifr:tl,fileParsers:wp,segmentParsers:en,fileReaders:Cd,tagKeys:wd,tagValues:Tv,tagRevivers:Iv,createDictionary:KE,extendDictionary:YE,fetchUrlAsArrayBuffer:gp,readBlobAsArrayBuffer:md,chunkedProps:Ja,otherSegments:bp,segments:vd,tiffBlocks:Lt,segmentsAndBlocks:Qa,tiffExtractables:Za,inheritables:yp,allFormatters:el,Options:As}),Ho=class{static findPosition(t,i){let n=t.getUint16(i+2)+2,r=typeof this.headerLength=="function"?this.headerLength(t,i,n):this.headerLength,o=i+r,s=n-r;return{offset:i,length:n,headerLength:r,start:o,size:s,end:o+s}}static parse(t,i={}){return new this(t,new As({[this.type]:i}),t).parse()}normalizeInput(t){return t instanceof Is?t:new Is(t)}constructor(t,i={},n){nt(this,"errors",[]),nt(this,"raw",new Map),nt(this,"handleError",r=>{if(!this.options.silentErrors)throw r;this.errors.push(r.message)}),this.chunk=this.normalizeInput(t),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=i,this.localOptions=i[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(t,i){let n=Iv.get(i),r=Tv.get(i),o=wd.get(i),s=this.options[i],a=s.reviveValues&&!!n,l=s.translateValues&&!!r,c=s.translateKeys&&!!o,d={};for(let[u,h]of t)a&&n.has(u)?h=n.get(u)(h):l&&r.has(u)&&(h=this.translateValue(h,r.get(u))),c&&o.has(u)&&(u=o.get(u)||u),d[u]=h;return d}translateValue(t,i){return i[t]||i.DEFAULT||t}assignToOutput(t,i){this.assignObjectToOutput(t,this.constructor.type,i)}assignObjectToOutput(t,i,n){if(this.globalOptions.mergeOutput)return Object.assign(t,n);t[i]?Object.assign(t[i],n):t[i]=n}};nt(Ho,"headerLength",4),nt(Ho,"type",void 0),nt(Ho,"multiSegment",!1),nt(Ho,"canHandle",()=>!1);function E9(e){return e===192||e===194||e===196||e===219||e===221||e===218||e===254}function R9(e){return e>=224&&e<=239}function P9(e,t,i){for(let[n,r]of en)if(r.canHandle(e,t,i))return n}var Cp=class extends class{constructor(t,i,n){nt(this,"errors",[]),nt(this,"ensureSegmentChunk",async r=>{let o=r.start,s=r.size||65536;if(this.file.chunked)if(this.file.available(o,s))r.chunk=this.file.subarray(o,s);else try{r.chunk=await this.file.readChunk(o,s)}catch(a){Ut(`Couldn't read segment: ${JSON.stringify(r)}. ${a.message}`)}else this.file.byteLength>o+s?r.chunk=this.file.subarray(o,s):r.size===void 0?r.chunk=this.file.subarray(o):Ut("Segment unreachable: "+JSON.stringify(r));return r.chunk}),this.extendOptions&&this.extendOptions(t),this.options=t,this.file=i,this.parsers=n}injectSegment(t,i){this.options[t].enabled&&this.createParser(t,i)}createParser(t,i){let n=new(en.get(t))(i,this.options,this.file);return this.parsers[t]=n}createParsers(t){for(let i of t){let{type:n,chunk:r}=i,o=this.options[n];if(o&&o.enabled){let s=this.parsers[n];s&&s.append||s||this.createParser(n,r)}}}async readSegments(t){let i=t.map(this.ensureSegmentChunk);await Promise.all(i)}}{constructor(...t){super(...t),nt(this,"appSegments",[]),nt(this,"jpegSegments",[]),nt(this,"unknownSegments",[])}static canHandle(t,i){return i===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(t){t===!0?(this.findAll=!0,this.wanted=new Set(en.keyList())):(t=t===void 0?en.keyList().filter(i=>this.options[i].enabled):t.filter(i=>this.options[i].enabled&&en.has(i)),this.findAll=!1,this.remaining=new Set(t),this.wanted=new Set(t)),this.unfinishedMultiSegment=!1}async findAppSegments(t=0,i){this.setupSegmentFinderArgs(i);let{file:n,findAll:r,wanted:o,remaining:s}=this;if(!r&&this.file.chunked&&(r=Array.from(o).some(a=>{let l=en.get(a),c=this.options[a];return l.multiSegment&&c.multiSegment}),r&&await this.file.readWhole()),t=this.findAppSegmentsInRange(t,n.byteLength),!this.options.onlyTiff&&n.chunked){let a=!1;for(;s.size>0&&!a&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:l}=n,c=this.appSegments.some(d=>!this.file.available(d.offset||d.start,d.length||d.size));if(a=t>l&&!c?!await n.readNextChunk(t):!await n.readNextChunk(l),(t=this.findAppSegmentsInRange(t,n.byteLength))===void 0)return}}}findAppSegmentsInRange(t,i){i-=2;let n,r,o,s,a,l,{file:c,findAll:d,wanted:u,remaining:h,options:p}=this;for(;t<i;t++)if(c.getUint8(t)===255){if(n=c.getUint8(t+1),R9(n)){if(r=c.getUint16(t+2),o=P9(c,t,r),o&&u.has(o)&&(s=en.get(o),a=s.findPosition(c,t),l=p[o],a.type=o,this.appSegments.push(a),!d&&(s.multiSegment&&l.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||h.delete(o)):h.delete(o),h.size===0)))break;p.recordUnknownSegments&&(a=Ho.findPosition(c,t),a.marker=n,this.unknownSegments.push(a)),t+=r+1}else if(E9(n)){if(r=c.getUint16(t+2),n===218&&p.stopAfterSos!==!1)return;p.recordJpegSegments&&this.jpegSegments.push({offset:t,length:r,marker:n}),t+=r+1}}return t}mergeMultiSegments(){if(!this.appSegments.some(i=>i.multiSegment))return;let t=(function(i,n){let r,o,s,a=new Map;for(let l=0;l<i.length;l++)r=i[l],o=r[n],a.has(o)?s=a.get(o):a.set(o,s=[]),s.push(r);return Array.from(a)})(this.appSegments,"type");this.mergedAppSegments=t.map(([i,n])=>{let r=en.get(i,this.options);return r.handleMultiSegments?{type:i,chunk:r.handleMultiSegments(n)}:n[0]})}getSegment(t){return this.appSegments.find(i=>i.type===t)}async getOrFindSegment(t){let i=this.getSegment(t);return i===void 0&&(await this.findAppSegments(0,[t]),i=this.getSegment(t)),i}};nt(Cp,"type","jpeg"),wp.set("jpeg",Cp);var k9=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],_v=class extends Ho{parseHeader(){var t=this.chunk.getUint16();t===18761?this.le=!0:t===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(t,i,n=new Map){let{pick:r,skip:o}=this.options[i];r=new Set(r);let s=r.size>0,a=o.size===0,l=this.chunk.getUint16(t);t+=2;for(let c=0;c<l;c++){let d=this.chunk.getUint16(t);if(s){if(r.has(d)&&(n.set(d,this.parseTag(t,d,i)),r.delete(d),r.size===0))break}else!a&&o.has(d)||n.set(d,this.parseTag(t,d,i));t+=12}return n}parseTag(t,i,n){let{chunk:r}=this,o=r.getUint16(t+2),s=r.getUint32(t+4),a=k9[o];if(a*s<=4?t+=8:t=r.getUint32(t+8),(o<1||o>13)&&Ut(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${i.toString(16)}, type: ${o}, offset ${t}`),t>r.byteLength&&Ut(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${i.toString(16)}, type: ${o}, offset ${t} is outside of chunk size ${r.byteLength}`),o===1)return r.getUint8Array(t,s);if(o===2)return(l=(function(c){for(;c.endsWith("\0");)c=c.slice(0,-1);return c})(l=r.getString(t,s)).trim())===""?void 0:l;var l;if(o===7)return r.getUint8Array(t,s);if(s===1)return this.parseTagValue(o,t);{let c=new((function(u){switch(u){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}})(o))(s),d=a;for(let u=0;u<s;u++)c[u]=this.parseTagValue(o,t),t+=d;return c}}parseTagValue(t,i){let{chunk:n}=this;switch(t){case 1:return n.getUint8(i);case 3:return n.getUint16(i);case 4:return n.getUint32(i);case 5:return n.getUint32(i)/n.getUint32(i+4);case 6:return n.getInt8(i);case 8:return n.getInt16(i);case 9:return n.getInt32(i);case 10:return n.getInt32(i)/n.getInt32(i+4);case 11:return n.getFloat(i);case 12:return n.getDouble(i);case 13:return n.getUint32(i);default:Ut(`Invalid tiff type ${t}`)}}},pd=class extends _v{static canHandle(t,i){return t.getUint8(i+1)===225&&t.getUint32(i+4)===1165519206&&t.getUint16(i+8)===0}async parse(){this.parseHeader();let{options:t}=this;return t.ifd0.enabled&&await this.parseIfd0Block(),t.exif.enabled&&await this.safeParse("parseExifBlock"),t.gps.enabled&&await this.safeParse("parseGpsBlock"),t.interop.enabled&&await this.safeParse("parseInteropBlock"),t.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(t){let i=this[t]();return i.catch!==void 0&&(i=i.catch(this.handleError)),i}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let t=this.chunk.getUint16(this.ifd0Offset),i=this.ifd0Offset+2+12*t;this.ifd1Offset=this.chunk.getUint32(i)}}parseBlock(t,i){let n=new Map;return this[i]=n,this.parseTags(t,i,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:t}=this;this.findIfd0Offset(),this.ifd0Offset<8&&Ut("Malformed EXIF data"),!t.chunked&&this.ifd0Offset>t.byteLength&&Ut(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${t.byteLength}`),t.tiff&&await t.ensureChunk(this.ifd0Offset,NE(this.options));let i=this.parseBlock(this.ifd0Offset,"ifd0");return i.size!==0?(this.exifOffset=i.get(34665),this.interopOffset=i.get(40965),this.gpsOffset=i.get(34853),this.xmp=i.get(700),this.iptc=i.get(33723),this.icc=i.get(34675),this.options.sanitize&&(i.delete(34665),i.delete(40965),i.delete(34853),i.delete(700),i.delete(33723),i.delete(34675)),i):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,NE(this.options));let t=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=t.get(40965)),this.makerNote=t.get(37500),this.userComment=t.get(37510),this.options.sanitize&&(t.delete(40965),t.delete(37500),t.delete(37510)),this.unpack(t,41728),this.unpack(t,41729),t}unpack(t,i){let n=t.get(i);n&&n.length===1&&t.set(i,n[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let t=this.parseBlock(this.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",GE(...t.get(2),t.get(1))),t.set("longitude",GE(...t.get(4),t.get(3)))),t}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(t=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||t))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let t=this.ifd1.get(513),i=this.ifd1.get(514);return this.chunk.getUint8Array(t,i)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let t,i,n,r={};for(i of Lt)if(t=this[i],!$E(t))if(n=this.canTranslate?this.translateBlock(t,i):Object.fromEntries(t),this.options.mergeOutput){if(i==="ifd1")continue;Object.assign(r,n)}else r[i]=n;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}assignToOutput(t,i){if(this.globalOptions.mergeOutput)Object.assign(t,i);else for(let[n,r]of Object.entries(i))this.assignObjectToOutput(t,n,r)}};function GE(e,t,i,n){var r=e+t/60+i/3600;return n!=="S"&&n!=="W"||(r*=-1),r}nt(pd,"type","tiff"),nt(pd,"headerLength",10),en.set("tiff",pd);var nge=Object.freeze({__proto__:null,default:x9,Exifr:tl,fileParsers:wp,segmentParsers:en,fileReaders:Cd,tagKeys:wd,tagValues:Tv,tagRevivers:Iv,createDictionary:KE,extendDictionary:YE,fetchUrlAsArrayBuffer:gp,readBlobAsArrayBuffer:md,chunkedProps:Ja,otherSegments:bp,segments:vd,tiffBlocks:Lt,segmentsAndBlocks:Qa,tiffExtractables:Za,inheritables:yp,allFormatters:el,Options:As,parse:XE}),Av={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},rge=Object.assign({},Av,{firstChunkSize:4e4,gps:[1,2,3,4]});var oge=Object.assign({},Av,{tiff:!1,ifd1:!0,mergeOutput:!1});var _9=Object.assign({},Av,{firstChunkSize:4e4,ifd0:[274]});async function D9(e){let t=new tl(_9);await t.read(e);let i=await t.parse();if(i&&i.ifd0)return i.ifd0[274]}var F9=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}}),ud=!0,hd=!0;if(typeof navigator=="object"){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,i,n]=t;ud=Number(i)+.1*Number(n)<13.4,hd=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);ud=hd=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);ud=hd=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);ud=hd=Number(t)<77}}async function JE(e){let t=await D9(e);return Object.assign({canvas:ud,css:hd},F9[t])}var Dv=class extends Is{constructor(...t){super(...t),nt(this,"ranges",new Fv),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(t,i,n){if(t===0&&this.byteLength===0&&n){let r=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(r)}else{let r=t+i;if(r>this.byteLength){let{dataView:o}=this._extend(r);this._swapDataView(o)}}}_extend(t){let i;i=qE?jE.allocUnsafe(t):new Uint8Array(t);let n=new DataView(i.buffer,i.byteOffset,i.byteLength);return i.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:i,dataView:n}}subarray(t,i,n=!1){return i=i||this._lengthToEnd(t),n&&this._tryExtend(t,i),this.ranges.add(t,i),super.subarray(t,i)}set(t,i,n=!1){n&&this._tryExtend(i,t.byteLength,t);let r=super.set(t,i);return this.ranges.add(i,r.byteLength),r}async ensureChunk(t,i){this.chunked&&(this.ranges.available(t,i)||await this.readChunk(t,i))}available(t,i){return this.ranges.available(t,i)}},Fv=class{constructor(){nt(this,"list",[])}get length(){return this.list.length}add(t,i,n=0){let r=t+i,o=this.list.filter(s=>WE(t,s.offset,r)||WE(t,s.end,r));if(o.length>0){t=Math.min(t,...o.map(a=>a.offset)),r=Math.max(r,...o.map(a=>a.end)),i=r-t;let s=o.shift();s.offset=t,s.length=i,s.end=r,this.list=this.list.filter(a=>!o.includes(a))}else this.list.push({offset:t,length:i,end:r})}available(t,i){let n=t+i;return this.list.some(r=>r.offset<=t&&n<=r.end)}};function WE(e,t,i){return e<=t&&t<=i}var Mv=class extends Dv{constructor(t,i){super(0),nt(this,"chunksRead",0),this.input=t,this.options=i}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(t=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let i=this.options.chunkSize,n=await this.readChunk(t,i);return!!n&&n.byteLength===i}async readChunk(t,i){if(this.chunksRead++,(i=this.safeWrapAddress(t,i))!==0)return this._readChunk(t,i)}safeWrapAddress(t,i){return this.size!==void 0&&t+i>this.size?Math.max(0,this.size-t):i}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}};Cd.set("blob",class extends Mv{async readWhole(){this.chunked=!1;let e=await md(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let i=t?e+t:void 0,n=this.input.slice(e,i),r=await md(n);return this.set(r,e,!0)}});var QE={name:"@uppy/thumbnail-generator",description:"Uppy plugin that generates small previews of images to show on your upload UI.",version:"5.1.0",license:"MIT",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","thumbnail","preview","resize"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./package.json":"./package.json"},dependencies:{"@uppy/utils":"^7.1.4",exifr:"^7.0.0"},devDependencies:{jsdom:"^26.1.0","namespace-emitter":"2.0.1",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.2.0"}};var ZE={strings:{generatingThumbnails:"Generating thumbnails..."}};function T9(e,t,i){try{e.getContext("2d").getImageData(0,0,1,1)}catch(n){if(n.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return e.toBlob?new Promise(n=>{e.toBlob(n,t,i)}).then(n=>{if(n===null)throw new Error("cannot read image, probably an svg with external resources");return n}):Promise.resolve().then(()=>k0(e.toDataURL(t,i),{})).then(n=>{if(n===null)throw new Error("could not extract blob, probably an old browser");return n})}function I9(e,t){let i=e.width,n=e.height;(t.deg===90||t.deg===270)&&(i=e.height,n=e.width);let r=document.createElement("canvas");r.width=i,r.height=n;let o=r.getContext("2d");return o.translate(i/2,n/2),t.canvas&&(o.rotate(t.rad),o.scale(t.scaleX,t.scaleY)),o.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),r}function A9(e){let t=e.width/e.height,i=5e6,n=4096,r=Math.floor(Math.sqrt(i*t)),o=Math.floor(i/Math.sqrt(i*t));if(r>n&&(r=n,o=Math.round(r/t)),o>n&&(o=n,r=Math.round(t*o)),e.width>r){let s=document.createElement("canvas");return s.width=r,s.height=o,s.getContext("2d").drawImage(e,0,0,r,o),s}return e}var O9={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1},Sp=class extends od{static VERSION=QE.version;queue;queueProcessing;defaultThumbnailDimension;thumbnailType;constructor(t,i){if(super(t,w(w({},O9),i)),this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=ZE,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(t,i,n){if(t.data==null)throw new Error("File data is empty");let r=URL.createObjectURL(t.data),o=new Promise((a,l)=>{let c=new Image;c.src=r,c.addEventListener("load",()=>{URL.revokeObjectURL(r),a(c)}),c.addEventListener("error",d=>{URL.revokeObjectURL(r),l(d.error||new Error("Could not create thumbnail"))})}),s=JE(t.data).catch(()=>1);return Promise.all([o,s]).then(([a,l])=>{let c=this.getProportionalDimensions(a,i,n,l.deg),d=I9(a,l),u=this.resizeImage(d,c.width,c.height);return T9(u,this.thumbnailType,80)}).then(a=>URL.createObjectURL(a))}getProportionalDimensions(t,i,n,r){let o=t.width/t.height;if((r===90||r===270)&&(o=t.height/t.width),i!=null){let s=i;return t.width<i&&(s=t.width),{width:s,height:Math.round(s/o)}}if(n!=null){let s=n;return t.height<n&&(s=t.height),{width:Math.round(s*o),height:s}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/o)}}resizeImage(t,i,n){let r=A9(t),o=Math.ceil(Math.log2(r.width/i));o<1&&(o=1);let s=i*2**(o-1),a=n*2**(o-1),l=2;for(;o--;){let c=document.createElement("canvas");c.width=s,c.height=a,c.getContext("2d").drawImage(r,0,0,s,a),r=c,s=Math.round(s/l),a=Math.round(a/l)}return r}setPreviewURL(t,i){this.uppy.setFileState(t,{preview:i})}addToQueue(t){this.queue.push(t),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){let t=this.uppy.getFile(this.queue.shift());return t?this.requestThumbnail(t).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(t){return Kc(t.type)&&!t.isRemote?this.createThumbnail(t,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(i=>{this.setPreviewURL(t.id,i),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${t.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(t.id),i)}).catch(i=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${t.id}:`,"warning"),this.uppy.log(i,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(t.id),i)}):Promise.resolve()}onFileAdded=t=>{!t.preview&&t.data&&Kc(t.type)&&!t.isRemote&&this.addToQueue(t.id)};onCancelRequest=t=>{let i=this.queue.indexOf(t.id);i!==-1&&this.queue.splice(i,1)};onFileRemoved=t=>{let i=this.queue.indexOf(t.id);i!==-1&&this.queue.splice(i,1),t.preview&&$c(t.preview)&&URL.revokeObjectURL(t.preview)};onRestored=()=>{this.uppy.getFiles().filter(i=>i.isRestored).forEach(i=>{(!i.preview||$c(i.preview))&&this.addToQueue(i.id)})};onAllFilesRemoved=()=>{this.queue=[]};waitUntilAllProcessed=t=>{t.forEach(n=>{let r=this.uppy.getFile(n);this.uppy.emit("preprocess-progress",r,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});let i=()=>{t.forEach(n=>{let r=this.uppy.getFile(n);this.uppy.emit("preprocess-complete",r)})};return new Promise(n=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{i(),n()}):(i(),n())})};install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}};var e6={name:"@uppy/dashboard",description:"Universal UI plugin for Uppy.",version:"5.1.0",license:"MIT",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --silent='passed-only'","test:e2e":"vitest run --project browser"},keywords:["file uploader","uppy","uppy-plugin","dashboard","ui"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./css/style.css":"./dist/style.css","./css/style.min.css":"./dist/style.min.css","./css/style.scss":"./src/style.scss","./package.json":"./package.json"},dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/provider-views":"^5.2.0","@uppy/thumbnail-generator":"^5.1.0","@uppy/utils":"^7.1.4",classnames:"^2.2.6",lodash:"^4.17.21",nanoid:"^5.0.9",preact:"^10.5.13","shallow-equal":"^3.0.0"},devDependencies:{"@uppy/core":"^5.2.0","@uppy/dropbox":"^5.1.0","@uppy/google-drive":"^5.1.0","@uppy/url":"^5.1.0","@uppy/webcam":"^5.1.0","@vitest/browser":"^3.2.4",cssnano:"^7.0.7",jsdom:"^26.1.0",playwright:"1.54.1",postcss:"^8.5.6","postcss-cli":"^11.0.1","resize-observer-polyfill":"^1.5.0",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.2.0"}};var I6=ft(ki(),1);var Ov=class extends pi{fileInput=null;folderInput=null;mobilePhotoFileInput=null;mobileVideoFileInput=null;triggerFileInputClick=()=>{this.fileInput?.click()};triggerFolderInputClick=()=>{this.folderInput?.click()};triggerVideoCameraInputClick=()=>{this.mobileVideoFileInput?.click()};triggerPhotoCameraInputClick=()=>{this.mobilePhotoFileInput?.click()};onFileInputChange=t=>{this.props.handleInputChange(t),t.currentTarget.value=""};renderHiddenInput=(t,i)=>y("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:t,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes?.join(", "),ref:i});renderHiddenCameraInput=(t,i,n)=>{let o={photo:"image/*",video:"video/*"}[t];return y("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${t}`,onChange:this.onFileInputChange,capture:i===""?"environment":i,accept:o,ref:n})};renderMyDeviceAcquirer=()=>y("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[y("div",{className:"uppy-DashboardTab-inner",children:y("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:y("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),y("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})});renderPhotoCamera=()=>y("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[y("div",{className:"uppy-DashboardTab-inner",children:y("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:y("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),y("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})});renderVideoCamera=()=>y("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[y("div",{className:"uppy-DashboardTab-inner",children:y("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:y("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),y("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})});renderBrowseButton=(t,i)=>{let n=this.props.acquirers.length;return y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:i,"data-uppy-super-focusable":n===0,children:t})};renderDropPasteBrowseTagline=t=>{let i=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),n=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),r=this.props.fileManagerSelectionType,o=r.charAt(0).toUpperCase()+r.slice(1);return y("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):t>0?this.props.i18nArray(`dropPasteImport${o}`,{browseFiles:i,browseFolders:n,browse:i}):this.props.i18nArray(`dropPaste${o}`,{browseFiles:i,browseFolders:n,browse:i})})};[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderAcquirer=t=>y("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":t.id,children:y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":t.id,"aria-controls":`uppy-DashboardContent-panel--${t.id}`,"aria-selected":this.props.activePickerPanel?.id===t.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(t.id),children:[y("div",{className:"uppy-DashboardTab-inner",children:t.icon()}),y("div",{className:"uppy-DashboardTab-name",children:t.name})]})});renderAcquirers=t=>{let i=[...t],n=i.splice(t.length-2,t.length);return y(Wt,{children:[i.map(r=>this.renderAcquirer(r)),y("span",{role:"presentation",style:{"white-space":"nowrap"},children:n.map(r=>this.renderAcquirer(r))})]})};renderSourcesList=(t,i)=>{let{showNativePhotoCameraButton:n,showNativeVideoCameraButton:r}=this.props,o=[],s="myDevice";i||o.push({key:s,elements:this.renderMyDeviceAcquirer()}),n&&o.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),r&&o.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),o.push(...t.map(d=>({key:d.id,elements:this.renderAcquirer(d)}))),o.length===1&&o[0].key===s&&(o=[]);let l=[...o],c=l.splice(o.length-2,o.length);return y(Wt,{children:[this.renderDropPasteBrowseTagline(o.length),y("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[l.map(({key:d,elements:u})=>y(Wt,{children:u},d)),y("span",{role:"presentation",style:{"white-space":"nowrap"},children:c.map(({key:d,elements:u})=>y(Wt,{children:u},d))})]})]})};renderPoweredByUppy(){let{i18nArray:t}=this.props,i=y("span",{children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:y("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),y("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),n=t("poweredBy",{uppy:i});return y("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:n})}render(){let{showNativePhotoCameraButton:t,showNativeVideoCameraButton:i,nativeCameraFacingMode:n}=this.props;return y("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,r=>{this.fileInput=r}),this.renderHiddenInput(!0,r=>{this.folderInput=r}),t&&this.renderHiddenCameraInput("photo",n,r=>{this.mobilePhotoFileInput=r}),i&&this.renderHiddenCameraInput("video",n,r=>{this.mobileVideoFileInput=r}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),y("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&y("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}},xp=Ov;var t6=ft(ki(),1);var N9=e=>y("div",{className:(0,t6.default)("uppy-Dashboard-AddFilesPanel",e.className),"data-uppy-panelType":"AddFiles","aria-hidden":!e.showAddFilesPanel,children:[y("div",{className:"uppy-DashboardContent-bar",children:[y("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:e.i18n("addingMoreFiles")}),y("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>e.toggleAddFilesPanel(!1),children:e.i18n("back")})]}),y(xp,w({},e))]}),i6=N9;var n6=ft(ki(),1);function B9(e){let t=e.files[e.fileCardFor],i=()=>{e.uppy.emit("file-editor:cancel",t),e.closeFileEditor()};return y("div",{className:(0,n6.default)("uppy-DashboardContent-panel",e.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[y("div",{className:"uppy-DashboardContent-bar",children:[y("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:e.i18nArray("editing",{file:y("span",{className:"uppy-DashboardContent-titleFile",children:t.meta?t.meta.name:t.name})})}),y("button",{className:"uppy-DashboardContent-back",type:"button",onClick:i,children:e.i18n("cancel")}),y("button",{className:"uppy-DashboardContent-save",type:"button",onClick:e.saveFileEditor,children:e.i18n("save")})]}),y("div",{className:"uppy-DashboardContent-panelBody",children:e.editors.map(n=>e.uppy.getPlugin(n.id).render(e.state))})]})}var r6=B9;var o6=ft(ki(),1);function H9(){return y("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:y("g",{fill:"#686DE0",fillRule:"evenodd",children:[y("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),y("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),y("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}function z9(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}function V9(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}function G9(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}function W9(){return y("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}function U9(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[y("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),y("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}function j9(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:y("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}function Os(e){let t={color:"#838999",icon:U9()};if(!e)return t;let i=e.split("/")[0],n=e.split("/")[1];return i==="text"?{color:"#5a5e69",icon:j9()}:i==="image"?{color:"#686de0",icon:H9()}:i==="audio"?{color:"#068dbb",icon:z9()}:i==="video"?{color:"#19af67",icon:V9()}:i==="application"&&n==="pdf"?{color:"#e25149",icon:G9()}:i==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(n)!==-1?{color:"#00C469",icon:W9()}:t}function q9(e){let{tagName:t}=e.target;if(t==="INPUT"||t==="TEXTAREA"){e.stopPropagation();return}e.preventDefault(),e.stopPropagation()}var sr=q9;function bd(e){let{file:t}=e;if(t.preview)return y("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:t.name,src:t.preview});let{color:i,icon:n}=Os(t.type);return y("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[y("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:i},children:n}),y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:y("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}function Lv(e){let{computedMetaFields:t,requiredMetaFields:i,updateMeta:n,form:r,formState:o}=e,s={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return t.map(a=>{let l=`uppy-Dashboard-FileCard-input-${a.id}`,c=i.includes(a.id);return y("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[y("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:l,children:a.name}),a.render!==void 0?a.render({value:o[a.id],onChange:d=>n(d,a.id),fieldCSSClasses:s,required:c,form:r.id},ed):y("input",{className:s.text,id:l,form:r.id,type:a.type||"text",required:c,value:o[a.id],placeholder:a.placeholder,onInput:d=>n(d.target.value,a.id),"data-uppy-super-focusable":!0})]},a.id)})}function Nv(e){let{files:t,fileCardFor:i,toggleFileCard:n,saveFileCard:r,metaFields:o,requiredMetaFields:s,openFileEditor:a,i18n:l,i18nArray:c,className:d,canEditFile:u}=e,h=()=>typeof o=="function"?o(t[i]):o,p=t[i],f=h()??[],g=u(p),m={};f.forEach(F=>{m[F.id]=p.meta[F.id]??""});let[v,C]=Zi(m),b=Wn(F=>{F.preventDefault(),r(v,i)},[r,v,i]),S=(F,N)=>{C(T(w({},v),{[N]:F}))},E=()=>{n(!1)},[x]=Zi(()=>{let F=document.createElement("form");return F.setAttribute("tabindex","-1"),F.id=No(),F}),P=or(null);return Gn(()=>{let F=P.current?.getRootNode()??document;return F instanceof Document?F.body.appendChild(x):(F instanceof ShadowRoot,F.appendChild(x)),x.addEventListener("submit",b),()=>{x.removeEventListener("submit",b),x.parentNode&&x.parentNode.removeChild(x)}},[x,b]),y("div",{className:(0,o6.default)("uppy-Dashboard-FileCard",d),"data-uppy-panelType":"FileCard",onDragOver:sr,onDragLeave:sr,onDrop:sr,onPaste:sr,ref:P,children:[y("div",{className:"uppy-DashboardContent-bar",children:[y("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:c("editing",{file:y("span",{className:"uppy-DashboardContent-titleFile",children:p.meta?p.meta.name:p.name})})}),y("button",{className:"uppy-DashboardContent-back",type:"button",form:x.id,title:l("finishEditingFile"),onClick:E,children:l("cancel")})]}),y("div",{className:"uppy-Dashboard-FileCard-inner",children:[y("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:Os(p.type).color},children:[y(bd,{file:p}),g&&y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:F=>{b(F),a(p)},children:l("editImage")})]}),y("div",{className:"uppy-Dashboard-FileCard-info",children:y(Lv,{computedMetaFields:f,requiredMetaFields:s,updateMeta:S,form:x,formState:v})}),y("div",{className:"uppy-Dashboard-FileCard-actions",children:[y("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:x.id,children:l("saveChanges")}),y("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:E,form:x.id,children:l("cancel")})]})]})]})}var c6=ft(ki(),1);function s6(e,t){if(e===t)return!0;if(!e||!t)return!1;let i=Object.keys(e),n=Object.keys(t),r=i.length;if(n.length!==r)return!1;for(let o=0;o<r;o++){let s=i[o];if(e[s]!==t[s]||!Object.prototype.hasOwnProperty.call(t,s))return!1}return!0}function Bv(e,t="Copy the URL below"){return new Promise(i=>{let n=document.createElement("textarea");n.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),n.value=e,document.body.appendChild(n),n.select();let r=()=>{document.body.removeChild(n),window.prompt(t,e),i()};try{return document.execCommand("copy")?(document.body.removeChild(n),i()):r()}catch{return document.body.removeChild(n),r()}})}function $9({file:e,uploadInProgressOrComplete:t,metaFields:i,canEditFile:n,i18n:r,onClick:o}){return!t&&i&&i.length>0||!t&&n(e)?y("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":r("editFileWithFilename",{file:e.meta.name}),title:r("editFileWithFilename",{file:e.meta.name}),onClick:()=>o(),children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:y("g",{fillRule:"evenodd",children:[y("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),y("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),y("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}function K9({i18n:e,onClick:t,file:i}){return y("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":e("removeFile",{file:i.meta.name}),title:e("removeFile",{file:i.meta.name}),onClick:()=>t(),children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[y("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),y("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}function Y9({file:e,uppy:t,i18n:i}){let n=r=>{Bv(e.uploadURL,i("copyLinkToClipboardFallback")).then(()=>{t.log("Link copied to clipboard."),t.info(i("copyLinkToClipboardSuccess"),"info",3e3)}).catch(t.log).then(()=>r.target.focus({preventScroll:!0}))};return y("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":i("copyLink"),title:i("copyLink"),onClick:r=>n(r),children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:y("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}function Hv(e){let{uppy:t,file:i,uploadInProgressOrComplete:n,canEditFile:r,metaFields:o,showLinkToFileUploadResult:s,showRemoveButton:a,i18n:l,toggleFileCard:c,openFileEditor:d}=e;return y("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[y($9,{i18n:l,file:i,uploadInProgressOrComplete:n,canEditFile:r,metaFields:o,onClick:()=>{o&&o.length>0?c(!0,i.id):d(i)}}),s&&i.uploadURL?y(Y9,{file:i,uppy:t,i18n:l}):null,a?y(K9,{i18n:l,file:i,onClick:()=>t.removeFile(i.id)}):null]})}var a6=ft(Gc(),1);var X9=(e,t)=>(typeof t=="function"?t():t).filter(r=>r.id===e)[0].name;function yd(e){let{file:t,toggleFileCard:i,i18n:n,metaFields:r}=e,{missingRequiredMetaFields:o}=t;if(!o?.length)return null;let s=o.map(a=>X9(a,r)).join(", ");return y("div",{className:"uppy-Dashboard-Item-errorMessage",children:[n("missingRequiredMetaFields",{smart_count:o.length,fields:s})," ",y("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>i(!0,t.id),children:n("editFile")})]})}var J9=e=>{let{author:t,name:i}=e.file.meta;function n(){return e.isSingleFile&&e.containerHeight>=350?90:e.containerWidth<=352?35:e.containerWidth<=576?60:t?20:30}return y("div",{className:"uppy-Dashboard-Item-name",title:i,children:Yc(i,n())})},Q9=e=>{let{author:t}=e.file.meta,i="remote"in e.file?e.file.remote?.providerName:void 0,n="\xB7";return t?y("div",{className:"uppy-Dashboard-Item-author",children:[y("a",{href:`${t.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:Yc(t.name,13)}),i?y(Wt,{children:[` ${n} `,i,` ${n} `]}):null]}):null},Z9=e=>e.file.size&&y("div",{className:"uppy-Dashboard-Item-statusSize",children:(0,a6.default)(e.file.size)}),eO=e=>e.file.isGhost&&y("span",{children:[" \u2022 ",y("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>e.toggleAddFilesPanel(!0),children:e.i18n("reSelect")})]}),tO=({file:e,onClick:t})=>e.error?y("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":e.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:t,type:"button",children:"?"}):null;function zv(e){let{file:t,i18n:i,toggleFileCard:n,metaFields:r,toggleAddFilesPanel:o,isSingleFile:s,containerHeight:a,containerWidth:l}=e;return y("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":t.source,children:[y("div",{className:"uppy-Dashboard-Item-fileName",children:[J9({file:t,isSingleFile:s,containerHeight:a,containerWidth:l}),y(tO,{file:t,onClick:()=>alert(t.error)})]}),y("div",{className:"uppy-Dashboard-Item-status",children:[Q9({file:t}),Z9({file:t}),eO({file:t,toggleAddFilesPanel:o,i18n:i})]}),y(yd,{file:t,i18n:i,toggleFileCard:n,metaFields:r})]})}function Vv(e){let{file:t,i18n:i,toggleFileCard:n,metaFields:r,showLinkToFileUploadResult:o}=e,a=t.preview?"rgba(255, 255, 255, 0.5)":Os(t.type).color;return y("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:a},children:[o&&t.uploadURL&&y("a",{className:"uppy-Dashboard-Item-previewLink",href:t.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":t.meta.name,children:y("span",{hidden:!0,children:t.meta.name})}),y(bd,{file:t}),y(yd,{file:t,i18n:i,toggleFileCard:n,metaFields:r})]})}function iO(e){if(!e.isUploaded){if(e.error&&!e.hideRetryButton){e.uppy.retryUpload(e.file.id);return}e.resumableUploads&&!e.hidePauseResumeButton?e.uppy.pauseResume(e.file.id):e.individualCancellation&&!e.hideCancelButton&&e.uppy.removeFile(e.file.id)}}function l6(e){return e.isUploaded?e.i18n("uploadComplete"):e.error?e.i18n("retryUpload"):e.resumableUploads?e.file.isPaused?e.i18n("resumeUpload"):e.i18n("pauseUpload"):e.individualCancellation?e.i18n("cancelUpload"):""}function Gv(e){return y("div",{className:"uppy-Dashboard-Item-progress",children:y("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":l6(e),title:l6(e),onClick:()=>iO(e),children:e.children})})}function Ep({children:e}){return y("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:e})}function Wv({progress:e}){let t=2*Math.PI*15;return y("g",{children:[y("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),y("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":t,"stroke-dashoffset":t-t/100*e})]})}function Uv(e){return!e.file.progress.uploadStarted||e.file.progress.percentage===void 0?null:e.isUploaded?y("div",{className:"uppy-Dashboard-Item-progress",children:y("div",{className:"uppy-Dashboard-Item-progressIndicator",children:y(Ep,{children:[y("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),y("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):e.recoveredState?null:e.error&&!e.hideRetryButton?y(Gv,T(w({},e),{children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[y("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),y("path",{d:"M7.9 3H10v2H7.9z"}),y("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),y("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})})):e.resumableUploads&&!e.hidePauseResumeButton?y(Gv,T(w({},e),{children:y(Ep,{children:[y(Wv,{progress:e.file.progress.percentage}),e.file.isPaused?y("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):y("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[y("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),y("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})})):!e.resumableUploads&&e.individualCancellation&&!e.hideCancelButton?y(Gv,T(w({},e),{children:y(Ep,{children:[y(Wv,{progress:e.file.progress.percentage}),y("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})})):y("div",{className:"uppy-Dashboard-Item-progress",children:y("div",{className:"uppy-Dashboard-Item-progressIndicator",children:y(Ep,{children:y(Wv,{progress:e.file.progress.percentage})})})})}var Rp=class extends pi{componentDidMount(){let{file:t}=this.props;t.preview||this.props.handleRequestThumbnail(t)}shouldComponentUpdate(t){return!s6(this.props,t)}componentDidUpdate(){let{file:t}=this.props;t.preview||this.props.handleRequestThumbnail(t)}componentWillUnmount(){let{file:t}=this.props;t.preview||this.props.handleCancelThumbnail(t)}render(){let{file:t}=this.props,i=t.progress.preprocess||t.progress.postprocess,n=!!t.progress.uploadComplete&&!i&&!t.error,r=!!t.progress.uploadStarted||!!i,o=t.progress.uploadStarted&&!t.progress.uploadComplete||i,s=t.error||!1,{isGhost:a}=t,l=(this.props.individualCancellation||!o)&&!n;n&&this.props.showRemoveButtonAfterComplete&&(l=!0);let c=(0,c6.default)({"uppy-Dashboard-Item":!0,"is-inprogress":o&&!this.props.recoveredState,"is-processing":i,"is-complete":n,"is-error":!!s,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":a});return y("div",{className:c,id:`uppy_${t.id}`,role:this.props.role,children:[y("div",{className:"uppy-Dashboard-Item-preview",children:[y(Vv,{file:t,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),y(Uv,{uppy:this.props.uppy,file:t,error:s,isUploaded:n,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),y("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[y(zv,{file:t,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),y(Hv,{file:t,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:l,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:r,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}};function nO(e,t){let i=[],n=[];return e.forEach(r=>{n.length<t?n.push(r):(i.push(n),n=[r])}),n.length&&i.push(n),i}function jv({id:e,i18n:t,uppy:i,files:n,resumableUploads:r,hideRetryButton:o,hidePauseResumeButton:s,hideCancelButton:a,showLinkToFileUploadResult:l,showRemoveButtonAfterComplete:c,metaFields:d,isSingleFile:u,toggleFileCard:h,handleRequestThumbnail:p,handleCancelThumbnail:f,recoveredState:g,individualCancellation:m,itemsPerRow:v,openFileEditor:C,canEditFile:b,toggleAddFilesPanel:S,containerWidth:E,containerHeight:x}){let P=v===1?71:200,F=Fs(()=>{let Y=(Z,me)=>Number(n[me].isGhost)-Number(n[Z].isGhost),X=Object.keys(n);return g&&X.sort(Y),nO(X,v)},[n,v,g]),N=Y=>y("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:Y.map(X=>y(Rp,{uppy:i,id:e,i18n:t,resumableUploads:r,individualCancellation:m,hideRetryButton:o,hidePauseResumeButton:s,hideCancelButton:a,showLinkToFileUploadResult:l,showRemoveButtonAfterComplete:c,metaFields:d,recoveredState:g,isSingleFile:u,containerWidth:E,containerHeight:x,toggleFileCard:h,handleRequestThumbnail:p,handleCancelThumbnail:f,role:"listitem",openFileEditor:C,canEditFile:b,toggleAddFilesPanel:S,file:n[X]},X))},Y[0]);return u?y("div",{class:"uppy-Dashboard-files",children:N(F[0])}):y(Xa,{class:"uppy-Dashboard-files",role:"list",data:F,renderRow:N,rowHeight:P})}var d6=300,Pp=class extends pi{ref=G3();componentWillEnter(t){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(t,d6)}componentWillLeave(t){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(t,d6)}render(){let{children:t}=this.props;return y("div",{className:"uppy-Informer-animated",ref:this.ref,children:t})}};function rO(e,t){return Object.assign(e,t)}function oO(e,t){return e?.key??t}function sO(e,t){let i=e._ptgLinkedRefs||(e._ptgLinkedRefs={});return i[t]||(i[t]=n=>{e.refs[t]=n})}function Sd(e){let t={};for(let i=0;i<e.length;i++)if(e[i]!=null){let n=oO(e[i],i.toString(36));t[n]=e[i]}return t}function aO(e,t){e=e||{},t=t||{};let i=s=>Object.hasOwn(t,s)?t[s]:e[s],n={},r=[];for(let s in e)Object.hasOwn(t,s)?r.length&&(n[s]=r,r=[]):r.push(s);let o={};for(let s in t){if(Object.hasOwn(n,s))for(let a=0;a<n[s].length;a++){let l=n[s][a];o[n[s][a]]=i(l)}o[s]=i(s)}for(let s=0;s<r.length;s++)o[r[s]]=i(r[s]);return o}var lO=e=>e,cO=(()=>{class e extends pi{constructor(i,n){super(i,n),this.refs={},this.state={children:Sd(rr(rr(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){let i=this.state.children;for(let n in i)i[n]&&this.performAppear(n)}componentWillReceiveProps(i){let n=Sd(rr(i.children)||[]),r=this.state.children;this.setState(s=>({children:aO(s.children,n)}));let o;for(o in n)if(Object.hasOwn(n,o)){let s=r&&Object.hasOwn(r,o);n[o]&&s&&this.currentlyTransitioningKeys[o]?(this.keysToEnter.push(o),this.keysToAbortLeave.push(o)):n[o]&&!s&&!this.currentlyTransitioningKeys[o]&&this.keysToEnter.push(o)}for(o in r)if(Object.hasOwn(r,o)){let s=n&&Object.hasOwn(n,o);r[o]&&!s&&!this.currentlyTransitioningKeys[o]&&this.keysToLeave.push(o)}}componentDidUpdate(){let{keysToEnter:i}=this;this.keysToEnter=[],i.forEach(this.performEnter);let{keysToLeave:n}=this;this.keysToLeave=[],n.forEach(this.performLeave)}_finishAbort(i){let n=this.keysToAbortLeave.indexOf(i);n!==-1&&this.keysToAbortLeave.splice(n,1)}performAppear(i){this.currentlyTransitioningKeys[i]=!0;let n=this.refs[i];n?.componentWillAppear?n.componentWillAppear(this._handleDoneAppearing.bind(this,i)):this._handleDoneAppearing(i)}_handleDoneAppearing(i){let n=this.refs[i];n?.componentDidAppear&&n.componentDidAppear(),delete this.currentlyTransitioningKeys[i],this._finishAbort(i);let r=Sd(rr(this.props.children)||[]);(!r||!Object.hasOwn(r,i))&&this.performLeave(i)}performEnter(i){this.currentlyTransitioningKeys[i]=!0;let n=this.refs[i];n?.componentWillEnter?n.componentWillEnter(this._handleDoneEntering.bind(this,i)):this._handleDoneEntering(i)}_handleDoneEntering(i){let n=this.refs[i];n?.componentDidEnter&&n.componentDidEnter(),delete this.currentlyTransitioningKeys[i],this._finishAbort(i);let r=Sd(rr(this.props.children)||[]);(!r||!Object.hasOwn(r,i))&&this.performLeave(i)}performLeave(i){if(this.keysToAbortLeave.indexOf(i)!==-1)return;this.currentlyTransitioningKeys[i]=!0;let r=this.refs[i];r?.componentWillLeave?r.componentWillLeave(this._handleDoneLeaving.bind(this,i)):this._handleDoneLeaving(i)}_handleDoneLeaving(i){if(this.keysToAbortLeave.indexOf(i)!==-1)return;let r=this.refs[i];r?.componentDidLeave&&r.componentDidLeave(),delete this.currentlyTransitioningKeys[i];let o=Sd(rr(this.props.children)||[]);if(o&&Object.hasOwn(o,i))this.performEnter(i);else{let s=rO({},this.state.children);delete s[i],this.setState({children:s})}}render(p,{children:h}){var f=p,{childFactory:i,transitionLeave:n,transitionName:r,transitionAppear:o,transitionEnter:s,transitionLeaveTimeout:a,transitionEnterTimeout:l,transitionAppearTimeout:c,component:d}=f,u=xt(f,["childFactory","transitionLeave","transitionName","transitionAppear","transitionEnter","transitionLeaveTimeout","transitionEnterTimeout","transitionAppearTimeout","component"]);let g=Object.entries(h).map(([m,v])=>{if(!v)return;let C=sO(this,m);return ep(i(v),{ref:C,key:m})}).filter(Boolean);return ed(d,u,g)}}return e.defaultProps={component:"span",childFactory:lO},e})(),u6=cO;var xd=class extends pi{render(){let{info:t}=this.props.uppy.getState();return y("div",{className:"uppy uppy-Informer",children:y(u6,{children:t.map(i=>y(Pp,{children:y("p",{role:"alert",children:[i.message," ",i.details&&y("span",{"aria-label":i.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${i.message} 

 ${i.details}`),children:"?"})]})},i.message))})})}};var h6=ft(ki(),1);function dO({activePickerPanel:e,className:t,hideAllPanels:i,i18n:n,state:r,uppy:o}){let s=or(null);return y("div",{className:(0,h6.default)("uppy-DashboardContent-panel",t),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${e.id}`,onDragOver:sr,onDragLeave:sr,onDrop:sr,onPaste:sr,children:[y("div",{className:"uppy-DashboardContent-bar",children:[y("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:n("importFrom",{name:e.name})}),y("button",{className:"uppy-DashboardContent-back",type:"button",onClick:i,children:n("cancel")})]}),y("div",{ref:s,className:"uppy-DashboardContent-panelBody",children:o.getPlugin(e.id).render(r,s.current)})]})}var p6=dO;var ar={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function uO(e,t,i,n={}){if(e)return ar.STATE_ERROR;if(t)return ar.STATE_COMPLETE;if(i)return ar.STATE_PAUSED;let r=ar.STATE_WAITING,o=Object.keys(n);for(let s=0;s<o.length;s++){let{progress:a}=n[o[s]];if(a.uploadStarted&&!a.uploadComplete)return ar.STATE_UPLOADING;a.preprocess&&r!==ar.STATE_UPLOADING&&(r=ar.STATE_PREPROCESSING),a.postprocess&&r!==ar.STATE_UPLOADING&&r!==ar.STATE_PREPROCESSING&&(r=ar.STATE_POSTPROCESSING)}return r}function hO({files:e,i18n:t,isAllComplete:i,isAllErrored:n,isAllPaused:r,inProgressNotPausedFiles:o,newFiles:s,processingFiles:a}){switch(uO(n,i,r,e)){case"uploading":return t("uploadingXFiles",{smart_count:o.length});case"preprocessing":case"postprocessing":return t("processingXFiles",{smart_count:a.length});case"paused":return t("uploadPaused");case"waiting":return t("xFilesSelected",{smart_count:s.length});case"complete":return t("uploadComplete");case"error":return t("error");default:}}function pO(e){let{i18n:t,isAllComplete:i,hideCancelButton:n,maxNumberOfFiles:r,toggleAddFilesPanel:o,uppy:s}=e,{allowNewUpload:a}=e;return a&&r&&(a=e.totalFileCount<e.maxNumberOfFiles),y("div",{className:"uppy-DashboardContent-bar",children:[!i&&!n?y("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>s.cancelAll(),children:t("cancel")}):y("div",{}),y("div",{className:"uppy-DashboardContent-title",children:y(hO,w({},e))}),a?y("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":t("addMoreFiles"),title:t("addMoreFiles"),onClick:()=>o(!0),children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:y("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),y("span",{className:"uppy-DashboardContent-addMoreCaption",children:t("addMore")})]}):y("div",{})]})}var f6=pO;var m6=ft(ki(),1);var il="uppy-transition-slideDownUp",g6=250;function fO({children:e}){let[t,i]=Zi(null),[n,r]=Zi(""),o=or(),s=or(),a=or(),l=Wn(()=>{r(`${il}-enter`),cancelAnimationFrame(a.current),clearTimeout(s.current),s.current=void 0,a.current=requestAnimationFrame(()=>{r(`${il}-enter ${il}-enter-active`),o.current=setTimeout(()=>{r("")},g6)})},[]),c=Wn(()=>{r(`${il}-leave`),cancelAnimationFrame(a.current),clearTimeout(o.current),o.current=void 0,a.current=requestAnimationFrame(()=>{r(`${il}-leave ${il}-leave-active`),s.current=setTimeout(()=>{i(null),r("")},g6)})},[]);return Gn(()=>{let d=rr(e)[0];t!==d&&(d&&!t?l():t&&!d&&!s.current&&c(),i(d))},[e,t,l,c]),Gn(()=>()=>{clearTimeout(o.current),clearTimeout(s.current),cancelAnimationFrame(a.current)},[]),t?ep(t,{className:(0,m6.default)(n,t.props.className)}):null}var Ed=fO;var tn={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var Xv=ft(ki(),1);var qv=ft(Gc(),1);var $v=ft(ki(),1);var gO="\xB7",v6=()=>` ${gO} `;function C6(e){let{newFiles:t,isUploadStarted:i,recoveredState:n,i18n:r,uploadState:o,isSomeGhost:s,startUpload:a}=e,l=(0,$v.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":o===tn.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":s}),c=t&&i&&!n?r("uploadXNewFiles",{smart_count:t}):r("uploadXFiles",{smart_count:t});return y("button",{type:"button",className:l,"aria-label":r("uploadXFiles",{smart_count:t}),onClick:a,disabled:s,"data-uppy-super-focusable":!0,children:c})}function w6(e){let{i18n:t,uppy:i}=e;return y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":t("retryUpload"),onClick:()=>i.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:y("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),t("retry")]})}function b6(e){let{i18n:t,uppy:i}=e;return y("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:t("cancel"),"aria-label":t("cancel"),onClick:()=>i.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0,children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:y("g",{fill:"none",fillRule:"evenodd",children:[y("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),y("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}function y6(e){let{isAllPaused:t,i18n:i,isAllComplete:n,resumableUploads:r,uppy:o}=e,s=i(t?"resume":"pause");function a(){if(!n){if(!r){o.cancelAll();return}if(t){o.resumeAll();return}o.pauseAll()}}return y("button",{title:s,"aria-label":s,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:y("g",{fill:"none",fillRule:"evenodd",children:[y("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),y("path",{fill:"#FFF",d:t?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}function S6(e){let{i18n:t,doneButtonHandler:i}=e;return y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:i,"data-uppy-super-focusable":!0,children:t("done")})}function x6(){return y("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:y("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}function E6(e){let{progress:t}=e,{value:i,mode:n,message:r}=t;return y("div",{className:"uppy-StatusBar-content",children:[y(x6,{}),n==="determinate"?`${Math.round(i*100)}% \xB7 `:"",r]})}function mO(e){let{numUploads:t,complete:i,totalUploadedSize:n,totalSize:r,totalETA:o,i18n:s}=e,a=t>1,l=(0,qv.default)(n);return y("div",{className:"uppy-StatusBar-statusSecondary",children:[a&&s("filesUploadedOfTotal",{complete:i,smart_count:t}),y("span",{className:"uppy-StatusBar-additionalInfo",children:[a&&v6(),r!=null?s("dataUploadedOfTotal",{complete:l,total:(0,qv.default)(r)}):s("dataUploadedOfUnknown",{complete:l}),v6(),o!=null&&s("xTimeLeft",{time:Xh(o)})]})]})}function R6(e){let{i18n:t,complete:i,numUploads:n}=e;return y("div",{className:"uppy-StatusBar-statusSecondary",children:t("filesUploadedOfTotal",{complete:i,smart_count:n})})}function vO(e){let{i18n:t,newFiles:i,startUpload:n}=e,r=(0,$v.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return y("div",{className:"uppy-StatusBar-statusSecondary",children:[y("div",{className:"uppy-StatusBar-statusSecondaryHint",children:t("xMoreFilesAdded",{smart_count:i})}),y("button",{type:"button",className:r,"aria-label":t("uploadXFiles",{smart_count:i}),onClick:n,children:t("upload")})]})}function P6(e){let{i18n:t,supportsUploadProgress:i,totalProgress:n,hideProgressDetails:r,isUploadStarted:o,isAllComplete:s,isAllPaused:a,newFiles:l,numUploads:c,complete:d,totalUploadedSize:u,totalSize:h,totalETA:p,startUpload:f}=e,g=l&&o;if(!o||s)return null;let m=t(a?"paused":"uploading");function v(){return!a&&!g&&!r?i?y(mO,{numUploads:c,complete:d,totalUploadedSize:u,totalSize:h,totalETA:p,i18n:t}):y(R6,{i18n:t,complete:d,numUploads:c}):null}return y("div",{className:"uppy-StatusBar-content",title:m,children:[a?null:y(x6,{}),y("div",{className:"uppy-StatusBar-status",children:[y("div",{className:"uppy-StatusBar-statusPrimary",children:i&&n!==0?`${m}: ${n}%`:m}),v(),g?y(vO,{i18n:t,newFiles:l,startUpload:f}):null]})]})}function k6(e){let{i18n:t}=e;return y("div",{className:"uppy-StatusBar-content",role:"status",title:t("complete"),children:y("div",{className:"uppy-StatusBar-status",children:y("div",{className:"uppy-StatusBar-statusPrimary",children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:y("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),t("complete")]})})})}function _6(e){let{error:t,i18n:i,complete:n,numUploads:r}=e;function o(){let s=`${i("uploadFailed")} 

 ${t}`;alert(s)}return y("div",{className:"uppy-StatusBar-content",title:i("uploadFailed"),children:[y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:y("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),y("div",{className:"uppy-StatusBar-status",children:[y("div",{className:"uppy-StatusBar-statusPrimary",children:[i("uploadFailed"),y("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":i("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:o,type:"button",children:"?"})]}),y(R6,{i18n:i,complete:n,numUploads:r})]})]})}function Rd(e){let t=[],i="indeterminate",n;for(let{progress:o}of Object.values(e)){let{preprocess:s,postprocess:a}=o;n==null&&(s||a)&&({mode:i,message:n}=s||a),s?.mode==="determinate"&&t.push(s.value),a?.mode==="determinate"&&t.push(a.value)}let r=t.reduce((o,s)=>o+s/t.length,0);return{mode:i,message:n,value:r}}var{STATE_ERROR:D6,STATE_WAITING:CO,STATE_PREPROCESSING:Kv,STATE_UPLOADING:kp,STATE_POSTPROCESSING:Yv,STATE_COMPLETE:_p}=tn;function Jv({newFiles:e,allowNewUpload:t,isUploadInProgress:i,isAllPaused:n,resumableUploads:r,error:o,hideUploadButton:s=void 0,hidePauseResumeButton:a=!1,hideCancelButton:l=!1,hideRetryButton:c=!1,recoveredState:d,uploadState:u,totalProgress:h,files:p,supportsUploadProgress:f,hideAfterFinish:g=!1,isSomeGhost:m,doneButtonHandler:v=void 0,isUploadStarted:C,i18n:b,startUpload:S,uppy:E,isAllComplete:x,hideProgressDetails:P=void 0,numUploads:F,complete:N,totalSize:Y,totalETA:X,totalUploadedSize:Z}){function me(){switch(u){case Yv:case Kv:{let ut=Rd(p);return ut.mode==="determinate"?ut.value*100:h}case D6:return null;case kp:return f?h:null;default:return h}}function oe(){switch(u){case Yv:case Kv:{let{mode:ut}=Rd(p);return ut==="indeterminate"}case kp:return!f;default:return!1}}let re=me(),_=re??100,k=!o&&e&&(!i&&!n||d)&&t&&!s,D=!l&&u!==CO&&u!==_p,V=r&&!a&&u===kp,U=o&&!x&&!c,G=v&&u===_p,z=(0,Xv.default)("uppy-StatusBar-progress",{"is-indeterminate":oe()}),O=(0,Xv.default)("uppy-StatusBar",`is-${u}`,{"has-ghosts":m}),W=(()=>{switch(u){case Kv:case Yv:return y(E6,{progress:Rd(p)});case _p:return y(k6,{i18n:b});case D6:return y(_6,{error:o,i18n:b,numUploads:F,complete:N});case kp:return y(P6,{i18n:b,supportsUploadProgress:f,totalProgress:h,hideProgressDetails:P,isUploadStarted:C,isAllComplete:x,isAllPaused:n,newFiles:e,numUploads:F,complete:N,totalUploadedSize:Z,totalSize:Y,totalETA:X,startUpload:S});default:return null}})();return!(k||U||V||D||G)&&!W||u===_p&&g?null:y("div",{className:O,children:[y("div",{className:z,style:{width:`${_}%`},role:"progressbar","aria-label":`${_}%`,"aria-valuetext":`${_}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":re}),W,y("div",{className:"uppy-StatusBar-actions",children:[k?y(C6,{newFiles:e,isUploadStarted:C,recoveredState:d,i18n:b,isSomeGhost:m,startUpload:S,uploadState:u}):null,U?y(w6,{i18n:b,uppy:E}):null,V?y(y6,{isAllPaused:n,i18n:b,isAllComplete:x,resumableUploads:r,uppy:E}):null,D?y(b6,{i18n:b,uppy:E}):null,G?y(S6,{i18n:b,doneButtonHandler:v}):null]})]})}var wO=2e3,bO=2e3;function yO(e,t,i,n){if(e)return tn.STATE_ERROR;if(t)return tn.STATE_COMPLETE;if(i)return tn.STATE_WAITING;let r=tn.STATE_WAITING,o=Object.keys(n);for(let s=0;s<o.length;s++){let{progress:a}=n[o[s]];if(a.uploadStarted&&!a.uploadComplete)return tn.STATE_UPLOADING;a.preprocess&&(r=tn.STATE_PREPROCESSING),a.postprocess&&r!==tn.STATE_PREPROCESSING&&(r=tn.STATE_POSTPROCESSING)}return r}var Dp=class extends pi{#e;#t;#i;#n;componentDidMount(){this.#e=performance.now(),this.#t=this.props.uppy.getFiles().reduce((t,i)=>t+(i.progress.bytesUploaded||0),0),this.props.uppy.on("upload",this.#r)}componentWillUnmount(){this.props.uppy.off("upload",this.#r)}#r=()=>{let{recoveredState:t}=this.props.uppy.getState();if(this.#i=null,this.#n=null,t){this.#t=Object.values(t.files).reduce((i,{progress:n})=>i+(n.bytesUploaded||0),0);return}this.#e=performance.now(),this.#t=0};#c(t){if(t.total==null||t.total===0)return null;let i=t.total-t.uploaded;if(i<=0)return null;this.#e??=performance.now();let n=performance.now()-this.#e;if(n===0)return Math.round((this.#n??0)/100)/10;if(this.#t==null)return this.#t=t.uploaded,null;let r=t.uploaded-this.#t;if(this.#t=t.uploaded,r<=0)return Math.round((this.#n??0)/100)/10;let o=r/n;if(!Number.isFinite(o)||o<=0)return null;let s=this.#i==null?o:Wc(o,this.#i,wO,n);if(!Number.isFinite(s)||s<=0)return null;this.#i=s;let a=i/s;if(!Number.isFinite(a)||a<0)return null;let l=Math.max((this.#n??0)-n,0),c=this.#n==null?a:Wc(a,l,bO,n);return!Number.isFinite(c)||c<0?null:(this.#n=c,this.#e=performance.now(),Math.round(c/100)/10)}startUpload=()=>{let{recoveredState:t}=this.props.uppy.getState();t?this.props.uppy.emit("restore-confirmed"):this.props.uppy.upload().catch(()=>{})};render(){let{capabilities:t,files:i,allowNewUpload:n,totalProgress:r,error:o,recoveredState:s}=this.props.uppy.getState(),{newFiles:a,startedFiles:l,completeFiles:c,isUploadStarted:d,isAllComplete:u,isAllPaused:h,isUploadInProgress:p,isSomeGhost:f}=this.props.uppy.getObjectOfFilesPerState(),g=s?Object.values(i):a,m=!!t.resumableUploads,v=t.uploadProgress!==!1,C=null,b=0;l.every(E=>E.progress.bytesTotal!=null&&E.progress.bytesTotal!==0)?(C=0,l.forEach(E=>{C+=E.progress.bytesTotal||0,b+=E.progress.bytesUploaded||0})):l.forEach(E=>{b+=E.progress.bytesUploaded||0});let S=this.#c({uploaded:b,total:C});return y(Jv,{error:o,uploadState:yO(o,u,s,i||{}),allowNewUpload:n,totalProgress:r,totalSize:C,totalUploadedSize:b,isAllComplete:u,isAllPaused:h,isUploadStarted:d,isUploadInProgress:p,isSomeGhost:f,recoveredState:s,complete:c.length,newFiles:g.length,numUploads:l.length,totalETA:S,files:i,i18n:this.props.i18n,uppy:this.props.uppy,startUpload:this.startUpload,doneButtonHandler:this.props.doneButtonHandler,resumableUploads:m,supportsUploadProgress:v,hideProgressDetails:this.props.hideProgressDetails,hideUploadButton:this.props.hideUploadButton,hideRetryButton:this.props.hideRetryButton,hidePauseResumeButton:this.props.hidePauseResumeButton,hideCancelButton:this.props.hideCancelButton,hideAfterFinish:this.props.hideAfterFinish})}};var F6=900,M6=700,Qv=576,T6=330;function Zv(e){let t=e.totalFileCount===0,i=e.totalFileCount===1,n=e.containerWidth>Qv,r=e.containerHeight>T6,o=(0,I6.default)({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":e.disabled,"uppy-Dashboard--animateOpenClose":e.animateOpenClose,"uppy-Dashboard--isClosing":e.isClosing,"uppy-Dashboard--isDraggingOver":e.isDraggingOver,"uppy-Dashboard--modal":!e.inline,"uppy-size--md":e.containerWidth>Qv,"uppy-size--lg":e.containerWidth>M6,"uppy-size--xl":e.containerWidth>F6,"uppy-size--height-md":e.containerHeight>T6,"uppy-Dashboard--isAddFilesPanelVisible":e.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":e.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":e.singleFileFullScreen&&i&&r}),s=1;e.containerWidth>F6?s=5:e.containerWidth>M6?s=4:e.containerWidth>Qv&&(s=3);let a=e.showSelectedFiles&&!t,l=e.recoveredState?Object.keys(e.recoveredState.files).length:null,c=e.files?Object.keys(e.files).filter(h=>e.files[h].isGhost).length:0,d=()=>c>0?e.i18n("recoveredXFiles",{smart_count:c}):e.i18n("recoveredAllFiles");return y("div",{className:o,"data-uppy-theme":e.theme,"data-uppy-num-acquirers":e.acquirers.length,"data-uppy-drag-drop-supported":!e.disableLocalFiles&&Yh(),"aria-hidden":e.inline?"false":e.isHidden,"aria-disabled":e.disabled,"aria-label":e.inline?e.i18n("dashboardTitle"):e.i18n("dashboardWindowTitle"),onPaste:e.handlePaste,onDragOver:e.handleDragOver,onDragLeave:e.handleDragLeave,onDrop:e.handleDrop,children:[y("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:e.handleClickOutside}),y("div",{className:"uppy-Dashboard-inner",role:e.inline?void 0:"dialog",style:{width:e.inline&&e.width?e.width:"",height:e.inline&&e.height?e.height:""},children:[e.inline?null:y("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":e.i18n("closeModal"),title:e.i18n("closeModal"),onClick:e.closeModal,children:y("span",{"aria-hidden":"true",children:"\xD7"})}),y("div",{className:"uppy-Dashboard-innerWrap",children:[y("div",{className:"uppy-Dashboard-dropFilesHereHint",children:e.i18n("dropHint")}),a&&y(f6,w({},e)),l!=null&&l>0&&y("div",{className:"uppy-Dashboard-serviceMsg",children:[y("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:y("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[y("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),y("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),y("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),y("strong",{className:"uppy-Dashboard-serviceMsg-title",children:e.i18n("sessionRestored")}),y("div",{className:"uppy-Dashboard-serviceMsg-text",children:d()})]}),a?y(jv,{id:e.id,i18n:e.i18n,uppy:e.uppy,files:e.files,resumableUploads:e.resumableUploads,hideRetryButton:e.hideRetryButton,hidePauseResumeButton:e.hidePauseResumeButton,hideCancelButton:e.hideCancelButton,showLinkToFileUploadResult:e.showLinkToFileUploadResult,showRemoveButtonAfterComplete:e.showRemoveButtonAfterComplete,metaFields:e.metaFields,toggleFileCard:e.toggleFileCard,handleRequestThumbnail:e.handleRequestThumbnail,handleCancelThumbnail:e.handleCancelThumbnail,recoveredState:e.recoveredState,individualCancellation:e.individualCancellation,openFileEditor:e.openFileEditor,canEditFile:e.canEditFile,toggleAddFilesPanel:e.toggleAddFilesPanel,isSingleFile:i,itemsPerRow:s,containerWidth:e.containerWidth,containerHeight:e.containerHeight}):y(xp,{i18n:e.i18n,i18nArray:e.i18nArray,acquirers:e.acquirers,handleInputChange:e.handleInputChange,maxNumberOfFiles:e.maxNumberOfFiles,allowedFileTypes:e.allowedFileTypes,showNativePhotoCameraButton:e.showNativePhotoCameraButton,showNativeVideoCameraButton:e.showNativeVideoCameraButton,nativeCameraFacingMode:e.nativeCameraFacingMode,showPanel:e.showPanel,activePickerPanel:e.activePickerPanel,disableLocalFiles:e.disableLocalFiles,fileManagerSelectionType:e.fileManagerSelectionType,note:e.note,proudlyDisplayPoweredByUppy:e.proudlyDisplayPoweredByUppy}),y(Ed,{children:e.showAddFilesPanel?y(i6,T(w({},e),{isSizeMD:n}),"AddFiles"):null}),y(Ed,{children:e.fileCardFor?y(Nv,w({},e),"FileCard"):null}),y(Ed,{children:e.activePickerPanel?y(p6,w({},e),"Picker"):null}),y(Ed,{children:e.showFileEditor?y(r6,w({},e),"Editor"):null}),y("div",{className:"uppy-Dashboard-progressindicators",children:[!e.disableInformer&&y(xd,{uppy:e.uppy}),!e.disableStatusBar&&y(Dp,{uppy:e.uppy,i18n:e.i18n,hideProgressDetails:e.hideProgressDetails,hideUploadButton:e.hideUploadButton,hideRetryButton:e.hideRetryButton,hidePauseResumeButton:e.hidePauseResumeButton,hideCancelButton:e.hideCancelButton,hideAfterFinish:e.hideProgressAfterFinish,doneButtonHandler:e.doneButtonHandler}),!e.disableInformer&&y(xd,{uppy:e.uppy}),e.progressindicators.map(h=>e.uppy.getPlugin(h.id).render(e.state))]})]})]})]})}var A6={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video",uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};var O6=ft(rp(),1);function Pd(e,t){if(t){let i=e.querySelector(`[data-uppy-paneltype="${t}"]`);if(i)return i}return e}function eC(){let e=!1;return(0,O6.default)((i,n)=>{let r=Pd(i,n),o=r.contains(document.activeElement);if(o&&e)return;let s=r.querySelector("[data-uppy-super-focusable]");o&&!s||(s?(s.focus({preventScroll:!0}),e=!0):(r.querySelector(Uc)?.focus({preventScroll:!0}),e=!1))},260)}function L6(e,t){let i=t[0];i&&(i.focus(),e.preventDefault())}function SO(e,t){let i=t[t.length-1];i&&(i.focus(),e.preventDefault())}function xO(e){return e.contains(document.activeElement)}function tC(e,t,i){let n=Pd(i,t),r=Ur(n.querySelectorAll(Uc)),o=r.indexOf(document.activeElement);xO(n)?e.shiftKey&&o===0?SO(e,r):!e.shiftKey&&o===r.length-1&&L6(e,r):L6(e,r)}function N6(e,t,i){t===null||tC(e,t,i)}var B6=9,RO=27;function H6(){let e={};return e.promise=new Promise((t,i)=>{e.resolve=t,e.reject=i}),e}var PO={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:dd,showLinkToFileUploadResult:!1,hideProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550},kd=class extends od{static VERSION=e6.version;#e;modalName=`uppy-Dashboard-${No()}`;superFocus=eC();ifFocusedOnUppyRecently=!1;dashboardIsDisabled;savedScrollPosition;savedActiveElement;resizeObserver;darkModeMediaQuery;makeDashboardInsidesVisibleAnywayTimeout;constructor(t,i){let n=i?.autoOpen??null;super(t,T(w(w({},PO),i),{autoOpen:n})),this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=A6,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),this.opts.onRequestCloseModal??=()=>this.closeModal(),this.i18nInit()}removeTarget=t=>{let n=this.getPluginState().targets.filter(r=>r.id!==t.id);this.setPluginState({targets:n})};addTarget=t=>{let i=t.id||t.constructor.name,n=t.title||i,r=t.type;if(r!=="acquirer"&&r!=="progressindicator"&&r!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;let o={id:i,name:n,type:r},a=this.getPluginState().targets.slice();return a.push(o),this.setPluginState({targets:a}),this.el};hideAllPanels=()=>{let t=this.getPluginState(),i={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};t.activePickerPanel===i.activePickerPanel&&t.showAddFilesPanel===i.showAddFilesPanel&&t.showFileEditor===i.showFileEditor&&t.activeOverlayType===i.activeOverlayType||(this.setPluginState(i),this.uppy.emit("dashboard:close-panel",t.activePickerPanel?.id))};showPanel=t=>{let{targets:i}=this.getPluginState(),n=i.find(r=>r.type==="acquirer"&&r.id===t);this.setPluginState({activePickerPanel:n,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",t)};canEditFile=t=>{let{targets:i}=this.getPluginState();return this.#a(i).some(r=>this.uppy.getPlugin(r.id).canEditFile(t))};openFileEditor=t=>{let{targets:i}=this.getPluginState(),n=this.#a(i);this.setPluginState({showFileEditor:!0,fileCardFor:t.id||null,activeOverlayType:"FileEditor"}),n.forEach(r=>{this.uppy.getPlugin(r.id).selectFile(t)})};closeFileEditor=()=>{let{metaFields:t}=this.getPluginState();t&&t.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})};saveFileEditor=()=>{let{targets:t}=this.getPluginState();this.#a(t).forEach(n=>{this.uppy.getPlugin(n.id).save()}),this.closeFileEditor()};openModal=()=>{let{promise:t,resolve:i}=H6();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){let n=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",n,!1),i()};this.el.addEventListener("animationend",n,!1)}else this.setPluginState({isHidden:!1}),i();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),t};closeModal=t=>{let i=t?.manualClose??!0,{isHidden:n,isClosing:r}=this.getPluginState();if(n||r)return;let{promise:o,resolve:s}=H6();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});let a=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",a,!1),s()};this.el.addEventListener("animationend",a,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),s();return document.removeEventListener("keydown",this.handleKeyDownInModal),i&&this.opts.browserBackButtonClose&&history.state?.[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),o};isModalOpen=()=>!this.getPluginState().isHidden||!1;requestCloseModal=()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal();setDarkModeCapability=t=>{let{capabilities:i}=this.uppy.getState();this.uppy.setState({capabilities:T(w({},i),{darkMode:t})})};handleSystemDarkModeChange=t=>{let i=t.matches;this.uppy.log(`[Dashboard] Dark mode is ${i?"on":"off"}`),this.setDarkModeCapability(i)};toggleFileCard=(t,i)=>{let n=this.uppy.getFile(i);t?this.uppy.emit("dashboard:file-edit-start",n):this.uppy.emit("dashboard:file-edit-complete",n),this.setPluginState({fileCardFor:t?i:null,activeOverlayType:t?"FileCard":null})};toggleAddFilesPanel=t=>{this.setPluginState({showAddFilesPanel:t,activeOverlayType:t?"AddFiles":null})};addFiles=t=>{let i=t.map(n=>({source:this.id,name:n.name,type:n.type,data:n,meta:{relativePath:n.relativePath||n.webkitRelativePath||null}}));try{this.uppy.addFiles(i)}catch(n){this.uppy.log(n)}};startListeningToResize=()=>{this.resizeObserver=new ResizeObserver(t=>{let i=t[0],{width:n,height:r}=i.contentRect;this.setPluginState({containerWidth:n,containerHeight:r,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{let t=this.getPluginState(),i=!this.opts.inline&&t.isHidden;!t.areInsidesReadyToBeVisible&&!i&&(this.uppy.log("[Dashboard] resize event didn\u2019t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)};stopListeningToResize=()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)};recordIfFocusedOnUppyRecently=t=>{this.el.contains(t.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())};disableInteractiveElements=t=>{let i=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],n=this.#e??Ur(this.el.querySelectorAll(i)).filter(r=>!r.classList.contains("uppy-Dashboard-close"));for(let r of n)r.tagName==="A"?r.setAttribute("aria-disabled",t):r.disabled=t;t?this.#e=n:this.#e=null,this.dashboardIsDisabled=t};updateBrowserHistory=()=>{history.state?.[this.modalName]||history.pushState(T(w({},history.state),{[this.modalName]:!0}),""),window.addEventListener("popstate",this.handlePopState,!1)};handlePopState=t=>{this.isModalOpen()&&(!t.state||!t.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&t.state?.[this.modalName]&&history.back()};handleKeyDownInModal=t=>{t.keyCode===RO&&this.requestCloseModal(),t.keyCode===B6&&tC(t,this.getPluginState().activeOverlayType,this.el)};handleClickOutside=()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()};handlePaste=t=>{this.uppy.iteratePlugins(n=>{n.type==="acquirer"&&n.handleRootPaste?.(t)});let i=Ur(t.clipboardData.files);i.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(i))};handleInputChange=t=>{t.preventDefault();let i=Ur(t.currentTarget.files||[]);i.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(i))};handleDragOver=t=>{t.preventDefault(),t.stopPropagation();let i=()=>{let s=!0;return this.uppy.iteratePlugins(a=>{a.canHandleRootDrop?.(t)&&(s=!0)}),s},n=()=>{let{types:s}=t.dataTransfer;return s.some(a=>a==="Files")},r=i(),o=n();if(!r&&!o||this.opts.disabled||this.opts.disableLocalFiles&&(o||!r)||!this.uppy.getState().allowNewUpload){t.dataTransfer.dropEffect="none";return}t.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(t)};handleDragLeave=t=>{t.preventDefault(),t.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(t)};handleDrop=async t=>{t.preventDefault(),t.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(o=>{o.type==="acquirer"&&o.handleRootDrop?.(t)});let i=!1,n=o=>{this.uppy.log(o,"error"),i||(this.uppy.info(o.message,"error"),i=!0)};this.uppy.log("[Dashboard] Processing dropped files");let r=await Kh(t.dataTransfer,{logDropError:n});r.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(r)),this.opts.onDrop(t)};handleRequestThumbnail=t=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",t)};handleCancelThumbnail=t=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",t)};handleKeyDownInInline=t=>{t.keyCode===B6&&N6(t,this.getPluginState().activeOverlayType,this.el)};handlePasteOnBody=t=>{this.el.contains(document.activeElement)&&this.handlePaste(t)};handleComplete=({failed:t})=>{this.opts.closeAfterFinish&&!t?.length&&this.requestCloseModal()};#t=()=>{if(this.opts.disableThumbnailGenerator)return;let t=600,i=this.uppy.getFiles();if(i.length===1){let n=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);n?.setOptions({thumbnailWidth:t});let r=T(w({},i[0]),{preview:void 0});n?.requestThumbnail(r).then(()=>{n?.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}};#i=t=>{let i=t[0],{metaFields:n}=this.getPluginState(),r=n&&n.length>0,o=this.canEditFile(i);r&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,i.id):o&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(i)};initEvents=()=>{if(this.opts.trigger&&!this.opts.inline){let t=jh(this.opts.trigger);t?t.forEach(i=>i.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",this.#l),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",this.#t),this.uppy.on("file-removed",this.#t),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",this.#i)};removeEvents=()=>{let t=jh(this.opts.trigger);!this.opts.inline&&t&&t.forEach(i=>i.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",this.#l),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",this.#t),this.uppy.off("file-removed",this.#t),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",this.#i)};superFocusOnEachUpdate=()=>{let t=this.el.contains(document.activeElement),i=document.activeElement===document.body||document.activeElement===null,n=this.uppy.getState().info.length===0,r=!this.opts.inline;n&&(r||t||i&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()};afterUpdate=()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()};saveFileCard=(t,i)=>{this.uppy.setFileMeta(i,t),this.toggleFileCard(!1,i)};#n=t=>{let i=this.uppy.getPlugin(t.id);return T(w({},t),{icon:i.icon||this.opts.defaultPickerIcon,render:i.render})};#r=t=>{let i=this.uppy.getPlugin(t.id);return typeof i.isSupported!="function"?!0:i.isSupported()};#c=t=>t.filter(i=>i.type==="acquirer"&&this.#r(i)).map(this.#n);#s=t=>t.filter(i=>i.type==="progressindicator").map(this.#n);#a=t=>t.filter(i=>i.type==="editor").map(this.#n);render=t=>{let i=this.getPluginState(),{files:n,capabilities:r,allowNewUpload:o}=t,{newFiles:s,uploadStartedFiles:a,completeFiles:l,erroredFiles:c,inProgressFiles:d,inProgressNotPausedFiles:u,processingFiles:h,isUploadStarted:p,isAllComplete:f,isAllPaused:g}=this.uppy.getObjectOfFilesPerState(),m=this.#c(i.targets),v=this.#s(i.targets),C=this.#a(i.targets),b;return this.opts.theme==="auto"?b=r.darkMode?"dark":"light":b=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),Zv({state:t,isHidden:i.isHidden,files:n,newFiles:s,uploadStartedFiles:a,completeFiles:l,erroredFiles:c,inProgressFiles:d,inProgressNotPausedFiles:u,processingFiles:h,isUploadStarted:p,isAllComplete:f,isAllPaused:g,totalFileCount:Object.keys(n).length,totalProgress:t.totalProgress,allowNewUpload:o,acquirers:m,theme:b,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:i.activePickerPanel,showFileEditor:i.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:i.isClosing,progressindicators:v,editors:C,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:t.recoveredState,metaFields:i.metaFields,resumableUploads:r.resumableUploads||!1,individualCancellation:r.individualCancellation,isMobileDevice:r.isMobileDevice,fileCardFor:i.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:i.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:i.containerWidth,containerHeight:i.containerHeight,areInsidesReadyToBeVisible:i.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:i.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop,disableInformer:this.opts.disableInformer,disableStatusBar:this.opts.disableStatusBar,hideProgressDetails:this.opts.hideProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideProgressAfterFinish:this.opts.hideProgressAfterFinish,doneButtonHandler:this.opts.doneButtonHandler})};#o=()=>{let{plugins:t}=this.opts;t.forEach(i=>{let n=this.uppy.getPlugin(i);n?n.mount(this,n):this.uppy.log(`[Uppy] Dashboard could not find plugin '${i}', make sure to uppy.use() the plugins you are specifying`,"warning")})};#p=()=>{this.uppy.iteratePlugins(this.#l)};#l=t=>{let i=["acquirer","editor"];t&&!t.opts?.target&&i.includes(t.type)&&(this.getPluginState().targets.some(r=>t.id===r.id)||t.mount(this,t))};#u(){let{thumbnailWidth:t,thumbnailHeight:i,thumbnailType:n,waitForThumbnailsBeforeUpload:r}=this.opts;return{thumbnailWidth:t,thumbnailHeight:i,thumbnailType:n,waitForThumbnailsBeforeUpload:r,lazy:!r}}setOptions(t){super.setOptions(t),this.uppy.getPlugin(this.#d())?.setOptions(this.#u())}#d(){return`${this.id}:ThumbnailGenerator`}install=()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});let{inline:t,closeAfterFinish:i}=this.opts;if(t&&i)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");let{allowMultipleUploads:n,allowMultipleUploadBatches:r}=this.uppy.opts;(n||r)&&i&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");let{target:o}=this.opts;o&&this.mount(o,this),this.opts.disableThumbnailGenerator||this.uppy.use(Sp,w({id:this.#d()},this.#u())),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;let s=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${s?"on":"off"}`),this.setDarkModeCapability(s),this.opts.theme==="auto"&&this.darkModeMediaQuery?.addListener(this.handleSystemDarkModeChange),this.#o(),this.#p(),this.initEvents()};uninstall=()=>{if(!this.opts.disableThumbnailGenerator){let i=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);i&&this.uppy.removePlugin(i)}let{plugins:t}=this.opts;t.forEach(i=>{let n=this.uppy.getPlugin(i);n&&n.unmount()}),this.opts.theme==="auto"&&this.darkModeMediaQuery?.removeListener(this.handleSystemDarkModeChange),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()}};function nl(e){"@babel/helpers - typeof";return nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nl(e)}function z6(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_O(n.key),n)}}function kO(e,t,i){return t&&z6(e.prototype,t),i&&z6(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _O(e){var t=DO(e,"string");return nl(t)=="symbol"?t:t+""}function DO(e,t){if(nl(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(nl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MO(e,t,i){return t=Dd(t),TO(e,nC()?Reflect.construct(t,i||[],Dd(e).constructor):t.apply(e,i))}function TO(e,t){if(t&&(nl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IO(e)}function IO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AO(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_d(e,t)}function iC(e){var t=typeof Map=="function"?new Map:void 0;return iC=function(n){if(n===null||!LO(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,r)}function r(){return OO(n,arguments,Dd(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_d(r,n)},iC(e)}function OO(e,t,i){if(nC())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var r=new(e.bind.apply(e,n));return i&&_d(r,i.prototype),r}function nC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nC=function(){return!!e})()}function LO(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function _d(e,t){return _d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},_d(e,t)}function Dd(e){return Dd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Dd(e)}var NO=(function(e){function t(i){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(FO(this,t),n=MO(this,t,[i]),n.originalRequest=o,n.originalResponse=s,n.causingError=r,r!=null&&(i+=", caused by ".concat(r.toString())),o!=null){var a=o.getHeader("X-Request-ID")||"n/a",l=o.getMethod(),c=o.getURL(),d=s?s.getStatus():"n/a",u=s?s.getBody()||"":"n/a";i+=", originated from request (method: ".concat(l,", url: ").concat(c,", response code: ").concat(d,", response text: ").concat(u,", request id: ").concat(a,")")}return n.message=i,n}return AO(t,e),kO(t)})(iC(Error)),rl=NO;var BO=!1;function zo(e){BO&&console.log(e)}function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function HO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V6(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VO(n.key),n)}}function zO(e,t,i){return t&&V6(e.prototype,t),i&&V6(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function VO(e){var t=GO(e,"string");return Fd(t)=="symbol"?t:t+""}function GO(e,t){if(Fd(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(Fd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G6=(function(){function e(){HO(this,e)}return zO(e,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(i){return Promise.resolve([])}},{key:"removeUpload",value:function(i){return Promise.resolve()}},{key:"addUpload",value:function(i,n){return Promise.resolve(null)}}])})();var K6="3.7.8",WO=K6,sl=typeof Buffer=="function",W6=typeof TextDecoder=="function"?new TextDecoder:void 0,U6=typeof TextEncoder=="function"?new TextEncoder:void 0,UO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Md=Array.prototype.slice.call(UO),Fp=(e=>{let t={};return e.forEach((i,n)=>t[i]=n),t})(Md),jO=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Qt=String.fromCharCode.bind(String),j6=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Y6=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),X6=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),J6=e=>{let t,i,n,r,o="",s=e.length%3;for(let a=0;a<e.length;){if((i=e.charCodeAt(a++))>255||(n=e.charCodeAt(a++))>255||(r=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=i<<16|n<<8|r,o+=Md[t>>18&63]+Md[t>>12&63]+Md[t>>6&63]+Md[t&63]}return s?o.slice(0,s-3)+"===".substring(s):o},sC=typeof btoa=="function"?e=>btoa(e):sl?e=>Buffer.from(e,"binary").toString("base64"):J6,rC=sl?e=>Buffer.from(e).toString("base64"):e=>{let i=[];for(let n=0,r=e.length;n<r;n+=4096)i.push(Qt.apply(null,e.subarray(n,n+4096)));return sC(i.join(""))},Mp=(e,t=!1)=>t?Y6(rC(e)):rC(e),qO=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?Qt(192|t>>>6)+Qt(128|t&63):Qt(224|t>>>12&15)+Qt(128|t>>>6&63)+Qt(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return Qt(240|t>>>18&7)+Qt(128|t>>>12&63)+Qt(128|t>>>6&63)+Qt(128|t&63)}},$O=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Q6=e=>e.replace($O,qO),q6=sl?e=>Buffer.from(e,"utf8").toString("base64"):U6?e=>rC(U6.encode(e)):e=>sC(Q6(e)),ol=(e,t=!1)=>t?Y6(q6(e)):q6(e),$6=e=>ol(e,!0),KO=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,YO=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),i=t-65536;return Qt((i>>>10)+55296)+Qt((i&1023)+56320);case 3:return Qt((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Qt((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},Z6=e=>e.replace(KO,YO),e4=e=>{if(e=e.replace(/\s+/g,""),!jO.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,i,n,r=[];for(let o=0;o<e.length;)t=Fp[e.charAt(o++)]<<18|Fp[e.charAt(o++)]<<12|(i=Fp[e.charAt(o++)])<<6|(n=Fp[e.charAt(o++)]),i===64?r.push(Qt(t>>16&255)):n===64?r.push(Qt(t>>16&255,t>>8&255)):r.push(Qt(t>>16&255,t>>8&255,t&255));return r.join("")},aC=typeof atob=="function"?e=>atob(X6(e)):sl?e=>Buffer.from(e,"base64").toString("binary"):e4,t4=sl?e=>j6(Buffer.from(e,"base64")):e=>j6(aC(e).split("").map(t=>t.charCodeAt(0))),i4=e=>t4(n4(e)),XO=sl?e=>Buffer.from(e,"base64").toString("utf8"):W6?e=>W6.decode(t4(e)):e=>Z6(aC(e)),n4=e=>X6(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),oC=e=>XO(n4(e)),JO=e=>{if(typeof e!="string")return!1;let t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},r4=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),o4=function(){let e=(t,i)=>Object.defineProperty(String.prototype,t,r4(i));e("fromBase64",function(){return oC(this)}),e("toBase64",function(t){return ol(this,t)}),e("toBase64URI",function(){return ol(this,!0)}),e("toBase64URL",function(){return ol(this,!0)}),e("toUint8Array",function(){return i4(this)})},s4=function(){let e=(t,i)=>Object.defineProperty(Uint8Array.prototype,t,r4(i));e("toBase64",function(t){return Mp(this,t)}),e("toBase64URI",function(){return Mp(this,!0)}),e("toBase64URL",function(){return Mp(this,!0)})},QO=()=>{o4(),s4()},a4={version:K6,VERSION:WO,atob:aC,atobPolyfill:e4,btoa:sC,btoaPolyfill:J6,fromBase64:oC,toBase64:ol,encode:ol,encodeURI:$6,encodeURL:$6,utob:Q6,btou:Z6,decode:oC,isValid:JO,fromUint8Array:Mp,toUint8Array:i4,extendString:o4,extendUint8Array:s4,extendBuiltins:QO};var I4=ft(b4());function uC(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,i=e==="x"?t:t&3|8;return i.toString(16)})}function hC(){"use strict";hC=function(){return t};var e,t={},i=Object.prototype,n=i.hasOwnProperty,r=Object.defineProperty||function(_,k,D){_[k]=D.value},o=typeof Symbol=="function"?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(_,k,D){return Object.defineProperty(_,k,{value:D,enumerable:!0,configurable:!0,writable:!0}),_[k]}try{c({},"")}catch{c=function(D,V,U){return D[V]=U}}function d(_,k,D,V){var U=k&&k.prototype instanceof v?k:v,G=Object.create(U.prototype),z=new oe(V||[]);return r(G,"_invoke",{value:Y(_,D,z)}),G}function u(_,k,D){try{return{type:"normal",arg:_.call(k,D)}}catch(V){return{type:"throw",arg:V}}}t.wrap=d;var h="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function v(){}function C(){}function b(){}var S={};c(S,s,function(){return this});var E=Object.getPrototypeOf,x=E&&E(E(re([])));x&&x!==i&&n.call(x,s)&&(S=x);var P=b.prototype=v.prototype=Object.create(S);function F(_){["next","throw","return"].forEach(function(k){c(_,k,function(D){return this._invoke(k,D)})})}function N(_,k){function D(U,G,z,O){var W=u(_[U],_,G);if(W.type!=="throw"){var ee=W.arg,Se=ee.value;return Se&&Ls(Se)=="object"&&n.call(Se,"__await")?k.resolve(Se.__await).then(function(Ee){D("next",Ee,z,O)},function(Ee){D("throw",Ee,z,O)}):k.resolve(Se).then(function(Ee){ee.value=Ee,z(ee)},function(Ee){return D("throw",Ee,z,O)})}O(W.arg)}var V;r(this,"_invoke",{value:function(G,z){function O(){return new k(function(W,ee){D(G,z,W,ee)})}return V=V?V.then(O,O):O()}})}function Y(_,k,D){var V=h;return function(U,G){if(V===f)throw Error("Generator is already running");if(V===g){if(U==="throw")throw G;return{value:e,done:!0}}for(D.method=U,D.arg=G;;){var z=D.delegate;if(z){var O=X(z,D);if(O){if(O===m)continue;return O}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(V===h)throw V=g,D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);V=f;var W=u(_,k,D);if(W.type==="normal"){if(V=D.done?g:p,W.arg===m)continue;return{value:W.arg,done:D.done}}W.type==="throw"&&(V=g,D.method="throw",D.arg=W.arg)}}}function X(_,k){var D=k.method,V=_.iterator[D];if(V===e)return k.delegate=null,D==="throw"&&_.iterator.return&&(k.method="return",k.arg=e,X(_,k),k.method==="throw")||D!=="return"&&(k.method="throw",k.arg=new TypeError("The iterator does not provide a '"+D+"' method")),m;var U=u(V,_.iterator,k.arg);if(U.type==="throw")return k.method="throw",k.arg=U.arg,k.delegate=null,m;var G=U.arg;return G?G.done?(k[_.resultName]=G.value,k.next=_.nextLoc,k.method!=="return"&&(k.method="next",k.arg=e),k.delegate=null,m):G:(k.method="throw",k.arg=new TypeError("iterator result is not an object"),k.delegate=null,m)}function Z(_){var k={tryLoc:_[0]};1 in _&&(k.catchLoc=_[1]),2 in _&&(k.finallyLoc=_[2],k.afterLoc=_[3]),this.tryEntries.push(k)}function me(_){var k=_.completion||{};k.type="normal",delete k.arg,_.completion=k}function oe(_){this.tryEntries=[{tryLoc:"root"}],_.forEach(Z,this),this.reset(!0)}function re(_){if(_||_===""){var k=_[s];if(k)return k.call(_);if(typeof _.next=="function")return _;if(!isNaN(_.length)){var D=-1,V=function U(){for(;++D<_.length;)if(n.call(_,D))return U.value=_[D],U.done=!1,U;return U.value=e,U.done=!0,U};return V.next=V}}throw new TypeError(Ls(_)+" is not iterable")}return C.prototype=b,r(P,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:C,configurable:!0}),C.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(_){var k=typeof _=="function"&&_.constructor;return!!k&&(k===C||(k.displayName||k.name)==="GeneratorFunction")},t.mark=function(_){return Object.setPrototypeOf?Object.setPrototypeOf(_,b):(_.__proto__=b,c(_,l,"GeneratorFunction")),_.prototype=Object.create(P),_},t.awrap=function(_){return{__await:_}},F(N.prototype),c(N.prototype,a,function(){return this}),t.AsyncIterator=N,t.async=function(_,k,D,V,U){U===void 0&&(U=Promise);var G=new N(d(_,k,D,V),U);return t.isGeneratorFunction(k)?G:G.next().then(function(z){return z.done?z.value:G.next()})},F(P),c(P,l,"Generator"),c(P,s,function(){return this}),c(P,"toString",function(){return"[object Generator]"}),t.keys=function(_){var k=Object(_),D=[];for(var V in k)D.push(V);return D.reverse(),function U(){for(;D.length;){var G=D.pop();if(G in k)return U.value=G,U.done=!1,U}return U.done=!0,U}},t.values=re,oe.prototype={constructor:oe,reset:function(k){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(me),!k)for(var D in this)D.charAt(0)==="t"&&n.call(this,D)&&!isNaN(+D.slice(1))&&(this[D]=e)},stop:function(){this.done=!0;var k=this.tryEntries[0].completion;if(k.type==="throw")throw k.arg;return this.rval},dispatchException:function(k){if(this.done)throw k;var D=this;function V(ee,Se){return z.type="throw",z.arg=k,D.next=ee,Se&&(D.method="next",D.arg=e),!!Se}for(var U=this.tryEntries.length-1;U>=0;--U){var G=this.tryEntries[U],z=G.completion;if(G.tryLoc==="root")return V("end");if(G.tryLoc<=this.prev){var O=n.call(G,"catchLoc"),W=n.call(G,"finallyLoc");if(O&&W){if(this.prev<G.catchLoc)return V(G.catchLoc,!0);if(this.prev<G.finallyLoc)return V(G.finallyLoc)}else if(O){if(this.prev<G.catchLoc)return V(G.catchLoc,!0)}else{if(!W)throw Error("try statement without catch or finally");if(this.prev<G.finallyLoc)return V(G.finallyLoc)}}}},abrupt:function(k,D){for(var V=this.tryEntries.length-1;V>=0;--V){var U=this.tryEntries[V];if(U.tryLoc<=this.prev&&n.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var G=U;break}}G&&(k==="break"||k==="continue")&&G.tryLoc<=D&&D<=G.finallyLoc&&(G=null);var z=G?G.completion:{};return z.type=k,z.arg=D,G?(this.method="next",this.next=G.finallyLoc,m):this.complete(z)},complete:function(k,D){if(k.type==="throw")throw k.arg;return k.type==="break"||k.type==="continue"?this.next=k.arg:k.type==="return"?(this.rval=this.arg=k.arg,this.method="return",this.next="end"):k.type==="normal"&&D&&(this.next=D),m},finish:function(k){for(var D=this.tryEntries.length-1;D>=0;--D){var V=this.tryEntries[D];if(V.finallyLoc===k)return this.complete(V.completion,V.afterLoc),me(V),m}},catch:function(k){for(var D=this.tryEntries.length-1;D>=0;--D){var V=this.tryEntries[D];if(V.tryLoc===k){var U=V.completion;if(U.type==="throw"){var G=U.arg;me(V)}return G}}throw Error("illegal catch attempt")},delegateYield:function(k,D,V){return this.delegate={iterator:re(k),resultName:D,nextLoc:V},this.method==="next"&&(this.arg=e),m}},t}function y4(e,t,i,n,r,o,s){try{var a=e[o](s),l=a.value}catch(c){i(c);return}a.done?t(l):Promise.resolve(l).then(n,r)}function dL(e){return function(){var t=this,i=arguments;return new Promise(function(n,r){var o=e.apply(t,i);function s(l){y4(o,n,r,s,a,"next",l)}function a(l){y4(o,n,r,s,a,"throw",l)}s(void 0)})}}function F4(e,t){return pL(e)||hL(e,t)||M4(e,t)||uL()}function uL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hL(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var n,r,o,s,a=[],l=!0,c=!1;try{if(o=(i=i.call(e)).next,t===0){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=o.call(i)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&i.return!=null&&(s=i.return(),Object(s)!==s))return}finally{if(c)throw r}}return a}}function pL(e){if(Array.isArray(e))return e}function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function fL(e,t){var i=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=M4(e))||t&&e&&typeof e.length=="number"){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){i=i.call(e)},n:function(){var c=i.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{!o&&i.return!=null&&i.return()}finally{if(s)throw a}}}}function M4(e,t){if(e){if(typeof e=="string")return S4(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return S4(e,t)}}function S4(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function x4(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),i.push.apply(i,n)}return i}function al(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?x4(Object(i),!0).forEach(function(n){gL(e,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):x4(Object(i)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))})}return e}function gL(e,t,i){return t=T4(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function mL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E4(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T4(n.key),n)}}function vL(e,t,i){return t&&E4(e.prototype,t),i&&E4(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function T4(e){var t=CL(e,"string");return Ls(t)=="symbol"?t:t+""}function CL(e,t){if(Ls(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(Ls(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ip="tus-v1",Ap="ietf-draft-03",Td="ietf-draft-05",wL={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:O4,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:Ip},A4=(function(){function e(t,i){mL(this,e),"resume"in i&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=i,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return vL(e,[{key:"findPreviousUploads",value:function(){var i=this;return this.options.fingerprint(this.file,this.options).then(function(n){return i._urlStorage.findUploadsByFingerprint(n)})}},{key:"resumeFromPreviousUpload",value:function(i){this.url=i.uploadUrl||null,this._parallelUploadUrls=i.parallelUploadUrls||null,this._urlStorageKey=i.urlStorageKey}},{key:"start",value:function(){var i=this,n=this.file;if(!n){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![Ip,Ap,Td].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var r=this.options.retryDelays;if(r!=null&&Object.prototype.toString.call(r)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var o=0,s=["uploadUrl","uploadSize","uploadLengthDeferred"];o<s.length;o++){var a=s[o];if(this.options[a]){this._emitError(new Error("tus: cannot use the ".concat(a," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(n,this.options).then(function(l){return l==null?zo("No fingerprint was calculated meaning that the upload cannot be stored in the URL storage."):zo("Calculated fingerprint: ".concat(l)),i._fingerprint=l,i._source?i._source:i.options.fileReader.openFile(n,i.options.chunkSize)}).then(function(l){if(i._source=l,i.options.uploadLengthDeferred)i._size=null;else if(i.options.uploadSize!=null){if(i._size=Number(i.options.uploadSize),Number.isNaN(i._size)){i._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(i._size=i._source.size,i._size==null){i._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}i.options.parallelUploads>1||i._parallelUploadUrls!=null?i._startParallelUpload():i._startSingleUpload()}).catch(function(l){i._emitError(l)})}},{key:"_startParallelUpload",value:function(){var i,n=this,r=this._size,o=0;this._parallelUploads=[];var s=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,a=(i=this.options.parallelUploadBoundaries)!==null&&i!==void 0?i:yL(this._source.size,s);this._parallelUploadUrls&&a.forEach(function(d,u){d.uploadUrl=n._parallelUploadUrls[u]||null}),this._parallelUploadUrls=new Array(a.length);var l=a.map(function(d,u){var h=0;return n._source.slice(d.start,d.end).then(function(p){var f=p.value;return new Promise(function(g,m){var v=al(al({},n.options),{},{uploadUrl:d.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:n.options.metadataForPartialUploads,headers:al(al({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:g,onError:m,onProgress:function(S){o=o-h+S,h=S,n._emitProgress(o,r)},onUploadUrlAvailable:function(){n._parallelUploadUrls[u]=C.url,n._parallelUploadUrls.filter(function(S){return!!S}).length===a.length&&n._saveUploadInUrlStorage()}}),C=new e(f,v);C.start(),n._parallelUploads.push(C)})})}),c;Promise.all(l).then(function(){c=n._openRequest("POST",n.options.endpoint),c.setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var d=R4(n.options.metadata);return d!==""&&c.setHeader("Upload-Metadata",d),n._sendRequest(c,null)}).then(function(d){if(!ll(d.getStatus(),200)){n._emitHttpError(c,d,"tus: unexpected response while creating upload");return}var u=d.getHeader("Location");if(u==null){n._emitHttpError(c,d,"tus: invalid or missing Location header");return}n.url=D4(n.options.endpoint,u),zo("Created upload at ".concat(n.url)),n._emitSuccess(d)}).catch(function(d){n._emitError(d)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){zo("Resuming upload from previous URL: ".concat(this.url)),this._resumeUpload();return}if(this.options.uploadUrl!=null){zo("Resuming upload from provided URL: ".concat(this.options.uploadUrl)),this.url=this.options.uploadUrl,this._resumeUpload();return}zo("Creating a new upload"),this._createUpload()}},{key:"abort",value:function(i){var n=this;if(this._parallelUploads!=null){var r=fL(this._parallelUploads),o;try{for(r.s();!(o=r.n()).done;){var s=o.value;s.abort(i)}}catch(a){r.e(a)}finally{r.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!i||this.url==null?Promise.resolve():e.terminate(this.url,this.options).then(function(){return n._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(i,n,r,o){this._emitError(new rl(r,o,i,n))}},{key:"_emitError",value:function(i){var n=this;if(!this._aborted){if(this.options.retryDelays!=null){var r=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(r&&(this._retryAttempt=0),_4(i,this._retryAttempt,this.options)){var o=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){n.start()},o);return}}if(typeof this.options.onError=="function")this.options.onError(i);else throw i}}},{key:"_emitSuccess",value:function(i){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:i})}},{key:"_emitProgress",value:function(i,n){typeof this.options.onProgress=="function"&&this.options.onProgress(i,n)}},{key:"_emitChunkComplete",value:function(i,n,r){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(i,n,r)}},{key:"_createUpload",value:function(){var i=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var n=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?n.setHeader("Upload-Defer-Length","1"):n.setHeader("Upload-Length","".concat(this._size));var r=R4(this.options.metadata);r!==""&&n.setHeader("Upload-Metadata",r);var o;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,o=this._addChunkToRequest(n)):((this.options.protocol===Ap||this.options.protocol===Td)&&n.setHeader("Upload-Complete","?0"),o=this._sendRequest(n,null)),o.then(function(s){if(!ll(s.getStatus(),200)){i._emitHttpError(n,s,"tus: unexpected response while creating upload");return}var a=s.getHeader("Location");if(a==null){i._emitHttpError(n,s,"tus: invalid or missing Location header");return}if(i.url=D4(i.options.endpoint,a),zo("Created upload at ".concat(i.url)),typeof i.options.onUploadUrlAvailable=="function"&&i.options.onUploadUrlAvailable(),i._size===0){i._emitSuccess(s),i._source.close();return}i._saveUploadInUrlStorage().then(function(){i.options.uploadDataDuringCreation?i._handleUploadResponse(n,s):(i._offset=0,i._performUpload())})}).catch(function(s){i._emitHttpError(n,null,"tus: failed to create upload",s)})}},{key:"_resumeUpload",value:function(){var i=this,n=this._openRequest("HEAD",this.url),r=this._sendRequest(n,null);r.then(function(o){var s=o.getStatus();if(!ll(s,200)){if(s===423){i._emitHttpError(n,o,"tus: upload is currently locked; retry later");return}if(ll(s,400)&&i._removeFromUrlStorage(),!i.options.endpoint){i._emitHttpError(n,o,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}i.url=null,i._createUpload();return}var a=Number.parseInt(o.getHeader("Upload-Offset"),10);if(Number.isNaN(a)){i._emitHttpError(n,o,"tus: invalid or missing offset value");return}var l=Number.parseInt(o.getHeader("Upload-Length"),10);if(Number.isNaN(l)&&!i.options.uploadLengthDeferred&&i.options.protocol===Ip){i._emitHttpError(n,o,"tus: invalid or missing length value");return}typeof i.options.onUploadUrlAvailable=="function"&&i.options.onUploadUrlAvailable(),i._saveUploadInUrlStorage().then(function(){if(a===l){i._emitProgress(l,l),i._emitSuccess(o);return}i._offset=a,i._performUpload()})}).catch(function(o){i._emitHttpError(n,null,"tus: failed to resume upload",o)})}},{key:"_performUpload",value:function(){var i=this;if(!this._aborted){var n;this.options.overridePatchMethod?(n=this._openRequest("POST",this.url),n.setHeader("X-HTTP-Method-Override","PATCH")):n=this._openRequest("PATCH",this.url),n.setHeader("Upload-Offset","".concat(this._offset));var r=this._addChunkToRequest(n);r.then(function(o){if(!ll(o.getStatus(),200)){i._emitHttpError(n,o,"tus: unexpected response while uploading chunk");return}i._handleUploadResponse(n,o)}).catch(function(o){i._aborted||i._emitHttpError(n,null,"tus: failed to upload chunk at offset ".concat(i._offset),o)})}}},{key:"_addChunkToRequest",value:function(i){var n=this,r=this._offset,o=this._offset+this.options.chunkSize;return i.setProgressHandler(function(s){n._emitProgress(r+s,n._size)}),this.options.protocol===Ip?i.setHeader("Content-Type","application/offset+octet-stream"):this.options.protocol===Td&&i.setHeader("Content-Type","application/partial-upload"),(o===Number.POSITIVE_INFINITY||o>this._size)&&!this.options.uploadLengthDeferred&&(o=this._size),this._source.slice(r,o).then(function(s){var a=s.value,l=s.done,c=a!=null&&a.size?a.size:0;n.options.uploadLengthDeferred&&l&&(n._size=n._offset+c,i.setHeader("Upload-Length","".concat(n._size)));var d=n._offset+c;return!n.options.uploadLengthDeferred&&l&&d!==n._size?Promise.reject(new Error("upload was configured with a size of ".concat(n._size," bytes, but the source is done after ").concat(d," bytes"))):a===null?n._sendRequest(i):((n.options.protocol===Ap||n.options.protocol===Td)&&i.setHeader("Upload-Complete",l?"?1":"?0"),n._emitProgress(n._offset,n._size),n._sendRequest(i,a))})}},{key:"_handleUploadResponse",value:function(i,n){var r=Number.parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(r)){this._emitHttpError(i,n,"tus: invalid or missing offset value");return}if(this._emitProgress(r,this._size),this._emitChunkComplete(r-this._offset,r,this._size),this._offset=r,r===this._size){this._emitSuccess(n),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(i,n){var r=P4(i,n,this.options);return this._req=r,r}},{key:"_removeFromUrlStorage",value:function(){var i=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(n){i._emitError(n)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var i=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var n={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?n.parallelUploadUrls=this._parallelUploadUrls:n.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,n).then(function(r){i._urlStorageKey=r})}},{key:"_sendRequest",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return k4(i,n,this.options)}}],[{key:"terminate",value:function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=P4("DELETE",i,n);return k4(r,null,n).then(function(o){if(o.getStatus()!==204)throw new rl("tus: unexpected response while terminating upload",null,r,o)}).catch(function(o){if(o instanceof rl||(o=new rl("tus: failed to terminate upload",o,r,null)),!_4(o,0,n))throw o;var s=n.retryDelays[0],a=n.retryDelays.slice(1),l=al(al({},n),{},{retryDelays:a});return new Promise(function(c){return setTimeout(c,s)}).then(function(){return e.terminate(i,l)})})}}])})();function R4(e){return Object.entries(e).map(function(t){var i=F4(t,2),n=i[0],r=i[1];return"".concat(n," ").concat(a4.encode(String(r)))}).join(",")}function ll(e,t){return e>=t&&e<t+100}function P4(e,t,i){var n=i.httpStack.createRequest(e,t);i.protocol===Ap?n.setHeader("Upload-Draft-Interop-Version","5"):i.protocol===Td?n.setHeader("Upload-Draft-Interop-Version","6"):n.setHeader("Tus-Resumable","1.0.0");for(var r=i.headers||{},o=0,s=Object.entries(r);o<s.length;o++){var a=F4(s[o],2),l=a[0],c=a[1];n.setHeader(l,c)}if(i.addRequestId){var d=uC();n.setHeader("X-Request-ID",d)}return n}function k4(e,t,i){return pC.apply(this,arguments)}function pC(){return pC=dL(hC().mark(function e(t,i,n){var r;return hC().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(typeof n.onBeforeRequest!="function"){s.next=3;break}return s.next=3,n.onBeforeRequest(t);case 3:return s.next=5,t.send(i);case 5:if(r=s.sent,typeof n.onAfterResponse!="function"){s.next=9;break}return s.next=9,n.onAfterResponse(t,r);case 9:return s.abrupt("return",r);case 10:case"end":return s.stop()}},e)})),pC.apply(this,arguments)}function bL(){var e=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(e=!1),e}function _4(e,t,i){return i.retryDelays==null||t>=i.retryDelays.length||e.originalRequest==null?!1:i&&typeof i.onShouldRetry=="function"?i.onShouldRetry(e,t,i):O4(e)}function O4(e){var t=e.originalResponse?e.originalResponse.getStatus():0;return(!ll(t,400)||t===409||t===423)&&bL()}function D4(e,t){return new I4.default(t,e).toString()}function yL(e,t){for(var i=Math.floor(e/t),n=[],r=0;r<t;r++)n.push({start:i*r,end:i*(r+1)});return n[t-1].end=e,n}A4.defaultOptions=wL;var Op=A4;var SL=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"},Lp=SL;function fC(e){return new Promise(function(t,i){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var r=n.response;t(r)},n.onerror=function(r){i(r)},n.open("GET",e),n.send()})}var xL=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")},L4=xL;function gC(e){return new Promise(function(t,i){var n=new FileReader;n.onload=function(){var r=new Uint8Array(n.result);t({value:r})},n.onerror=function(r){i(r)},n.readAsArrayBuffer(e)})}function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function EL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N4(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PL(n.key),n)}}function RL(e,t,i){return t&&N4(e.prototype,t),i&&N4(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function PL(e){var t=kL(e,"string");return Id(t)=="symbol"?t:t+""}function kL(e,t){if(Id(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(Id(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mC=(function(){function e(t){EL(this,e),this._file=t,this.size=t.size}return RL(e,[{key:"slice",value:function(i,n){if(L4())return gC(this._file.slice(i,n));var r=this._file.slice(i,n),o=n>=this.size;return Promise.resolve({value:r,done:o})}},{key:"close",value:function(){}}])})();function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function _L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B4(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FL(n.key),n)}}function DL(e,t,i){return t&&B4(e.prototype,t),i&&B4(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function FL(e){var t=ML(e,"string");return Ad(t)=="symbol"?t:t+""}function ML(e,t){if(Ad(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(Ad(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H4(e){return e===void 0?0:e.size!==void 0?e.size:e.length}function TL(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var i=new e.constructor(e.length+t.length);return i.set(e),i.set(t,e.length),i}throw new Error("Unknown data type")}var z4=(function(){function e(t){_L(this,e),this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}return DL(e,[{key:"slice",value:function(i,n){return i<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(i,n)}},{key:"_readUntilEnoughDataOrDone",value:function(i,n){var r=this,o=n<=this._bufferOffset+H4(this._buffer);if(this._done||o){var s=this._getDataFromBuffer(i,n),a=s==null?this._done:!1;return Promise.resolve({value:s,done:a})}return this._reader.read().then(function(l){var c=l.value,d=l.done;return d?r._done=!0:r._buffer===void 0?r._buffer=c:r._buffer=TL(r._buffer,c),r._readUntilEnoughDataOrDone(i,n)})}},{key:"_getDataFromBuffer",value:function(i,n){i>this._bufferOffset&&(this._buffer=this._buffer.slice(i-this._bufferOffset),this._bufferOffset=i);var r=H4(this._buffer)===0;return this._done&&r?null:this._buffer.slice(0,n-i)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])})();function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}function vC(){"use strict";vC=function(){return t};var e,t={},i=Object.prototype,n=i.hasOwnProperty,r=Object.defineProperty||function(_,k,D){_[k]=D.value},o=typeof Symbol=="function"?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(_,k,D){return Object.defineProperty(_,k,{value:D,enumerable:!0,configurable:!0,writable:!0}),_[k]}try{c({},"")}catch{c=function(D,V,U){return D[V]=U}}function d(_,k,D,V){var U=k&&k.prototype instanceof v?k:v,G=Object.create(U.prototype),z=new oe(V||[]);return r(G,"_invoke",{value:Y(_,D,z)}),G}function u(_,k,D){try{return{type:"normal",arg:_.call(k,D)}}catch(V){return{type:"throw",arg:V}}}t.wrap=d;var h="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function v(){}function C(){}function b(){}var S={};c(S,s,function(){return this});var E=Object.getPrototypeOf,x=E&&E(E(re([])));x&&x!==i&&n.call(x,s)&&(S=x);var P=b.prototype=v.prototype=Object.create(S);function F(_){["next","throw","return"].forEach(function(k){c(_,k,function(D){return this._invoke(k,D)})})}function N(_,k){function D(U,G,z,O){var W=u(_[U],_,G);if(W.type!=="throw"){var ee=W.arg,Se=ee.value;return Se&&Ns(Se)=="object"&&n.call(Se,"__await")?k.resolve(Se.__await).then(function(Ee){D("next",Ee,z,O)},function(Ee){D("throw",Ee,z,O)}):k.resolve(Se).then(function(Ee){ee.value=Ee,z(ee)},function(Ee){return D("throw",Ee,z,O)})}O(W.arg)}var V;r(this,"_invoke",{value:function(G,z){function O(){return new k(function(W,ee){D(G,z,W,ee)})}return V=V?V.then(O,O):O()}})}function Y(_,k,D){var V=h;return function(U,G){if(V===f)throw Error("Generator is already running");if(V===g){if(U==="throw")throw G;return{value:e,done:!0}}for(D.method=U,D.arg=G;;){var z=D.delegate;if(z){var O=X(z,D);if(O){if(O===m)continue;return O}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(V===h)throw V=g,D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);V=f;var W=u(_,k,D);if(W.type==="normal"){if(V=D.done?g:p,W.arg===m)continue;return{value:W.arg,done:D.done}}W.type==="throw"&&(V=g,D.method="throw",D.arg=W.arg)}}}function X(_,k){var D=k.method,V=_.iterator[D];if(V===e)return k.delegate=null,D==="throw"&&_.iterator.return&&(k.method="return",k.arg=e,X(_,k),k.method==="throw")||D!=="return"&&(k.method="throw",k.arg=new TypeError("The iterator does not provide a '"+D+"' method")),m;var U=u(V,_.iterator,k.arg);if(U.type==="throw")return k.method="throw",k.arg=U.arg,k.delegate=null,m;var G=U.arg;return G?G.done?(k[_.resultName]=G.value,k.next=_.nextLoc,k.method!=="return"&&(k.method="next",k.arg=e),k.delegate=null,m):G:(k.method="throw",k.arg=new TypeError("iterator result is not an object"),k.delegate=null,m)}function Z(_){var k={tryLoc:_[0]};1 in _&&(k.catchLoc=_[1]),2 in _&&(k.finallyLoc=_[2],k.afterLoc=_[3]),this.tryEntries.push(k)}function me(_){var k=_.completion||{};k.type="normal",delete k.arg,_.completion=k}function oe(_){this.tryEntries=[{tryLoc:"root"}],_.forEach(Z,this),this.reset(!0)}function re(_){if(_||_===""){var k=_[s];if(k)return k.call(_);if(typeof _.next=="function")return _;if(!isNaN(_.length)){var D=-1,V=function U(){for(;++D<_.length;)if(n.call(_,D))return U.value=_[D],U.done=!1,U;return U.value=e,U.done=!0,U};return V.next=V}}throw new TypeError(Ns(_)+" is not iterable")}return C.prototype=b,r(P,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:C,configurable:!0}),C.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(_){var k=typeof _=="function"&&_.constructor;return!!k&&(k===C||(k.displayName||k.name)==="GeneratorFunction")},t.mark=function(_){return Object.setPrototypeOf?Object.setPrototypeOf(_,b):(_.__proto__=b,c(_,l,"GeneratorFunction")),_.prototype=Object.create(P),_},t.awrap=function(_){return{__await:_}},F(N.prototype),c(N.prototype,a,function(){return this}),t.AsyncIterator=N,t.async=function(_,k,D,V,U){U===void 0&&(U=Promise);var G=new N(d(_,k,D,V),U);return t.isGeneratorFunction(k)?G:G.next().then(function(z){return z.done?z.value:G.next()})},F(P),c(P,l,"Generator"),c(P,s,function(){return this}),c(P,"toString",function(){return"[object Generator]"}),t.keys=function(_){var k=Object(_),D=[];for(var V in k)D.push(V);return D.reverse(),function U(){for(;D.length;){var G=D.pop();if(G in k)return U.value=G,U.done=!1,U}return U.done=!0,U}},t.values=re,oe.prototype={constructor:oe,reset:function(k){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(me),!k)for(var D in this)D.charAt(0)==="t"&&n.call(this,D)&&!isNaN(+D.slice(1))&&(this[D]=e)},stop:function(){this.done=!0;var k=this.tryEntries[0].completion;if(k.type==="throw")throw k.arg;return this.rval},dispatchException:function(k){if(this.done)throw k;var D=this;function V(ee,Se){return z.type="throw",z.arg=k,D.next=ee,Se&&(D.method="next",D.arg=e),!!Se}for(var U=this.tryEntries.length-1;U>=0;--U){var G=this.tryEntries[U],z=G.completion;if(G.tryLoc==="root")return V("end");if(G.tryLoc<=this.prev){var O=n.call(G,"catchLoc"),W=n.call(G,"finallyLoc");if(O&&W){if(this.prev<G.catchLoc)return V(G.catchLoc,!0);if(this.prev<G.finallyLoc)return V(G.finallyLoc)}else if(O){if(this.prev<G.catchLoc)return V(G.catchLoc,!0)}else{if(!W)throw Error("try statement without catch or finally");if(this.prev<G.finallyLoc)return V(G.finallyLoc)}}}},abrupt:function(k,D){for(var V=this.tryEntries.length-1;V>=0;--V){var U=this.tryEntries[V];if(U.tryLoc<=this.prev&&n.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var G=U;break}}G&&(k==="break"||k==="continue")&&G.tryLoc<=D&&D<=G.finallyLoc&&(G=null);var z=G?G.completion:{};return z.type=k,z.arg=D,G?(this.method="next",this.next=G.finallyLoc,m):this.complete(z)},complete:function(k,D){if(k.type==="throw")throw k.arg;return k.type==="break"||k.type==="continue"?this.next=k.arg:k.type==="return"?(this.rval=this.arg=k.arg,this.method="return",this.next="end"):k.type==="normal"&&D&&(this.next=D),m},finish:function(k){for(var D=this.tryEntries.length-1;D>=0;--D){var V=this.tryEntries[D];if(V.finallyLoc===k)return this.complete(V.completion,V.afterLoc),me(V),m}},catch:function(k){for(var D=this.tryEntries.length-1;D>=0;--D){var V=this.tryEntries[D];if(V.tryLoc===k){var U=V.completion;if(U.type==="throw"){var G=U.arg;me(V)}return G}}throw Error("illegal catch attempt")},delegateYield:function(k,D,V){return this.delegate={iterator:re(k),resultName:D,nextLoc:V},this.method==="next"&&(this.arg=e),m}},t}function V4(e,t,i,n,r,o,s){try{var a=e[o](s),l=a.value}catch(c){i(c);return}a.done?t(l):Promise.resolve(l).then(n,r)}function IL(e){return function(){var t=this,i=arguments;return new Promise(function(n,r){var o=e.apply(t,i);function s(l){V4(o,n,r,s,a,"next",l)}function a(l){V4(o,n,r,s,a,"throw",l)}s(void 0)})}}function AL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G4(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LL(n.key),n)}}function OL(e,t,i){return t&&G4(e.prototype,t),i&&G4(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function LL(e){var t=NL(e,"string");return Ns(t)=="symbol"?t:t+""}function NL(e,t){if(Ns(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(Ns(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var W4=(function(){function e(){AL(this,e)}return OL(e,[{key:"openFile",value:(function(){var t=IL(vC().mark(function n(r,o){var s;return vC().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(Lp()&&r&&typeof r.uri<"u")){l.next=11;break}return l.prev=1,l.next=4,fC(r.uri);case 4:return s=l.sent,l.abrupt("return",new mC(s));case 8:throw l.prev=8,l.t0=l.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(l.t0));case 11:if(!(typeof r.slice=="function"&&typeof r.size<"u")){l.next=13;break}return l.abrupt("return",Promise.resolve(new mC(r)));case 13:if(typeof r.read!="function"){l.next=18;break}if(o=Number(o),Number.isFinite(o)){l.next=17;break}return l.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return l.abrupt("return",Promise.resolve(new z4(r,o)));case 18:return l.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return l.stop()}},n,null,[[1,8]])}));function i(n,r){return t.apply(this,arguments)}return i})()}])})();function CC(e,t){return Lp()?Promise.resolve(BL(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}function BL(e,t){var i=e.exif?HL(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",i,t.endpoint].join("/")}function HL(e){var t=0;if(e.length===0)return t;for(var i=0;i<e.length;i++){var n=e.charCodeAt(i);t=(t<<5)-t+n,t&=t}return t}function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function wC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U4(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zL(n.key),n)}}function bC(e,t,i){return t&&U4(e.prototype,t),i&&U4(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function zL(e){var t=VL(e,"string");return Od(t)=="symbol"?t:t+""}function VL(e,t){if(Od(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(Od(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j4=(function(){function e(){wC(this,e)}return bC(e,[{key:"createRequest",value:function(i,n){return new GL(i,n)}},{key:"getName",value:function(){return"XHRHttpStack"}}])})();var GL=(function(){function e(t,i){wC(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,i,!0),this._method=t,this._url=i,this._headers={}}return bC(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(i,n){this._xhr.setRequestHeader(i,n),this._headers[i]=n}},{key:"getHeader",value:function(i){return this._headers[i]}},{key:"setProgressHandler",value:function(i){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(n){n.lengthComputable&&i(n.loaded)})}},{key:"send",value:function(){var i=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(r,o){i._xhr.onload=function(){r(new WL(i._xhr))},i._xhr.onerror=function(s){o(s)},i._xhr.send(n)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})(),WL=(function(){function e(t){wC(this,e),this._xhr=t}return bC(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(i){return this._xhr.getResponseHeader(i)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})();function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}function UL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q4(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qL(n.key),n)}}function jL(e,t,i){return t&&q4(e.prototype,t),i&&q4(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function qL(e){var t=$L(e,"string");return Ld(t)=="symbol"?t:t+""}function $L(e,t){if(Ld(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(Ld(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SC=!1;try{SC="localStorage"in window,Np="tusSupport",yC=localStorage.getItem(Np),localStorage.setItem(Np,yC),yC===null&&localStorage.removeItem(Np)}catch(e){if(e.code===e.SECURITY_ERR||e.code===e.QUOTA_EXCEEDED_ERR)SC=!1;else throw e}var Np,yC,$4=SC,K4=(function(){function e(){UL(this,e)}return jL(e,[{key:"findAllUploads",value:function(){var i=this._findEntries("tus::");return Promise.resolve(i)}},{key:"findUploadsByFingerprint",value:function(i){var n=this._findEntries("tus::".concat(i,"::"));return Promise.resolve(n)}},{key:"removeUpload",value:function(i){return localStorage.removeItem(i),Promise.resolve()}},{key:"addUpload",value:function(i,n){var r=Math.round(Math.random()*1e12),o="tus::".concat(i,"::").concat(r);return localStorage.setItem(o,JSON.stringify(n)),Promise.resolve(o)}},{key:"_findEntries",value:function(i){for(var n=[],r=0;r<localStorage.length;r++){var o=localStorage.key(r);if(o.indexOf(i)===0)try{var s=JSON.parse(localStorage.getItem(o));s.urlStorageKey=o,n.push(s)}catch{}}return n}}])})();function dl(e){"@babel/helpers - typeof";return dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dl(e)}function KL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y4(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q4(n.key),n)}}function YL(e,t,i){return t&&Y4(e.prototype,t),i&&Y4(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function XL(e,t,i){return t=Bp(t),JL(e,J4()?Reflect.construct(t,i||[],Bp(e).constructor):t.apply(e,i))}function JL(e,t){if(t&&(dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QL(e)}function QL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J4=function(){return!!e})()}function Bp(e){return Bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Bp(e)}function ZL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xC(e,t)}function xC(e,t){return xC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},xC(e,t)}function X4(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),i.push.apply(i,n)}return i}function cl(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?X4(Object(i),!0).forEach(function(n){eN(e,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):X4(Object(i)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))})}return e}function eN(e,t,i){return t=Q4(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Q4(e){var t=tN(e,"string");return dl(t)=="symbol"?t:t+""}function tN(e,t){if(dl(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t||"default");if(dl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hp=cl(cl({},Op.defaultOptions),{},{httpStack:new j4,fileReader:new W4,urlStorage:$4?new K4:new G6,fingerprint:CC}),Z4=(function(e){function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return KL(this,t),n=cl(cl({},Hp),n),XL(this,t,[i,n])}return ZL(t,e),YL(t,null,[{key:"terminate",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=cl(cl({},Hp),r),Op.terminate(n,r)}}])})(Op),_ve=typeof XMLHttpRequest=="function"&&typeof Blob=="function"&&typeof Blob.prototype.slice=="function";var t5={name:"@uppy/tus",description:"Resumable uploads for Uppy using Tus.io",version:"5.1.0",license:"MIT",type:"module",sideEffects:!1,scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","upload","resumable","tus"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],exports:{".":"./lib/index.js","./package.json":"./package.json"},dependencies:{"@uppy/companion-client":"^5.1.1","@uppy/utils":"^7.1.4","tus-js-client":"^4.2.3"},devDependencies:{"@uppy/core":"^5.2.0",jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"^5.2.0"}};function nN(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")}function rN(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"}function EC(e){return(t,i)=>{if(nN()||rN())return Hp.fingerprint(t,i);let n=["tus",e.id,i.endpoint].join("-");return Promise.resolve(n)}}var i5={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},oN={limit:20,retryDelays:i5.retryDelays,withCredentials:!1,allowedMetaFields:!0},zp=class extends jr{static VERSION=t5.version;#e;requests;uploaders;uploaderEvents;constructor(t,i){if(super(t,w(w({},oN),i)),this.type="uploader",this.id=this.opts.id||"Tus",i?.allowedMetaFields===void 0&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in i)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=this.opts.rateLimitedQueue??new ks(this.opts.limit),this.#e=this.opts.retryDelays?.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}resetUploaderReferences(t,i){let n=this.uploaders[t];n&&(n.abort(),i?.abort&&n.abort(!0),this.uploaders[t]=null),this.uploaderEvents[t]&&(this.uploaderEvents[t].remove(),this.uploaderEvents[t]=null)}async#t(t){return this.resetUploaderReferences(t.id),new Promise((i,n)=>{let r,o,s,a=w(w({},this.opts),t.tus||{});typeof a.headers=="function"&&(a.headers=a.headers(t));let v=a,{onShouldRetry:l,onBeforeRequest:c}=v,d=xt(v,["onShouldRetry","onBeforeRequest"]),u=w(w({},i5),d);u.fingerprint=EC(t),u.onBeforeRequest=async C=>{let b=C.getUnderlyingObject();b.withCredentials=!!a.withCredentials;let S;if(typeof c=="function"&&(S=c(C,t)),$a(r,"shouldBeRequeued")){if(!r.shouldBeRequeued)return Promise.reject();let E,x=new Promise(P=>{E=P});r=this.requests.run(()=>(t.isPaused&&r.abort(),E(),()=>{})),await Promise.all([x,S]);return}return S},u.onError=C=>{this.uppy.log(C);let b=C.originalRequest!=null?C.originalRequest.getUnderlyingObject():null;H0(b)&&(C=new D0(C,b)),this.resetUploaderReferences(t.id),r?.abort(),typeof a.onError=="function"&&a.onError(C),n(C)},u.onProgress=(C,b)=>{this.onReceiveUploadUrl(t,s.url),typeof a.onProgress=="function"&&a.onProgress(C,b);let S=this.uppy.getFile(t.id);this.uppy.emit("upload-progress",S,{uploadStarted:S.progress.uploadStarted??0,bytesUploaded:C,bytesTotal:b})},u.onSuccess=C=>{let b={uploadURL:s.url??void 0,status:200,body:{xhr:C.lastResponse.getUnderlyingObject()}};if(this.uppy.emit("upload-success",this.uppy.getFile(t.id),b),this.resetUploaderReferences(t.id),r.done(),s.url){let{name:S}=s.file;this.uppy.log(`Download ${S} from ${s.url}`)}typeof a.onSuccess=="function"&&a.onSuccess(C),i(s)};let h=C=>{let b=C?.originalResponse?.getStatus();if(b===429){if(!this.requests.isPaused){let S=this.#e?.next();if(S==null||S.done)return!1;this.requests.rateLimit(S.value)}}else{if(b!=null&&b>=400&&b<500&&b!==409&&b!==423)return!1;typeof navigator<"u"&&navigator.onLine===!1&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",()=>{this.requests.resume()},{once:!0})))}return r.abort(),r={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};l!=null?u.onShouldRetry=(C,b)=>l(C,b,a,h):u.onShouldRetry=h;let p=(C,b,S)=>{$a(C,b)&&!$a(C,S)&&(C[S]=C[b])},f={};if(qh(a.allowedMetaFields,t.meta).forEach(C=>{f[C]=String(t.meta[C])}),p(f,"type","filetype"),p(f,"name","filename"),u.metadata=f,t.data==null)throw new Error("File data is empty");s=new Z4(t.data,u),this.uploaders[t.id]=s;let m=new nd(this.uppy);this.uploaderEvents[t.id]=m,o=()=>(t.isPaused||s.start(),()=>{}),s.findPreviousUploads().then(C=>{let b=C[0];b&&(this.uppy.log(`[Tus] Resuming upload of ${t.id} started at ${b.creationTime}`),s.resumeFromPreviousUpload(b)),r=this.requests.run(o)}),m.onFileRemove(t.id,C=>{r.abort(),this.resetUploaderReferences(t.id,{abort:!!s.url}),i(`upload ${C} was removed`)}),m.onPause(t.id,C=>{r.abort(),C?s.abort():r=this.requests.run(o)}),m.onPauseAll(t.id,()=>{r.abort(),s.abort()}),m.onCancelAll(t.id,()=>{r.abort(),this.resetUploaderReferences(t.id,{abort:!!s.url}),i(`upload ${t.id} was canceled`)}),m.onResumeAll(t.id,()=>{r.abort(),t.error&&s.abort(),r=this.requests.run(o)})}).catch(i=>{throw this.uppy.emit("upload-error",t,i),i})}onReceiveUploadUrl(t,i){let n=this.uppy.getFile(t.id);n&&(!n.tus||n.tus.uploadUrl!==i)&&(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(n.id,{tus:T(w({},n.tus),{uploadUrl:i})}))}#i(t){let i=w({},this.opts);return t.tus&&Object.assign(i,t.tus),typeof i.headers=="function"&&(i.headers=i.headers(t)),T(w({},"remote"in t&&t.remote.body),{endpoint:i.endpoint,uploadUrl:i.uploadUrl,protocol:"tus",size:t.data.size,headers:i.headers,metadata:t.meta})}async#n(t){let i=F0(t),n=M0(i);this.uppy.emit("upload-start",n),await Promise.allSettled(i.map(r=>{if(r.isRemote){let o=()=>this.requests,s=new AbortController,a=c=>{c.id===r.id&&s.abort()};this.uppy.on("file-removed",a);let l=this.uppy.getRequestClientForFile(r).uploadRemoteFile(r,this.#i(r),{signal:s.signal,getQueue:o});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",a)},{priority:-1})(),l}return this.#t(r)}))}#r=async t=>{if(t.length===0){this.uppy.log("[Tus] No files to upload");return}this.opts.limit===0&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");let i=this.uppy.getFilesByIds(t);await this.#n(i)};install(){this.uppy.setState({capabilities:T(w({},this.uppy.getState().capabilities),{resumableUploads:!0})}),this.uppy.addUploader(this.#r)}uninstall(){this.uppy.setState({capabilities:T(w({},this.uppy.getState().capabilities),{resumableUploads:!1})}),this.uppy.removeUploader(this.#r)}};var qve=(()=>{class e{uploadEndpoint=De("");maxFileSize=De(10*1024*1024);allowedFileTypes=De(["image/*","application/pdf",".doc",".docx"]);maxNumberOfFiles=De(10);note=De("");uploadComplete=Ce();uploadError=Ce();filesAdded=Ce();uppy=null;ngOnInit(){this.initializeUppy()}ngOnDestroy(){this.uppy?.destroy()}initializeUppy(){this.uppy=new sp({id:"file-uploader",autoProceed:!1,allowMultipleUploadBatches:!0,restrictions:{maxFileSize:this.maxFileSize(),maxNumberOfFiles:this.maxNumberOfFiles(),allowedFileTypes:this.allowedFileTypes()}}).use(kd,{inline:!0,target:"#uppy-dashboard",height:400,width:"100%",theme:"auto",proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!1,hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showRemoveButtonAfterComplete:!0,note:this.note()||"Images up to 10MB, PDFs and documents allowed"}).use(ap,{quality:.8,limit:10}),this.uploadEndpoint()&&this.uppy.use(zp,{endpoint:this.uploadEndpoint(),retryDelays:[0,1e3,3e3,5e3],chunkSize:5*1024*1024}),this.uppy.on("file-added",()=>{this.filesAdded.emit(this.uppy?.getFiles().length??0)}),this.uppy.on("complete",i=>{let n=[];i.successful&&(n=i.successful.map(r=>({id:r.id,name:r.name,size:r.size,type:r.type??"unknown",url:r.response?.uploadURL}))),this.uploadComplete.emit(n)}),this.uppy.on("error",i=>{this.uploadError.emit(i)}),this.uppy.on("upload-error",(i,n)=>{console.error("Upload error for file:",i?.name,n),this.uploadError.emit(n)})}clearFiles(){this.uppy?.cancelAll()}getFiles(){return this.uppy?.getFiles()??[]}upload(){this.uppy?.upload()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-file-upload"]],inputs:{uploadEndpoint:[1,"uploadEndpoint"],maxFileSize:[1,"maxFileSize"],allowedFileTypes:[1,"allowedFileTypes"],maxNumberOfFiles:[1,"maxNumberOfFiles"],note:[1,"note"]},outputs:{uploadComplete:"uploadComplete",uploadError:"uploadError",filesAdded:"filesAdded"},decls:1,vars:0,consts:[["id","uppy-dashboard"]],template:function(n,r){n&1&&Nh(0,"div",0)},styles:["[_nghost-%COMP%]{display:block;width:100%}#uppy-dashboard[_ngcontent-%COMP%]{border-radius:.5rem;overflow:hidden}[_nghost-%COMP%]     .uppy-Dashboard-inner{background-color:hsl(var(--background));border:1px solid hsl(var(--border));border-radius:.5rem}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{border-color:hsl(var(--border))}[_nghost-%COMP%]     .uppy-Dashboard-AddFiles-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-Dashboard-note{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-DashboardContent-bar{background-color:hsl(var(--muted));border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardContent-title{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem{border-bottom:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-DashboardItem-name{color:hsl(var(--foreground))}[_nghost-%COMP%]     .uppy-DashboardItem-status{color:hsl(var(--muted-foreground))}[_nghost-%COMP%]     .uppy-StatusBar{background-color:hsl(var(--muted));border-top:1px solid hsl(var(--border))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload{background-color:hsl(var(--primary));color:hsl(var(--primary-foreground))}[_nghost-%COMP%]     .uppy-StatusBar-actionBtn--upload:hover{background-color:hsl(var(--primary) / .9)}[_nghost-%COMP%]     .uppy-StatusBar-progress{background-color:hsl(var(--primary))}@media(prefers-color-scheme:dark){[_nghost-%COMP%]     .uppy-Dashboard-AddFiles{background-color:hsl(var(--background))}[_nghost-%COMP%]     .uppy-Dashboard-dropFilesHereHint{color:hsl(var(--muted-foreground))}}"],changeDetection:0})}return e})();function gi(e){this.content=e}gi.prototype={constructor:gi,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,i){var n=i&&i!=e?this.remove(i):this,r=n.find(e),o=n.content.slice();return r==-1?o.push(i||e,t):(o[r+1]=t,i&&(o[r]=i)),new gi(o)},remove:function(e){var t=this.find(e);if(t==-1)return this;var i=this.content.slice();return i.splice(t,2),new gi(i)},addToStart:function(e,t){return new gi([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var i=this.remove(e).content.slice();return i.push(e,t),new gi(i)},addBefore:function(e,t,i){var n=this.remove(t),r=n.content.slice(),o=n.find(e);return r.splice(o==-1?r.length:o,0,t,i),new gi(r)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=gi.from(e),e.size?new gi(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=gi.from(e),e.size?new gi(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=gi.from(e);for(var i=0;i<e.content.length;i+=2)t=t.remove(e.content[i]);return t},toObject:function(){var e={};return this.forEach(function(t,i){e[t]=i}),e},get size(){return this.content.length>>1}};gi.from=function(e){if(e instanceof gi)return e;var t=[];if(e)for(var i in e)t.push(i,e[i]);return new gi(t)};var RC=gi;function h5(e,t,i){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:i;let r=e.child(n),o=t.child(n);if(r==o){i+=r.nodeSize;continue}if(!r.sameMarkup(o))return i;if(r.isText&&r.text!=o.text){for(let s=0;r.text[s]==o.text[s];s++)i++;return i}if(r.content.size||o.content.size){let s=h5(r.content,o.content,i+1);if(s!=null)return s}i+=r.nodeSize}}function p5(e,t,i,n){for(let r=e.childCount,o=t.childCount;;){if(r==0||o==0)return r==o?null:{a:i,b:n};let s=e.child(--r),a=t.child(--o),l=s.nodeSize;if(s==a){i-=l,n-=l;continue}if(!s.sameMarkup(a))return{a:i,b:n};if(s.isText&&s.text!=a.text){let c=0,d=Math.min(s.text.length,a.text.length);for(;c<d&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,i--,n--;return{a:i,b:n}}if(s.content.size||a.content.size){let c=p5(s.content,a.content,i-1,n-1);if(c)return c}i-=l,n-=l}}var ie=class e{constructor(t,i){if(this.content=t,this.size=i||0,i==null)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,i,n,r=0,o){for(let s=0,a=0;a<i;s++){let l=this.content[s],c=a+l.nodeSize;if(c>t&&n(l,r+a,o||null,s)!==!1&&l.content.size){let d=a+1;l.nodesBetween(Math.max(0,t-d),Math.min(l.content.size,i-d),n,r+d)}a=c}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,i,n,r){let o="",s=!0;return this.nodesBetween(t,i,(a,l)=>{let c=a.isText?a.text.slice(Math.max(t,l)-l,i-l):a.isLeaf?r?typeof r=="function"?r(a):r:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&n&&(s?s=!1:o+=n),o+=c},0),o}append(t){if(!t.size)return this;if(!this.size)return t;let i=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(i.isText&&i.sameMarkup(n)&&(r[r.length-1]=i.withText(i.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new e(r,this.size+t.size)}cut(t,i=this.size){if(t==0&&i==this.size)return this;let n=[],r=0;if(i>t)for(let o=0,s=0;s<i;o++){let a=this.content[o],l=s+a.nodeSize;l>t&&((s<t||l>i)&&(a.isText?a=a.cut(Math.max(0,t-s),Math.min(a.text.length,i-s)):a=a.cut(Math.max(0,t-s-1),Math.min(a.content.size,i-s-1))),n.push(a),r+=a.nodeSize),s=l}return new e(n,r)}cutByIndex(t,i){return t==i?e.empty:t==0&&i==this.content.length?this:new e(this.content.slice(t,i))}replaceChild(t,i){let n=this.content[t];if(n==i)return this;let r=this.content.slice(),o=this.size+i.nodeSize-n.nodeSize;return r[t]=i,new e(r,o)}addToStart(t){return new e([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new e(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let i=0;i<this.content.length;i++)if(!this.content[i].eq(t.content[i]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let i=this.content[t];if(!i)throw new RangeError("Index "+t+" out of range for "+this);return i}maybeChild(t){return this.content[t]||null}forEach(t){for(let i=0,n=0;i<this.content.length;i++){let r=this.content[i];t(r,n,i),n+=r.nodeSize}}findDiffStart(t,i=0){return h5(this,t,i)}findDiffEnd(t,i=this.size,n=t.size){return p5(this,t,i,n)}findIndex(t){if(t==0)return Vp(0,t);if(t==this.size)return Vp(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let i=0,n=0;;i++){let r=this.child(i),o=n+r.nodeSize;if(o>=t)return o==t?Vp(i+1,o):Vp(i,n);n=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,i){if(!i)return e.empty;if(!Array.isArray(i))throw new RangeError("Invalid input for Fragment.fromJSON");return new e(i.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return e.empty;let i,n=0;for(let r=0;r<t.length;r++){let o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(i||(i=t.slice(0,r)),i[i.length-1]=o.withText(i[i.length-1].text+o.text)):i&&i.push(o)}return new e(i||t,n)}static from(t){if(!t)return e.empty;if(t instanceof e)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new e([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};ie.empty=new ie([],0);var PC={index:0,offset:0};function Vp(e,t){return PC.index=e,PC.offset=t,PC}function Wp(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let i=Array.isArray(e);if(Array.isArray(t)!=i)return!1;if(i){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!Wp(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!Wp(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}var lt=(()=>{class e{constructor(i,n){this.type=i,this.attrs=n}addToSet(i){let n,r=!1;for(let o=0;o<i.length;o++){let s=i[o];if(this.eq(s))return i;if(this.type.excludes(s.type))n||(n=i.slice(0,o));else{if(s.type.excludes(this.type))return i;!r&&s.type.rank>this.type.rank&&(n||(n=i.slice(0,o)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=i.slice()),r||n.push(this),n}removeFromSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return i.slice(0,n).concat(i.slice(n+1));return i}isInSet(i){for(let n=0;n<i.length;n++)if(this.eq(i[n]))return!0;return!1}eq(i){return this==i||this.type==i.type&&Wp(this.attrs,i.attrs)}toJSON(){let i={type:this.type.name};for(let n in this.attrs){i.attrs=this.attrs;break}return i}static fromJSON(i,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=i.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let o=r.create(n.attrs);return r.checkAttrs(o.attrs),o}static sameSet(i,n){if(i==n)return!0;if(i.length!=n.length)return!1;for(let r=0;r<i.length;r++)if(!i[r].eq(n[r]))return!1;return!0}static setFrom(i){if(!i||Array.isArray(i)&&i.length==0)return e.none;if(i instanceof e)return[i];let n=i.slice();return n.sort((r,o)=>r.type.rank-o.type.rank),n}}return e.none=[],e})(),zs=class extends Error{},we=class e{constructor(t,i,n){this.content=t,this.openStart=i,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,i){let n=g5(this.content,t+this.openStart,i);return n&&new e(n,this.openStart,this.openEnd)}removeBetween(t,i){return new e(f5(this.content,t+this.openStart,i+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,i){if(!i)return e.empty;let n=i.openStart||0,r=i.openEnd||0;if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new e(ie.fromJSON(t,i.content),n,r)}static maxOpen(t,i=!0){let n=0,r=0;for(let o=t.firstChild;o&&!o.isLeaf&&(i||!o.type.spec.isolating);o=o.firstChild)n++;for(let o=t.lastChild;o&&!o.isLeaf&&(i||!o.type.spec.isolating);o=o.lastChild)r++;return new e(t,n,r)}};we.empty=new we(ie.empty,0,0);function f5(e,t,i){let{index:n,offset:r}=e.findIndex(t),o=e.maybeChild(n),{index:s,offset:a}=e.findIndex(i);if(r==t||o.isText){if(a!=i&&!e.child(s).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(i))}if(n!=s)throw new RangeError("Removing non-flat range");return e.replaceChild(n,o.copy(f5(o.content,t-r-1,i-r-1)))}function g5(e,t,i,n){let{index:r,offset:o}=e.findIndex(t),s=e.maybeChild(r);if(o==t||s.isText)return n&&!n.canReplace(r,r,i)?null:e.cut(0,t).append(i).append(e.cut(t));let a=g5(s.content,t-o-1,i,s);return a&&e.replaceChild(r,s.copy(a))}function sN(e,t,i){if(i.openStart>e.depth)throw new zs("Inserted content deeper than insertion position");if(e.depth-i.openStart!=t.depth-i.openEnd)throw new zs("Inconsistent open depths");return m5(e,t,i,0)}function m5(e,t,i,n){let r=e.index(n),o=e.node(n);if(r==t.index(n)&&n<e.depth-i.openStart){let s=m5(e,t,i,n+1);return o.copy(o.content.replaceChild(r,s))}else if(i.content.size)if(!i.openStart&&!i.openEnd&&e.depth==n&&t.depth==n){let s=e.parent,a=s.content;return Hs(s,a.cut(0,e.parentOffset).append(i.content).append(a.cut(t.parentOffset)))}else{let{start:s,end:a}=aN(i,e);return Hs(o,C5(e,s,a,t,n))}else return Hs(o,Up(e,t,n))}function v5(e,t){if(!t.type.compatibleContent(e.type))throw new zs("Cannot join "+t.type.name+" onto "+e.type.name)}function _C(e,t,i){let n=e.node(i);return v5(n,t.node(i)),n}function Bs(e,t){let i=t.length-1;i>=0&&e.isText&&e.sameMarkup(t[i])?t[i]=e.withText(t[i].text+e.text):t.push(e)}function Nd(e,t,i,n){let r=(t||e).node(i),o=0,s=t?t.index(i):r.childCount;e&&(o=e.index(i),e.depth>i?o++:e.textOffset&&(Bs(e.nodeAfter,n),o++));for(let a=o;a<s;a++)Bs(r.child(a),n);t&&t.depth==i&&t.textOffset&&Bs(t.nodeBefore,n)}function Hs(e,t){return e.type.checkContent(t),e.copy(t)}function C5(e,t,i,n,r){let o=e.depth>r&&_C(e,t,r+1),s=n.depth>r&&_C(i,n,r+1),a=[];return Nd(null,e,r,a),o&&s&&t.index(r)==i.index(r)?(v5(o,s),Bs(Hs(o,C5(e,t,i,n,r+1)),a)):(o&&Bs(Hs(o,Up(e,t,r+1)),a),Nd(t,i,r,a),s&&Bs(Hs(s,Up(i,n,r+1)),a)),Nd(n,null,r,a),new ie(a)}function Up(e,t,i){let n=[];if(Nd(null,e,i,n),e.depth>i){let r=_C(e,t,i+1);Bs(Hs(r,Up(e,t,i+1)),n)}return Nd(t,null,i,n),new ie(n)}function aN(e,t){let i=t.depth-e.openStart,r=t.node(i).copy(e.content);for(let o=i-1;o>=0;o--)r=t.node(o).copy(ie.from(r));return{start:r.resolveNoCache(e.openStart+i),end:r.resolveNoCache(r.content.size-e.openEnd-i)}}var jp=class e{constructor(t,i,n){this.pos=t,this.path=i,this.parentOffset=n,this.depth=i.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,i=this.index(this.depth);if(i==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=t.child(i);return n?t.child(i).cut(n):r}get nodeBefore(){let t=this.index(this.depth),i=this.pos-this.path[this.path.length-1];return i?this.parent.child(t).cut(0,i):t==0?null:this.parent.child(t-1)}posAtIndex(t,i){i=this.resolveDepth(i);let n=this.path[i*3],r=i==0?0:this.path[i*3-1]+1;for(let o=0;o<t;o++)r+=n.child(o).nodeSize;return r}marks(){let t=this.parent,i=this.index();if(t.content.size==0)return lt.none;if(this.textOffset)return t.child(i).marks;let n=t.maybeChild(i-1),r=t.maybeChild(i);if(!n){let a=n;n=r,r=a}let o=n.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!r||!o[s].isInSet(r.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(t){let i=this.parent.maybeChild(this.index());if(!i||!i.isInline)return null;let n=i.marks,r=t.parent.maybeChild(t.index());for(var o=0;o<n.length;o++)n[o].type.spec.inclusive===!1&&(!r||!n[o].isInSet(r.marks))&&(n=n[o--].removeFromSet(n));return n}sharedDepth(t){for(let i=this.depth;i>0;i--)if(this.start(i)<=t&&this.end(i)>=t)return i;return 0}blockRange(t=this,i){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!i||i(this.node(n))))return new Vs(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let i=1;i<=this.depth;i++)t+=(t?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return t+":"+this.parentOffset}static resolve(t,i){if(!(i>=0&&i<=t.content.size))throw new RangeError("Position "+i+" out of range");let n=[],r=0,o=i;for(let s=t;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(n.push(s,a,r+l),!c||(s=s.child(a),s.isText))break;o=c-1,r+=l+1}return new e(i,n,o)}static resolveCached(t,i){let n=n5.get(t);if(n)for(let o=0;o<n.elts.length;o++){let s=n.elts[o];if(s.pos==i)return s}else n5.set(t,n=new DC);let r=n.elts[n.i]=e.resolve(t,i);return n.i=(n.i+1)%lN,r}},DC=class{constructor(){this.elts=[],this.i=0}},lN=12,n5=new WeakMap,Vs=class{constructor(t,i,n){this.$from=t,this.$to=i,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}},cN=Object.create(null),Hi=class e{constructor(t,i,n,r=lt.none){this.type=t,this.attrs=i,this.marks=r,this.content=n||ie.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,i,n,r=0){this.content.nodesBetween(t,i,n,r,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,i,n,r){return this.content.textBetween(t,i,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,i,n){return this.type==t&&Wp(this.attrs,i||t.defaultAttrs||cN)&&lt.sameSet(this.marks,n||lt.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(t,i=this.content.size){return t==0&&i==this.content.size?this:this.copy(this.content.cut(t,i))}slice(t,i=this.content.size,n=!1){if(t==i)return we.empty;let r=this.resolve(t),o=this.resolve(i),s=n?0:r.sharedDepth(i),a=r.start(s),c=r.node(s).content.cut(r.pos-a,o.pos-a);return new we(c,r.depth-s,o.depth-s)}replace(t,i,n){return sN(this.resolve(t),this.resolve(i),n)}nodeAt(t){for(let i=this;;){let{index:n,offset:r}=i.content.findIndex(t);if(i=i.maybeChild(n),!i)return null;if(r==t||i.isText)return i;t-=r+1}}childAfter(t){let{index:i,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(i),index:i,offset:n}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:i,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(i),index:i,offset:n};let r=this.content.child(i-1);return{node:r,index:i-1,offset:n-r.nodeSize}}resolve(t){return jp.resolveCached(this,t)}resolveNoCache(t){return jp.resolve(this,t)}rangeHasMark(t,i,n){let r=!1;return i>t&&this.nodesBetween(t,i,o=>(n.isInSet(o.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),w5(this.marks,t)}contentMatchAt(t){let i=this.type.contentMatch.matchFragment(this.content,0,t);if(!i)throw new Error("Called contentMatchAt on a node with invalid content");return i}canReplace(t,i,n=ie.empty,r=0,o=n.childCount){let s=this.contentMatchAt(t).matchFragment(n,r,o),a=s&&s.matchFragment(this.content,i);if(!a||!a.validEnd)return!1;for(let l=r;l<o;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(t,i,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(t).matchType(n),s=o&&o.matchFragment(this.content,i);return s?s.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=lt.none;for(let i=0;i<this.marks.length;i++){let n=this.marks[i];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!lt.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(i=>i.type.name)}`);this.content.forEach(i=>i.check())}toJSON(){let t={type:this.type.name};for(let i in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(i=>i.toJSON())),t}static fromJSON(t,i){if(!i)throw new RangeError("Invalid input for Node.fromJSON");let n;if(i.marks){if(!Array.isArray(i.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=i.marks.map(t.markFromJSON)}if(i.type=="text"){if(typeof i.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(i.text,n)}let r=ie.fromJSON(t,i.content),o=t.nodeType(i.type).create(i.attrs,r,n);return o.type.checkAttrs(o.attrs),o}};Hi.prototype.text=void 0;var FC=class e extends Hi{constructor(t,i,n,r){if(super(t,i,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):w5(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,i){return this.text.slice(t,i)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)}cut(t=0,i=this.text.length){return t==0&&i==this.text.length?this:this.withText(this.text.slice(t,i))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}};function w5(e,t){for(let i=e.length-1;i>=0;i--)t=e[i].type.name+"("+t+")";return t}var Gs=class e{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,i){let n=new MC(t,i);if(n.next==null)return e.empty;let r=b5(n);n.next&&n.err("Unexpected trailing text");let o=mN(gN(r));return vN(o,n),o}matchType(t){for(let i=0;i<this.next.length;i++)if(this.next[i].type==t)return this.next[i].next;return null}matchFragment(t,i=0,n=t.childCount){let r=this;for(let o=i;r&&o<n;o++)r=r.matchType(t.child(o).type);return r}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:i}=this.next[t];if(!(i.isText||i.hasRequiredAttrs()))return i}return null}compatible(t){for(let i=0;i<this.next.length;i++)for(let n=0;n<t.next.length;n++)if(this.next[i].type==t.next[n].type)return!0;return!1}fillBefore(t,i=!1,n=0){let r=[this];function o(s,a){let l=s.matchFragment(t,n);if(l&&(!i||l.validEnd))return ie.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:d,next:u}=s.next[c];if(!(d.isText||d.hasRequiredAttrs())&&r.indexOf(u)==-1){r.push(u);let h=o(u,a.concat(d));if(h)return h}}return null}return o(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let i=this.computeWrapping(t);return this.wrapCache.push(t,i),i}computeWrapping(t){let i=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(t)){let s=[];for(let a=r;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in i)&&(!r.type||l.validEnd)&&(n.push({match:a.contentMatch,type:a,via:r}),i[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function i(n){t.push(n);for(let r=0;r<n.next.length;r++)t.indexOf(n.next[r].next)==-1&&i(n.next[r].next)}return i(this),t.map((n,r)=>{let o=r+(n.validEnd?"*":" ")+" ";for(let s=0;s<n.next.length;s++)o+=(s?", ":"")+n.next[s].type.name+"->"+t.indexOf(n.next[s].next);return o}).join(`
`)}};Gs.empty=new Gs(!0);var MC=class{constructor(t,i){this.string=t,this.nodeTypes=i,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}};function b5(e){let t=[];do t.push(dN(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function dN(e){let t=[];do t.push(uN(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function uN(e){let t=fN(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=hN(e,t);else break;return t}function r5(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function hN(e,t){let i=r5(e),n=i;return e.eat(",")&&(e.next!="}"?n=r5(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:i,max:n,expr:t}}function pN(e,t){let i=e.nodeTypes,n=i[t];if(n)return[n];let r=[];for(let o in i){let s=i[o];s.isInGroup(t)&&r.push(s)}return r.length==0&&e.err("No node type or group '"+t+"' found"),r}function fN(e){if(e.eat("(")){let t=b5(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=pN(e,e.next).map(i=>(e.inline==null?e.inline=i.isInline:e.inline!=i.isInline&&e.err("Mixing inline and block content"),{type:"name",value:i}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function gN(e){let t=[[]];return r(o(e,0),i()),t;function i(){return t.push([])-1}function n(s,a,l){let c={term:l,to:a};return t[s].push(c),c}function r(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;r(c,a=i())}else if(s.type=="star"){let l=i();return n(a,l),r(o(s.expr,l),l),[n(l)]}else if(s.type=="plus"){let l=i();return r(o(s.expr,a),l),r(o(s.expr,l),l),[n(l)]}else{if(s.type=="opt")return[n(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let d=i();r(o(s.expr,l),d),l=d}if(s.max==-1)r(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let d=i();n(l,d),r(o(s.expr,l),d),l=d}return[n(l)]}else{if(s.type=="name")return[n(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function y5(e,t){return t-e}function o5(e,t){let i=[];return n(t),i.sort(y5);function n(r){let o=e[r];if(o.length==1&&!o[0].term)return n(o[0].to);i.push(r);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&i.indexOf(l)==-1&&n(l)}}}function mN(e){let t=Object.create(null);return i(o5(e,0));function i(n){let r=[];n.forEach(s=>{e[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let d=0;d<r.length;d++)r[d][0]==a&&(c=r[d][1]);o5(e,l).forEach(d=>{c||r.push([a,c=[]]),c.indexOf(d)==-1&&c.push(d)})})});let o=t[n.join(",")]=new Gs(n.indexOf(e.length-1)>-1);for(let s=0;s<r.length;s++){let a=r[s][1].sort(y5);o.next.push({type:r[s][0],next:t[a.join(",")]||i(a)})}return o}}function vN(e,t){for(let i=0,n=[e];i<n.length;i++){let r=n[i],o=!r.validEnd,s=[];for(let a=0;a<r.next.length;a++){let{type:l,next:c}=r.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),n.indexOf(c)==-1&&n.push(c)}o&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function S5(e){let t=Object.create(null);for(let i in e){let n=e[i];if(!n.hasDefault)return null;t[i]=n.default}return t}function x5(e,t){let i=Object.create(null);for(let n in e){let r=t&&t[n];if(r===void 0){let o=e[n];if(o.hasDefault)r=o.default;else throw new RangeError("No value supplied for attribute "+n)}i[n]=r}return i}function E5(e,t,i,n){for(let r in t)if(!(r in e))throw new RangeError(`Unsupported attribute ${r} for ${i} of type ${r}`);for(let r in e){let o=e[r];o.validate&&o.validate(t[r])}}function R5(e,t){let i=Object.create(null);if(t)for(let n in t)i[n]=new TC(e,n,t[n]);return i}var qp=class e{constructor(t,i,n){this.name=t,this.schema=i,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=R5(t,n.attrs),this.defaultAttrs=S5(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Gs.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:x5(this.attrs,t)}create(t=null,i,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Hi(this,this.computeAttrs(t),ie.from(i),lt.setFrom(n))}createChecked(t=null,i,n){return i=ie.from(i),this.checkContent(i),new Hi(this,this.computeAttrs(t),i,lt.setFrom(n))}createAndFill(t=null,i,n){if(t=this.computeAttrs(t),i=ie.from(i),i.size){let s=this.contentMatch.fillBefore(i);if(!s)return null;i=s.append(i)}let r=this.contentMatch.matchFragment(i),o=r&&r.fillBefore(ie.empty,!0);return o?new Hi(this,t,i.append(o),lt.setFrom(n)):null}validContent(t){let i=this.contentMatch.matchFragment(t);if(!i||!i.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){E5(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let i=0;i<t.length;i++)if(!this.allowsMarkType(t[i].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let i;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?i&&i.push(t[n]):i||(i=t.slice(0,n));return i?i.length?i:lt.none:t}static compile(t,i){let n=Object.create(null);t.forEach((o,s)=>n[o]=new e(o,i,s));let r=i.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function CN(e,t,i){let n=i.split("|");return r=>{let o=r===null?"null":typeof r;if(n.indexOf(o)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${o}`)}}var TC=class{constructor(t,i,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?CN(t,i,n.validate):n.validate}get isRequired(){return!this.hasDefault}},Hd=class e{constructor(t,i,n,r){this.name=t,this.rank=i,this.schema=n,this.spec=r,this.attrs=R5(t,r.attrs),this.excluded=null;let o=S5(this.attrs);this.instance=o?new lt(this,o):null}create(t=null){return!t&&this.instance?this.instance:new lt(this,x5(this.attrs,t))}static compile(t,i){let n=Object.create(null),r=0;return t.forEach((o,s)=>n[o]=new e(o,r++,i,s)),n}removeFromSet(t){for(var i=0;i<t.length;i++)t[i].type==this&&(t=t.slice(0,i).concat(t.slice(i+1)),i--);return t}isInSet(t){for(let i=0;i<t.length;i++)if(t[i].type==this)return t[i]}checkAttrs(t){E5(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}},hl=class{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let i=this.spec={};for(let r in t)i[r]=t[r];i.nodes=RC.from(t.nodes),i.marks=RC.from(t.marks||{}),this.nodes=qp.compile(this.spec.nodes,this),this.marks=Hd.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let o=this.nodes[r],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=n[s]||(n[s]=Gs.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?s5(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let r in this.marks){let o=this.marks[r],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:s5(this,s.split(" "))}this.nodeFromJSON=r=>Hi.fromJSON(this,r),this.markFromJSON=r=>lt.fromJSON(this,r),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,i=null,n,r){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof qp){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(i,n,r)}text(t,i){let n=this.nodes.text;return new FC(n,n.defaultAttrs,t,lt.setFrom(i))}mark(t,i){return typeof t=="string"&&(t=this.marks[t]),t.create(i)}nodeType(t){let i=this.nodes[t];if(!i)throw new RangeError("Unknown node type: "+t);return i}};function s5(e,t){let i=[];for(let n=0;n<t.length;n++){let r=t[n],o=e.marks[r],s=o;if(o)i.push(o);else for(let a in e.marks){let l=e.marks[a];(r=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(r)>-1)&&i.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return i}function wN(e){return e.tag!=null}function bN(e){return e.style!=null}var dr=class e{constructor(t,i){this.schema=t,this.rules=i,this.tags=[],this.styles=[];let n=this.matchedStyles=[];i.forEach(r=>{if(wN(r))this.tags.push(r);else if(bN(r)){let o=/[^=]*/.exec(r.style)[0];n.indexOf(o)<0&&n.push(o),this.styles.push(r)}}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let o=t.nodes[r.node];return o.contentMatch.matchType(o)})}parse(t,i={}){let n=new $p(this,i,!1);return n.addAll(t,lt.none,i.from,i.to),n.finish()}parseSlice(t,i={}){let n=new $p(this,i,!0);return n.addAll(t,lt.none,i.from,i.to),we.maxOpen(n.finish())}matchTag(t,i,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let o=this.tags[r];if(xN(t,o.tag)&&(o.namespace===void 0||t.namespaceURI==o.namespace)&&(!o.context||i.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(t);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(t,i,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(t)!=0||s.context&&!n.matchesContext(s.context)||a.length>t.length&&(a.charCodeAt(t.length)!=61||a.slice(t.length+1)!=i))){if(s.getAttrs){let l=s.getAttrs(i);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(t){let i=[];function n(r){let o=r.priority==null?50:r.priority,s=0;for(;s<i.length;s++){let a=i[s];if((a.priority==null?50:a.priority)<o)break}i.splice(s,0,r)}for(let r in t.marks){let o=t.marks[r].spec.parseDOM;o&&o.forEach(s=>{n(s=l5(s)),s.mark||s.ignore||s.clearMark||(s.mark=r)})}for(let r in t.nodes){let o=t.nodes[r].spec.parseDOM;o&&o.forEach(s=>{n(s=l5(s)),s.node||s.ignore||s.mark||(s.node=r)})}return i}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}},P5={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},yN={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},k5={ol:!0,ul:!0},zd=1,IC=2,Bd=4;function a5(e,t,i){return t!=null?(t?zd:0)|(t==="full"?IC:0):e&&e.whitespace=="pre"?zd|IC:i&~Bd}var ul=class{constructor(t,i,n,r,o,s){this.type=t,this.attrs=i,this.marks=n,this.solid=r,this.options=s,this.content=[],this.activeMarks=lt.none,this.match=o||(s&Bd?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let i=this.type.contentMatch.fillBefore(ie.from(t));if(i)this.match=this.type.contentMatch.matchFragment(i);else{let n=this.type.contentMatch,r;return(r=n.findWrapping(t.type))?(this.match=n,r):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&zd)){let n=this.content[this.content.length-1],r;if(n&&n.isText&&(r=/[ \t\r\n\u000c]+$/.exec(n.text))){let o=n;n.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-r[0].length))}}let i=ie.from(this.content);return!t&&this.match&&(i=i.append(this.match.fillBefore(ie.empty,!0))),this.type?this.type.create(this.attrs,i,this.marks):i}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!P5.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}},$p=class{constructor(t,i,n){this.parser=t,this.options=i,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r=i.topNode,o,s=a5(null,i.preserveWhitespace,0)|(n?Bd:0);r?o=new ul(r.type,r.attrs,lt.none,!0,i.topMatch||r.type.contentMatch,s):n?o=new ul(null,null,lt.none,!0,null,s):o=new ul(t.schema.topNodeType,null,lt.none,!0,null,s),this.nodes=[o],this.find=i.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,i){t.nodeType==3?this.addTextNode(t,i):t.nodeType==1&&this.addElement(t,i)}addTextNode(t,i){let n=t.nodeValue,r=this.top,o=r.options&IC?"full":this.localPreserveWS||(r.options&zd)>0,{schema:s}=this.parser;if(o==="full"||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(o)if(o==="full")n=n.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let a=n.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),i,!0),a[l]&&this.insertNode(s.text(a[l]),i,!/\S/.test(a[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let a=r.content[r.content.length-1],l=t.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),i,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,i,n){let r=this.localPreserveWS,o=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let s=t.nodeName.toLowerCase(),a;k5.hasOwnProperty(s)&&this.parser.normalizeLists&&SN(t);let l=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(a=this.parser.matchTag(t,this,n));e:if(l?l.ignore:yN.hasOwnProperty(s))this.findInside(t),this.ignoreFallback(t,i);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(t=l.skip);let c,d=this.needsBlock;if(P5.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,i);break e}let u=l&&l.skip?i:this.readStyles(t,i);u&&this.addAll(t,u),c&&this.sync(o),this.needsBlock=d}else{let c=this.readStyles(t,i);c&&this.addElementByRule(t,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=r}leafFallback(t,i){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),i)}ignoreFallback(t,i){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),i,!0)}readStyles(t,i){let n=t.style;if(n&&n.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let o=this.parser.matchedStyles[r],s=n.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?i=i.filter(c=>!l.clearMark(c)):i=i.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return i}addElementByRule(t,i,n,r){let o,s;if(i.node)if(s=this.parser.schema.nodes[i.node],s.isLeaf)this.insertNode(s.create(i.attrs),n,t.nodeName=="BR")||this.leafFallback(t,n);else{let l=this.enter(s,i.attrs||null,n,i.preserveWhitespace);l&&(o=!0,n=l)}else{let l=this.parser.schema.marks[i.mark];n=n.concat(l.create(i.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(t);else if(r)this.addElement(t,n,r);else if(i.getContent)this.findInside(t),i.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=t;typeof i.contentElement=="string"?l=t.querySelector(i.contentElement):typeof i.contentElement=="function"?l=i.contentElement(t):i.contentElement&&(l=i.contentElement),this.findAround(t,l,!0),this.addAll(l,n),this.findAround(t,l,!1)}o&&this.sync(a)&&this.open--}addAll(t,i,n,r){let o=n||0;for(let s=n?t.childNodes[n]:t.firstChild,a=r==null?null:t.childNodes[r];s!=a;s=s.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(s,i);this.findAtPoint(t,o)}findPlace(t,i,n){let r,o;for(let s=this.open,a=0;s>=0;s--){let l=this.nodes[s],c=l.findWrapping(t);if(c&&(!r||r.length>c.length+a)&&(r=c,o=l,!c.length))break;if(l.solid){if(n)break;a+=2}}if(!r)return null;this.sync(o);for(let s=0;s<r.length;s++)i=this.enterInner(r[s],null,i,!1);return i}insertNode(t,i,n){if(t.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(i=this.enterInner(o,null,i))}let r=this.findPlace(t,i,n);if(r){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(t.type));let s=lt.none;for(let a of r.concat(t.marks))(o.type?o.type.allowsMarkType(a.type):c5(a.type,t.type))&&(s=a.addToSet(s));return o.content.push(t.mark(s)),!0}return!1}enter(t,i,n,r){let o=this.findPlace(t.create(i),n,!1);return o&&(o=this.enterInner(t,i,n,!0,r)),o}enterInner(t,i,n,r=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(t);let a=a5(t,o,s.options);s.options&Bd&&s.content.length==0&&(a|=Bd);let l=lt.none;return n=n.filter(c=>(s.type?s.type.allowsMarkType(c.type):c5(c.type,t))?(l=c.addToSet(l),!1):!0),this.nodes.push(new ul(t,i,l,r,null,a)),this.open++,n}closeExtra(t=!1){let i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let i=this.open;i>=0;i--){if(this.nodes[i]==t)return this.open=i,!0;this.localPreserveWS&&(this.nodes[i].options|=zd)}return!1}get currentPos(){this.closeExtra();let t=0;for(let i=this.open;i>=0;i--){let n=this.nodes[i].content;for(let r=n.length-1;r>=0;r--)t+=n[r].nodeSize;i&&t++}return t}findAtPoint(t,i){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==i&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)}findAround(t,i,n){if(t!=i&&this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&t.nodeType==1&&t.contains(this.find[r].node)&&i.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==t&&(this.find[i].pos=this.currentPos-(t.nodeValue.length-this.find[i].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let i=t.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+(r?0:1),s=(a,l)=>{for(;a>=0;a--){let c=i[a];if(c==""){if(a==i.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let d=l>0||l==0&&r?this.nodes[l].type:n&&l>=o?n.node(l-o).type:null;if(!d||d.name!=c&&!d.isInGroup(c))return!1;l--}}return!0};return s(i.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let i=t.depth;i>=0;i--){let n=t.node(i).contentMatchAt(t.indexAfter(i)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let i in this.parser.schema.nodes){let n=this.parser.schema.nodes[i];if(n.isTextblock&&n.defaultAttrs)return n}}};function SN(e){for(let t=e.firstChild,i=null;t;t=t.nextSibling){let n=t.nodeType==1?t.nodeName.toLowerCase():null;n&&k5.hasOwnProperty(n)&&i?(i.appendChild(t),t=i):n=="li"?i=t:n&&(i=null)}}function xN(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function l5(e){let t={};for(let i in e)t[i]=e[i];return t}function c5(e,t){let i=t.schema.nodes;for(let n in i){let r=i[n];if(!r.allowsMarkType(e))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:d}=a.edge(l);if(c==t||o.indexOf(d)<0&&s(d))return!0}};if(s(r.contentMatch))return!0}}var qr=class e{constructor(t,i){this.nodes=t,this.marks=i}serializeFragment(t,i={},n){n||(n=kC(i).createDocumentFragment());let r=n,o=[];return t.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)r=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],d=this.serializeMark(c,s.isInline,i);d&&(o.push([c,r]),r.appendChild(d.dom),r=d.contentDOM||d.dom)}}r.appendChild(this.serializeNodeInner(s,i))}),n}serializeNodeInner(t,i){let{dom:n,contentDOM:r}=Gp(kC(i),this.nodes[t.type.name](t),null,t.attrs);if(r){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,i,r)}return n}serializeNode(t,i={}){let n=this.serializeNodeInner(t,i);for(let r=t.marks.length-1;r>=0;r--){let o=this.serializeMark(t.marks[r],t.isInline,i);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(t,i,n={}){let r=this.marks[t.type.name];return r&&Gp(kC(n),r(t,i),null,t.attrs)}static renderSpec(t,i,n=null,r){return Gp(t,i,n,r)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new e(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let i=d5(t.nodes);return i.text||(i.text=n=>n.text),i}static marksFromSchema(t){return d5(t.marks)}};function d5(e){let t={};for(let i in e){let n=e[i].spec.toDOM;n&&(t[i]=n)}return t}function kC(e){return e.document||window.document}var u5=new WeakMap;function EN(e){let t=u5.get(e);return t===void 0&&u5.set(e,t=RN(e)),t}function RN(e){let t=null;function i(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")t||(t=[]),t.push(n);else for(let r=0;r<n.length;r++)i(n[r]);else for(let r in n)i(n[r])}return i(e),t}function Gp(e,t,i,n){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let r=t[0],o;if(typeof r!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(o=EN(n))&&o.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=r.indexOf(" ");s>0&&(i=r.slice(0,s),r=r.slice(s+1));let a,l=i?e.createElementNS(i,r):e.createElement(r),c=t[1],d=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){d=2;for(let u in c)if(c[u]!=null){let h=u.indexOf(" ");h>0?l.setAttributeNS(u.slice(0,h),u.slice(h+1),c[u]):u=="style"&&l.style?l.style.cssText=c[u]:l.setAttribute(u,c[u])}}for(let u=d;u<t.length;u++){let h=t[u];if(h===0){if(u<t.length-1||u>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:f}=Gp(e,h,i,n);if(l.appendChild(p),f){if(a)throw new RangeError("Multiple content holes");a=f}}}return{dom:l,contentDOM:a}}var F5=65535,M5=Math.pow(2,16);function PN(e,t){return e+t*M5}function _5(e){return e&F5}function kN(e){return(e-(e&F5))/M5}var T5=1,I5=2,Kp=4,A5=8,Wd=class{constructor(t,i,n){this.pos=t,this.delInfo=i,this.recover=n}get deleted(){return(this.delInfo&A5)>0}get deletedBefore(){return(this.delInfo&(T5|Kp))>0}get deletedAfter(){return(this.delInfo&(I5|Kp))>0}get deletedAcross(){return(this.delInfo&Kp)>0}},$r=class e{constructor(t,i=!1){if(this.ranges=t,this.inverted=i,!t.length&&e.empty)return e.empty}recover(t){let i=0,n=_5(t);if(!this.inverted)for(let r=0;r<n;r++)i+=this.ranges[r*3+2]-this.ranges[r*3+1];return this.ranges[n*3]+i+kN(t)}mapResult(t,i=1){return this._map(t,i,!1)}map(t,i=1){return this._map(t,i,!0)}_map(t,i,n){let r=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>t)break;let c=this.ranges[a+o],d=this.ranges[a+s],u=l+c;if(t<=u){let h=c?t==l?-1:t==u?1:i:i,p=l+r+(h<0?0:d);if(n)return p;let f=t==(i<0?l:u)?null:PN(a/3,t-l),g=t==l?I5:t==u?T5:Kp;return(i<0?t!=l:t!=u)&&(g|=A5),new Wd(p,g,f)}r+=d-c}return n?t+r:new Wd(t+r,0,null)}touches(t,i){let n=0,r=_5(i),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?n:0);if(l>t)break;let c=this.ranges[a+o],d=l+c;if(t<=d&&a==r*3)return!0;n+=this.ranges[a+s]-c}return!1}forEach(t){let i=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let s=this.ranges[r],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[r+i],d=this.ranges[r+n];t(a,a+c,l,l+d),o+=d-c}}invert(){return new e(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?e.empty:new e(t<0?[0,-t,0]:[0,0,t])}};$r.empty=new $r([]);var Ud=class e{constructor(t,i,n=0,r=t?t.length:0){this.mirror=i,this.from=n,this.to=r,this._maps=t||[],this.ownData=!(t||i)}get maps(){return this._maps}slice(t=0,i=this.maps.length){return new e(this._maps,this.mirror,t,i)}appendMap(t,i){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),i!=null&&this.setMirror(this._maps.length-1,i)}appendMapping(t){for(let i=0,n=this._maps.length;i<t._maps.length;i++){let r=t.getMirror(i);this.appendMap(t._maps[i],r!=null&&r<i?n+r:void 0)}}getMirror(t){if(this.mirror){for(let i=0;i<this.mirror.length;i++)if(this.mirror[i]==t)return this.mirror[i+(i%2?-1:1)]}}setMirror(t,i){this.mirror||(this.mirror=[]),this.mirror.push(t,i)}appendMappingInverted(t){for(let i=t.maps.length-1,n=this._maps.length+t._maps.length;i>=0;i--){let r=t.getMirror(i);this.appendMap(t._maps[i].invert(),r!=null&&r>i?n-r-1:void 0)}}invert(){let t=new e;return t.appendMappingInverted(this),t}map(t,i=1){if(this.mirror)return this._map(t,i,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,i);return t}mapResult(t,i=1){return this._map(t,i,!1)}_map(t,i,n){let r=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(t,i);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,t=this._maps[l].recover(a.recover);continue}}r|=a.delInfo,t=a.pos}return n?t:new Wd(t,r,null)}},AC=Object.create(null),jt=class{getMap(){return $r.empty}merge(t){return null}static fromJSON(t,i){if(!i||!i.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=AC[i.stepType];if(!n)throw new RangeError(`No step type ${i.stepType} defined`);return n.fromJSON(t,i)}static jsonID(t,i){if(t in AC)throw new RangeError("Duplicate use of step JSON ID "+t);return AC[t]=i,i.prototype.jsonID=t,i}},Zt=class e{constructor(t,i){this.doc=t,this.failed=i}static ok(t){return new e(t,null)}static fail(t){return new e(null,t)}static fromReplace(t,i,n,r){try{return e.ok(t.replace(i,n,r))}catch(o){if(o instanceof zs)return e.fail(o.message);throw o}}};function HC(e,t,i){let n=[];for(let r=0;r<e.childCount;r++){let o=e.child(r);o.content.size&&(o=o.copy(HC(o.content,t,o))),o.isInline&&(o=t(o,i,r)),n.push(o)}return ie.fromArray(n)}var jd=class e extends jt{constructor(t,i,n){super(),this.from=t,this.to=i,this.mark=n}apply(t){let i=t.slice(this.from,this.to),n=t.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new we(HC(i.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),r),i.openStart,i.openEnd);return Zt.fromReplace(t,this.from,this.to,o)}invert(){return new Kr(this.from,this.to,this.mark)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new e(i.pos,n.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(i.from,i.to,t.markFromJSON(i.mark))}};jt.jsonID("addMark",jd);var Kr=class e extends jt{constructor(t,i,n){super(),this.from=t,this.to=i,this.mark=n}apply(t){let i=t.slice(this.from,this.to),n=new we(HC(i.content,r=>r.mark(this.mark.removeFromSet(r.marks)),t),i.openStart,i.openEnd);return Zt.fromReplace(t,this.from,this.to,n)}invert(){return new jd(this.from,this.to,this.mark)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deleted&&n.deleted||i.pos>=n.pos?null:new e(i.pos,n.pos,this.mark)}merge(t){return t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(i.from,i.to,t.markFromJSON(i.mark))}};jt.jsonID("removeMark",Kr);var qd=class e extends jt{constructor(t,i){super(),this.pos=t,this.mark=i}apply(t){let i=t.nodeAt(this.pos);if(!i)return Zt.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.addToSet(i.marks));return Zt.fromReplace(t,this.pos,this.pos+1,new we(ie.from(n),0,i.isLeaf?0:1))}invert(t){let i=t.nodeAt(this.pos);if(i){let n=this.mark.addToSet(i.marks);if(n.length==i.marks.length){for(let r=0;r<i.marks.length;r++)if(!i.marks[r].isInSet(n))return new e(this.pos,i.marks[r]);return new e(this.pos,this.mark)}}return new pl(this.pos,this.mark)}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new e(i.pos,t.markFromJSON(i.mark))}};jt.jsonID("addNodeMark",qd);var pl=class e extends jt{constructor(t,i){super(),this.pos=t,this.mark=i}apply(t){let i=t.nodeAt(this.pos);if(!i)return Zt.fail("No node at mark step's position");let n=i.type.create(i.attrs,null,this.mark.removeFromSet(i.marks));return Zt.fromReplace(t,this.pos,this.pos+1,new we(ie.from(n),0,i.isLeaf?0:1))}invert(t){let i=t.nodeAt(this.pos);return!i||!this.mark.isInSet(i.marks)?this:new qd(this.pos,this.mark)}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new e(i.pos,t.markFromJSON(i.mark))}};jt.jsonID("removeNodeMark",pl);var mi=class e extends jt{constructor(t,i,n,r=!1){super(),this.from=t,this.to=i,this.slice=n,this.structure=r}apply(t){return this.structure&&NC(t,this.from,this.to)?Zt.fail("Structure replace would overwrite content"):Zt.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new $r([this.from,this.to-this.from,this.slice.size])}invert(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return i.deletedAcross&&n.deletedAcross?null:new e(i.pos,Math.max(i.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let i=this.slice.size+t.slice.size==0?we.empty:new we(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),i,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let i=this.slice.size+t.slice.size==0?we.empty:new we(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,i,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(i.from,i.to,we.fromJSON(t,i.slice),!!i.structure)}};jt.jsonID("replace",mi);var Nt=class e extends jt{constructor(t,i,n,r,o,s,a=!1){super(),this.from=t,this.to=i,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=s,this.structure=a}apply(t){if(this.structure&&(NC(t,this.from,this.gapFrom)||NC(t,this.gapTo,this.to)))return Zt.fail("Structure gap-replace would overwrite content");let i=t.slice(this.gapFrom,this.gapTo);if(i.openStart||i.openEnd)return Zt.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,i.content);return n?Zt.fromReplace(t,this.from,this.to,n):Zt.fail("Content does not fit in gap")}getMap(){return new $r([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let i=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+i,this.from+this.insert,this.from+this.insert+i,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let i=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),r=this.from==this.gapFrom?i.pos:t.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return i.deletedAcross&&n.deletedAcross||r<i.pos||o>n.pos?null:new e(i.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,i){if(typeof i.from!="number"||typeof i.to!="number"||typeof i.gapFrom!="number"||typeof i.gapTo!="number"||typeof i.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(i.from,i.to,i.gapFrom,i.gapTo,we.fromJSON(t,i.slice),i.insert,!!i.structure)}};jt.jsonID("replaceAround",Nt);function NC(e,t,i){let n=e.resolve(t),r=i-t,o=n.depth;for(;r>0&&o>0&&n.indexAfter(o)==n.node(o).childCount;)o--,r--;if(r>0){let s=n.node(o).maybeChild(n.indexAfter(o));for(;r>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,r--}}return!1}function _N(e,t,i,n){let r=[],o=[],s,a;e.doc.nodesBetween(t,i,(l,c,d)=>{if(!l.isInline)return;let u=l.marks;if(!n.isInSet(u)&&d.type.allowsMarkType(n.type)){let h=Math.max(c,t),p=Math.min(c+l.nodeSize,i),f=n.addToSet(u);for(let g=0;g<u.length;g++)u[g].isInSet(f)||(s&&s.to==h&&s.mark.eq(u[g])?s.to=p:r.push(s=new Kr(h,p,u[g])));a&&a.to==h?a.to=p:o.push(a=new jd(h,p,n))}}),r.forEach(l=>e.step(l)),o.forEach(l=>e.step(l))}function DN(e,t,i,n){let r=[],o=0;e.doc.nodesBetween(t,i,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(n instanceof Hd){let c=s.marks,d;for(;d=n.isInSet(c);)(l||(l=[])).push(d),c=d.removeFromSet(c)}else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,i);for(let d=0;d<l.length;d++){let u=l[d],h;for(let p=0;p<r.length;p++){let f=r[p];f.step==o-1&&u.eq(r[p].style)&&(h=f)}h?(h.to=c,h.step=o):r.push({style:u,from:Math.max(a,t),to:c,step:o})}}}),r.forEach(s=>e.step(new Kr(s.from,s.to,s.style)))}function zC(e,t,i,n=i.contentMatch,r=!0){let o=e.doc.nodeAt(t),s=[],a=t+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),d=a+c.nodeSize,u=n.matchType(c.type);if(!u)s.push(new mi(a,d,we.empty));else{n=u;for(let h=0;h<c.marks.length;h++)i.allowsMarkType(c.marks[h].type)||e.step(new Kr(a,d,c.marks[h]));if(r&&c.isText&&i.whitespace!="pre"){let h,p=/\r?\n|\r/g,f;for(;h=p.exec(c.text);)f||(f=new we(ie.from(i.schema.text(" ",i.allowedMarks(c.marks))),0,0)),s.push(new mi(a+h.index,a+h.index+h[0].length,f))}}a=d}if(!n.validEnd){let l=n.fillBefore(ie.empty,!0);e.replace(a,a,new we(l,0,0))}for(let l=s.length-1;l>=0;l--)e.step(s[l])}function FN(e,t,i){return(t==0||e.canReplace(t,e.childCount))&&(i==e.childCount||e.canReplace(0,i))}function Yr(e){let i=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,r=0,o=0;;--n){let s=e.$from.node(n),a=e.$from.index(n)+r,l=e.$to.indexAfter(n)-o;if(n<e.depth&&s.canReplace(a,l,i))return n;if(n==0||s.type.spec.isolating||!FN(s,a,l))break;a&&(r=1),l<s.childCount&&(o=1)}return null}function MN(e,t,i){let{$from:n,$to:r,depth:o}=t,s=n.before(o+1),a=r.after(o+1),l=s,c=a,d=ie.empty,u=0;for(let f=o,g=!1;f>i;f--)g||n.index(f)>0?(g=!0,d=ie.from(n.node(f).copy(d)),u++):l--;let h=ie.empty,p=0;for(let f=o,g=!1;f>i;f--)g||r.after(f+1)<r.end(f)?(g=!0,h=ie.from(r.node(f).copy(h)),p++):c++;e.step(new Nt(l,c,s,a,new we(d.append(h),u,p),d.size-u,!0))}function ml(e,t,i=null,n=e){let r=TN(e,t),o=r&&IN(n,t);return o?r.map(D5).concat({type:t,attrs:i}).concat(o.map(D5)):null}function D5(e){return{type:e,attrs:null}}function TN(e,t){let{parent:i,startIndex:n,endIndex:r}=e,o=i.contentMatchAt(n).findWrapping(t);if(!o)return null;let s=o.length?o[0]:t;return i.canReplaceWith(n,r,s)?o:null}function IN(e,t){let{parent:i,startIndex:n,endIndex:r}=e,o=i.child(n),s=t.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:t).contentMatch;for(let c=n;l&&c<r;c++)l=l.matchType(i.child(c).type);return!l||!l.validEnd?null:s}function AN(e,t,i){let n=ie.empty;for(let s=i.length-1;s>=0;s--){if(n.size){let a=i[s].type.contentMatch.matchFragment(n);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=ie.from(i[s].type.create(i[s].attrs,n))}let r=t.start,o=t.end;e.step(new Nt(r,o,r,o,new we(n,0,0),i.length,!0))}function ON(e,t,i,n,r){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=e.steps.length;e.doc.nodesBetween(t,i,(s,a)=>{let l=typeof r=="function"?r(s):r;if(s.isTextblock&&!s.hasMarkup(n,l)&&LN(e.doc,e.mapping.slice(o).map(a),n)){let c=null;if(n.schema.linebreakReplacement){let p=n.whitespace=="pre",f=!!n.contentMatch.matchType(n.schema.linebreakReplacement);p&&!f?c=!1:!p&&f&&(c=!0)}c===!1&&L5(e,s,a,o),zC(e,e.mapping.slice(o).map(a,1),n,void 0,c===null);let d=e.mapping.slice(o),u=d.map(a,1),h=d.map(a+s.nodeSize,1);return e.step(new Nt(u,h,u+1,h-1,new we(ie.from(n.create(l,null,s.marks)),0,0),1,!0)),c===!0&&O5(e,s,a,o),!1}})}function O5(e,t,i,n){t.forEach((r,o)=>{if(r.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(r.text);){let l=e.mapping.slice(n).map(i+1+o+s.index);e.replaceWith(l,l+1,t.type.schema.linebreakReplacement.create())}}})}function L5(e,t,i,n){t.forEach((r,o)=>{if(r.type==r.type.schema.linebreakReplacement){let s=e.mapping.slice(n).map(i+1+o);e.replaceWith(s,s+1,t.type.schema.text(`
`))}})}function LN(e,t,i){let n=e.resolve(t),r=n.index();return n.parent.canReplaceWith(r,r+1,i)}function NN(e,t,i,n,r){let o=e.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");i||(i=o.type);let s=i.create(n,null,r||o.marks);if(o.isLeaf)return e.replaceWith(t,t+o.nodeSize,s);if(!i.validContent(o.content))throw new RangeError("Invalid content for node type "+i.name);e.step(new Nt(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new we(ie.from(s),0,0),1,!0))}function nn(e,t,i=1,n){let r=e.resolve(t),o=r.depth-i,s=n&&n[n.length-1]||r.parent;if(o<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!s.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let c=r.depth-1,d=i-2;c>o;c--,d--){let u=r.node(c),h=r.index(c);if(u.type.spec.isolating)return!1;let p=u.content.cutByIndex(h,u.childCount),f=n&&n[d+1];f&&(p=p.replaceChild(0,f.type.create(f.attrs)));let g=n&&n[d]||u;if(!u.canReplace(h+1,u.childCount)||!g.type.validContent(p))return!1}let a=r.indexAfter(o),l=n&&n[0];return r.node(o).canReplaceWith(a,a,l?l.type:r.node(o+1).type)}function BN(e,t,i=1,n){let r=e.doc.resolve(t),o=ie.empty,s=ie.empty;for(let a=r.depth,l=r.depth-i,c=i-1;a>l;a--,c--){o=ie.from(r.node(a).copy(o));let d=n&&n[c];s=ie.from(d?d.type.create(d.attrs,s):r.node(a).copy(s))}e.step(new mi(t,t,new we(o.append(s),i,i),!0))}function bn(e,t){let i=e.resolve(t),n=i.index();return N5(i.nodeBefore,i.nodeAfter)&&i.parent.canReplace(n,n+1)}function HN(e,t){t.content.size||e.type.compatibleContent(t.type);let i=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let r=0;r<t.childCount;r++){let o=t.child(r),s=o.type==n?e.type.schema.nodes.text:o.type;if(i=i.matchType(s),!i||!e.type.allowsMarks(o.marks))return!1}return i.validEnd}function N5(e,t){return!!(e&&t&&!e.isLeaf&&HN(e,t))}function Ws(e,t,i=-1){let n=e.resolve(t);for(let r=n.depth;;r--){let o,s,a=n.index(r);if(r==n.depth?(o=n.nodeBefore,s=n.nodeAfter):i>0?(o=n.node(r+1),a++,s=n.node(r).maybeChild(a)):(o=n.node(r).maybeChild(a-1),s=n.node(r+1)),o&&!o.isTextblock&&N5(o,s)&&n.node(r).canReplace(a,a+1))return t;if(r==0)break;t=i<0?n.before(r):n.after(r)}}function zN(e,t,i){let n=null,{linebreakReplacement:r}=e.doc.type.schema,o=e.doc.resolve(t-i),s=o.node().type;if(r&&s.inlineContent){let d=s.whitespace=="pre",u=!!s.contentMatch.matchType(r);d&&!u?n=!1:!d&&u&&(n=!0)}let a=e.steps.length;if(n===!1){let d=e.doc.resolve(t+i);L5(e,d.node(),d.before(),a)}s.inlineContent&&zC(e,t+i-1,s,o.node().contentMatchAt(o.index()),n==null);let l=e.mapping.slice(a),c=l.map(t-i);if(e.step(new mi(c,l.map(t+i,-1),we.empty,!0)),n===!0){let d=e.doc.resolve(c);O5(e,d.node(),d.before(),e.steps.length)}return e}function VN(e,t,i){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),i))return t;if(n.parentOffset==0)for(let r=n.depth-1;r>=0;r--){let o=n.index(r);if(n.node(r).canReplaceWith(o,o,i))return n.before(r+1);if(o>0)return null}if(n.parentOffset==n.parent.content.size)for(let r=n.depth-1;r>=0;r--){let o=n.indexAfter(r);if(n.node(r).canReplaceWith(o,o,i))return n.after(r+1);if(o<n.node(r).childCount)return null}return null}function Jp(e,t,i){let n=e.resolve(t);if(!i.content.size)return t;let r=i.content;for(let o=0;o<i.openStart;o++)r=r.firstChild.content;for(let o=1;o<=(i.openStart==0&&i.size?2:1);o++)for(let s=n.depth;s>=0;s--){let a=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,l=n.index(s)+(a>0?1:0),c=n.node(s),d=!1;if(o==1)d=c.canReplace(l,l,r);else{let u=c.contentMatchAt(l).findWrapping(r.firstChild.type);d=u&&c.canReplaceWith(l,l,u[0])}if(d)return a==0?n.pos:a<0?n.before(s+1):n.after(s+1)}return null}function $d(e,t,i=t,n=we.empty){if(t==i&&!n.size)return null;let r=e.resolve(t),o=e.resolve(i);return B5(r,o,n)?new mi(t,i,n):new BC(r,o,n).fit()}function B5(e,t,i){return!i.openStart&&!i.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),i.content)}var BC=class{constructor(t,i,n){this.$from=t,this.$to=i,this.unplaced=n,this.frontier=[],this.placed=ie.empty;for(let r=0;r<=t.depth;r++){let o=t.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(r))})}for(let r=t.depth;r>0;r--)this.placed=ie.from(t.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),i=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(t<0?this.$to:n.doc.resolve(t));if(!r)return null;let o=this.placed,s=n.depth,a=r.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new we(o,s,a);return t>-1?new Nt(n.pos,t,this.$to.pos,this.$to.end(),l,i):l.size||n.pos!=this.$to.pos?new mi(n.pos,r.pos,l):null}findFittable(){let t=this.unplaced.openStart;for(let i=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<t;n++){let o=i.firstChild;if(i.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){t=n;break}i=o.content}for(let i=1;i<=2;i++)for(let n=i==1?t:this.unplaced.openStart;n>=0;n--){let r,o=null;n?(o=OC(this.unplaced.content,n-1).firstChild,r=o.content):r=this.unplaced.content;let s=r.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],d,u=null;if(i==1&&(s?c.matchType(s.type)||(u=c.fillBefore(ie.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:n,frontierDepth:a,parent:o,inject:u};if(i==2&&s&&(d=c.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:a,parent:o,wrap:d};if(o&&c.matchType(o.type))break}}}openMore(){let{content:t,openStart:i,openEnd:n}=this.unplaced,r=OC(t,i);return!r.childCount||r.firstChild.isLeaf?!1:(this.unplaced=new we(t,i+1,Math.max(n,r.size+i>=t.size-n?i+1:0)),!0)}dropNode(){let{content:t,openStart:i,openEnd:n}=this.unplaced,r=OC(t,i);if(r.childCount<=1&&i>0){let o=t.size-i<=i+r.size;this.unplaced=new we(Vd(t,i-1,1),i-1,o?i-1:n)}else this.unplaced=new we(Vd(t,i,1),i,n)}placeNodes({sliceDepth:t,frontierDepth:i,parent:n,inject:r,wrap:o}){for(;this.depth>i;)this.closeFrontierNode();if(o)for(let g=0;g<o.length;g++)this.openFrontierNode(o[g]);let s=this.unplaced,a=n?n.content:s.content,l=s.openStart-t,c=0,d=[],{match:u,type:h}=this.frontier[i];if(r){for(let g=0;g<r.childCount;g++)d.push(r.child(g));u=u.matchFragment(r)}let p=a.size+t-(s.content.size-s.openEnd);for(;c<a.childCount;){let g=a.child(c),m=u.matchType(g.type);if(!m)break;c++,(c>1||l==0||g.content.size)&&(u=m,d.push(H5(g.mark(h.allowedMarks(g.marks)),c==1?l:0,c==a.childCount?p:-1)))}let f=c==a.childCount;f||(p=-1),this.placed=Gd(this.placed,i,ie.from(d)),this.frontier[i].match=u,f&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,m=a;g<p;g++){let v=m.lastChild;this.frontier.push({type:v.type,match:v.contentMatchAt(v.childCount)}),m=v.content}this.unplaced=f?t==0?we.empty:new we(Vd(s.content,t-1,1),t-1,p<0?s.openEnd:t-1):new we(Vd(s.content,t,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],i;if(!t.type.isTextblock||!LC(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(i=this.findCloseLevel(this.$to))&&i.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(t){e:for(let i=Math.min(this.depth,t.depth);i>=0;i--){let{match:n,type:r}=this.frontier[i],o=i<t.depth&&t.end(i+1)==t.pos+(t.depth-(i+1)),s=LC(t,i,r,n,o);if(s){for(let a=i-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],d=LC(t,a,c,l,!0);if(!d||d.childCount)continue e}return{depth:i,fit:s,move:o?t.doc.resolve(t.after(i+1)):t}}}}close(t){let i=this.findCloseLevel(t);if(!i)return null;for(;this.depth>i.depth;)this.closeFrontierNode();i.fit.childCount&&(this.placed=Gd(this.placed,i.depth,i.fit)),t=i.move;for(let n=i.depth+1;n<=t.depth;n++){let r=t.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,t.index(n));this.openFrontierNode(r.type,r.attrs,o)}return t}openFrontierNode(t,i=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(t),this.placed=Gd(this.placed,this.depth,ie.from(t.create(i,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let i=this.frontier.pop().match.fillBefore(ie.empty,!0);i.childCount&&(this.placed=Gd(this.placed,this.frontier.length,i))}};function Vd(e,t,i){return t==0?e.cutByIndex(i,e.childCount):e.replaceChild(0,e.firstChild.copy(Vd(e.firstChild.content,t-1,i)))}function Gd(e,t,i){return t==0?e.append(i):e.replaceChild(e.childCount-1,e.lastChild.copy(Gd(e.lastChild.content,t-1,i)))}function OC(e,t){for(let i=0;i<t;i++)e=e.firstChild.content;return e}function H5(e,t,i){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,H5(n.firstChild,t-1,n.childCount==1?i-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),i<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(ie.empty,!0)))),e.copy(n)}function LC(e,t,i,n,r){let o=e.node(t),s=r?e.indexAfter(t):e.index(t);if(s==o.childCount&&!i.compatibleContent(o.type))return null;let a=n.fillBefore(o.content,!0,s);return a&&!GN(i,o.content,s)?a:null}function GN(e,t,i){for(let n=i;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}function WN(e){return e.spec.defining||e.spec.definingForContent}function UN(e,t,i,n){if(!n.size)return e.deleteRange(t,i);let r=e.doc.resolve(t),o=e.doc.resolve(i);if(B5(r,o,n))return e.step(new mi(t,i,n));let s=V5(r,o);s[s.length-1]==0&&s.pop();let a=-(r.depth+1);s.unshift(a);for(let h=r.depth,p=r.pos-1;h>0;h--,p--){let f=r.node(h).type.spec;if(f.defining||f.definingAsContext||f.isolating)break;s.indexOf(h)>-1?a=h:r.before(h)==p&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],d=n.openStart;for(let h=n.content,p=0;;p++){let f=h.firstChild;if(c.push(f),p==n.openStart)break;h=f.content}for(let h=d-1;h>=0;h--){let p=c[h],f=WN(p.type);if(f&&!p.sameMarkup(r.node(Math.abs(a)-1)))d=h;else if(f||!p.type.isTextblock)break}for(let h=n.openStart;h>=0;h--){let p=(h+d+1)%(n.openStart+1),f=c[p];if(f)for(let g=0;g<s.length;g++){let m=s[(g+l)%s.length],v=!0;m<0&&(v=!1,m=-m);let C=r.node(m-1),b=r.index(m-1);if(C.canReplaceWith(b,b,f.type,f.marks))return e.replace(r.before(m),v?o.after(m):i,new we(z5(n.content,0,n.openStart,p),p,n.openEnd))}}let u=e.steps.length;for(let h=s.length-1;h>=0&&(e.replace(t,i,n),!(e.steps.length>u));h--){let p=s[h];p<0||(t=r.before(p),i=o.after(p))}}function z5(e,t,i,n,r){if(t<i){let o=e.firstChild;e=e.replaceChild(0,o.copy(z5(o.content,t+1,i,n,o)))}if(t>n){let o=r.contentMatchAt(0),s=o.fillBefore(e).append(e);e=s.append(o.matchFragment(s).fillBefore(ie.empty,!0))}return e}function jN(e,t,i,n){if(!n.isInline&&t==i&&e.doc.resolve(t).parent.content.size){let r=VN(e.doc,t,n.type);r!=null&&(t=i=r)}e.replaceRange(t,i,new we(ie.from(n),0,0))}function qN(e,t,i){let n=e.doc.resolve(t),r=e.doc.resolve(i),o=V5(n,r);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||n.node(a).type.contentMatch.validEnd)return e.delete(n.start(a),r.end(a));if(a>0&&(l||n.node(a-1).canReplace(n.index(a-1),r.indexAfter(a-1))))return e.delete(n.before(a),r.after(a))}for(let s=1;s<=n.depth&&s<=r.depth;s++)if(t-n.start(s)==n.depth-s&&i>n.end(s)&&r.end(s)-i!=r.depth-s&&n.start(s-1)==r.start(s-1)&&n.node(s-1).canReplace(n.index(s-1),r.index(s-1)))return e.delete(n.before(s),i);e.delete(t,i)}function V5(e,t){let i=[],n=Math.min(e.depth,t.depth);for(let r=n;r>=0;r--){let o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&i.push(r)}return i}var Yp=class e extends jt{constructor(t,i,n){super(),this.pos=t,this.attr=i,this.value=n}apply(t){let i=t.nodeAt(this.pos);if(!i)return Zt.fail("No node at attribute step's position");let n=Object.create(null);for(let o in i.attrs)n[o]=i.attrs[o];n[this.attr]=this.value;let r=i.type.create(n,null,i.marks);return Zt.fromReplace(t,this.pos,this.pos+1,new we(ie.from(r),0,i.isLeaf?0:1))}getMap(){return $r.empty}invert(t){return new e(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let i=t.mapResult(this.pos,1);return i.deletedAfter?null:new e(i.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,i){if(typeof i.pos!="number"||typeof i.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new e(i.pos,i.attr,i.value)}};jt.jsonID("attr",Yp);var Xp=class e extends jt{constructor(t,i){super(),this.attr=t,this.value=i}apply(t){let i=Object.create(null);for(let r in t.attrs)i[r]=t.attrs[r];i[this.attr]=this.value;let n=t.type.create(i,t.content,t.marks);return Zt.ok(n)}getMap(){return $r.empty}invert(t){return new e(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,i){if(typeof i.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new e(i.attr,i.value)}};jt.jsonID("docAttr",Xp);var fl=class extends Error{};fl=function e(t){let i=Error.call(this,t);return i.__proto__=e.prototype,i};fl.prototype=Object.create(Error.prototype);fl.prototype.constructor=fl;fl.prototype.name="TransformError";var gl=class{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Ud}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let i=this.maybeStep(t);if(i.failed)throw new fl(i.failed);return this}maybeStep(t){let i=t.apply(this.doc);return i.failed||this.addStep(t,i.doc),i}get docChanged(){return this.steps.length>0}addStep(t,i){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=i}replace(t,i=t,n=we.empty){let r=$d(this.doc,t,i,n);return r&&this.step(r),this}replaceWith(t,i,n){return this.replace(t,i,new we(ie.from(n),0,0))}delete(t,i){return this.replace(t,i,we.empty)}insert(t,i){return this.replaceWith(t,t,i)}replaceRange(t,i,n){return UN(this,t,i,n),this}replaceRangeWith(t,i,n){return jN(this,t,i,n),this}deleteRange(t,i){return qN(this,t,i),this}lift(t,i){return MN(this,t,i),this}join(t,i=1){return zN(this,t,i),this}wrap(t,i){return AN(this,t,i),this}setBlockType(t,i=t,n,r=null){return ON(this,t,i,n,r),this}setNodeMarkup(t,i,n=null,r){return NN(this,t,i,n,r),this}setNodeAttribute(t,i,n){return this.step(new Yp(t,i,n)),this}setDocAttribute(t,i){return this.step(new Xp(t,i)),this}addNodeMark(t,i){return this.step(new qd(t,i)),this}removeNodeMark(t,i){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(i instanceof lt)i.isInSet(n.marks)&&this.step(new pl(t,i));else{let r=n.marks,o,s=[];for(;o=i.isInSet(r);)s.push(new pl(t,o)),r=o.removeFromSet(r);for(let a=s.length-1;a>=0;a--)this.step(s[a])}return this}split(t,i=1,n){return BN(this,t,i,n),this}addMark(t,i,n){return _N(this,t,i,n),this}removeMark(t,i,n){return DN(this,t,i,n),this}clearIncompatible(t,i,n){return zC(this,t,i,n),this}};var VC=Object.create(null),Me=class{constructor(t,i,n){this.$anchor=t,this.$head=i,this.ranges=n||[new Zp(t.min(i),t.max(i))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let i=0;i<t.length;i++)if(t[i].$from.pos!=t[i].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,i=we.empty){let n=i.content.lastChild,r=null;for(let a=0;a<i.openEnd;a++)r=n,n=n.lastChild;let o=t.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],d=t.mapping.slice(o);t.replaceRange(d.map(l.pos),d.map(c.pos),a?we.empty:i),a==0&&U5(t,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(t,i){let n=t.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:s,$to:a}=r[o],l=t.mapping.slice(n),c=l.map(s.pos),d=l.map(a.pos);o?t.deleteRange(c,d):(t.replaceRangeWith(c,d,i),U5(t,n,i.isInline?-1:1))}}static findFrom(t,i,n=!1){let r=t.parent.inlineContent?new ke(t):vl(t.node(0),t.parent,t.pos,t.index(),i,n);if(r)return r;for(let o=t.depth-1;o>=0;o--){let s=i<0?vl(t.node(0),t.node(o),t.before(o+1),t.index(o),i,n):vl(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,i,n);if(s)return s}return null}static near(t,i=1){return this.findFrom(t,i)||this.findFrom(t,-i)||new Fi(t.node(0))}static atStart(t){return vl(t,t,0,0,1)||new Fi(t)}static atEnd(t){return vl(t,t,t.content.size,t.childCount,-1)||new Fi(t)}static fromJSON(t,i){if(!i||!i.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=VC[i.type];if(!n)throw new RangeError(`No selection type ${i.type} defined`);return n.fromJSON(t,i)}static jsonID(t,i){if(t in VC)throw new RangeError("Duplicate use of selection JSON ID "+t);return VC[t]=i,i.prototype.jsonID=t,i}getBookmark(){return ke.between(this.$anchor,this.$head).getBookmark()}};Me.prototype.visible=!0;var Zp=class{constructor(t,i){this.$from=t,this.$to=i}},G5=!1;function W5(e){!G5&&!e.parent.inlineContent&&(G5=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}var ke=class e extends Me{constructor(t,i=t){W5(t),W5(i),super(t,i)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,i){let n=t.resolve(i.map(this.head));if(!n.parent.inlineContent)return Me.near(n);let r=t.resolve(i.map(this.anchor));return new e(r.parent.inlineContent?r:n,n)}replace(t,i=we.empty){if(super.replace(t,i),i==we.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new ef(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,i){if(typeof i.anchor!="number"||typeof i.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(i.anchor),t.resolve(i.head))}static create(t,i,n=i){let r=t.resolve(i);return new this(r,n==i?r:t.resolve(n))}static between(t,i,n){let r=t.pos-i.pos;if((!n||r)&&(n=r>=0?1:-1),!i.parent.inlineContent){let o=Me.findFrom(i,n,!0)||Me.findFrom(i,-n,!0);if(o)i=o.$head;else return Me.near(i,n)}return t.parent.inlineContent||(r==0?t=i:(t=(Me.findFrom(t,-n,!0)||Me.findFrom(t,n,!0)).$anchor,t.pos<i.pos!=r<0&&(t=i))),new e(t,i)}};Me.jsonID("text",ke);var ef=class e{constructor(t,i){this.anchor=t,this.head=i}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(t){return ke.between(t.resolve(this.anchor),t.resolve(this.head))}},Re=class e extends Me{constructor(t){let i=t.nodeAfter,n=t.node(0).resolve(t.pos+i.nodeSize);super(t,n),this.node=i}map(t,i){let{deleted:n,pos:r}=i.mapResult(this.anchor),o=t.resolve(r);return n?Me.near(o):new e(o)}content(){return new we(ie.from(this.node),0,0)}eq(t){return t instanceof e&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new WC(this.anchor)}static fromJSON(t,i){if(typeof i.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(i.anchor))}static create(t,i){return new e(t.resolve(i))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}};Re.prototype.visible=!1;Me.jsonID("node",Re);var WC=class e{constructor(t){this.anchor=t}map(t){let{deleted:i,pos:n}=t.mapResult(this.anchor);return i?new ef(n,n):new e(n)}resolve(t){let i=t.resolve(this.anchor),n=i.nodeAfter;return n&&Re.isSelectable(n)?new Re(i):Me.near(i)}},Fi=class e extends Me{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,i=we.empty){if(i==we.empty){t.delete(0,t.doc.content.size);let n=Me.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,i)}toJSON(){return{type:"all"}}static fromJSON(t){return new e(t)}map(t){return new e(t)}eq(t){return t instanceof e}getBookmark(){return $N}};Me.jsonID("all",Fi);var $N={map(){return this},resolve(e){return new Fi(e)}};function vl(e,t,i,n,r,o=!1){if(t.inlineContent)return ke.create(e,i);for(let s=n-(r>0?0:1);r>0?s<t.childCount:s>=0;s+=r){let a=t.child(s);if(a.isAtom){if(!o&&Re.isSelectable(a))return Re.create(e,i-(r<0?a.nodeSize:0))}else{let l=vl(e,a,i+r,r<0?a.childCount:0,r,o);if(l)return l}i+=a.nodeSize*r}return null}function U5(e,t,i){let n=e.steps.length-1;if(n<t)return;let r=e.steps[n];if(!(r instanceof mi||r instanceof Nt))return;let o=e.mapping.maps[n],s;o.forEach((a,l,c,d)=>{s==null&&(s=d)}),e.setSelection(Me.near(e.doc.resolve(s),i))}var j5=1,Qp=2,q5=4,UC=class extends gl{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|j5)&~Qp,this.storedMarks=null,this}get selectionSet(){return(this.updated&j5)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=Qp,this}ensureMarks(t){return lt.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Qp)>0}addStep(t,i){super.addStep(t,i),this.updated=this.updated&~Qp,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,i=!0){let n=this.selection;return i&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||lt.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,i,n){let r=this.doc.type.schema;if(i==null)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();{if(n==null&&(n=i),!t)return this.deleteRange(i,n);let o=this.storedMarks;if(!o){let s=this.doc.resolve(i);o=n==i?s.marks():s.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(i,n,r.text(t,o)),!this.selection.empty&&this.selection.to==i+t.length&&this.setSelection(Me.near(this.selection.$to)),this}}setMeta(t,i){return this.meta[typeof t=="string"?t:t.key]=i,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=q5,this}get scrolledIntoView(){return(this.updated&q5)>0}};function $5(e,t){return!t||!e?e:e.bind(t)}var Us=class{constructor(t,i,n){this.name=t,this.init=$5(i.init,n),this.apply=$5(i.apply,n)}},KN=[new Us("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new Us("selection",{init(e,t){return e.selection||Me.atStart(t.doc)},apply(e){return e.selection}}),new Us("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,i,n){return n.selection.$cursor?e.storedMarks:null}}),new Us("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})],Kd=class{constructor(t,i){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=KN.slice(),i&&i.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Us(n.key,n.spec.state,n))})}},tf=class e{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,i=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=i){let r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let i=[t],n=this.applyInner(t),r=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=r?r[s].n:0,c=r?r[s].state:this,d=l<i.length&&a.spec.appendTransaction.call(a,l?i.slice(l):i,c,n);if(d&&n.filterTransaction(d,s)){if(d.setMeta("appendedTransaction",t),!r){r=[];for(let u=0;u<this.config.plugins.length;u++)r.push(u<s?{state:n,n:i.length}:{state:this,n:0})}i.push(d),n=n.applyInner(d),o=!0}r&&(r[s]={state:n,n:i.length})}}if(!o)return{state:n,transactions:i}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let i=new e(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];i[o.name]=o.apply(t,this[o.name],this,i)}return i}get tr(){return new UC(this)}static create(t){let i=new Kd(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new e(i);for(let r=0;r<i.fields.length;r++)n[i.fields[r].name]=i.fields[r].init(t,n);return n}reconfigure(t){let i=new Kd(this.schema,t.plugins),n=i.fields,r=new e(i);for(let o=0;o<n.length;o++){let s=n[o].name;r[s]=this.hasOwnProperty(s)?this[s]:n[o].init(t,r)}return r}toJSON(t){let i={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(i.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&typeof t=="object")for(let n in t){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=t[n],o=r.spec.state;o&&o.toJSON&&(i[n]=o.toJSON.call(r,this[r.key]))}return i}static fromJSON(t,i,n){if(!i)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let r=new Kd(t.schema,t.plugins),o=new e(r);return r.fields.forEach(s=>{if(s.name=="doc")o.doc=Hi.fromJSON(t.schema,i.doc);else if(s.name=="selection")o.selection=Me.fromJSON(o.doc,i.selection);else if(s.name=="storedMarks")i.storedMarks&&(o.storedMarks=i.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let a in n){let l=n[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(i,a)){o[s.name]=c.fromJSON.call(l,t,i[a],o);return}}o[s.name]=s.init(t,o)}}),o}};function K5(e,t,i){for(let n in e){let r=e[n];r instanceof Function?r=r.bind(t):n=="handleDOMEvents"&&(r=K5(r,t,{})),i[n]=r}return i}var Te=class{constructor(t){this.spec=t,this.props={},t.props&&K5(t.props,this,this.props),this.key=t.key?t.key.key:Y5("plugin")}getState(t){return t[this.key]}},GC=Object.create(null);function Y5(e){return e in GC?e+"$"+ ++GC[e]:(GC[e]=0,e+"$")}var Be=class{constructor(t="key"){this.key=Y5(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}};var nf=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function J5(e,t){let{$cursor:i}=e.selection;return!i||(t?!t.endOfTextblock("backward",e):i.parentOffset>0)?null:i}var qC=(e,t,i)=>{let n=J5(e,i);if(!n)return!1;let r=KC(n);if(!r){let s=n.blockRange(),a=s&&Yr(s);return a==null?!1:(t&&t(e.tr.lift(s,a).scrollIntoView()),!0)}let o=r.nodeBefore;if(sR(e,r,t,-1))return!0;if(n.parent.content.size==0&&(Cl(o,"end")||Re.isSelectable(o)))for(let s=n.depth;;s--){let a=$d(e.doc,n.before(s),n.after(s),we.empty);if(a&&a.slice.size<a.to-a.from){if(t){let l=e.tr.step(a);l.setSelection(Cl(o,"end")?Me.findFrom(l.doc.resolve(l.mapping.map(r.pos,-1)),-1):Re.create(l.doc,r.pos-o.nodeSize)),t(l.scrollIntoView())}return!0}if(s==1||n.node(s-1).childCount>1)break}return o.isAtom&&r.depth==n.depth-1?(t&&t(e.tr.delete(r.pos-o.nodeSize,r.pos).scrollIntoView()),!0):!1},Q5=(e,t,i)=>{let n=J5(e,i);if(!n)return!1;let r=KC(n);return r?eR(e,r,t):!1},Z5=(e,t,i)=>{let n=tR(e,i);if(!n)return!1;let r=JC(n);return r?eR(e,r,t):!1};function eR(e,t,i){let n=t.nodeBefore,r=n,o=t.pos-1;for(;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;let d=r.lastChild;if(!d)return!1;r=d}let s=t.nodeAfter,a=s,l=t.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let d=a.firstChild;if(!d)return!1;a=d}let c=$d(e.doc,o,l,we.empty);if(!c||c.from!=o||c instanceof mi&&c.slice.size>=l-o)return!1;if(i){let d=e.tr.step(c);d.setSelection(ke.create(d.doc,o)),i(d.scrollIntoView())}return!0}function Cl(e,t,i=!1){for(let n=e;n;n=t=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(i&&n.childCount!=1)return!1}return!1}var $C=(e,t,i)=>{let{$head:n,empty:r}=e.selection,o=n;if(!r)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("backward",e):n.parentOffset>0)return!1;o=KC(n)}let s=o&&o.nodeBefore;return!s||!Re.isSelectable(s)?!1:(t&&t(e.tr.setSelection(Re.create(e.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function KC(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function tR(e,t){let{$cursor:i}=e.selection;return!i||(t?!t.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size)?null:i}var YC=(e,t,i)=>{let n=tR(e,i);if(!n)return!1;let r=JC(n);if(!r)return!1;let o=r.nodeAfter;if(sR(e,r,t,1))return!0;if(n.parent.content.size==0&&(Cl(o,"start")||Re.isSelectable(o))){let s=$d(e.doc,n.before(),n.after(),we.empty);if(s&&s.slice.size<s.to-s.from){if(t){let a=e.tr.step(s);a.setSelection(Cl(o,"start")?Me.findFrom(a.doc.resolve(a.mapping.map(r.pos)),1):Re.create(a.doc,a.mapping.map(r.pos))),t(a.scrollIntoView())}return!0}}return o.isAtom&&r.depth==n.depth-1?(t&&t(e.tr.delete(r.pos,r.pos+o.nodeSize).scrollIntoView()),!0):!1},XC=(e,t,i)=>{let{$head:n,empty:r}=e.selection,o=n;if(!r)return!1;if(n.parent.isTextblock){if(i?!i.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;o=JC(n)}let s=o&&o.nodeAfter;return!s||!Re.isSelectable(s)?!1:(t&&t(e.tr.setSelection(Re.create(e.doc,o.pos)).scrollIntoView()),!0)};function JC(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let i=e.node(t);if(e.index(t)+1<i.childCount)return e.doc.resolve(e.after(t+1));if(i.type.spec.isolating)break}return null}var iR=(e,t)=>{let i=e.selection,n=i instanceof Re,r;if(n){if(i.node.isTextblock||!bn(e.doc,i.from))return!1;r=i.from}else if(r=Ws(e.doc,i.from,-1),r==null)return!1;if(t){let o=e.tr.join(r);n&&o.setSelection(Re.create(o.doc,r-e.doc.resolve(r).nodeBefore.nodeSize)),t(o.scrollIntoView())}return!0},nR=(e,t)=>{let i=e.selection,n;if(i instanceof Re){if(i.node.isTextblock||!bn(e.doc,i.to))return!1;n=i.to}else if(n=Ws(e.doc,i.to,1),n==null)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},rR=(e,t)=>{let{$from:i,$to:n}=e.selection,r=i.blockRange(n),o=r&&Yr(r);return o==null?!1:(t&&t(e.tr.lift(r,o).scrollIntoView()),!0)},QC=(e,t)=>{let{$head:i,$anchor:n}=e.selection;return!i.parent.type.spec.code||!i.sameParent(n)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function ZC(e){for(let t=0;t<e.edgeCount;t++){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}var e1=(e,t)=>{let{$head:i,$anchor:n}=e.selection;if(!i.parent.type.spec.code||!i.sameParent(n))return!1;let r=i.node(-1),o=i.indexAfter(-1),s=ZC(r.contentMatchAt(o));if(!s||!r.canReplaceWith(o,o,s))return!1;if(t){let a=i.after(),l=e.tr.replaceWith(a,a,s.createAndFill());l.setSelection(Me.near(l.doc.resolve(a),1)),t(l.scrollIntoView())}return!0},t1=(e,t)=>{let i=e.selection,{$from:n,$to:r}=i;if(i instanceof Fi||n.parent.inlineContent||r.parent.inlineContent)return!1;let o=ZC(r.parent.contentMatchAt(r.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){let s=(!n.parentOffset&&r.index()<r.parent.childCount?n:r).pos,a=e.tr.insert(s,o.createAndFill());a.setSelection(ke.create(a.doc,s+1)),t(a.scrollIntoView())}return!0},i1=(e,t)=>{let{$cursor:i}=e.selection;if(!i||i.parent.content.size)return!1;if(i.depth>1&&i.after()!=i.end(-1)){let o=i.before();if(nn(e.doc,o))return t&&t(e.tr.split(o).scrollIntoView()),!0}let n=i.blockRange(),r=n&&Yr(n);return r==null?!1:(t&&t(e.tr.lift(n,r).scrollIntoView()),!0)};function YN(e){return(t,i)=>{let{$from:n,$to:r}=t.selection;if(t.selection instanceof Re&&t.selection.node.isBlock)return!n.parentOffset||!nn(t.doc,n.pos)?!1:(i&&i(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let o=[],s,a,l=!1,c=!1;for(let p=n.depth;;p--)if(n.node(p).isBlock){l=n.end(p)==n.pos+(n.depth-p),c=n.start(p)==n.pos-(n.depth-p),a=ZC(n.node(p-1).contentMatchAt(n.indexAfter(p-1)));let g=e&&e(r.parent,l,n);o.unshift(g||(l&&a?{type:a}:null)),s=p;break}else{if(p==1)return!1;o.unshift(null)}let d=t.tr;(t.selection instanceof ke||t.selection instanceof Fi)&&d.deleteSelection();let u=d.mapping.map(n.pos),h=nn(d.doc,u,o.length,o);if(h||(o[0]=a?{type:a}:null,h=nn(d.doc,u,o.length,o)),!h)return!1;if(d.split(u,o.length,o),!l&&c&&n.node(s).type!=a){let p=d.mapping.map(n.before(s)),f=d.doc.resolve(p);a&&n.node(s-1).canReplaceWith(f.index(),f.index()+1,a)&&d.setNodeMarkup(d.mapping.map(n.before(s)),a)}return i&&i(d.scrollIntoView()),!0}}var XN=YN();var oR=(e,t)=>{let{$from:i,to:n}=e.selection,r,o=i.sharedDepth(n);return o==0?!1:(r=i.before(o),t&&t(e.tr.setSelection(Re.create(e.doc,r))),!0)},JN=(e,t)=>(t&&t(e.tr.setSelection(new Fi(e.doc))),!0);function QN(e,t,i){let n=t.nodeBefore,r=t.nodeAfter,o=t.index();return!n||!r||!n.type.compatibleContent(r.type)?!1:!n.content.size&&t.parent.canReplace(o-1,o)?(i&&i(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(o,o+1)||!(r.isTextblock||bn(e.doc,t.pos))?!1:(i&&i(e.tr.join(t.pos).scrollIntoView()),!0)}function sR(e,t,i,n){let r=t.nodeBefore,o=t.nodeAfter,s,a,l=r.type.spec.isolating||o.type.spec.isolating;if(!l&&QN(e,t,i))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(s=(a=r.contentMatchAt(r.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(i){let p=t.pos+o.nodeSize,f=ie.empty;for(let v=s.length-1;v>=0;v--)f=ie.from(s[v].create(null,f));f=ie.from(r.copy(f));let g=e.tr.step(new Nt(t.pos-1,p,t.pos,p,new we(f,1,0),s.length,!0)),m=g.doc.resolve(p+2*s.length);m.nodeAfter&&m.nodeAfter.type==r.type&&bn(g.doc,m.pos)&&g.join(m.pos),i(g.scrollIntoView())}return!0}let d=o.type.spec.isolating||n>0&&l?null:Me.findFrom(t,1),u=d&&d.$from.blockRange(d.$to),h=u&&Yr(u);if(h!=null&&h>=t.depth)return i&&i(e.tr.lift(u,h).scrollIntoView()),!0;if(c&&Cl(o,"start",!0)&&Cl(r,"end")){let p=r,f=[];for(;f.push(p),!p.isTextblock;)p=p.lastChild;let g=o,m=1;for(;!g.isTextblock;g=g.firstChild)m++;if(p.canReplace(p.childCount,p.childCount,g.content)){if(i){let v=ie.empty;for(let b=f.length-1;b>=0;b--)v=ie.from(f[b].copy(v));let C=e.tr.step(new Nt(t.pos-f.length,t.pos+o.nodeSize,t.pos+m,t.pos+o.nodeSize-m,new we(v,f.length,0),0,!0));i(C.scrollIntoView())}return!0}}return!1}function aR(e){return function(t,i){let n=t.selection,r=e<0?n.$from:n.$to,o=r.depth;for(;r.node(o).isInline;){if(!o)return!1;o--}return r.node(o).isTextblock?(i&&i(t.tr.setSelection(ke.create(t.doc,e<0?r.start(o):r.end(o)))),!0):!1}}var n1=aR(-1),r1=aR(1);function lR(e,t=null){return function(i,n){let{$from:r,$to:o}=i.selection,s=r.blockRange(o),a=s&&ml(s,e,t);return a?(n&&n(i.tr.wrap(s,a).scrollIntoView()),!0):!1}}function o1(e,t=null){return function(i,n){let r=!1;for(let o=0;o<i.selection.ranges.length&&!r;o++){let{$from:{pos:s},$to:{pos:a}}=i.selection.ranges[o];i.doc.nodesBetween(s,a,(l,c)=>{if(r)return!1;if(!(!l.isTextblock||l.hasMarkup(e,t)))if(l.type==e)r=!0;else{let d=i.doc.resolve(c),u=d.index();r=d.parent.canReplaceWith(u,u+1,e)}})}if(!r)return!1;if(n){let o=i.tr;for(let s=0;s<i.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=i.selection.ranges[s];o.setBlockType(a,l,e,t)}n(o.scrollIntoView())}return!0}}function s1(...e){return function(t,i,n){for(let r=0;r<e.length;r++)if(e[r](t,i,n))return!0;return!1}}var jC=s1(nf,qC,$C),X5=s1(nf,YC,XC),Vo={Enter:s1(QC,t1,i1,XN),"Mod-Enter":e1,Backspace:jC,"Mod-Backspace":jC,"Shift-Backspace":jC,Delete:X5,"Mod-Delete":X5,"Mod-a":JN},ZN={"Ctrl-h":Vo.Backspace,"Alt-Backspace":Vo["Mod-Backspace"],"Ctrl-d":Vo.Delete,"Ctrl-Alt-Backspace":Vo["Mod-Delete"],"Alt-Delete":Vo["Mod-Delete"],"Alt-d":Vo["Mod-Delete"],"Ctrl-a":n1,"Ctrl-e":r1};for(let e in Vo)ZN[e]=Vo[e];var lCe=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1;function cR(e,t=null){return function(i,n){let{$from:r,$to:o}=i.selection,s=r.blockRange(o);if(!s)return!1;let a=n?i.tr:null;return eB(a,s,e,t)?(n&&n(a.scrollIntoView()),!0):!1}}function eB(e,t,i,n=null){let r=!1,o=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(i)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let l=s.resolve(t.start-2);o=new Vs(l,l,t.depth),t.endIndex<t.parent.childCount&&(t=new Vs(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),r=!0}let a=ml(o,i,n,t);return a?(e&&tB(e,t,a,r,i),!0):!1}function tB(e,t,i,n,r){let o=ie.empty;for(let d=i.length-1;d>=0;d--)o=ie.from(i[d].type.create(i[d].attrs,o));e.step(new Nt(t.start-(n?2:0),t.end,t.start,t.end,new we(o,0,0),i.length,!0));let s=0;for(let d=0;d<i.length;d++)i[d].type==r&&(s=d+1);let a=i.length-s,l=t.start+i.length-(n?2:0),c=t.parent;for(let d=t.startIndex,u=t.endIndex,h=!0;d<u;d++,h=!1)!h&&nn(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(d).nodeSize;return e}function dR(e){return function(t,i){let{$from:n,$to:r}=t.selection,o=n.blockRange(r,s=>s.childCount>0&&s.firstChild.type==e);return o?i?n.node(o.depth-1).type==e?iB(t,i,e,o):nB(t,i,o):!0:!1}}function iB(e,t,i,n){let r=e.tr,o=n.end,s=n.$to.end(n.depth);o<s&&(r.step(new Nt(o-1,s,o,s,new we(ie.from(i.create(null,n.parent.copy())),1,0),1,!0)),n=new Vs(r.doc.resolve(n.$from.pos),r.doc.resolve(s),n.depth));let a=Yr(n);if(a==null)return!1;r.lift(n,a);let l=r.doc.resolve(r.mapping.map(o,-1)-1);return bn(r.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&r.join(l.pos),t(r.scrollIntoView()),!0}function nB(e,t,i){let n=e.tr,r=i.parent;for(let p=i.end,f=i.endIndex-1,g=i.startIndex;f>g;f--)p-=r.child(f).nodeSize,n.delete(p-1,p+1);let o=n.doc.resolve(i.start),s=o.nodeAfter;if(n.mapping.map(i.end)!=i.start+o.nodeAfter.nodeSize)return!1;let a=i.startIndex==0,l=i.endIndex==r.childCount,c=o.node(-1),d=o.index(-1);if(!c.canReplace(d+(a?0:1),d+1,s.content.append(l?ie.empty:ie.from(r))))return!1;let u=o.pos,h=u+s.nodeSize;return n.step(new Nt(u-(a?1:0),h+(l?1:0),u+1,h-1,new we((a?ie.empty:ie.from(r.copy(ie.empty))).append(l?ie.empty:ie.from(r.copy(ie.empty))),a?0:1,l?0:1),a?0:1)),t(n.scrollIntoView()),!0}function uR(e){return function(t,i){let{$from:n,$to:r}=t.selection,o=n.blockRange(r,c=>c.childCount>0&&c.firstChild.type==e);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=e)return!1;if(i){let c=l.lastChild&&l.lastChild.type==a.type,d=ie.from(c?e.create():null),u=new we(ie.from(e.create(null,ie.from(a.type.create(null,d)))),c?3:1,0),h=o.start,p=o.end;i(t.tr.step(new Nt(h-(c?3:1),p,h,p,u,1,!0)).scrollIntoView())}return!0}}var ei=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},xl=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t},h1=null,Jr=function(e,t,i){let n=h1||(h1=document.createRange());return n.setEnd(e,i??e.nodeValue.length),n.setStart(e,t||0),n},rB=function(){h1=null},Js=function(e,t,i,n){return i&&(hR(e,t,i,n,-1)||hR(e,t,i,n,1))},oB=/^(img|br|input|textarea|hr)$/i;function hR(e,t,i,n,r){for(var o;;){if(e==i&&t==n)return!0;if(t==(r<0?0:Sn(e))){let s=e.parentNode;if(!s||s.nodeType!=1||iu(e)||oB.test(e.nodeName)||e.contentEditable=="false")return!1;t=ei(e)+(r<0?0:1),e=s}else if(e.nodeType==1){let s=e.childNodes[t+(r<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)t+=r;else return!1;else e=s,t=r<0?Sn(e):0}else return!1}}function Sn(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function sB(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=Sn(e)}else if(e.parentNode&&!iu(e))t=ei(e),e=e.parentNode;else return null}}function aB(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!iu(e))t=ei(e)+1,e=e.parentNode;else return null}}function lB(e,t,i){for(let n=t==0,r=t==Sn(e);n||r;){if(e==i)return!0;let o=ei(e);if(e=e.parentNode,!e)return!1;n=n&&o==0,r=r&&o==Sn(e)}}function iu(e){let t;for(let i=e;i&&!(t=i.pmViewDesc);i=i.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var ff=function(e){return e.focusNode&&Js(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function js(e,t){let i=document.createEvent("Event");return i.initEvent("keydown",!0,!0),i.keyCode=e,i.key=i.code=t,i}function cB(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function dB(e,t,i){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,i);if(n)return{node:n.offsetNode,offset:Math.min(Sn(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,i);if(n)return{node:n.startContainer,offset:Math.min(Sn(n.startContainer),n.startOffset)}}}var ur=typeof navigator<"u"?navigator:null,pR=typeof document<"u"?document:null,$o=ur&&ur.userAgent||"",p1=/Edge\/(\d+)/.exec($o),jR=/MSIE \d/.exec($o),f1=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec($o),zi=!!(jR||f1||p1),jo=jR?document.documentMode:f1?+f1[1]:p1?+p1[1]:0,xn=!zi&&/gecko\/(\d+)/i.test($o);xn&&+(/Firefox\/(\d+)/.exec($o)||[0,0])[1];var g1=!zi&&/Chrome\/(\d+)/.exec($o),qt=!!g1,qR=g1?+g1[1]:0,Ci=!zi&&!!ur&&/Apple Computer/.test(ur.vendor),El=Ci&&(/Mobile\/\w+/.test($o)||!!ur&&ur.maxTouchPoints>2),yn=El||(ur?/Mac/.test(ur.platform):!1),$R=ur?/Win/.test(ur.platform):!1,Qr=/Android \d/.test($o),nu=!!pR&&"webkitFontSmoothing"in pR.documentElement.style,uB=nu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function hB(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Xr(e,t){return typeof e=="number"?e:e[t]}function pB(e){let t=e.getBoundingClientRect(),i=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*i,top:t.top,bottom:t.top+e.clientHeight*n}}function fR(e,t,i){let n=e.someProp("scrollThreshold")||0,r=e.someProp("scrollMargin")||5,o=e.dom.ownerDocument;for(let s=i||e.dom;s;){if(s.nodeType!=1){s=xl(s);continue}let a=s,l=a==o.body,c=l?hB(o):pB(a),d=0,u=0;if(t.top<c.top+Xr(n,"top")?u=-(c.top-t.top+Xr(r,"top")):t.bottom>c.bottom-Xr(n,"bottom")&&(u=t.bottom-t.top>c.bottom-c.top?t.top+Xr(r,"top")-c.top:t.bottom-c.bottom+Xr(r,"bottom")),t.left<c.left+Xr(n,"left")?d=-(c.left-t.left+Xr(r,"left")):t.right>c.right-Xr(n,"right")&&(d=t.right-c.right+Xr(r,"right")),d||u)if(l)o.defaultView.scrollBy(d,u);else{let p=a.scrollLeft,f=a.scrollTop;u&&(a.scrollTop+=u),d&&(a.scrollLeft+=d);let g=a.scrollLeft-p,m=a.scrollTop-f;t={left:t.left-g,top:t.top-m,right:t.right-g,bottom:t.bottom-m}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:xl(s)}}function fB(e){let t=e.dom.getBoundingClientRect(),i=Math.max(0,t.top),n,r;for(let o=(t.left+t.right)/2,s=i+1;s<Math.min(innerHeight,t.bottom);s+=5){let a=e.root.elementFromPoint(o,s);if(!a||a==e.dom||!e.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=i-20){n=a,r=l.top;break}}return{refDOM:n,refTop:r,stack:KR(e.dom)}}function KR(e){let t=[],i=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=i);n=xl(n));return t}function gB({refDOM:e,refTop:t,stack:i}){let n=e?e.getBoundingClientRect().top:0;YR(i,n==0?0:n-t)}function YR(e,t){for(let i=0;i<e.length;i++){let{dom:n,top:r,left:o}=e[i];n.scrollTop!=r+t&&(n.scrollTop=r+t),n.scrollLeft!=o&&(n.scrollLeft=o)}}var wl=null;function mB(e){if(e.setActive)return e.setActive();if(wl)return e.focus(wl);let t=KR(e);e.focus(wl==null?{get preventScroll(){return wl={preventScroll:!0},!0}}:void 0),wl||(wl=!1,YR(t,0))}function XR(e,t){let i,n=2e8,r,o=0,s=t.top,a=t.top,l,c;for(let d=e.firstChild,u=0;d;d=d.nextSibling,u++){let h;if(d.nodeType==1)h=d.getClientRects();else if(d.nodeType==3)h=Jr(d).getClientRects();else continue;for(let p=0;p<h.length;p++){let f=h[p];if(f.top<=s&&f.bottom>=a){s=Math.max(f.bottom,s),a=Math.min(f.top,a);let g=f.left>t.left?f.left-t.left:f.right<t.left?t.left-f.right:0;if(g<n){i=d,n=g,r=g&&i.nodeType==3?{left:f.right<t.left?f.right:f.left,top:t.top}:t,d.nodeType==1&&g&&(o=u+(t.left>=(f.left+f.right)/2?1:0));continue}}else f.top>t.top&&!l&&f.left<=t.left&&f.right>=t.left&&(l=d,c={left:Math.max(f.left,Math.min(f.right,t.left)),top:f.top});!i&&(t.left>=f.right&&t.top>=f.top||t.left>=f.left&&t.top>=f.bottom)&&(o=u+1)}}return!i&&l&&(i=l,r=c,n=0),i&&i.nodeType==3?vB(i,r):!i||n&&i.nodeType==1?{node:e,offset:o}:XR(i,r)}function vB(e,t){let i=e.nodeValue.length,n=document.createRange(),r;for(let o=0;o<i;o++){n.setEnd(e,o+1),n.setStart(e,o);let s=Go(n,1);if(s.top!=s.bottom&&F1(t,s)){r={node:e,offset:o+(t.left>=(s.left+s.right)/2?1:0)};break}}return n.detach(),r||{node:e,offset:0}}function F1(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function CB(e,t){let i=e.parentNode;return i&&/^li$/i.test(i.nodeName)&&t.left<e.getBoundingClientRect().left?i:e}function wB(e,t,i){let{node:n,offset:r}=XR(t,i),o=-1;if(n.nodeType==1&&!n.firstChild){let s=n.getBoundingClientRect();o=s.left!=s.right&&i.left>(s.left+s.right)/2?1:-1}return e.docView.posFromDOM(n,r,o)}function bB(e,t,i,n){let r=-1;for(let o=t,s=!1;o!=e.dom;){let a=e.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!s&&l.left>n.left||l.top>n.top?r=a.posBefore:(!s&&l.right<n.left||l.bottom<n.top)&&(r=a.posAfter),s=!0),!a.contentDOM&&r<0&&!a.node.isText))return(a.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return r>-1?r:e.docView.posFromDOM(t,i,-1)}function JR(e,t,i){let n=e.childNodes.length;if(n&&i.top<i.bottom)for(let r=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-i.top)/(i.bottom-i.top))-2)),o=r;;){let s=e.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(F1(t,c))return JR(s,t,c)}}if((o=(o+1)%n)==r)break}return e}function yB(e,t){let i=e.dom.ownerDocument,n,r=0,o=dB(i,t.left,t.top);o&&({node:n,offset:r}=o);let s=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top),a;if(!s||!e.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=e.dom.getBoundingClientRect();if(!F1(t,c)||(s=JR(e.dom,t,c),!s))return null}if(Ci)for(let c=s;n&&c;c=xl(c))c.draggable&&(n=void 0);if(s=CB(s,t),n){if(xn&&n.nodeType==1&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){let d=n.childNodes[r],u;d.nodeName=="IMG"&&(u=d.getBoundingClientRect()).right<=t.left&&u.bottom>t.top&&r++}let c;nu&&r&&n.nodeType==1&&(c=n.childNodes[r-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=t.top&&r--,n==e.dom&&r==n.childNodes.length-1&&n.lastChild.nodeType==1&&t.top>n.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:(r==0||n.nodeType!=1||n.childNodes[r-1].nodeName!="BR")&&(a=bB(e,n,r,t))}a==null&&(a=wB(e,s,t));let l=e.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function gR(e){return e.top<e.bottom||e.left<e.right}function Go(e,t){let i=e.getClientRects();if(i.length){let n=i[t<0?0:i.length-1];if(gR(n))return n}return Array.prototype.find.call(i,gR)||e.getBoundingClientRect()}var SB=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function QR(e,t,i){let{node:n,offset:r,atom:o}=e.docView.domFromPos(t,i<0?-1:1),s=nu||xn;if(n.nodeType==3)if(s&&(SB.test(n.nodeValue)||(i<0?!r:r==n.nodeValue.length))){let l=Go(Jr(n,r,r),i);if(xn&&r&&/\s/.test(n.nodeValue[r-1])&&r<n.nodeValue.length){let c=Go(Jr(n,r-1,r-1),-1);if(c.top==l.top){let d=Go(Jr(n,r,r+1),-1);if(d.top!=l.top)return Yd(d,d.left<c.left)}}return l}else{let l=r,c=r,d=i<0?1:-1;return i<0&&!r?(c++,d=-1):i>=0&&r==n.nodeValue.length?(l--,d=1):i<0?l--:c++,Yd(Go(Jr(n,l,c),d),d<0)}if(!e.state.doc.resolve(t-(o||0)).parent.inlineContent){if(o==null&&r&&(i<0||r==Sn(n))){let l=n.childNodes[r-1];if(l.nodeType==1)return a1(l.getBoundingClientRect(),!1)}if(o==null&&r<Sn(n)){let l=n.childNodes[r];if(l.nodeType==1)return a1(l.getBoundingClientRect(),!0)}return a1(n.getBoundingClientRect(),i>=0)}if(o==null&&r&&(i<0||r==Sn(n))){let l=n.childNodes[r-1],c=l.nodeType==3?Jr(l,Sn(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Yd(Go(c,1),!1)}if(o==null&&r<Sn(n)){let l=n.childNodes[r];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Jr(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return Yd(Go(c,-1),!0)}return Yd(Go(n.nodeType==3?Jr(n):n,-i),i>=0)}function Yd(e,t){if(e.width==0)return e;let i=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:i,right:i}}function a1(e,t){if(e.height==0)return e;let i=t?e.top:e.bottom;return{top:i,bottom:i,left:e.left,right:e.right}}function ZR(e,t,i){let n=e.state,r=e.root.activeElement;n!=t&&e.updateState(t),r!=e.dom&&e.focus();try{return i()}finally{n!=t&&e.updateState(n),r!=e.dom&&r&&r.focus()}}function xB(e,t,i){let n=t.selection,r=i=="up"?n.$from:n.$to;return ZR(e,t,()=>{let{node:o}=e.docView.domFromPos(r.pos,i=="up"?-1:1);for(;;){let a=e.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=QR(e,r.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Jr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let d=l[c];if(d.bottom>d.top+1&&(i=="up"?s.top-d.top>(d.bottom-s.top)*2:d.bottom-s.bottom>(s.bottom-d.top)*2))return!1}}return!0})}var EB=/[\u0590-\u08ac]/;function RB(e,t,i){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let r=n.parentOffset,o=!r,s=r==n.parent.content.size,a=e.domSelection();return a?!EB.test(n.parent.textContent)||!a.modify?i=="left"||i=="backward"?o:s:ZR(e,t,()=>{let{focusNode:l,focusOffset:c,anchorNode:d,anchorOffset:u}=e.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",i,"character");let p=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:f,focusOffset:g}=e.domSelectionRange(),m=f&&!p.contains(f.nodeType==1?f:f.parentNode)||l==f&&c==g;try{a.collapse(d,u),l&&(l!=d||c!=u)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),m}):n.pos==n.start()||n.pos==n.end()}var mR=null,vR=null,CR=!1;function PB(e,t,i){return mR==t&&vR==i?CR:(mR=t,vR=i,CR=i=="up"||i=="down"?xB(e,t,i):RB(e,t,i))}var En=0,wR=1,qs=2,hr=3,Qs=class{constructor(t,i,n,r){this.parent=t,this.children=i,this.dom=n,this.contentDOM=r,this.dirty=En,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,i,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let i=0;i<this.children.length;i++)t+=this.children[i].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let i=0,n=this.posAtStart;;i++){let r=this.children[i];if(r==t)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,i,n){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(n<0){let o,s;if(t==this.contentDOM)o=t.childNodes[i-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(t==this.contentDOM)o=t.childNodes[i];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let r;if(t==this.dom&&this.contentDOM)r=i>ei(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(i==0)for(let o=t;;o=o.parentNode){if(o==this.dom){r=!1;break}if(o.previousSibling)break}if(r==null&&i==t.childNodes.length)for(let o=t;;o=o.parentNode){if(o==this.dom){r=!0;break}if(o.nextSibling)break}}return r??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,i=!1){for(let n=!0,r=t;r;r=r.parentNode){let o=this.getDesc(r),s;if(o&&(!i||o.node))if(n&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(t.nodeType==1?t:t.parentNode):s==t))n=!1;else return o}}getDesc(t){let i=t.pmViewDesc;for(let n=i;n;n=n.parent)if(n==this)return i}posFromDOM(t,i,n){for(let r=t;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(t,i,n)}return-1}descAt(t){for(let i=0,n=0;i<this.children.length;i++){let r=this.children[i],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)for(let s=0;s<r.children.length;s++){let a=r.children[s];if(a.size){r=a;break}}return r}if(t<o)return r.descAt(t-n-r.border);n=o}}domFromPos(t,i){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,r=0;for(let o=0;n<this.children.length;n++){let s=this.children[n],a=o+s.size;if(a>t||s instanceof sf){r=t-o;break}o=a}if(r)return this.children[n].domFromPos(r-this.children[n].border,i);for(let o;n&&!(o=this.children[n-1]).size&&o instanceof rf&&o.side>=0;n--);if(i<=0){let o,s=!0;for(;o=n?this.children[n-1]:null,!(!o||o.dom.parentNode==this.contentDOM);n--,s=!1);return o&&i&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,i):{node:this.contentDOM,offset:o?ei(o.dom)+1:0}}else{let o,s=!0;for(;o=n<this.children.length?this.children[n]:null,!(!o||o.dom.parentNode==this.contentDOM);n++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,i):{node:this.contentDOM,offset:o?ei(o.dom):this.contentDOM.childNodes.length}}}parseRange(t,i,n=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:i,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let s=n,a=0;;a++){let l=this.children[a],c=s+l.size;if(r==-1&&t<=c){let d=s+l.border;if(t>=d&&i<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,i,d);t=s;for(let u=a;u>0;u--){let h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){r=ei(h.dom)+1;break}t-=h.size}r==-1&&(r=0)}if(r>-1&&(c>i||a==this.children.length-1)){i=c;for(let d=a+1;d<this.children.length;d++){let u=this.children[d];if(u.size&&u.dom.parentNode==this.contentDOM&&!u.emptyChildAt(-1)){o=ei(u.dom);break}i+=u.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:t,to:i,fromOffset:r,toOffset:o}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let i=this.children[t<0?0:this.children.length-1];return i.size==0||i.emptyChildAt(t)}domAfterPos(t){let{node:i,offset:n}=this.domFromPos(t,0);if(i.nodeType!=1||n==i.childNodes.length)throw new RangeError("No node after pos "+t);return i.childNodes[n]}setSelection(t,i,n,r=!1){let o=Math.min(t,i),s=Math.max(t,i);for(let p=0,f=0;p<this.children.length;p++){let g=this.children[p],m=f+g.size;if(o>f&&s<m)return g.setSelection(t-f-g.border,i-f-g.border,n,r);f=m}let a=this.domFromPos(t,t?-1:1),l=i==t?a:this.domFromPos(i,i?-1:1),c=n.root.getSelection(),d=n.domSelectionRange(),u=!1;if((xn||Ci)&&t==i){let{node:p,offset:f}=a;if(p.nodeType==3){if(u=!!(f&&p.nodeValue[f-1]==`
`),u&&f==p.nodeValue.length)for(let g=p,m;g;g=g.parentNode){if(m=g.nextSibling){m.nodeName=="BR"&&(a=l={node:m.parentNode,offset:ei(m)+1});break}let v=g.pmViewDesc;if(v&&v.node&&v.node.isBlock)break}}else{let g=p.childNodes[f-1];u=g&&(g.nodeName=="BR"||g.contentEditable=="false")}}if(xn&&d.focusNode&&d.focusNode!=l.node&&d.focusNode.nodeType==1){let p=d.focusNode.childNodes[d.focusOffset];p&&p.contentEditable=="false"&&(r=!0)}if(!(r||u&&Ci)&&Js(a.node,a.offset,d.anchorNode,d.anchorOffset)&&Js(l.node,l.offset,d.focusNode,d.focusOffset))return;let h=!1;if((c.extend||t==i)&&!(u&&xn)){c.collapse(a.node,a.offset);try{t!=i&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(t>i){let f=a;a=l,l=f}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,i){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],s=n+o.size;if(n==s?t<=s&&i>=n:t<s&&i>n){let a=n+o.border,l=s-o.border;if(t>=a&&i<=l){this.dirty=t==n||i==s?qs:wR,t==a&&i==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=hr:o.markDirty(t-a,i-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?qs:hr}n=s}this.dirty=qs}markParentsDirty(){let t=1;for(let i=this.parent;i;i=i.parent,t++){let n=t==1?qs:wR;i.dirty<n&&(i.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}},rf=class extends Qs{constructor(t,i,n,r){let o,s=i.type.toDOM;if(typeof s=="function"&&(s=s(n,()=>{if(!o)return r;if(o.parent)return o.parent.posBeforeChild(o)})),!i.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(t,[],s,null),this.widget=i,this.widget=i,o=this}matchesWidget(t){return this.dirty==En&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let i=this.widget.spec.stopEvent;return i?i(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}},m1=class extends Qs{constructor(t,i,n,r){super(t,[],i,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(t,i){return t!=this.textDOM?this.posAtStart+(i?this.size:0):this.posAtStart+i}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}},Rl=class e extends Qs{constructor(t,i,n,r,o){super(t,[],n,r),this.mark=i,this.spec=o}static create(t,i,n,r){let o=r.nodeViews[i.type.name],s=o&&o(i,r,n);return(!s||!s.dom)&&(s=qr.renderSpec(document,i.type.spec.toDOM(i,n),null,i.attrs)),new e(t,i,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&hr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=hr&&this.mark.eq(t)}markDirty(t,i){if(super.markDirty(t,i),this.dirty!=En){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=En}}slice(t,i,n){let r=e.create(this.parent,this.mark,!0,n),o=this.children,s=this.size;i<s&&(o=b1(o,i,s,n)),t>0&&(o=b1(o,0,t,n));for(let a=0;a<o.length;a++)o[a].parent=r;return r.children=o,r}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}},qo=class e extends Qs{constructor(t,i,n,r,o,s,a,l,c){super(t,[],o,s),this.node=i,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=a}static create(t,i,n,r,o,s){let a=o.nodeViews[i.type.name],l,c=a&&a(i,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},n,r),d=c&&c.dom,u=c&&c.contentDOM;if(i.isText){if(!d)d=document.createTextNode(i.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:u}=qr.renderSpec(document,i.type.spec.toDOM(i),null,i.attrs));!u&&!i.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),i.type.spec.draggable&&(d.draggable=!0));let h=d;return d=iP(d,n,i),c?l=new v1(t,i,n,r,d,u||null,h,c,o,s+1):i.isText?new of(t,i,n,r,d,h,o):new e(t,i,n,r,d,u||null,h,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let i=this.children.length-1;i>=0;i--){let n=this.children[i];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>ie.empty)}return t}matchesNode(t,i,n){return this.dirty==En&&t.eq(this.node)&&af(i,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,i){let n=this.node.inlineContent,r=i,o=t.composing?this.localCompositionInfo(t,i):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new w1(this,s&&s.node,t);FB(this.node,this.innerDeco,(c,d,u)=>{c.spec.marks?l.syncToMarks(c.spec.marks,n,t):c.type.side>=0&&!u&&l.syncToMarks(d==this.node.childCount?lt.none:this.node.child(d).marks,n,t),l.placeWidget(c,t,r)},(c,d,u,h)=>{l.syncToMarks(c.marks,n,t);let p;l.findNodeMatch(c,d,u,h)||a&&t.state.selection.from>r&&t.state.selection.to<r+c.nodeSize&&(p=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,d,u,p,t)||l.updateNextNode(c,d,u,t,h,r)||l.addNode(c,d,u,t,r),r+=c.nodeSize}),l.syncToMarks([],n,t),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==qs)&&(s&&this.protectLocalComposition(t,s),eP(this.contentDOM,this.children,t),El&&MB(this.dom))}localCompositionInfo(t,i){let{from:n,to:r}=t.state.selection;if(!(t.state.selection instanceof ke)||n<i||r>i+this.node.content.size)return null;let o=t.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=TB(this.node.content,s,n-i,r-i);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(t,{node:i,pos:n,text:r}){if(this.getDesc(i))return;let o=i;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new m1(this,o,i,r);t.input.compositionNodes.push(s),this.children=b1(this.children,n,n+r.length,t,s)}update(t,i,n,r){return this.dirty==hr||!t.sameMarkup(this.node)?!1:(this.updateInner(t,i,n,r),!0)}updateInner(t,i,n,r){this.updateOuterDeco(i),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=En}updateOuterDeco(t){if(af(t,this.outerDeco))return;let i=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=tP(this.dom,this.nodeDOM,C1(this.outerDeco,this.node,i),C1(t,this.node,i)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}};function bR(e,t,i,n,r){iP(n,t,e);let o=new qo(void 0,e,t,i,n,n,n,r,0);return o.contentDOM&&o.updateChildren(r,0),o}var of=class e extends qo{constructor(t,i,n,r,o,s,a){super(t,i,n,r,o,null,s,a,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,i,n,r){return this.dirty==hr||this.dirty!=En&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(i),(this.dirty!=En||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,this.dirty=En,!0)}inParent(){let t=this.parent.contentDOM;for(let i=this.nodeDOM;i;i=i.parentNode)if(i==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,i,n){return t==this.nodeDOM?this.posAtStart+Math.min(i,this.node.text.length):super.localPosFromDOM(t,i,n)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,i,n){let r=this.node.cut(t,i),o=document.createTextNode(r.text);return new e(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(t,i){super.markDirty(t,i),this.dom!=this.nodeDOM&&(t==0||i==this.nodeDOM.nodeValue.length)&&(this.dirty=hr)}get domAtom(){return!1}isText(t){return this.node.text==t}},sf=class extends Qs{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==En&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}},v1=class extends qo{constructor(t,i,n,r,o,s,a,l,c,d){super(t,i,n,r,o,s,a,c,d),this.spec=l}update(t,i,n,r){if(this.dirty==hr)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let o=this.spec.update(t,i,n);return o&&this.updateInner(t,i,n,r),o}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,i,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,i,n,r){this.spec.setSelection?this.spec.setSelection(t,i,n.root):super.setSelection(t,i,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}};function eP(e,t,i){let n=e.firstChild,r=!1;for(let o=0;o<t.length;o++){let s=t[o],a=s.dom;if(a.parentNode==e){for(;a!=n;)n=yR(n),r=!0;n=n.nextSibling}else r=!0,e.insertBefore(a,n);if(s instanceof Rl){let l=n?n.previousSibling:e.lastChild;eP(s.contentDOM,s.children,i),n=l?l.nextSibling:e.firstChild}}for(;n;)n=yR(n),r=!0;r&&i.trackWrites==e&&(i.trackWrites=null)}var Xd=function(e){e&&(this.nodeName=e)};Xd.prototype=Object.create(null);var $s=[new Xd];function C1(e,t,i){if(e.length==0)return $s;let n=i?$s[0]:new Xd,r=[n];for(let o=0;o<e.length;o++){let s=e[o].type.attrs;if(s){s.nodeName&&r.push(n=new Xd(s.nodeName));for(let a in s){let l=s[a];l!=null&&(i&&r.length==1&&r.push(n=new Xd(t.isInline?"span":"div")),a=="class"?n.class=(n.class?n.class+" ":"")+l:a=="style"?n.style=(n.style?n.style+";":"")+l:a!="nodeName"&&(n[a]=l))}}}return r}function tP(e,t,i,n){if(i==$s&&n==$s)return t;let r=t;for(let o=0;o<n.length;o++){let s=n[o],a=i[o];if(o){let l;a&&a.nodeName==s.nodeName&&r!=e&&(l=r.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(r),a=$s[0]),r=l}kB(r,a||$s[0],s)}return r}function kB(e,t,i){for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&!(n in i)&&e.removeAttribute(n);for(let n in i)n!="class"&&n!="style"&&n!="nodeName"&&i[n]!=t[n]&&e.setAttribute(n,i[n]);if(t.class!=i.class){let n=t.class?t.class.split(" ").filter(Boolean):[],r=i.class?i.class.split(" ").filter(Boolean):[];for(let o=0;o<n.length;o++)r.indexOf(n[o])==-1&&e.classList.remove(n[o]);for(let o=0;o<r.length;o++)n.indexOf(r[o])==-1&&e.classList.add(r[o]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=i.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=n.exec(t.style);)e.style.removeProperty(r[1])}i.style&&(e.style.cssText+=i.style)}}function iP(e,t,i){return tP(e,e,$s,C1(t,i,e.nodeType!=1))}function af(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].type.eq(t[i].type))return!1;return!0}function yR(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}var w1=class{constructor(t,i,n){this.lock=i,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=_B(t.node.content,t)}destroyBetween(t,i){if(t!=i){for(let n=t;n<i;n++)this.top.children[n].destroy();this.top.children.splice(t,i-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,i,n){let r=0,o=this.stack.length>>1,s=Math.min(o,t.length);for(;r<s&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&t[r].type.spec.spanning!==!1;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=En,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(t[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Rl.create(this.top,t[o],i,n);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(t,i,n,r){let o=-1,s;if(r>=this.preMatch.index&&(s=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&s.matchesNode(t,i,n))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(t,i,n)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(t,i,n,r,o){let s=this.top.children[r];return s.dirty==hr&&s.dom==s.contentDOM&&(s.dirty=qs),s.update(t,i,n,o)?(this.destroyBetween(this.index,r),this.index++,!0):!1}findIndexWithChild(t){for(;;){let i=t.parentNode;if(!i)return-1;if(i==this.top.contentDOM){let n=t.pmViewDesc;if(n){for(let r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r}return-1}t=i}}updateNextNode(t,i,n,r,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof qo){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let d=l.dom,u,h=this.isLocked(d)&&!(t.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==t.text&&l.dirty!=hr&&af(i,l.outerDeco));if(!h&&l.update(t,i,n,r))return this.destroyBetween(this.index,a),l.dom!=d&&(this.changed=!0),this.index++,!0;if(!h&&(u=this.recreateWrapper(l,t,i,n,r,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=u,u.contentDOM&&(u.dirty=qs,u.updateChildren(r,s+1),u.dirty=En),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,i,n,r,o,s){if(t.dirty||i.isAtom||!t.children.length||!t.node.content.eq(i.content)||!af(n,t.outerDeco)||!r.eq(t.innerDeco))return null;let a=qo.create(this.top,i,n,r,o,s);if(a.contentDOM){a.children=t.children,t.children=[];for(let l of a.children)l.parent=a}return t.destroy(),a}addNode(t,i,n,r,o){let s=qo.create(this.top,t,i,n,r,o);s.contentDOM&&s.updateChildren(r,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(t,i,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(t)&&(t==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let o=new rf(this.top,t,i,n);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],i=this.top;for(;t instanceof Rl;)i=t,t=i.children[i.children.length-1];(!t||!(t instanceof of)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Ci||qt)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",i),this.addHackNode("BR",this.top))}addHackNode(t,i){if(i==this.top&&this.index<i.children.length&&i.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),t=="BR"&&(n.className="ProseMirror-trailingBreak");let r=new sf(this.top,[],n,null);i!=this.top?i.children.push(r):i.children.splice(this.index++,0,r),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}};function _B(e,t){let i=t,n=i.children.length,r=e.childCount,o=new Map,s=[];e:for(;r>0;){let a;for(;;)if(n){let c=i.children[n-1];if(c instanceof Rl)i=c,n=c.children.length;else{a=c,n--;break}}else{if(i==t)break e;n=i.parent.children.indexOf(i),i=i.parent}let l=a.node;if(l){if(l!=e.child(r-1))break;--r,o.set(a,r),s.push(a)}}return{index:r,matched:o,matches:s.reverse()}}function DB(e,t){return e.type.side-t.type.side}function FB(e,t,i,n){let r=t.locals(e),o=0;if(r.length==0){for(let c=0;c<e.childCount;c++){let d=e.child(c);n(d,r,t.forChild(o,d),c),o+=d.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let d,u;for(;s<r.length&&r[s].to==o;){let m=r[s++];m.widget&&(d?(u||(u=[d])).push(m):d=m)}if(d)if(u){u.sort(DB);for(let m=0;m<u.length;m++)i(u[m],c,!!l)}else i(d,c,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(c<e.childCount)p=c,h=e.child(c++);else break;for(let m=0;m<a.length;m++)a[m].to<=o&&a.splice(m--,1);for(;s<r.length&&r[s].from<=o&&r[s].to>o;)a.push(r[s++]);let f=o+h.nodeSize;if(h.isText){let m=f;s<r.length&&r[s].from<m&&(m=r[s].from);for(let v=0;v<a.length;v++)a[v].to<m&&(m=a[v].to);m<f&&(l=h.cut(m-o),h=h.cut(0,m-o),f=m,p=-1)}else for(;s<r.length&&r[s].to<f;)s++;let g=h.isInline&&!h.isLeaf?a.filter(m=>!m.inline):a.slice();n(h,g,t.forChild(o,h),p),o=f}}function MB(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function TB(e,t,i,n){for(let r=0,o=0;r<e.childCount&&o<=n;){let s=e.child(r++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;r<e.childCount;){let c=e.child(r++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=i){if(o>=n&&l.slice(n-t.length-a,n-a)==t)return n-t.length;let c=a<n?l.lastIndexOf(t,n-a-1):-1;if(c>=0&&c+t.length+a>=i)return a+c;if(i==n&&l.length>=n+t.length-a&&l.slice(n-a,n-a+t.length)==t)return n}}return-1}function b1(e,t,i,n,r){let o=[];for(let s=0,a=0;s<e.length;s++){let l=e[s],c=a,d=a+=l.size;c>=i||d<=t?o.push(l):(c<t&&o.push(l.slice(0,t-c,n)),r&&(o.push(r),r=void 0),d>i&&o.push(l.slice(i-c,l.size,n)))}return o}function M1(e,t=null){let i=e.domSelectionRange(),n=e.state.doc;if(!i.focusNode)return null;let r=e.docView.nearestDesc(i.focusNode),o=r&&r.size==0,s=e.docView.posFromDOM(i.focusNode,i.focusOffset,1);if(s<0)return null;let a=n.resolve(s),l,c;if(ff(i)){for(l=s;r&&!r.node;)r=r.parent;let u=r.node;if(r&&u.isAtom&&Re.isSelectable(u)&&r.parent&&!(u.isInline&&lB(i.focusNode,i.focusOffset,r.dom))){let h=r.posBefore;c=new Re(s==h?a:n.resolve(h))}}else{if(i instanceof e.dom.ownerDocument.defaultView.Selection&&i.rangeCount>1){let u=s,h=s;for(let p=0;p<i.rangeCount;p++){let f=i.getRangeAt(p);u=Math.min(u,e.docView.posFromDOM(f.startContainer,f.startOffset,1)),h=Math.max(h,e.docView.posFromDOM(f.endContainer,f.endOffset,-1))}if(u<0)return null;[l,s]=h==e.state.selection.anchor?[h,u]:[u,h],a=n.resolve(s)}else l=e.docView.posFromDOM(i.anchorNode,i.anchorOffset,1);if(l<0)return null}let d=n.resolve(l);if(!c){let u=t=="pointer"||e.state.selection.head<a.pos&&!o?1:-1;c=T1(e,d,a,u)}return c}function nP(e){return e.editable?e.hasFocus():oP(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Zr(e,t=!1){let i=e.state.selection;if(rP(e,i),!!nP(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&qt){let n=e.domSelectionRange(),r=e.domObserver.currentSelection;if(n.anchorNode&&r.anchorNode&&Js(n.anchorNode,n.anchorOffset,r.anchorNode,r.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)AB(e);else{let{anchor:n,head:r}=i,o,s;SR&&!(i instanceof ke)&&(i.$from.parent.inlineContent||(o=xR(e,i.from)),!i.empty&&!i.$from.parent.inlineContent&&(s=xR(e,i.to))),e.docView.setSelection(n,r,e,t),SR&&(o&&ER(o),s&&ER(s)),i.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&IB(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}var SR=Ci||qt&&qR<63;function xR(e,t){let{node:i,offset:n}=e.docView.domFromPos(t,0),r=n<i.childNodes.length?i.childNodes[n]:null,o=n?i.childNodes[n-1]:null;if(Ci&&r&&r.contentEditable=="false")return l1(r);if((!r||r.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(r)return l1(r);if(o)return l1(o)}}function l1(e){return e.contentEditable="true",Ci&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function ER(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function IB(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let i=e.domSelectionRange(),n=i.anchorNode,r=i.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(i.anchorNode!=n||i.anchorOffset!=r)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!nP(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function AB(e){let t=e.domSelection();if(!t)return;let i=e.cursorWrapper.dom,n=i.nodeName=="IMG";n?t.collapse(i.parentNode,ei(i)+1):t.collapse(i,0),!n&&!e.state.selection.visible&&zi&&jo<=11&&(i.disabled=!0,i.disabled=!1)}function rP(e,t){if(t instanceof Re){let i=e.docView.descAt(t.from);i!=e.lastSelectedViewDesc&&(RR(e),i&&i.selectNode(),e.lastSelectedViewDesc=i)}else RR(e)}function RR(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function T1(e,t,i,n){return e.someProp("createSelectionBetween",r=>r(e,t,i))||ke.between(t,i,n)}function PR(e){return e.editable&&!e.hasFocus()?!1:oP(e)}function oP(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function OB(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),i=e.domSelectionRange();return Js(t.node,t.offset,i.anchorNode,i.anchorOffset)}function y1(e,t){let{$anchor:i,$head:n}=e.selection,r=t>0?i.max(n):i.min(n),o=r.parent.inlineContent?r.depth?e.doc.resolve(t>0?r.after():r.before()):null:r;return o&&Me.findFrom(o,t)}function Wo(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function kR(e,t,i){let n=e.state.selection;if(n instanceof ke)if(i.indexOf("s")>-1){let{$head:r}=n,o=r.textOffset?null:t<0?r.nodeBefore:r.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=e.state.doc.resolve(r.pos+o.nodeSize*(t<0?-1:1));return Wo(e,new ke(n.$anchor,s))}else if(n.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let r=y1(e.state,t);return r&&r instanceof Re?Wo(e,r):!1}else if(!(yn&&i.indexOf("m")>-1)){let r=n.$head,o=r.textOffset?null:t<0?r.nodeBefore:r.nodeAfter,s;if(!o||o.isText)return!1;let a=t<0?r.pos-o.nodeSize:r.pos;return o.isAtom||(s=e.docView.descAt(a))&&!s.contentDOM?Re.isSelectable(o)?Wo(e,new Re(t<0?e.state.doc.resolve(r.pos-o.nodeSize):r)):nu?Wo(e,new ke(e.state.doc.resolve(t<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(n instanceof Re&&n.node.isInline)return Wo(e,new ke(t>0?n.$to:n.$from));{let r=y1(e.state,t);return r?Wo(e,r):!1}}}function lf(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function Jd(e,t){let i=e.pmViewDesc;return i&&i.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function bl(e,t){return t<0?LB(e):NB(e)}function LB(e){let t=e.domSelectionRange(),i=t.focusNode,n=t.focusOffset;if(!i)return;let r,o,s=!1;for(xn&&i.nodeType==1&&n<lf(i)&&Jd(i.childNodes[n],-1)&&(s=!0);;)if(n>0){if(i.nodeType!=1)break;{let a=i.childNodes[n-1];if(Jd(a,-1))r=i,o=--n;else if(a.nodeType==3)i=a,n=i.nodeValue.length;else break}}else{if(sP(i))break;{let a=i.previousSibling;for(;a&&Jd(a,-1);)r=i.parentNode,o=ei(a),a=a.previousSibling;if(a)i=a,n=lf(i);else{if(i=i.parentNode,i==e.dom)break;n=0}}}s?S1(e,i,n):r&&S1(e,r,o)}function NB(e){let t=e.domSelectionRange(),i=t.focusNode,n=t.focusOffset;if(!i)return;let r=lf(i),o,s;for(;;)if(n<r){if(i.nodeType!=1)break;let a=i.childNodes[n];if(Jd(a,1))o=i,s=++n;else break}else{if(sP(i))break;{let a=i.nextSibling;for(;a&&Jd(a,1);)o=a.parentNode,s=ei(a)+1,a=a.nextSibling;if(a)i=a,n=0,r=lf(i);else{if(i=i.parentNode,i==e.dom)break;n=r=0}}}o&&S1(e,o,s)}function sP(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function BB(e,t){for(;e&&t==e.childNodes.length&&!iu(e);)t=ei(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let i=e.childNodes[t];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;e=i,t=0}}function HB(e,t){for(;e&&!t&&!iu(e);)t=ei(e),e=e.parentNode;for(;e&&t;){let i=e.childNodes[t-1];if(i.nodeType==3)return i;if(i.nodeType==1&&i.contentEditable=="false")break;e=i,t=e.childNodes.length}}function S1(e,t,i){if(t.nodeType!=3){let o,s;(s=BB(t,i))?(t=s,i=0):(o=HB(t,i))&&(t=o,i=o.nodeValue.length)}let n=e.domSelection();if(!n)return;if(ff(n)){let o=document.createRange();o.setEnd(t,i),o.setStart(t,i),n.removeAllRanges(),n.addRange(o)}else n.extend&&n.extend(t,i);e.domObserver.setCurSelection();let{state:r}=e;setTimeout(()=>{e.state==r&&Zr(e)},50)}function _R(e,t){let i=e.state.doc.resolve(t);if(!(qt||$R)&&i.parent.inlineContent){let r=e.coordsAtPos(t);if(t>i.start()){let o=e.coordsAtPos(t-1),s=(o.top+o.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(o.left-r.left)>1)return o.left<r.left?"ltr":"rtl"}if(t<i.end()){let o=e.coordsAtPos(t+1),s=(o.top+o.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(o.left-r.left)>1)return o.left>r.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function DR(e,t,i){let n=e.state.selection;if(n instanceof ke&&!n.empty||i.indexOf("s")>-1||yn&&i.indexOf("m")>-1)return!1;let{$from:r,$to:o}=n;if(!r.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let s=y1(e.state,t);if(s&&s instanceof Re)return Wo(e,s)}if(!r.parent.inlineContent){let s=t<0?r:o,a=n instanceof Fi?Me.near(s,t):Me.findFrom(s,t);return a?Wo(e,a):!1}return!1}function FR(e,t){if(!(e.state.selection instanceof ke))return!0;let{$head:i,$anchor:n,empty:r}=e.state.selection;if(!i.sameParent(n))return!0;if(!r)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let o=!i.textOffset&&(t<0?i.nodeBefore:i.nodeAfter);if(o&&!o.isText){let s=e.state.tr;return t<0?s.delete(i.pos-o.nodeSize,i.pos):s.delete(i.pos,i.pos+o.nodeSize),e.dispatch(s),!0}return!1}function MR(e,t,i){e.domObserver.stop(),t.contentEditable=i,e.domObserver.start()}function zB(e){if(!Ci||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:i}=e.domSelectionRange();if(t&&t.nodeType==1&&i==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let n=t.firstChild;MR(e,n,"true"),setTimeout(()=>MR(e,n,"false"),20)}return!1}function VB(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function GB(e,t){let i=t.keyCode,n=VB(t);if(i==8||yn&&i==72&&n=="c")return FR(e,-1)||bl(e,-1);if(i==46&&!t.shiftKey||yn&&i==68&&n=="c")return FR(e,1)||bl(e,1);if(i==13||i==27)return!0;if(i==37||yn&&i==66&&n=="c"){let r=i==37?_R(e,e.state.selection.from)=="ltr"?-1:1:-1;return kR(e,r,n)||bl(e,r)}else if(i==39||yn&&i==70&&n=="c"){let r=i==39?_R(e,e.state.selection.from)=="ltr"?1:-1:1;return kR(e,r,n)||bl(e,r)}else{if(i==38||yn&&i==80&&n=="c")return DR(e,-1,n)||bl(e,-1);if(i==40||yn&&i==78&&n=="c")return zB(e)||DR(e,1,n)||bl(e,1);if(n==(yn?"m":"c")&&(i==66||i==73||i==89||i==90))return!0}return!1}function I1(e,t){e.someProp("transformCopied",p=>{t=p(t,e)});let i=[],{content:n,openStart:r,openEnd:o}=t;for(;r>1&&o>1&&n.childCount==1&&n.firstChild.childCount==1;){r--,o--;let p=n.firstChild;i.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),n=p.content}let s=e.someProp("clipboardSerializer")||qr.fromSchema(e.state.schema),a=hP(),l=a.createElement("div");l.appendChild(s.serializeFragment(n,{document:a}));let c=l.firstChild,d,u=0;for(;c&&c.nodeType==1&&(d=uP[c.nodeName.toLowerCase()]);){for(let p=d.length-1;p>=0;p--){let f=a.createElement(d[p]);for(;l.firstChild;)f.appendChild(l.firstChild);l.appendChild(f),u++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${r} ${o}${u?` -${u}`:""} ${JSON.stringify(i)}`);let h=e.someProp("clipboardTextSerializer",p=>p(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:h,slice:t}}function aP(e,t,i,n,r){let o=r.parent.type.spec.code,s,a;if(!i&&!t)return null;let l=!!t&&(n||o||!i);if(l){if(e.someProp("transformPastedText",h=>{t=h(t,o||n,e)}),o)return a=new we(ie.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",h=>{a=h(a,e,!0)}),a;let u=e.someProp("clipboardTextParser",h=>h(t,r,n,e));if(u)a=u;else{let h=r.marks(),{schema:p}=e.state,f=qr.fromSchema(p);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(g=>{let m=s.appendChild(document.createElement("p"));g&&m.appendChild(f.serializeNode(p.text(g,h)))})}}else e.someProp("transformPastedHTML",u=>{i=u(i,e)}),s=qB(i),nu&&$B(s);let c=s&&s.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let u=+d[3];u>0;u--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(a||(a=(e.someProp("clipboardParser")||e.someProp("domParser")||dr.fromSchema(e.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||d),context:r,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!WB.test(h.parentNode.nodeName)?{ignore:!0}:null}})),d)a=KB(TR(a,+d[1],+d[2]),d[4]);else if(a=we.maxOpen(UB(a.content,r),!0),a.openStart||a.openEnd){let u=0,h=0;for(let p=a.content.firstChild;u<a.openStart&&!p.type.spec.isolating;u++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=TR(a,u,h)}return e.someProp("transformPasted",u=>{a=u(a,e,l)}),a}var WB=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function UB(e,t){if(e.childCount<2)return e;for(let i=t.depth;i>=0;i--){let r=t.node(i).contentMatchAt(t.index(i)),o,s=[];if(e.forEach(a=>{if(!s)return;let l=r.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&cP(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=dP(s[s.length-1],o.length));let d=lP(a,l);s.push(d),r=r.matchType(d.type),o=l}}),s)return ie.from(s)}return e}function lP(e,t,i=0){for(let n=t.length-1;n>=i;n--)e=t[n].create(null,ie.from(e));return e}function cP(e,t,i,n,r){if(r<e.length&&r<t.length&&e[r]==t[r]){let o=cP(e,t,i,n.lastChild,r+1);if(o)return n.copy(n.content.replaceChild(n.childCount-1,o));if(n.contentMatchAt(n.childCount).matchType(r==e.length-1?i.type:e[r+1]))return n.copy(n.content.append(ie.from(lP(i,e,r+1))))}}function dP(e,t){if(t==0)return e;let i=e.content.replaceChild(e.childCount-1,dP(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(ie.empty,!0);return e.copy(i.append(n))}function x1(e,t,i,n,r,o){let s=t<0?e.firstChild:e.lastChild,a=s.content;return e.childCount>1&&(o=0),r<n-1&&(a=x1(a,t,i,n,r+1,o)),r>=i&&(a=t<0?s.contentMatchAt(0).fillBefore(a,o<=r).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(ie.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function TR(e,t,i){return t<e.openStart&&(e=new we(x1(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),i<e.openEnd&&(e=new we(x1(e.content,1,i,e.openEnd,0,0),e.openStart,i)),e}var uP={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},IR=null;function hP(){return IR||(IR=document.implementation.createHTMLDocument("title"))}var c1=null;function jB(e){let t=window.trustedTypes;return t?(c1||(c1=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:i=>i})),c1.createHTML(e)):e}function qB(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let i=hP().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),r;if((r=n&&uP[n[1].toLowerCase()])&&(e=r.map(o=>"<"+o+">").join("")+e+r.map(o=>"</"+o+">").reverse().join("")),i.innerHTML=jB(e),r)for(let o=0;o<r.length;o++)i=i.querySelector(r[o])||i;return i}function $B(e){let t=e.querySelectorAll(qt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let i=0;i<t.length;i++){let n=t[i];n.childNodes.length==1&&n.textContent=="\xA0"&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function KB(e,t){if(!e.size)return e;let i=e.content.firstChild.type.schema,n;try{n=JSON.parse(t)}catch{return e}let{content:r,openStart:o,openEnd:s}=e;for(let a=n.length-2;a>=0;a-=2){let l=i.nodes[n[a]];if(!l||l.hasRequiredAttrs())break;r=ie.from(l.create(n[a+1],r)),o++,s++}return new we(r,o,s)}var Mi={},Ti={},YB={touchstart:!0,touchmove:!0},E1=class{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}};function XB(e){for(let t in Mi){let i=Mi[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=n=>{QB(e,n)&&!A1(e,n)&&(e.editable||!(n.type in Ti))&&i(e,n)},YB[t]?{passive:!0}:void 0)}Ci&&e.dom.addEventListener("input",()=>null),R1(e)}function Uo(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function JB(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function R1(e){e.someProp("handleDOMEvents",t=>{for(let i in t)e.input.eventHandlers[i]||e.dom.addEventListener(i,e.input.eventHandlers[i]=n=>A1(e,n))})}function A1(e,t){return e.someProp("handleDOMEvents",i=>{let n=i[t.type];return n?n(e,t)||t.defaultPrevented:!1})}function QB(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target;i!=e.dom;i=i.parentNode)if(!i||i.nodeType==11||i.pmViewDesc&&i.pmViewDesc.stopEvent(t))return!1;return!0}function ZB(e,t){!A1(e,t)&&Mi[t.type]&&(e.editable||!(t.type in Ti))&&Mi[t.type](e,t)}Ti.keydown=(e,t)=>{let i=t;if(e.input.shiftKey=i.keyCode==16||i.shiftKey,!fP(e,i)&&(e.input.lastKeyCode=i.keyCode,e.input.lastKeyCodeTime=Date.now(),!(Qr&&qt&&i.keyCode==13)))if(i.keyCode!=229&&e.domObserver.forceFlush(),El&&i.keyCode==13&&!i.ctrlKey&&!i.altKey&&!i.metaKey){let n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",r=>r(e,js(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",n=>n(e,i))||GB(e,i)?i.preventDefault():Uo(e,"key")};Ti.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};Ti.keypress=(e,t)=>{let i=t;if(fP(e,i)||!i.charCode||i.ctrlKey&&!i.altKey||yn&&i.metaKey)return;if(e.someProp("handleKeyPress",r=>r(e,i))){i.preventDefault();return}let n=e.state.selection;if(!(n instanceof ke)||!n.$from.sameParent(n.$to)){let r=String.fromCharCode(i.charCode),o=()=>e.state.tr.insertText(r).scrollIntoView();!/[\r\n]/.test(r)&&!e.someProp("handleTextInput",s=>s(e,n.$from.pos,n.$to.pos,r,o))&&e.dispatch(o()),i.preventDefault()}};function gf(e){return{left:e.clientX,top:e.clientY}}function eH(e,t){let i=t.x-e.clientX,n=t.y-e.clientY;return i*i+n*n<100}function O1(e,t,i,n,r){if(n==-1)return!1;let o=e.state.doc.resolve(n);for(let s=o.depth+1;s>0;s--)if(e.someProp(t,a=>s>o.depth?a(e,i,o.nodeAfter,o.before(s),r,!0):a(e,i,o.node(s),o.before(s),r,!1)))return!0;return!1}function Sl(e,t,i){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);i=="pointer"&&n.setMeta("pointer",!0),e.dispatch(n)}function tH(e,t){if(t==-1)return!1;let i=e.state.doc.resolve(t),n=i.nodeAfter;return n&&n.isAtom&&Re.isSelectable(n)?(Sl(e,new Re(i),"pointer"),!0):!1}function iH(e,t){if(t==-1)return!1;let i=e.state.selection,n,r;i instanceof Re&&(n=i.node);let o=e.state.doc.resolve(t);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(Re.isSelectable(a)){n&&i.$from.depth>0&&s>=i.$from.depth&&o.before(i.$from.depth+1)==i.$from.pos?r=o.before(i.$from.depth):r=o.before(s);break}}return r!=null?(Sl(e,Re.create(e.state.doc,r),"pointer"),!0):!1}function nH(e,t,i,n,r){return O1(e,"handleClickOn",t,i,n)||e.someProp("handleClick",o=>o(e,t,n))||(r?iH(e,i):tH(e,i))}function rH(e,t,i,n){return O1(e,"handleDoubleClickOn",t,i,n)||e.someProp("handleDoubleClick",r=>r(e,t,n))}function oH(e,t,i,n){return O1(e,"handleTripleClickOn",t,i,n)||e.someProp("handleTripleClick",r=>r(e,t,n))||sH(e,i,n)}function sH(e,t,i){if(i.button!=0)return!1;let n=e.state.doc;if(t==-1)return n.inlineContent?(Sl(e,ke.create(n,0,n.content.size),"pointer"),!0):!1;let r=n.resolve(t);for(let o=r.depth+1;o>0;o--){let s=o>r.depth?r.nodeAfter:r.node(o),a=r.before(o);if(s.inlineContent)Sl(e,ke.create(n,a+1,a+1+s.content.size),"pointer");else if(Re.isSelectable(s))Sl(e,Re.create(n,a),"pointer");else continue;return!0}}function L1(e){return cf(e)}var pP=yn?"metaKey":"ctrlKey";Mi.mousedown=(e,t)=>{let i=t;e.input.shiftKey=i.shiftKey;let n=L1(e),r=Date.now(),o="singleClick";r-e.input.lastClick.time<500&&eH(i,e.input.lastClick)&&!i[pP]&&e.input.lastClick.button==i.button&&(e.input.lastClick.type=="singleClick"?o="doubleClick":e.input.lastClick.type=="doubleClick"&&(o="tripleClick")),e.input.lastClick={time:r,x:i.clientX,y:i.clientY,type:o,button:i.button};let s=e.posAtCoords(gf(i));s&&(o=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new P1(e,s,i,!!n)):(o=="doubleClick"?rH:oH)(e,s.pos,s.inside,i)?i.preventDefault():Uo(e,"pointer"))};var P1=class{constructor(t,i,n,r){this.view=t,this.pos=i,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[pP],this.allowDefault=n.shiftKey;let o,s;if(i.inside>-1)o=t.state.doc.nodeAt(i.inside),s=i.inside;else{let d=t.state.doc.resolve(i.pos);o=d.parent,s=d.depth?d.before():0}let a=r?null:n.target,l=a?t.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=t.state;(n.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof Re&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&xn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Uo(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Zr(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let i=this.pos;this.view.state.doc!=this.startDoc&&(i=this.view.posAtCoords(gf(t))),this.updateAllowDefault(t),this.allowDefault||!i?Uo(this.view,"pointer"):nH(this.view,i.pos,i.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Ci&&this.mightDrag&&!this.mightDrag.node.isAtom||qt&&!this.view.state.selection.visible&&Math.min(Math.abs(i.pos-this.view.state.selection.from),Math.abs(i.pos-this.view.state.selection.to))<=2)?(Sl(this.view,Me.near(this.view.state.doc.resolve(i.pos)),"pointer"),t.preventDefault()):Uo(this.view,"pointer")}move(t){this.updateAllowDefault(t),Uo(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}};Mi.touchstart=e=>{e.input.lastTouch=Date.now(),L1(e),Uo(e,"pointer")};Mi.touchmove=e=>{e.input.lastTouch=Date.now(),Uo(e,"pointer")};Mi.contextmenu=e=>L1(e);function fP(e,t){return e.composing?!0:Ci&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}var aH=Qr?5e3:-1;Ti.compositionstart=Ti.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,i=t.selection.$to;if(t.selection instanceof ke&&(t.storedMarks||!i.textOffset&&i.parentOffset&&i.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||qt&&$R&&lH(e)))e.markCursor=e.state.storedMarks||i.marks(),cf(e,!0),e.markCursor=null;else if(cf(e,!t.selection.empty),xn&&t.selection.empty&&i.parentOffset&&!i.textOffset&&i.nodeBefore.marks.length){let n=e.domSelectionRange();for(let r=n.focusNode,o=n.focusOffset;r&&r.nodeType==1&&o!=0;){let s=o<0?r.lastChild:r.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=e.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else r=s,o=-1}}e.input.composing=!0}gP(e,aH)};function lH(e){let{focusNode:t,focusOffset:i}=e.domSelectionRange();if(!t||t.nodeType!=1||i>=t.childNodes.length)return!1;let n=t.childNodes[i];return n.nodeType==1&&n.contentEditable=="false"}Ti.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,gP(e,20))};function gP(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>cf(e),t))}function mP(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=dH());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function cH(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let i=sB(t.focusNode,t.focusOffset),n=aB(t.focusNode,t.focusOffset);if(i&&n&&i!=n){let r=n.pmViewDesc,o=e.domObserver.lastChangedTextNode;if(i==o||n==o)return o;if(!r||!r.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let s=i.pmViewDesc;if(!(!s||!s.isText(i.nodeValue)))return n}}return i||n}function dH(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function cf(e,t=!1){if(!(Qr&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),mP(e),t||e.docView&&e.docView.dirty){let i=M1(e),n=e.state.selection;return i&&!i.eq(n)?e.dispatch(e.state.tr.setSelection(i)):(e.markCursor||t)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function uH(e,t){if(!e.dom.parentNode)return;let i=e.dom.parentNode.appendChild(document.createElement("div"));i.appendChild(t),i.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),r=document.createRange();r.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(r),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i),e.focus()},50)}var Qd=zi&&jo<15||El&&uB<604;Mi.copy=Ti.cut=(e,t)=>{let i=t,n=e.state.selection,r=i.type=="cut";if(n.empty)return;let o=Qd?null:i.clipboardData,s=n.content(),{dom:a,text:l}=I1(e,s);o?(i.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):uH(e,a),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function hH(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function pH(e,t){if(!e.dom.parentNode)return;let i=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(i?"textarea":"div"));i||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let r=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),i?Zd(e,n.value,null,r,t):Zd(e,n.textContent,n.innerHTML,r,t)},50)}function Zd(e,t,i,n,r){let o=aP(e,t,i,n,e.state.selection.$from);if(e.someProp("handlePaste",l=>l(e,r,o||we.empty)))return!0;if(!o)return!1;let s=hH(o),a=s?e.state.tr.replaceSelectionWith(s,n):e.state.tr.replaceSelection(o);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function vP(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let i=e.getData("text/uri-list");return i?i.replace(/\r?\n/g," "):""}Ti.paste=(e,t)=>{let i=t;if(e.composing&&!Qr)return;let n=Qd?null:i.clipboardData,r=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&Zd(e,vP(n),n.getData("text/html"),r,i)?i.preventDefault():pH(e,i)};var df=class{constructor(t,i,n){this.slice=t,this.move=i,this.node=n}},fH=yn?"altKey":"ctrlKey";function CP(e,t){let i=e.someProp("dragCopies",n=>!n(t));return i??!t[fH]}Mi.dragstart=(e,t)=>{let i=t,n=e.input.mouseDown;if(n&&n.done(),!i.dataTransfer)return;let r=e.state.selection,o=r.empty?null:e.posAtCoords(gf(i)),s;if(!(o&&o.pos>=r.from&&o.pos<=(r instanceof Re?r.to-1:r.to))){if(n&&n.mightDrag)s=Re.create(e.state.doc,n.mightDrag.pos);else if(i.target&&i.target.nodeType==1){let u=e.docView.nearestDesc(i.target,!0);u&&u.node.type.spec.draggable&&u!=e.docView&&(s=Re.create(e.state.doc,u.posBefore))}}let a=(s||e.state.selection).content(),{dom:l,text:c,slice:d}=I1(e,a);(!i.dataTransfer.files.length||!qt||qR>120)&&i.dataTransfer.clearData(),i.dataTransfer.setData(Qd?"Text":"text/html",l.innerHTML),i.dataTransfer.effectAllowed="copyMove",Qd||i.dataTransfer.setData("text/plain",c),e.dragging=new df(d,CP(e,i),s)};Mi.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};Ti.dragover=Ti.dragenter=(e,t)=>t.preventDefault();Ti.drop=(e,t)=>{try{gH(e,t,e.dragging)}finally{e.dragging=null}};function gH(e,t,i){if(!t.dataTransfer)return;let n=e.posAtCoords(gf(t));if(!n)return;let r=e.state.doc.resolve(n.pos),o=i&&i.slice;o?e.someProp("transformPasted",p=>{o=p(o,e,!1)}):o=aP(e,vP(t.dataTransfer),Qd?null:t.dataTransfer.getData("text/html"),!1,r);let s=!!(i&&CP(e,t));if(e.someProp("handleDrop",p=>p(e,t,o||we.empty,s))){t.preventDefault();return}if(!o)return;t.preventDefault();let a=o?Jp(e.state.doc,r.pos,o):r.pos;a==null&&(a=r.pos);let l=e.state.tr;if(s){let{node:p}=i;p?p.replace(l):l.deleteSelection()}let c=l.mapping.map(a),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,u=l.doc;if(d?l.replaceRangeWith(c,c,o.content.firstChild):l.replaceRange(c,c,o),l.doc.eq(u))return;let h=l.doc.resolve(c);if(d&&Re.isSelectable(o.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(o.content.firstChild))l.setSelection(new Re(h));else{let p=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((f,g,m,v)=>p=v),l.setSelection(T1(e,h,l.doc.resolve(p)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))}Mi.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Zr(e)},20))};Mi.blur=(e,t)=>{let i=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),i.relatedTarget&&e.dom.contains(i.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};Mi.beforeinput=(e,t)=>{if(qt&&Qr&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:n}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=n||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",o=>o(e,js(8,"Backspace")))))return;let{$cursor:r}=e.state.selection;r&&r.pos>0&&e.dispatch(e.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let e in Ti)Mi[e]=Ti[e];function eu(e,t){if(e==t)return!0;for(let i in e)if(e[i]!==t[i])return!1;for(let i in t)if(!(i in e))return!1;return!0}var uf=class e{constructor(t,i){this.toDOM=t,this.spec=i||Ys,this.side=this.spec.side||0}map(t,i,n,r){let{pos:o,deleted:s}=t.mapResult(i.from+r,this.side<0?-1:1);return s?null:new wi(o-n,o-n,this)}valid(){return!0}eq(t){return this==t||t instanceof e&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&eu(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}},Ks=class e{constructor(t,i){this.attrs=t,this.spec=i||Ys}map(t,i,n,r){let o=t.map(i.from+r,this.spec.inclusiveStart?-1:1)-n,s=t.map(i.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=s?null:new wi(o,s,this)}valid(t,i){return i.from<i.to}eq(t){return this==t||t instanceof e&&eu(this.attrs,t.attrs)&&eu(this.spec,t.spec)}static is(t){return t.type instanceof e}destroy(){}},k1=class e{constructor(t,i){this.attrs=t,this.spec=i||Ys}map(t,i,n,r){let o=t.mapResult(i.from+r,1);if(o.deleted)return null;let s=t.mapResult(i.to+r,-1);return s.deleted||s.pos<=o.pos?null:new wi(o.pos-n,s.pos-n,this)}valid(t,i){let{index:n,offset:r}=t.content.findIndex(i.from),o;return r==i.from&&!(o=t.child(n)).isText&&r+o.nodeSize==i.to}eq(t){return this==t||t instanceof e&&eu(this.attrs,t.attrs)&&eu(this.spec,t.spec)}destroy(){}},wi=class e{constructor(t,i,n){this.from=t,this.to=i,this.type=n}copy(t,i){return new e(t,i,this.type)}eq(t,i=0){return this.type.eq(t.type)&&this.from+i==t.from&&this.to+i==t.to}map(t,i,n){return this.type.map(t,this,i,n)}static widget(t,i,n){return new e(t,t,new uf(i,n))}static inline(t,i,n,r){return new e(t,i,new Ks(n,r))}static node(t,i,n,r){return new e(t,i,new k1(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ks}get widget(){return this.type instanceof uf}},yl=[],Ys={},Tt=class e{constructor(t,i){this.local=t.length?t:yl,this.children=i.length?i:yl}static create(t,i){return i.length?pf(i,t,0,Ys):vi}find(t,i,n){let r=[];return this.findInner(t??0,i??1e9,r,0,n),r}findInner(t,i,n,r,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=i&&a.to>=t&&(!o||o(a.spec))&&n.push(a.copy(a.from+r,a.to+r))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<i&&this.children[s+1]>t){let a=this.children[s]+1;this.children[s+2].findInner(t-a,i-a,n,r+a,o)}}map(t,i,n){return this==vi||t.maps.length==0?this:this.mapInner(t,i,0,0,n||Ys)}mapInner(t,i,n,r,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(t,n,r);l&&l.type.valid(i,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?mH(this.children,s||[],t,i,n,r,o):s?new e(s.sort(Xs),yl):vi}add(t,i){return i.length?this==vi?e.create(t,i):this.addInner(t,i,0):this}addInner(t,i,n){let r,o=0;t.forEach((a,l)=>{let c=l+n,d;if(d=bP(i,a,c)){for(r||(r=this.children.slice());o<r.length&&r[o]<l;)o+=3;r[o]==l?r[o+2]=r[o+2].addInner(a,d,c+1):r.splice(o,0,l,l+a.nodeSize,pf(d,a,c+1,Ys)),o+=3}});let s=wP(o?yP(i):i,-n);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||s.splice(a--,1);return new e(s.length?this.local.concat(s).sort(Xs):this.local,r||this.children)}remove(t){return t.length==0||this==vi?this:this.removeInner(t,0)}removeInner(t,i){let n=this.children,r=this.local;for(let o=0;o<n.length;o+=3){let s,a=n[o]+i,l=n[o+1]+i;for(let d=0,u;d<t.length;d++)(u=t[d])&&u.from>a&&u.to<l&&(t[d]=null,(s||(s=[])).push(u));if(!s)continue;n==this.children&&(n=this.children.slice());let c=n[o+2].removeInner(s,a+1);c!=vi?n[o+2]=c:(n.splice(o,3),o-=3)}if(r.length){for(let o=0,s;o<t.length;o++)if(s=t[o])for(let a=0;a<r.length;a++)r[a].eq(s,i)&&(r==this.local&&(r=this.local.slice()),r.splice(a--,1))}return n==this.children&&r==this.local?this:r.length||n.length?new e(r,n):vi}forChild(t,i){if(this==vi)return this;if(i.isLeaf)return e.empty;let n,r;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(n=this.children[a+2]);break}let o=t+1,s=o+i.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof Ks){let c=Math.max(o,l.from)-o,d=Math.min(s,l.to)-o;c<d&&(r||(r=[])).push(l.copy(c,d))}}if(r){let a=new e(r.sort(Xs),yl);return n?new hf([a,n]):a}return n||vi}eq(t){if(this==t)return!0;if(!(t instanceof e)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let i=0;i<this.local.length;i++)if(!this.local[i].eq(t.local[i]))return!1;for(let i=0;i<this.children.length;i+=3)if(this.children[i]!=t.children[i]||this.children[i+1]!=t.children[i+1]||!this.children[i+2].eq(t.children[i+2]))return!1;return!0}locals(t){return N1(this.localsInner(t))}localsInner(t){if(this==vi)return yl;if(t.inlineContent||!this.local.some(Ks.is))return this.local;let i=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Ks||i.push(this.local[n]);return i}forEachSet(t){t(this)}};Tt.empty=new Tt([],[]);Tt.removeOverlap=N1;var vi=Tt.empty,hf=class e{constructor(t){this.members=t}map(t,i){let n=this.members.map(r=>r.map(t,i,Ys));return e.from(n)}forChild(t,i){if(i.isLeaf)return Tt.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(t,i);o!=vi&&(o instanceof e?n=n.concat(o.members):n.push(o))}return e.from(n)}eq(t){if(!(t instanceof e)||t.members.length!=this.members.length)return!1;for(let i=0;i<this.members.length;i++)if(!this.members[i].eq(t.members[i]))return!1;return!0}locals(t){let i,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(t);if(o.length)if(!i)i=o;else{n&&(i=i.slice(),n=!1);for(let s=0;s<o.length;s++)i.push(o[s])}}return i?N1(n?i:i.sort(Xs)):yl}static from(t){switch(t.length){case 0:return vi;case 1:return t[0];default:return new e(t.every(i=>i instanceof Tt)?t:t.reduce((i,n)=>i.concat(n instanceof Tt?n:n.members),[]))}}forEachSet(t){for(let i=0;i<this.members.length;i++)this.members[i].forEachSet(t)}};function mH(e,t,i,n,r,o,s){let a=e.slice();for(let c=0,d=o;c<i.maps.length;c++){let u=0;i.maps[c].forEach((h,p,f,g)=>{let m=g-f-(p-h);for(let v=0;v<a.length;v+=3){let C=a[v+1];if(C<0||h>C+d-u)continue;let b=a[v]+d-u;p>=b?a[v+1]=h<=b?-2:-1:h>=d&&m&&(a[v]+=m,a[v+1]+=m)}u+=m}),d=i.maps[c].map(d,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let d=i.map(e[c]+o),u=d-r;if(u<0||u>=n.content.size){l=!0;continue}let h=i.map(e[c+1]+o,-1),p=h-r,{index:f,offset:g}=n.content.findIndex(u),m=n.maybeChild(f);if(m&&g==u&&g+m.nodeSize==p){let v=a[c+2].mapInner(i,m,d+1,e[c]+o+1,s);v!=vi?(a[c]=u,a[c+1]=p,a[c+2]=v):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=vH(a,e,t,i,r,o,s),d=pf(c,n,0,s);t=d.local;for(let u=0;u<a.length;u+=3)a[u+1]<0&&(a.splice(u,3),u-=3);for(let u=0,h=0;u<d.children.length;u+=3){let p=d.children[u];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,d.children[u],d.children[u+1],d.children[u+2])}}return new Tt(t.sort(Xs),a)}function wP(e,t){if(!t||!e.length)return e;let i=[];for(let n=0;n<e.length;n++){let r=e[n];i.push(new wi(r.from+t,r.to+t,r.type))}return i}function vH(e,t,i,n,r,o,s){function a(l,c){for(let d=0;d<l.local.length;d++){let u=l.local[d].map(n,r,c);u?i.push(u):s.onRemove&&s.onRemove(l.local[d].spec)}for(let d=0;d<l.children.length;d+=3)a(l.children[d+2],l.children[d]+c+1)}for(let l=0;l<e.length;l+=3)e[l+1]==-1&&a(e[l+2],t[l]+o+1);return i}function bP(e,t,i){if(t.isLeaf)return null;let n=i+t.nodeSize,r=null;for(let o=0,s;o<e.length;o++)(s=e[o])&&s.from>i&&s.to<n&&((r||(r=[])).push(s),e[o]=null);return r}function yP(e){let t=[];for(let i=0;i<e.length;i++)e[i]!=null&&t.push(e[i]);return t}function pf(e,t,i,n){let r=[],o=!1;t.forEach((a,l)=>{let c=bP(e,a,l+i);if(c){o=!0;let d=pf(c,a,i+l+1,n);d!=vi&&r.push(l,l+a.nodeSize,d)}});let s=wP(o?yP(e):e,-i).sort(Xs);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(n.onRemove&&n.onRemove(s[a].spec),s.splice(a--,1));return s.length||r.length?new Tt(s,r):vi}function Xs(e,t){return e.from-t.from||e.to-t.to}function N1(e){let t=e;for(let i=0;i<t.length-1;i++){let n=t[i];if(n.from!=n.to)for(let r=i+1;r<t.length;r++){let o=t[r];if(o.from==n.from){o.to!=n.to&&(t==e&&(t=e.slice()),t[r]=o.copy(o.from,n.to),AR(t,r+1,o.copy(n.to,o.to)));continue}else{o.from<n.to&&(t==e&&(t=e.slice()),t[i]=n.copy(n.from,o.from),AR(t,r,n.copy(o.from,n.to)));break}}}return t}function AR(e,t,i){for(;t<e.length&&Xs(i,e[t])>0;)t++;e.splice(t,0,i)}function d1(e){let t=[];return e.someProp("decorations",i=>{let n=i(e.state);n&&n!=vi&&t.push(n)}),e.cursorWrapper&&t.push(Tt.create(e.state.doc,[e.cursorWrapper.deco])),hf.from(t)}var CH={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},wH=zi&&jo<=11,_1=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}},D1=class{constructor(t,i){this.view=t,this.handleDOMChange=i,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new _1,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let r=0;r<n.length;r++)this.queue.push(n[r]);zi&&jo<=11&&n.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),wH&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,CH)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let i=0;i<t.length;i++)this.queue.push(t[i]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(PR(this.view)){if(this.suppressingSelectionUpdates)return Zr(this.view);if(zi&&jo<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&Js(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let i=new Set,n;for(let o=t.focusNode;o;o=xl(o))i.add(o);for(let o=t.anchorNode;o;o=xl(o))if(i.has(o)){n=o;break}let r=n&&this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let i=this.pendingRecords();i.length&&(this.queue=[]);let n=t.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&PR(t)&&!this.ignoreSelectionChange(n),o=-1,s=-1,a=!1,l=[];if(t.editable)for(let d=0;d<i.length;d++){let u=this.registerMutation(i[d],l);u&&(o=o<0?u.from:Math.min(u.from,o),s=s<0?u.to:Math.max(u.to,s),u.typeOver&&(a=!0))}if(xn&&l.length){let d=l.filter(u=>u.nodeName=="BR");if(d.length==2){let[u,h]=d;u.parentNode&&u.parentNode.parentNode==h.parentNode?h.remove():u.remove()}else{let{focusNode:u}=this.currentSelection;for(let h of d){let p=h.parentNode;p&&p.nodeName=="LI"&&(!u||SH(t,u)!=p)&&h.remove()}}}else if((qt||Ci)&&l.some(d=>d.nodeName=="BR")&&(t.input.lastKeyCode==8||t.input.lastKeyCode==46)){for(let d of l)if(d.nodeName=="BR"&&d.parentNode){let u=d.nextSibling;u&&u.nodeType==1&&u.contentEditable=="false"&&d.parentNode.removeChild(d)}}let c=null;o<0&&r&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&ff(n)&&(c=M1(t))&&c.eq(Me.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Zr(t),this.currentSelection.set(n),t.scrollToSelection()):(o>-1||r)&&(o>-1&&(t.docView.markDirty(o,s),bH(t)),this.handleDOMChange(o,s,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||Zr(t),this.currentSelection.set(n))}registerMutation(t,i){if(i.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(n==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if(t.type=="childList"){for(let d=0;d<t.addedNodes.length;d++){let u=t.addedNodes[d];i.push(u),u.nodeType==3&&(this.lastChangedTextNode=u)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let r=t.previousSibling,o=t.nextSibling;if(zi&&jo<=11&&t.addedNodes.length)for(let d=0;d<t.addedNodes.length;d++){let{previousSibling:u,nextSibling:h}=t.addedNodes[d];(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(r=u),(!h||Array.prototype.indexOf.call(t.addedNodes,h)<0)&&(o=h)}let s=r&&r.parentNode==t.target?ei(r)+1:0,a=n.localPosFromDOM(t.target,s,-1),l=o&&o.parentNode==t.target?ei(o):t.target.childNodes.length,c=n.localPosFromDOM(t.target,l,1);return{from:a,to:c}}else return t.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}},OR=new WeakMap,LR=!1;function bH(e){if(!OR.has(e)&&(OR.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=xn,LR)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),LR=!0}}function NR(e,t){let i=t.startContainer,n=t.startOffset,r=t.endContainer,o=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return Js(s.node,s.offset,r,o)&&([i,n,r,o]=[r,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:o}}function yH(e,t){if(t.getComposedRanges){let r=t.getComposedRanges(e.root)[0];if(r)return NR(e,r)}let i;function n(r){r.preventDefault(),r.stopImmediatePropagation(),i=r.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),i?NR(e,i):null}function SH(e,t){for(let i=t.parentNode;i&&i!=e.dom;i=i.parentNode){let n=e.docView.nearestDesc(i,!0);if(n&&n.node.isBlock)return i}return null}function xH(e,t,i){let{node:n,fromOffset:r,toOffset:o,from:s,to:a}=e.docView.parseRange(t,i),l=e.domSelectionRange(),c,d=l.anchorNode;if(d&&e.dom.contains(d.nodeType==1?d:d.parentNode)&&(c=[{node:d,offset:l.anchorOffset}],ff(l)||c.push({node:l.focusNode,offset:l.focusOffset})),qt&&e.input.lastKeyCode===8)for(let m=o;m>r;m--){let v=n.childNodes[m-1],C=v.pmViewDesc;if(v.nodeName=="BR"&&!C){o=m;break}if(!C||C.size)break}let u=e.state.doc,h=e.someProp("domParser")||dr.fromSchema(e.state.schema),p=u.resolve(s),f=null,g=h.parse(n,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:r,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:EH,context:p});if(c&&c[0].pos!=null){let m=c[0].pos,v=c[1]&&c[1].pos;v==null&&(v=m),f={anchor:m+s,head:v+s}}return{doc:g,sel:f,from:s,to:a}}function EH(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(Ci&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let i=document.createElement("div");return i.appendChild(document.createElement("li")),{skip:i}}else if(e.parentNode.lastChild==e||Ci&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}var RH=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function PH(e,t,i,n,r){let o=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let P=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,F=M1(e,P);if(F&&!e.state.selection.eq(F)){if(qt&&Qr&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",Y=>Y(e,js(13,"Enter"))))return;let N=e.state.tr.setSelection(F);P=="pointer"?N.setMeta("pointer",!0):P=="key"&&N.scrollIntoView(),o&&N.setMeta("composition",o),e.dispatch(N)}return}let s=e.state.doc.resolve(t),a=s.sharedDepth(i);t=s.before(a+1),i=e.state.doc.resolve(i).after(a+1);let l=e.state.selection,c=xH(e,t,i),d=e.state.doc,u=d.slice(c.from,c.to),h,p;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(h=e.state.selection.to,p="end"):(h=e.state.selection.from,p="start"),e.input.lastKeyCode=null;let f=DH(u.content,c.doc.content,c.from,h,p);if(f&&e.input.domChangeCount++,(El&&e.input.lastIOSEnter>Date.now()-225||Qr)&&r.some(P=>P.nodeType==1&&!RH.test(P.nodeName))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",P=>P(e,js(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!f)if(n&&l instanceof ke&&!l.empty&&l.$head.sameParent(l.$anchor)&&!e.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))f={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let P=BR(e,e.state.doc,c.sel);if(P&&!P.eq(e.state.selection)){let F=e.state.tr.setSelection(P);o&&F.setMeta("composition",o),e.dispatch(F)}}return}e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof ke&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=c.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=c.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),zi&&jo<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>c.from&&c.doc.textBetween(f.start-c.from-1,f.start-c.from+1)==" \xA0"&&(f.start--,f.endA--,f.endB--);let g=c.doc.resolveNoCache(f.start-c.from),m=c.doc.resolveNoCache(f.endB-c.from),v=d.resolve(f.start),C=g.sameParent(m)&&g.parent.inlineContent&&v.end()>=f.endA;if((El&&e.input.lastIOSEnter>Date.now()-225&&(!C||r.some(P=>P.nodeName=="DIV"||P.nodeName=="P"))||!C&&g.pos<c.doc.content.size&&(!g.sameParent(m)||!g.parent.inlineContent)&&g.pos<m.pos&&!/\S/.test(c.doc.textBetween(g.pos,m.pos,"","")))&&e.someProp("handleKeyDown",P=>P(e,js(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>f.start&&_H(d,f.start,f.endA,g,m)&&e.someProp("handleKeyDown",P=>P(e,js(8,"Backspace")))){Qr&&qt&&e.domObserver.suppressSelectionUpdates();return}qt&&f.endB==f.start&&(e.input.lastChromeDelete=Date.now()),Qr&&!C&&g.start()!=m.start()&&m.parentOffset==0&&g.depth==m.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==f.endA&&(f.endB-=2,m=c.doc.resolveNoCache(f.endB-c.from),setTimeout(()=>{e.someProp("handleKeyDown",function(P){return P(e,js(13,"Enter"))})},20));let b=f.start,S=f.endA,E=P=>{let F=P||e.state.tr.replace(b,S,c.doc.slice(f.start-c.from,f.endB-c.from));if(c.sel){let N=BR(e,F.doc,c.sel);N&&!(qt&&e.composing&&N.empty&&(f.start!=f.endB||e.input.lastChromeDelete<Date.now()-100)&&(N.head==b||N.head==F.mapping.map(S)-1)||zi&&N.empty&&N.head==b)&&F.setSelection(N)}return o&&F.setMeta("composition",o),F.scrollIntoView()},x;if(C)if(g.pos==m.pos){zi&&jo<=11&&g.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>Zr(e),20));let P=E(e.state.tr.delete(b,S)),F=d.resolve(f.start).marksAcross(d.resolve(f.endA));F&&P.ensureMarks(F),e.dispatch(P)}else if(f.endA==f.endB&&(x=kH(g.parent.content.cut(g.parentOffset,m.parentOffset),v.parent.content.cut(v.parentOffset,f.endA-v.start())))){let P=E(e.state.tr);x.type=="add"?P.addMark(b,S,x.mark):P.removeMark(b,S,x.mark),e.dispatch(P)}else if(g.parent.child(g.index()).isText&&g.index()==m.index()-(m.textOffset?0:1)){let P=g.parent.textBetween(g.parentOffset,m.parentOffset),F=()=>E(e.state.tr.insertText(P,b,S));e.someProp("handleTextInput",N=>N(e,b,S,P,F))||e.dispatch(F())}else e.dispatch(E());else e.dispatch(E())}function BR(e,t,i){return Math.max(i.anchor,i.head)>t.content.size?null:T1(e,t.resolve(i.anchor),t.resolve(i.head))}function kH(e,t){let i=e.firstChild.marks,n=t.firstChild.marks,r=i,o=n,s,a,l;for(let d=0;d<n.length;d++)r=n[d].removeFromSet(r);for(let d=0;d<i.length;d++)o=i[d].removeFromSet(o);if(r.length==1&&o.length==0)a=r[0],s="add",l=d=>d.mark(a.addToSet(d.marks));else if(r.length==0&&o.length==1)a=o[0],s="remove",l=d=>d.mark(a.removeFromSet(d.marks));else return null;let c=[];for(let d=0;d<t.childCount;d++)c.push(l(t.child(d)));if(ie.from(c).eq(e))return{mark:a,type:s}}function _H(e,t,i,n,r){if(i-t<=r.pos-n.pos||u1(n,!0,!1)<r.pos)return!1;let o=e.resolve(t);if(!n.parent.isTextblock){let a=o.nodeAfter;return a!=null&&i==t+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=e.resolve(u1(o,!0,!0));return!s.parent.isTextblock||s.pos>i||u1(s,!0,!1)<i?!1:n.parent.content.cut(n.parentOffset).eq(s.parent.content)}function u1(e,t,i){let n=e.depth,r=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,r++,t=!1;if(i){let o=e.node(n).maybeChild(e.indexAfter(n));for(;o&&!o.isLeaf;)o=o.firstChild,r++}return r}function DH(e,t,i,n,r){let o=e.findDiffStart(t,i);if(o==null)return null;let{a:s,b:a}=e.findDiffEnd(t,i+e.size,i+t.size);if(r=="end"){let l=Math.max(0,o-Math.min(s,a));n-=s+l-o}if(s<o&&e.size<t.size){let l=n<=o&&n>=s?o-n:0;o-=l,o&&o<t.size&&HR(t.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=n<=o&&n>=a?o-n:0;o-=l,o&&o<e.size&&HR(e.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function HR(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),i=e.charCodeAt(1);return t>=56320&&t<=57343&&i>=55296&&i<=56319}var tu=class{constructor(t,i){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new E1,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=i,this.state=i.state,this.directPlugins=i.plugins||[],this.directPlugins.forEach(UR),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=GR(this),VR(this),this.nodeViews=WR(this),this.docView=bR(this.state.doc,zR(this),d1(this),this.dom,this),this.domObserver=new D1(this,(n,r,o,s)=>PH(this,n,r,o,s)),this.domObserver.start(),XB(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let i in t)this._props[i]=t[i];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&R1(this);let i=this._props;this._props=t,t.plugins&&(t.plugins.forEach(UR),this.directPlugins=t.plugins),this.updateStateInner(t.state,i)}setProps(t){let i={};for(let n in this._props)i[n]=this._props[n];i.state=this.state;for(let n in t)i[n]=t[n];this.update(i)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,i){var n;let r=this.state,o=!1,s=!1;t.storedMarks&&this.composing&&(mP(this),s=!0),this.state=t;let a=r.plugins!=t.plugins||this._props.plugins!=i.plugins;if(a||this._props.plugins!=i.plugins||this._props.nodeViews!=i.nodeViews){let p=WR(this);MH(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(a||i.handleDOMEvents!=this._props.handleDOMEvents)&&R1(this),this.editable=GR(this),VR(this);let l=d1(this),c=zR(this),d=r.plugins!=t.plugins&&!r.doc.eq(t.doc)?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(t.doc,c,l);(u||!t.selection.eq(r.selection))&&(s=!0);let h=d=="preserve"&&s&&this.dom.style.overflowAnchor==null&&fB(this);if(s){this.domObserver.stop();let p=u&&(zi||qt)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&FH(r.selection,t.selection);if(u){let f=qt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=cH(this)),(o||!this.docView.update(t.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=bR(t.doc,c,l,this.dom,this)),f&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&OB(this))?Zr(this,p):(rP(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),!((n=this.dragging)===null||n===void 0)&&n.node&&!r.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,r),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():h&&gB(h)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",i=>i(this)))if(this.state.selection instanceof Re){let i=this.docView.domAfterPos(this.state.selection.from);i.nodeType==1&&fR(this,i.getBoundingClientRect(),t)}else fR(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let i=0;i<this.directPlugins.length;i++){let n=this.directPlugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let i=0;i<this.state.plugins.length;i++){let n=this.state.plugins[i];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let i=0;i<this.pluginViews.length;i++){let n=this.pluginViews[i];n.update&&n.update(this,t)}}updateDraggedNode(t,i){let n=t.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let o=n.from+(this.state.doc.content.size-i.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==n.node&&(r=o)}this.dragging=new df(t.slice,t.move,r<0?void 0:Re.create(this.state.doc,r))}someProp(t,i){let n=this._props&&this._props[t],r;if(n!=null&&(r=i?i(n):n))return r;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[t];if(a!=null&&(r=i?i(a):a))return r}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[t];if(a!=null&&(r=i?i(a):a))return r}}hasFocus(){if(zi){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&mB(this.dom),Zr(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let i=this.dom.parentNode;i;i=i.parentNode)if(i.nodeType==9||i.nodeType==11&&i.host)return i.getSelection||(Object.getPrototypeOf(i).getSelection=()=>i.ownerDocument.getSelection()),this._root=i}return t||document}updateRoot(){this._root=null}posAtCoords(t){return yB(this,t)}coordsAtPos(t,i=1){return QR(this,t,i)}domAtPos(t,i=0){return this.docView.domFromPos(t,i)}nodeDOM(t){let i=this.docView.descAt(t);return i?i.nodeDOM:null}posAtDOM(t,i,n=-1){let r=this.docView.posFromDOM(t,i,n);if(r==null)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(t,i){return PB(this,i||this.state,t)}pasteHTML(t,i){return Zd(this,"",t,!1,i||new ClipboardEvent("paste"))}pasteText(t,i){return Zd(this,t,null,!0,i||new ClipboardEvent("paste"))}serializeForClipboard(t){return I1(this,t)}destroy(){this.docView&&(JB(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],d1(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,rB())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return ZB(this,t)}domSelectionRange(){let t=this.domSelection();return t?Ci&&this.root.nodeType===11&&cB(this.dom.ownerDocument)==this.dom&&yH(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}};tu.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};function zR(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",i=>{if(typeof i=="function"&&(i=i(e.state)),i)for(let n in i)n=="class"?t.class+=" "+i[n]:n=="style"?t.style=(t.style?t.style+";":"")+i[n]:!t[n]&&n!="contenteditable"&&n!="nodeName"&&(t[n]=String(i[n]))}),t.translate||(t.translate="no"),[wi.node(0,e.state.doc.content.size,t)]}function VR(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:wi.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function GR(e){return!e.someProp("editable",t=>t(e.state)===!1)}function FH(e,t){let i=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(i)!=t.$anchor.start(i)}function WR(e){let t=Object.create(null);function i(n){for(let r in n)Object.prototype.hasOwnProperty.call(t,r)||(t[r]=n[r])}return e.someProp("nodeViews",i),e.someProp("markViews",i),t}function MH(e,t){let i=0,n=0;for(let r in e){if(e[r]!=t[r])return!0;i++}for(let r in t)n++;return i!=n}function UR(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var eo={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},vf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},TH=typeof navigator<"u"&&/Mac/.test(navigator.platform),IH=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(Bt=0;Bt<10;Bt++)eo[48+Bt]=eo[96+Bt]=String(Bt);var Bt;for(Bt=1;Bt<=24;Bt++)eo[Bt+111]="F"+Bt;var Bt;for(Bt=65;Bt<=90;Bt++)eo[Bt]=String.fromCharCode(Bt+32),vf[Bt]=String.fromCharCode(Bt);var Bt;for(mf in eo)vf.hasOwnProperty(mf)||(vf[mf]=eo[mf]);var mf;function SP(e){var t=TH&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||IH&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",i=!t&&e.key||(e.shiftKey?vf:eo)[e.keyCode]||e.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}var AH=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),OH=typeof navigator<"u"&&/Win/.test(navigator.platform);function LH(e){let t=e.split(/-(?!$)/),i=t[t.length-1];i=="Space"&&(i=" ");let n,r,o,s;for(let a=0;a<t.length-1;a++){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))AH?s=!0:r=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(i="Alt-"+i),r&&(i="Ctrl-"+i),s&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function NH(e){let t=Object.create(null);for(let i in e)t[LH(i)]=e[i];return t}function B1(e,t,i=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),i&&t.shiftKey&&(e="Shift-"+e),e}function xP(e){return new Te({props:{handleKeyDown:H1(e)}})}function H1(e){let t=NH(e);return function(i,n){let r=SP(n),o,s=t[B1(r,n)];if(s&&s(i.state,i.dispatch,i))return!0;if(r.length==1&&r!=" "){if(n.shiftKey){let a=t[B1(r,n,!1)];if(a&&a(i.state,i.dispatch,i))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(OH&&n.ctrlKey&&n.altKey)&&(o=eo[n.keyCode])&&o!=r){let a=t[B1(o,n)];if(a&&a(i.state,i.dispatch,i))return!0}}return!1}}var BH=Object.defineProperty,q1=(e,t)=>{for(var i in t)BH(e,i,{get:t[i],enumerable:!0})};function Rf(e){let{state:t,transaction:i}=e,{selection:n}=i,{doc:r}=i,{storedMarks:o}=i;return T(w({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return n},get doc(){return r},get tr(){return n=i.selection,r=i.doc,o=i.storedMarks,i}})}var Pf=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:i}=this,{view:n}=t,{tr:r}=i,o=this.buildProps(r);return Object.fromEntries(Object.entries(e).map(([s,a])=>[s,(...c)=>{let d=a(...c)(o);return!r.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(r),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:i,editor:n,state:r}=this,{view:o}=n,s=[],a=!!e,l=e||r.tr,c=()=>(!a&&t&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(l),s.every(u=>u===!0)),d=T(w({},Object.fromEntries(Object.entries(i).map(([u,h])=>[u,(...f)=>{let g=this.buildProps(l,t),m=h(...f)(g);return s.push(m),d}]))),{run:c});return d}createCan(e){let{rawCommands:t,state:i}=this,n=!1,r=e||i.tr,o=this.buildProps(r,n),s=Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...c)=>l(...c)(T(w({},o),{dispatch:void 0}))]));return T(w({},s),{chain:()=>this.createChain(r,n)})}buildProps(e,t=!0){let{rawCommands:i,editor:n,state:r}=this,{view:o}=n,s={tr:e,editor:n,view:o,state:Rf({state:r,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(i).map(([a,l])=>[a,(...c)=>l(...c)(s)]))}};return s}},IP={};q1(IP,{blur:()=>HH,clearContent:()=>zH,clearNodes:()=>VH,command:()=>GH,createParagraphNear:()=>WH,cut:()=>UH,deleteCurrentNode:()=>jH,deleteNode:()=>qH,deleteRange:()=>$H,deleteSelection:()=>KH,enter:()=>YH,exitCode:()=>XH,extendMarkRange:()=>JH,first:()=>QH,focus:()=>ez,forEach:()=>tz,insertContent:()=>iz,insertContentAt:()=>oz,joinBackward:()=>lz,joinDown:()=>az,joinForward:()=>cz,joinItemBackward:()=>dz,joinItemForward:()=>uz,joinTextblockBackward:()=>hz,joinTextblockForward:()=>pz,joinUp:()=>sz,keyboardShortcut:()=>gz,lift:()=>mz,liftEmptyBlock:()=>vz,liftListItem:()=>Cz,newlineInCode:()=>wz,resetAttributes:()=>bz,scrollIntoView:()=>yz,selectAll:()=>Sz,selectNodeBackward:()=>xz,selectNodeForward:()=>Ez,selectParentNode:()=>Rz,selectTextblockEnd:()=>Pz,selectTextblockStart:()=>kz,setContent:()=>_z,setMark:()=>Uz,setMeta:()=>jz,setNode:()=>qz,setNodeSelection:()=>$z,setTextDirection:()=>Kz,setTextSelection:()=>Yz,sinkListItem:()=>Xz,splitBlock:()=>Jz,splitListItem:()=>Qz,toggleList:()=>Zz,toggleMark:()=>eV,toggleNode:()=>tV,toggleWrap:()=>iV,undoInputRule:()=>nV,unsetAllMarks:()=>rV,unsetMark:()=>oV,unsetTextDirection:()=>sV,updateAttributes:()=>aV,wrapIn:()=>lV,wrapInList:()=>cV});var HH=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var i;e.isDestroyed||(t.dom.blur(),(i=window?.getSelection())==null||i.removeAllRanges())}),!0),zH=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),VH=()=>({state:e,tr:t,dispatch:i})=>{let{selection:n}=t,{ranges:r}=n;return i&&r.forEach(({$from:o,$to:s})=>{e.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;let{doc:c,mapping:d}=t,u=c.resolve(d.map(l)),h=c.resolve(d.map(l+a.nodeSize)),p=u.blockRange(h);if(!p)return;let f=Yr(p);if(a.type.isTextblock){let{defaultType:g}=u.parent.contentMatchAt(u.index());t.setNodeMarkup(p.start,g)}(f||f===0)&&t.lift(p,f)})}),!0},GH=e=>t=>e(t),WH=()=>({state:e,dispatch:t})=>t1(e,t),UH=(e,t)=>({editor:i,tr:n})=>{let{state:r}=i,o=r.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);let s=n.mapping.map(t);return n.insert(s,o.content),n.setSelection(new ke(n.doc.resolve(Math.max(s-1,0)))),!0},jH=()=>({tr:e,dispatch:t})=>{let{selection:i}=e,n=i.$anchor.node();if(n.content.size>0)return!1;let r=e.selection.$anchor;for(let o=r.depth;o>0;o-=1)if(r.node(o).type===n.type){if(t){let a=r.before(o),l=r.after(o);e.delete(a,l).scrollIntoView()}return!0}return!1};function Pt(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var qH=e=>({tr:t,state:i,dispatch:n})=>{let r=Pt(e,i.schema),o=t.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===r){if(n){let l=o.before(s),c=o.after(s);t.delete(l,c).scrollIntoView()}return!0}return!1},$H=e=>({tr:t,dispatch:i})=>{let{from:n,to:r}=e;return i&&t.delete(n,r),!0},KH=()=>({state:e,dispatch:t})=>nf(e,t),YH=()=>({commands:e})=>e.keyboardShortcut("Enter"),XH=()=>({state:e,dispatch:t})=>e1(e,t);function $1(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function xf(e,t,i={strict:!0}){let n=Object.keys(t);return n.length?n.every(r=>i.strict?t[r]===e[r]:$1(t[r])?t[r].test(e[r]):t[r]===e[r]):!0}function AP(e,t,i={}){return e.find(n=>n.type===t&&xf(Object.fromEntries(Object.keys(i).map(r=>[r,n.attrs[r]])),i))}function EP(e,t,i={}){return!!AP(e,t,i)}function K1(e,t,i){var n;if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if((!r.node||!r.node.marks.some(d=>d.type===t))&&(r=e.parent.childBefore(e.parentOffset)),!r.node||!r.node.marks.some(d=>d.type===t)||(i=i||((n=r.node.marks[0])==null?void 0:n.attrs),!AP([...r.node.marks],t,i)))return;let s=r.index,a=e.start()+r.offset,l=s+1,c=a+r.node.nodeSize;for(;s>0&&EP([...e.parent.child(s-1).marks],t,i);)s-=1,a-=e.parent.child(s).nodeSize;for(;l<e.parent.childCount&&EP([...e.parent.child(l).marks],t,i);)c+=e.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function to(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var JH=(e,t={})=>({tr:i,state:n,dispatch:r})=>{let o=to(e,n.schema),{doc:s,selection:a}=i,{$from:l,from:c,to:d}=a;if(r){let u=K1(l,o,t);if(u&&u.from<=c&&u.to>=d){let h=ke.create(s,u.from,u.to);i.setSelection(h)}}return!0},QH=e=>t=>{let i=typeof e=="function"?e(t):e;for(let n=0;n<i.length;n+=1)if(i[n](t))return!0;return!1};function OP(e){return e instanceof ke}function Zs(e=0,t=0,i=0){return Math.min(Math.max(e,t),i)}function LP(e,t=null){if(!t)return null;let i=Me.atStart(e),n=Me.atEnd(e);if(t==="start"||t===!0)return i;if(t==="end")return n;let r=i.from,o=n.to;return t==="all"?ke.create(e,Zs(0,r,o),Zs(e.content.size,r,o)):ke.create(e,Zs(t,r,o),Zs(t,r,o))}function ZH(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Y1(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var ez=(e=null,t={})=>({editor:i,view:n,tr:r,dispatch:o})=>{t=w({scrollIntoView:!0},t);let s=()=>{(Y1()||ZH())&&n.dom.focus(),requestAnimationFrame(()=>{i.isDestroyed||(n.focus(),t?.scrollIntoView&&i.commands.scrollIntoView())})};if(n.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!OP(i.state.selection))return s(),!0;let a=LP(r.doc,e)||i.state.selection,l=i.state.selection.eq(a);return o&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),s()),!0},tz=(e,t)=>i=>e.every((n,r)=>t(n,T(w({},i),{index:r}))),iz=(e,t)=>({tr:i,commands:n})=>n.insertContentAt({from:i.selection.from,to:i.selection.to},e,t),NP=e=>{let t=e.childNodes;for(let i=t.length-1;i>=0;i-=1){let n=t[i];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&NP(n)}return e};function Cf(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");let t=`<body>${e}</body>`,i=new window.DOMParser().parseFromString(t,"text/html").body;return NP(i)}function ru(e,t,i){if(e instanceof Hi||e instanceof ie)return e;i=w({slice:!0,parseOptions:{}},i);let n=typeof e=="object"&&e!==null,r=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return ie.fromArray(e.map(a=>t.nodeFromJSON(a)));let s=t.nodeFromJSON(e);return i.errorOnInvalidContent&&s.check(),s}catch(o){if(i.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),ru("",t,i)}if(r){if(i.errorOnInvalidContent){let s=!1,a="",l=new hl({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(i.slice?dr.fromSchema(l).parseSlice(Cf(e),i.parseOptions):dr.fromSchema(l).parse(Cf(e),i.parseOptions),i.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}let o=dr.fromSchema(t);return i.slice?o.parseSlice(Cf(e),i.parseOptions).content:o.parse(Cf(e),i.parseOptions)}return ru("",t,i)}function nz(e,t,i){let n=e.steps.length-1;if(n<t)return;let r=e.steps[n];if(!(r instanceof mi||r instanceof Nt))return;let o=e.mapping.maps[n],s=0;o.forEach((a,l,c,d)=>{s===0&&(s=d)}),e.setSelection(Me.near(e.doc.resolve(s),i))}var rz=e=>!("type"in e),oz=(e,t,i)=>({tr:n,dispatch:r,editor:o})=>{var s;if(r){i=w({parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1},i);let a,l=m=>{o.emit("contentError",{editor:o,error:m,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c=w({preserveWhitespace:"full"},i.parseOptions);if(!i.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{ru(t,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(m){l(m)}try{a=ru(t,o.schema,{parseOptions:c,errorOnInvalidContent:(s=i.errorOnInvalidContent)!=null?s:o.options.enableContentCheck})}catch(m){return l(m),!1}let{from:d,to:u}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},h=!0,p=!0;if((rz(a)?a:[a]).forEach(m=>{m.check(),h=h?m.isText&&m.marks.length===0:!1,p=p?m.isBlock:!1}),d===u&&p){let{parent:m}=n.doc.resolve(d);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(d-=1,u+=1)}let g;if(h){if(Array.isArray(t))g=t.map(m=>m.text||"").join("");else if(t instanceof ie){let m="";t.forEach(v=>{v.text&&(m+=v.text)}),g=m}else typeof t=="object"&&t&&t.text?g=t.text:g=t;n.insertText(g,d,u)}else{g=a;let m=n.doc.resolve(d),v=m.node(),C=m.parentOffset===0,b=v.isText||v.isTextblock,S=v.content.size>0;C&&b&&S&&(d=Math.max(0,d-1)),n.replaceWith(d,u,g)}i.updateSelection&&nz(n,n.steps.length-1,-1),i.applyInputRules&&n.setMeta("applyInputRules",{from:d,text:g}),i.applyPasteRules&&n.setMeta("applyPasteRules",{from:d,text:g})}return!0},sz=()=>({state:e,dispatch:t})=>iR(e,t),az=()=>({state:e,dispatch:t})=>nR(e,t),lz=()=>({state:e,dispatch:t})=>qC(e,t),cz=()=>({state:e,dispatch:t})=>YC(e,t),dz=()=>({state:e,dispatch:t,tr:i})=>{try{let n=Ws(e.doc,e.selection.$from.pos,-1);return n==null?!1:(i.join(n,2),t&&t(i),!0)}catch{return!1}},uz=()=>({state:e,dispatch:t,tr:i})=>{try{let n=Ws(e.doc,e.selection.$from.pos,1);return n==null?!1:(i.join(n,2),t&&t(i),!0)}catch{return!1}},hz=()=>({state:e,dispatch:t})=>Q5(e,t),pz=()=>({state:e,dispatch:t})=>Z5(e,t);function BP(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function fz(e){let t=e.split(/-(?!$)/),i=t[t.length-1];i==="Space"&&(i=" ");let n,r,o,s;for(let a=0;a<t.length-1;a+=1){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Y1()||BP()?s=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(i=`Alt-${i}`),r&&(i=`Ctrl-${i}`),s&&(i=`Meta-${i}`),o&&(i=`Shift-${i}`),i}var gz=e=>({editor:t,view:i,tr:n,dispatch:r})=>{let o=fz(e).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{i.someProp("handleKeyDown",c=>c(i,a))});return l?.steps.forEach(c=>{let d=c.map(n.mapping);d&&r&&n.maybeStep(d)}),!0};function pr(e,t,i={}){let{from:n,to:r,empty:o}=e.selection,s=t?Pt(t,e.schema):null,a=[];e.doc.nodesBetween(n,r,(u,h)=>{if(u.isText)return;let p=Math.max(n,h),f=Math.min(r,h+u.nodeSize);a.push({node:u,from:p,to:f})});let l=r-n,c=a.filter(u=>s?s.name===u.node.type.name:!0).filter(u=>xf(u.node.attrs,i,{strict:!1}));return o?!!c.length:c.reduce((u,h)=>u+h.to-h.from,0)>=l}var mz=(e,t={})=>({state:i,dispatch:n})=>{let r=Pt(e,i.schema);return pr(i,r,t)?rR(i,n):!1},vz=()=>({state:e,dispatch:t})=>i1(e,t),Cz=e=>({state:t,dispatch:i})=>{let n=Pt(e,t.schema);return dR(n)(t,i)},wz=()=>({state:e,dispatch:t})=>QC(e,t);function kf(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function RP(e,t){let i=typeof t=="string"?[t]:t;return Object.keys(e).reduce((n,r)=>(i.includes(r)||(n[r]=e[r]),n),{})}var bz=(e,t)=>({tr:i,state:n,dispatch:r})=>{let o=null,s=null,a=kf(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(o=Pt(e,n.schema)),a==="mark"&&(s=to(e,n.schema));let l=!1;return i.selection.ranges.forEach(c=>{n.doc.nodesBetween(c.$from.pos,c.$to.pos,(d,u)=>{o&&o===d.type&&(l=!0,r&&i.setNodeMarkup(u,void 0,RP(d.attrs,t))),s&&d.marks.length&&d.marks.forEach(h=>{s===h.type&&(l=!0,r&&i.addMark(u,u+d.nodeSize,s.create(RP(h.attrs,t))))})})}),l},yz=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),Sz=()=>({tr:e,dispatch:t})=>{if(t){let i=new Fi(e.doc);e.setSelection(i)}return!0},xz=()=>({state:e,dispatch:t})=>$C(e,t),Ez=()=>({state:e,dispatch:t})=>XC(e,t),Rz=()=>({state:e,dispatch:t})=>oR(e,t),Pz=()=>({state:e,dispatch:t})=>r1(e,t),kz=()=>({state:e,dispatch:t})=>n1(e,t);function W1(e,t,i={},n={}){return ru(e,t,{slice:!1,parseOptions:i,errorOnInvalidContent:n.errorOnInvalidContent})}var _z=(e,{errorOnInvalidContent:t,emitUpdate:i=!0,parseOptions:n={}}={})=>({editor:r,tr:o,dispatch:s,commands:a})=>{let{doc:l}=o;if(n.preserveWhitespace!=="full"){let c=W1(e,r.schema,n,{errorOnInvalidContent:t??r.options.enableContentCheck});return s&&o.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!i),!0}return s&&o.setMeta("preventUpdate",!i),a.insertContentAt({from:0,to:l.content.size},e,{parseOptions:n,errorOnInvalidContent:t??r.options.enableContentCheck})};function HP(e,t){let i=to(t,e.schema),{from:n,to:r,empty:o}=e.selection,s=[];o?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,r,l=>{s.push(...l.marks)});let a=s.find(l=>l.type.name===i.name);return a?w({},a.attrs):{}}function X1(e,t){let i=new gl(e);return t.forEach(n=>{n.steps.forEach(r=>{i.step(r)})}),i}function Dz(e){for(let t=0;t<e.edgeCount;t+=1){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}function zP(e,t,i){let n=[];return e.nodesBetween(t.from,t.to,(r,o)=>{i(r)&&n.push({node:r,pos:o})}),n}function Fz(e,t){for(let i=e.depth;i>0;i-=1){let n=e.node(i);if(t(n))return{pos:i>0?e.before(i):0,start:e.start(i),depth:i,node:n}}}function _f(e){return t=>Fz(t.$from,e)}function Pe(e,t,i){return e.config[t]===void 0&&e.parent?Pe(e.parent,t,i):typeof e.config[t]=="function"?e.config[t].bind(T(w({},i),{parent:e.parent?Pe(e.parent,t,i):null})):e.config[t]}function J1(e){return e.map(t=>{let i={name:t.name,options:t.options,storage:t.storage},n=Pe(t,"addExtensions",i);return n?[t,...J1(n())]:t}).flat(10)}function Q1(e,t){let i=qr.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(i),r.innerHTML}function VP(e){return typeof e=="function"}function rt(e,t=void 0,...i){return VP(e)?t?e.bind(t)(...i):e(...i):e}function Mz(e={}){return Object.keys(e).length===0&&e.constructor===Object}function kl(e){let t=e.filter(r=>r.type==="extension"),i=e.filter(r=>r.type==="node"),n=e.filter(r=>r.type==="mark");return{baseExtensions:t,nodeExtensions:i,markExtensions:n}}function GP(e){let t=[],{nodeExtensions:i,markExtensions:n}=kl(e),r=[...i,...n],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(s=>{let a={name:s.name,options:s.options,storage:s.storage,extensions:r},l=Pe(s,"addGlobalAttributes",a);if(!l)return;l().forEach(d=>{d.types.forEach(u=>{Object.entries(d.attributes).forEach(([h,p])=>{t.push({type:u,name:h,attribute:w(w({},o),p)})})})})}),r.forEach(s=>{let a={name:s.name,options:s.options,storage:s.storage},l=Pe(s,"addAttributes",a);if(!l)return;let c=l();Object.entries(c).forEach(([d,u])=>{let h=w(w({},o),u);typeof h?.default=="function"&&(h.default=h.default()),h?.isRequired&&h?.default===void 0&&delete h.default,t.push({type:s.name,name:d,attribute:h})})}),t}function We(...e){return e.filter(t=>!!t).reduce((t,i)=>{let n=w({},t);return Object.entries(i).forEach(([r,o])=>{if(!n[r]){n[r]=o;return}if(r==="class"){let a=o?String(o).split(" "):[],l=n[r]?n[r].split(" "):[],c=a.filter(d=>!l.includes(d));n[r]=[...l,...c].join(" ")}else if(r==="style"){let a=o?o.split(";").map(d=>d.trim()).filter(Boolean):[],l=n[r]?n[r].split(";").map(d=>d.trim()).filter(Boolean):[],c=new Map;l.forEach(d=>{let[u,h]=d.split(":").map(p=>p.trim());c.set(u,h)}),a.forEach(d=>{let[u,h]=d.split(":").map(p=>p.trim());c.set(u,h)}),n[r]=Array.from(c.entries()).map(([d,u])=>`${d}: ${u}`).join("; ")}else n[r]=o}),n},{})}function Ef(e,t){return t.filter(i=>i.type===e.type.name).filter(i=>i.attribute.rendered).map(i=>i.attribute.renderHTML?i.attribute.renderHTML(e.attrs)||{}:{[i.name]:e.attrs[i.name]}).reduce((i,n)=>We(i,n),{})}function Tz(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function PP(e,t){return"style"in e?e:T(w({},e),{getAttrs:i=>{let n=e.getAttrs?e.getAttrs(i):e.attrs;if(n===!1)return!1;let r=t.reduce((o,s)=>{let a=s.attribute.parseHTML?s.attribute.parseHTML(i):Tz(i.getAttribute(s.name));return a==null?o:T(w({},o),{[s.name]:a})},{});return w(w({},n),r)}})}function kP(e){return Object.fromEntries(Object.entries(e).filter(([t,i])=>t==="attrs"&&Mz(i)?!1:i!=null))}function _P(e){var t,i;let n={};return!((t=e?.attribute)!=null&&t.isRequired)&&"default"in(e?.attribute||{})&&(n.default=e.attribute.default),((i=e?.attribute)==null?void 0:i.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function Iz(e,t){var i;let n=GP(e),{nodeExtensions:r,markExtensions:o}=kl(e),s=(i=r.find(c=>Pe(c,"topNode")))==null?void 0:i.name,a=Object.fromEntries(r.map(c=>{let d=n.filter(v=>v.type===c.name),u={name:c.name,options:c.options,storage:c.storage,editor:t},h=e.reduce((v,C)=>{let b=Pe(C,"extendNodeSchema",u);return w(w({},v),b?b(c):{})},{}),p=kP(T(w({},h),{content:rt(Pe(c,"content",u)),marks:rt(Pe(c,"marks",u)),group:rt(Pe(c,"group",u)),inline:rt(Pe(c,"inline",u)),atom:rt(Pe(c,"atom",u)),selectable:rt(Pe(c,"selectable",u)),draggable:rt(Pe(c,"draggable",u)),code:rt(Pe(c,"code",u)),whitespace:rt(Pe(c,"whitespace",u)),linebreakReplacement:rt(Pe(c,"linebreakReplacement",u)),defining:rt(Pe(c,"defining",u)),isolating:rt(Pe(c,"isolating",u)),attrs:Object.fromEntries(d.map(_P))})),f=rt(Pe(c,"parseHTML",u));f&&(p.parseDOM=f.map(v=>PP(v,d)));let g=Pe(c,"renderHTML",u);g&&(p.toDOM=v=>g({node:v,HTMLAttributes:Ef(v,d)}));let m=Pe(c,"renderText",u);return m&&(p.toText=m),[c.name,p]})),l=Object.fromEntries(o.map(c=>{let d=n.filter(m=>m.type===c.name),u={name:c.name,options:c.options,storage:c.storage,editor:t},h=e.reduce((m,v)=>{let C=Pe(v,"extendMarkSchema",u);return w(w({},m),C?C(c):{})},{}),p=kP(T(w({},h),{inclusive:rt(Pe(c,"inclusive",u)),excludes:rt(Pe(c,"excludes",u)),group:rt(Pe(c,"group",u)),spanning:rt(Pe(c,"spanning",u)),code:rt(Pe(c,"code",u)),attrs:Object.fromEntries(d.map(_P))})),f=rt(Pe(c,"parseHTML",u));f&&(p.parseDOM=f.map(m=>PP(m,d)));let g=Pe(c,"renderHTML",u);return g&&(p.toDOM=m=>g({mark:m,HTMLAttributes:Ef(m,d)})),[c.name,p]}));return new hl({topNode:s,nodes:a,marks:l})}function Az(e){let t=e.filter((i,n)=>e.indexOf(i)!==n);return Array.from(new Set(t))}function U1(e){return e.sort((i,n)=>{let r=Pe(i,"priority")||100,o=Pe(n,"priority")||100;return r>o?-1:r<o?1:0})}function DP(e){let t=U1(J1(e)),i=Az(t.map(n=>n.name));return i.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${i.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),t}function WP(e,t,i){let{from:n,to:r}=t,{blockSeparator:o=`

`,textSerializers:s={}}=i||{},a="";return e.nodesBetween(n,r,(l,c,d,u)=>{var h;l.isBlock&&c>n&&(a+=o);let p=s?.[l.type.name];if(p)return d&&(a+=p({node:l,pos:c,parent:d,index:u,range:t})),!1;l.isText&&(a+=(h=l?.text)==null?void 0:h.slice(Math.max(n,c)-c,r-c))}),a}function Oz(e,t){let i={from:0,to:e.content.size};return WP(e,i,t)}function UP(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,i])=>[t,i.spec.toText]))}function Lz(e,t){let i=Pt(t,e.schema),{from:n,to:r}=e.selection,o=[];e.doc.nodesBetween(n,r,a=>{o.push(a)});let s=o.reverse().find(a=>a.type.name===i.name);return s?w({},s.attrs):{}}function Z1(e,t){let i=kf(typeof t=="string"?t:t.name,e.schema);return i==="node"?Lz(e,t):i==="mark"?HP(e,t):{}}function Nz(e,t=JSON.stringify){let i={};return e.filter(n=>{let r=t(n);return Object.prototype.hasOwnProperty.call(i,r)?!1:i[r]=!0})}function Bz(e){let t=Nz(e);return t.length===1?t:t.filter((i,n)=>!t.filter((o,s)=>s!==n).some(o=>i.oldRange.from>=o.oldRange.from&&i.oldRange.to<=o.oldRange.to&&i.newRange.from>=o.newRange.from&&i.newRange.to<=o.newRange.to))}function ew(e){let{mapping:t,steps:i}=e,n=[];return t.maps.forEach((r,o)=>{let s=[];if(r.ranges.length)r.forEach((a,l)=>{s.push({from:a,to:l})});else{let{from:a,to:l}=i[o];if(a===void 0||l===void 0)return;s.push({from:a,to:l})}s.forEach(({from:a,to:l})=>{let c=t.slice(o).map(a,-1),d=t.slice(o).map(l),u=t.invert().map(c,-1),h=t.invert().map(d);n.push({oldRange:{from:u,to:h},newRange:{from:c,to:d}})})}),Bz(n)}function Df(e,t,i){let n=[];return e===t?i.resolve(e).marks().forEach(r=>{let o=i.resolve(e),s=K1(o,r.type);s&&n.push(w({mark:r},s))}):i.nodesBetween(e,t,(r,o)=>{!r||r?.nodeSize===void 0||n.push(...r.marks.map(s=>({from:o,to:o+r.nodeSize,mark:s})))}),n}var jP=(e,t,i,n=20)=>{let r=e.doc.resolve(i),o=n,s=null;for(;o>0&&s===null;){let a=r.node(o);a?.type.name===t?s=a:o-=1}return[s,o]};function z1(e,t){return t.nodes[e]||t.marks[e]||null}function Sf(e,t,i){return Object.fromEntries(Object.entries(i).filter(([n])=>{let r=e.find(o=>o.type===t&&o.name===n);return r?r.attribute.keepOnSplit:!1}))}var Hz=(e,t=500)=>{let i="",n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,(r,o,s,a)=>{var l,c;let d=((c=(l=r.type.spec).toText)==null?void 0:c.call(l,{node:r,pos:o,parent:s,index:a}))||r.textContent||"%leaf%";i+=r.isAtom&&!r.isText?d:d.slice(0,Math.max(0,n-o))}),i};function j1(e,t,i={}){let{empty:n,ranges:r}=e.selection,o=t?to(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(u=>o?o.name===u.type.name:!0).find(u=>xf(u.attrs,i,{strict:!1}));let s=0,a=[];if(r.forEach(({$from:u,$to:h})=>{let p=u.pos,f=h.pos;e.doc.nodesBetween(p,f,(g,m)=>{if(!g.isText&&!g.marks.length)return;let v=Math.max(p,m),C=Math.min(f,m+g.nodeSize),b=C-v;s+=b,a.push(...g.marks.map(S=>({mark:S,from:v,to:C})))})}),s===0)return!1;let l=a.filter(u=>o?o.name===u.mark.type.name:!0).filter(u=>xf(u.mark.attrs,i,{strict:!1})).reduce((u,h)=>u+h.to-h.from,0),c=a.filter(u=>o?u.mark.type!==o&&u.mark.type.excludes(o):!0).reduce((u,h)=>u+h.to-h.from,0);return(l>0?l+c:l)>=s}function zz(e,t,i={}){if(!t)return pr(e,null,i)||j1(e,null,i);let n=kf(t,e.schema);return n==="node"?pr(e,t,i):n==="mark"?j1(e,t,i):!1}var qP=(e,t)=>{let{$from:i,$to:n,$anchor:r}=e.selection;if(t){let o=_f(a=>a.type.name===t)(e.selection);if(!o)return!1;let s=e.doc.resolve(o.pos+1);return r.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||i.pos!==n.pos)},$P=e=>{let{$from:t,$to:i}=e.selection;return!(t.parentOffset>0||t.pos!==i.pos)};function FP(e,t){return Array.isArray(t)?t.some(i=>(typeof i=="string"?i:i.name)===e.name):t}function MP(e,t){let{nodeExtensions:i}=kl(t),n=i.find(s=>s.name===e);if(!n)return!1;let r={name:n.name,options:n.options,storage:n.storage},o=rt(Pe(n,"group",r));return typeof o!="string"?!1:o.split(" ").includes("list")}function ou(e,{checkChildren:t=!0,ignoreWhitespace:i=!1}={}){var n;if(i){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let r=!0;return e.content.forEach(o=>{r!==!1&&(ou(o,{ignoreWhitespace:i,checkChildren:t})||(r=!1))}),r}return!1}function Ff(e){return e instanceof Re}var KP=class YP{constructor(t){this.position=t}static fromJSON(t){return new YP(t.position)}toJSON(){return{position:this.position}}};function Vz(e,t){let i=t.mapping.mapResult(e.position);return{position:new KP(i.pos),mapResult:i}}function Gz(e){return new KP(e)}function Wz(e,t,i){var n;let{selection:r}=t,o=null;if(OP(r)&&(o=r.$cursor),o){let a=(n=e.storedMarks)!=null?n:o.marks();return o.parent.type.allowsMarkType(i)&&(!!i.isInSet(a)||!a.some(c=>c.type.excludes(i)))}let{ranges:s}=r;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(i):!1;return e.doc.nodesBetween(a.pos,l.pos,(d,u,h)=>{if(c)return!1;if(d.isInline){let p=!h||h.type.allowsMarkType(i),f=!!i.isInSet(d.marks)||!d.marks.some(g=>g.type.excludes(i));c=p&&f}return!c}),c})}var Uz=(e,t={})=>({tr:i,state:n,dispatch:r})=>{let{selection:o}=i,{empty:s,ranges:a}=o,l=to(e,n.schema);if(r)if(s){let c=HP(n,l);i.addStoredMark(l.create(w(w({},c),t)))}else a.forEach(c=>{let d=c.$from.pos,u=c.$to.pos;n.doc.nodesBetween(d,u,(h,p)=>{let f=Math.max(p,d),g=Math.min(p+h.nodeSize,u);h.marks.find(v=>v.type===l)?h.marks.forEach(v=>{l===v.type&&i.addMark(f,g,l.create(w(w({},v.attrs),t)))}):i.addMark(f,g,l.create(t))})});return Wz(n,i,l)},jz=(e,t)=>({tr:i})=>(i.setMeta(e,t),!0),qz=(e,t={})=>({state:i,dispatch:n,chain:r})=>{let o=Pt(e,i.schema),s;return i.selection.$anchor.sameParent(i.selection.$head)&&(s=i.selection.$anchor.parent.attrs),o.isTextblock?r().command(({commands:a})=>o1(o,w(w({},s),t))(i)?!0:a.clearNodes()).command(({state:a})=>o1(o,w(w({},s),t))(a,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},$z=e=>({tr:t,dispatch:i})=>{if(i){let{doc:n}=t,r=Zs(e,0,n.content.size),o=Re.create(n,r);t.setSelection(o)}return!0},Kz=(e,t)=>({tr:i,state:n,dispatch:r})=>{let{selection:o}=n,s,a;return typeof t=="number"?(s=t,a=t):t&&"from"in t&&"to"in t?(s=t.from,a=t.to):(s=o.from,a=o.to),r&&i.doc.nodesBetween(s,a,(l,c)=>{l.isText||i.setNodeMarkup(c,void 0,T(w({},l.attrs),{dir:e}))}),!0},Yz=e=>({tr:t,dispatch:i})=>{if(i){let{doc:n}=t,{from:r,to:o}=typeof e=="number"?{from:e,to:e}:e,s=ke.atStart(n).from,a=ke.atEnd(n).to,l=Zs(r,s,a),c=Zs(o,s,a),d=ke.create(n,l,c);t.setSelection(d)}return!0},Xz=e=>({state:t,dispatch:i})=>{let n=Pt(e,t.schema);return uR(n)(t,i)};function TP(e,t){let i=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(i){let n=i.filter(r=>t?.includes(r.type.name));e.tr.ensureMarks(n)}}var Jz=({keepMarks:e=!0}={})=>({tr:t,state:i,dispatch:n,editor:r})=>{let{selection:o,doc:s}=t,{$from:a,$to:l}=o,c=r.extensionManager.attributes,d=Sf(c,a.node().type.name,a.node().attrs);if(o instanceof Re&&o.node.isBlock)return!a.parentOffset||!nn(s,a.pos)?!1:(n&&(e&&TP(i,r.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let u=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:Dz(a.node(-1).contentMatchAt(a.indexAfter(-1))),p=u&&h?[{type:h,attrs:d}]:void 0,f=nn(t.doc,t.mapping.map(a.pos),1,p);if(!p&&!f&&nn(t.doc,t.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(f=!0,p=h?[{type:h,attrs:d}]:void 0),n){if(f&&(o instanceof ke&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,p),h&&!u&&!a.parentOffset&&a.parent.type!==h)){let g=t.mapping.map(a.before()),m=t.doc.resolve(g);a.node(-1).canReplaceWith(m.index(),m.index()+1,h)&&t.setNodeMarkup(t.mapping.map(a.before()),h)}e&&TP(i,r.extensionManager.splittableMarks),t.scrollIntoView()}return f},Qz=(e,t={})=>({tr:i,state:n,dispatch:r,editor:o})=>{var s;let a=Pt(e,n.schema),{$from:l,$to:c}=n.selection,d=n.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(c))return!1;let u=l.node(-1);if(u.type!==a)return!1;let h=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let v=ie.empty,C=l.index(-1)?1:l.index(-2)?2:3;for(let F=l.depth-C;F>=l.depth-3;F-=1)v=ie.from(l.node(F).copy(v));let b=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,S=w(w({},Sf(h,l.node().type.name,l.node().attrs)),t),E=((s=a.contentMatch.defaultType)==null?void 0:s.createAndFill(S))||void 0;v=v.append(ie.from(a.createAndFill(null,E)||void 0));let x=l.before(l.depth-(C-1));i.replace(x,l.after(-b),new we(v,4-C,0));let P=-1;i.doc.nodesBetween(x,i.doc.content.size,(F,N)=>{if(P>-1)return!1;F.isTextblock&&F.content.size===0&&(P=N+1)}),P>-1&&i.setSelection(ke.near(i.doc.resolve(P))),i.scrollIntoView()}return!0}let p=c.pos===l.end()?u.contentMatchAt(0).defaultType:null,f=w(w({},Sf(h,u.type.name,u.attrs)),t),g=w(w({},Sf(h,l.node().type.name,l.node().attrs)),t);i.delete(l.pos,c.pos);let m=p?[{type:a,attrs:f},{type:p,attrs:g}]:[{type:a,attrs:f}];if(!nn(i.doc,l.pos,2))return!1;if(r){let{selection:v,storedMarks:C}=n,{splittableMarks:b}=o.extensionManager,S=C||v.$to.parentOffset&&v.$from.marks();if(i.split(l.pos,2,m).scrollIntoView(),!S||!r)return!0;let E=S.filter(x=>b.includes(x.type.name));i.ensureMarks(E)}return!0},V1=(e,t)=>{let i=_f(s=>s.type===t)(e.selection);if(!i)return!0;let n=e.doc.resolve(Math.max(0,i.pos-1)).before(i.depth);if(n===void 0)return!0;let r=e.doc.nodeAt(n);return i.node.type===r?.type&&bn(e.doc,i.pos)&&e.join(i.pos),!0},G1=(e,t)=>{let i=_f(s=>s.type===t)(e.selection);if(!i)return!0;let n=e.doc.resolve(i.start).after(i.depth);if(n===void 0)return!0;let r=e.doc.nodeAt(n);return i.node.type===r?.type&&bn(e.doc,n)&&e.join(n),!0},Zz=(e,t,i,n={})=>({editor:r,tr:o,state:s,dispatch:a,chain:l,commands:c,can:d})=>{let{extensions:u,splittableMarks:h}=r.extensionManager,p=Pt(e,s.schema),f=Pt(t,s.schema),{selection:g,storedMarks:m}=s,{$from:v,$to:C}=g,b=v.blockRange(C),S=m||g.$to.parentOffset&&g.$from.marks();if(!b)return!1;let E=_f(x=>MP(x.type.name,u))(g);if(b.depth>=1&&E&&b.depth-E.depth<=1){if(E.node.type===p)return c.liftListItem(f);if(MP(E.node.type.name,u)&&p.validContent(E.node.content)&&a)return l().command(()=>(o.setNodeMarkup(E.pos,p),!0)).command(()=>V1(o,p)).command(()=>G1(o,p)).run()}return!i||!S||!a?l().command(()=>d().wrapInList(p,n)?!0:c.clearNodes()).wrapInList(p,n).command(()=>V1(o,p)).command(()=>G1(o,p)).run():l().command(()=>{let x=d().wrapInList(p,n),P=S.filter(F=>h.includes(F.type.name));return o.ensureMarks(P),x?!0:c.clearNodes()}).wrapInList(p,n).command(()=>V1(o,p)).command(()=>G1(o,p)).run()},eV=(e,t={},i={})=>({state:n,commands:r})=>{let{extendEmptyMarkRange:o=!1}=i,s=to(e,n.schema);return j1(n,s,t)?r.unsetMark(s,{extendEmptyMarkRange:o}):r.setMark(s,t)},tV=(e,t,i={})=>({state:n,commands:r})=>{let o=Pt(e,n.schema),s=Pt(t,n.schema),a=pr(n,o,i),l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),a?r.setNode(s,l):r.setNode(o,w(w({},l),i))},iV=(e,t={})=>({state:i,commands:n})=>{let r=Pt(e,i.schema);return pr(i,r,t)?n.lift(r):n.wrapIn(r,t)},nV=()=>({state:e,dispatch:t})=>{let i=e.plugins;for(let n=0;n<i.length;n+=1){let r=i[n],o;if(r.spec.isInputRules&&(o=r.getState(e))){if(t){let s=e.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){let l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,e.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},rV=()=>({tr:e,dispatch:t})=>{let{selection:i}=e,{empty:n,ranges:r}=i;return n||t&&r.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},oV=(e,t={})=>({tr:i,state:n,dispatch:r})=>{var o;let{extendEmptyMarkRange:s=!1}=t,{selection:a}=i,l=to(e,n.schema),{$from:c,empty:d,ranges:u}=a;if(!r)return!0;if(d&&s){let{from:h,to:p}=a,f=(o=c.marks().find(m=>m.type===l))==null?void 0:o.attrs,g=K1(c,l,f);g&&(h=g.from,p=g.to),i.removeMark(h,p,l)}else u.forEach(h=>{i.removeMark(h.$from.pos,h.$to.pos,l)});return i.removeStoredMark(l),!0},sV=e=>({tr:t,state:i,dispatch:n})=>{let{selection:r}=i,o,s;return typeof e=="number"?(o=e,s=e):e&&"from"in e&&"to"in e?(o=e.from,s=e.to):(o=r.from,s=r.to),n&&t.doc.nodesBetween(o,s,(a,l)=>{if(a.isText)return;let c=w({},a.attrs);delete c.dir,t.setNodeMarkup(l,void 0,c)}),!0},aV=(e,t={})=>({tr:i,state:n,dispatch:r})=>{let o=null,s=null,a=kf(typeof e=="string"?e:e.name,n.schema);if(!a)return!1;a==="node"&&(o=Pt(e,n.schema)),a==="mark"&&(s=to(e,n.schema));let l=!1;return i.selection.ranges.forEach(c=>{let d=c.$from.pos,u=c.$to.pos,h,p,f,g;i.selection.empty?n.doc.nodesBetween(d,u,(m,v)=>{o&&o===m.type&&(l=!0,f=Math.max(v,d),g=Math.min(v+m.nodeSize,u),h=v,p=m)}):n.doc.nodesBetween(d,u,(m,v)=>{v<d&&o&&o===m.type&&(l=!0,f=Math.max(v,d),g=Math.min(v+m.nodeSize,u),h=v,p=m),v>=d&&v<=u&&(o&&o===m.type&&(l=!0,r&&i.setNodeMarkup(v,void 0,w(w({},m.attrs),t))),s&&m.marks.length&&m.marks.forEach(C=>{if(s===C.type&&(l=!0,r)){let b=Math.max(v,d),S=Math.min(v+m.nodeSize,u);i.addMark(b,S,s.create(w(w({},C.attrs),t)))}}))}),p&&(h!==void 0&&r&&i.setNodeMarkup(h,void 0,w(w({},p.attrs),t)),s&&p.marks.length&&p.marks.forEach(m=>{s===m.type&&r&&i.addMark(f,g,s.create(w(w({},m.attrs),t)))}))}),l},lV=(e,t={})=>({state:i,dispatch:n})=>{let r=Pt(e,i.schema);return lR(r,t)(i,n)},cV=(e,t={})=>({state:i,dispatch:n})=>{let r=Pt(e,i.schema);return cR(r,t)(i,n)},dV=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let i=this.callbacks[e];return i&&i.forEach(n=>n.apply(this,t)),this}off(e,t){let i=this.callbacks[e];return i&&(t?this.callbacks[e]=i.filter(n=>n!==t):delete this.callbacks[e]),this}once(e,t){let i=(...n)=>{this.off(e,i),t.apply(this,n)};return this.on(e,i)}removeAllListeners(){this.callbacks={}}},Mf=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=(t=e.undoable)!=null?t:!0}},uV=(e,t)=>{if($1(t))return t.exec(e);let i=t(e);if(!i)return null;let n=[i.text];return n.index=i.index,n.input=e,n.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(i.replaceWith)),n};function wf(e){var t;let{editor:i,from:n,to:r,text:o,rules:s,plugin:a}=e,{view:l}=i;if(l.composing)return!1;let c=l.state.doc.resolve(n);if(c.parent.type.spec.code||(t=c.nodeBefore||c.nodeAfter)!=null&&t.marks.find(h=>h.type.spec.code))return!1;let d=!1,u=Hz(c)+o;return s.forEach(h=>{if(d)return;let p=uV(u,h.find);if(!p)return;let f=l.state.tr,g=Rf({state:l.state,transaction:f}),m={from:n-(p[0].length-o.length),to:r},{commands:v,chain:C,can:b}=new Pf({editor:i,state:g});h.handler({state:g,range:m,match:p,commands:v,chain:C,can:b})===null||!f.steps.length||(h.undoable&&f.setMeta(a,{transform:f,from:n,to:r,text:o}),l.dispatch(f),d=!0)}),d}function hV(e){let{editor:t,rules:i}=e,n=new Te({state:{init(){return null},apply(r,o,s){let a=r.getMeta(n);if(a)return a;let l=r.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:d}=l;typeof d=="string"?d=d:d=Q1(ie.from(d),s.schema);let{from:u}=l,h=u+d.length;wf({editor:t,from:u,to:h,text:d,rules:i,plugin:n})}),r.selectionSet||r.docChanged?null:o}},props:{handleTextInput(r,o,s,a){return wf({editor:t,from:o,to:s,text:a,rules:i,plugin:n})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{let{$cursor:o}=r.state.selection;o&&wf({editor:t,from:o.pos,to:o.pos,text:"",rules:i,plugin:n})}),!1)},handleKeyDown(r,o){if(o.key!=="Enter")return!1;let{$cursor:s}=r.state.selection;return s?wf({editor:t,from:s.pos,to:s.pos,text:`
`,rules:i,plugin:n}):!1}},isInputRules:!0});return n}function pV(e){return Object.prototype.toString.call(e).slice(8,-1)}function bf(e){return pV(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function XP(e,t){let i=w({},e);return bf(e)&&bf(t)&&Object.keys(t).forEach(n=>{bf(t[n])&&bf(e[n])?i[n]=XP(e[n],t[n]):i[n]=t[n]}),i}var tw=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config=w(w({},this.config),e),this.name=this.config.name}get options(){return w({},rt(Pe(this,"addOptions",{name:this.name}))||{})}get storage(){return w({},rt(Pe(this,"addStorage",{name:this.name,options:this.options}))||{})}configure(e={}){let t=this.extend(T(w({},this.config),{addOptions:()=>XP(this.options,e)}));return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new this.constructor(w(w({},this.config),e));return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},rn=class JP extends tw{constructor(){super(...arguments),this.type="mark"}static create(t={}){let i=typeof t=="function"?t():t;return new JP(i)}static handleExit({editor:t,mark:i}){let{tr:n}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){let s=r.marks();if(!!!s.find(c=>c?.type.name===i.name))return!1;let l=s.find(c=>c?.type.name===i.name);return l&&n.removeStoredMark(l),n.insertText(" ",r.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}};function fV(e){return typeof e=="number"}var gV=class{constructor(e){this.find=e.find,this.handler=e.handler}},mV=(e,t,i)=>{if($1(t))return[...e.matchAll(t)];let n=t(e,i);return n?n.map(r=>{let o=[r.text];return o.index=r.index,o.input=e,o.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(r.replaceWith)),o}):[]};function vV(e){let{editor:t,state:i,from:n,to:r,rule:o,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:c,can:d}=new Pf({editor:t,state:i}),u=[];return i.doc.nodesBetween(n,r,(p,f)=>{var g,m,v,C,b;if((m=(g=p.type)==null?void 0:g.spec)!=null&&m.code||!(p.isText||p.isTextblock||p.isInline))return;let S=(b=(C=(v=p.content)==null?void 0:v.size)!=null?C:p.nodeSize)!=null?b:0,E=Math.max(n,f),x=Math.min(r,f+S);if(E>=x)return;let P=p.isText?p.text||"":p.textBetween(E-f,x-f,void 0,"\uFFFC");mV(P,o.find,s).forEach(N=>{if(N.index===void 0)return;let Y=E+N.index+1,X=Y+N[0].length,Z={from:i.tr.mapping.map(Y),to:i.tr.mapping.map(X)},me=o.handler({state:i,range:Z,match:N,commands:l,chain:c,can:d,pasteEvent:s,dropEvent:a});u.push(me)})}),u.every(p=>p!==null)}var yf=null,CV=e=>{var t;let i=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=i.clipboardData)==null||t.setData("text/html",e),i};function wV(e){let{editor:t,rules:i}=e,n=null,r=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}let l=({state:d,from:u,to:h,rule:p,pasteEvt:f})=>{let g=d.tr,m=Rf({state:d,transaction:g});if(!(!vV({editor:t,state:m,from:Math.max(u-1,0),to:h.b-1,rule:p,pasteEvent:f,dropEvent:a})||!g.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}};return i.map(d=>new Te({view(u){let h=f=>{var g;n=(g=u.dom.parentElement)!=null&&g.contains(f.target)?u.dom.parentElement:null,n&&(yf=t)},p=()=>{yf&&(yf=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(u,h)=>{if(o=n===u.dom.parentElement,a=h,!o){let p=yf;p?.isEditable&&setTimeout(()=>{let f=p.state.selection;f&&p.commands.deleteRange({from:f.from,to:f.to})},10)}return!1},paste:(u,h)=>{var p;let f=(p=h.clipboardData)==null?void 0:p.getData("text/html");return s=h,r=!!f?.includes("data-pm-slice"),!1}}},appendTransaction:(u,h,p)=>{let f=u[0],g=f.getMeta("uiEvent")==="paste"&&!r,m=f.getMeta("uiEvent")==="drop"&&!o,v=f.getMeta("applyPasteRules"),C=!!v;if(!g&&!m&&!C)return;if(C){let{text:E}=v;typeof E=="string"?E=E:E=Q1(ie.from(E),p.schema);let{from:x}=v,P=x+E.length,F=CV(E);return l({rule:d,state:p,from:x,to:{b:P},pasteEvt:F})}let b=h.doc.content.findDiffStart(p.doc.content),S=h.doc.content.findDiffEnd(p.doc.content);if(!(!fV(b)||!S||b===S.b))return l({rule:d,state:p,from:b,to:S,pasteEvt:s})}}))}var bV=(()=>{let e=class{constructor(t,i){this.splittableMarks=[],this.editor=i,this.baseExtensions=t,this.extensions=DP(t),this.schema=Iz(this.extensions,i),this.setupExtensions()}get commands(){return this.extensions.reduce((t,i)=>{let n={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:z1(i.name,this.schema)},r=Pe(i,"addCommands",n);return r?w(w({},t),r()):t},{})}get plugins(){let{editor:t}=this;return U1([...this.extensions].reverse()).flatMap(r=>{let o={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:z1(r.name,this.schema)},s=[],a=Pe(r,"addKeyboardShortcuts",o),l={};if(r.type==="mark"&&Pe(r,"exitable",o)&&(l.ArrowRight=()=>rn.handleExit({editor:t,mark:r})),a){let p=Object.fromEntries(Object.entries(a()).map(([f,g])=>[f,()=>g({editor:t})]));l=w(w({},l),p)}let c=xP(l);s.push(c);let d=Pe(r,"addInputRules",o);if(FP(r,t.options.enableInputRules)&&d){let p=d();if(p&&p.length){let f=hV({editor:t,rules:p}),g=Array.isArray(f)?f:[f];s.push(...g)}}let u=Pe(r,"addPasteRules",o);if(FP(r,t.options.enablePasteRules)&&u){let p=u();if(p&&p.length){let f=wV({editor:t,rules:p});s.push(...f)}}let h=Pe(r,"addProseMirrorPlugins",o);if(h){let p=h();s.push(...p)}return s})}get attributes(){return GP(this.extensions)}get nodeViews(){let{editor:t}=this,{nodeExtensions:i}=kl(this.extensions);return Object.fromEntries(i.filter(n=>!!Pe(n,"addNodeView")).map(n=>{let r=this.attributes.filter(c=>c.type===n.name),o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Pt(n.name,this.schema)},s=Pe(n,"addNodeView",o);if(!s)return[];let a=s();if(!a)return[];let l=(c,d,u,h,p)=>{let f=Ef(c,r);return a({node:c,view:d,getPos:u,decorations:h,innerDecorations:p,editor:t,extension:n,HTMLAttributes:f})};return[n.name,l]}))}get markViews(){let{editor:t}=this,{markExtensions:i}=kl(this.extensions);return Object.fromEntries(i.filter(n=>!!Pe(n,"addMarkView")).map(n=>{let r=this.attributes.filter(l=>l.type===n.name),o={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:to(n.name,this.schema)},s=Pe(n,"addMarkView",o);if(!s)return[];let a=(l,c,d)=>{let u=Ef(l,r);return s()({mark:l,view:c,inline:d,editor:t,extension:n,HTMLAttributes:u,updateAttributes:h=>{MV(l,t,h)}})};return[n.name,a]}))}setupExtensions(){let t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(i=>[i.name,i.storage])),t.forEach(i=>{var n;let r={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:this.editor,type:z1(i.name,this.schema)};i.type==="mark"&&((n=rt(Pe(i,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(i.name);let o=Pe(i,"onBeforeCreate",r),s=Pe(i,"onCreate",r),a=Pe(i,"onUpdate",r),l=Pe(i,"onSelectionUpdate",r),c=Pe(i,"onTransaction",r),d=Pe(i,"onFocus",r),u=Pe(i,"onBlur",r),h=Pe(i,"onDestroy",r);o&&this.editor.on("beforeCreate",o),s&&this.editor.on("create",s),a&&this.editor.on("update",a),l&&this.editor.on("selectionUpdate",l),c&&this.editor.on("transaction",c),d&&this.editor.on("focus",d),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}};return e.resolve=DP,e.sort=U1,e.flatten=J1,e})(),yV={};q1(yV,{ClipboardTextSerializer:()=>ZP,Commands:()=>ek,Delete:()=>tk,Drop:()=>ik,Editable:()=>nk,FocusEvents:()=>ok,Keymap:()=>sk,Paste:()=>ak,Tabindex:()=>lk,TextDirection:()=>ck,focusEventsPluginKey:()=>rk});var Xe=class QP extends tw{constructor(){super(...arguments),this.type="extension"}static create(t={}){let i=typeof t=="function"?t():t;return new QP(i)}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}},ZP=Xe.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Te({key:new Be("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:i}=e,{doc:n,selection:r}=t,{ranges:o}=r,s=Math.min(...o.map(d=>d.$from.pos)),a=Math.max(...o.map(d=>d.$to.pos)),l=UP(i);return WP(n,{from:s,to:a},T(w({},this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{}),{textSerializers:l}))}}})]}}),ek=Xe.create({name:"commands",addCommands(){return w({},IP)}}),tk=Xe.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var i,n,r;let o=()=>{var s,a,l,c;if((c=(l=(a=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,e))!=null?c:e.getMeta("y-sync$"))return;let d=X1(e.before,[e,...t]);ew(d).forEach(p=>{d.mapping.mapResult(p.oldRange.from).deletedAfter&&d.mapping.mapResult(p.oldRange.to).deletedBefore&&d.before.nodesBetween(p.oldRange.from,p.oldRange.to,(f,g)=>{let m=g+f.nodeSize-2,v=p.oldRange.from<=g&&m<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:f,from:g,to:m,newFrom:d.mapping.map(g),newTo:d.mapping.map(m),deletedRange:p.oldRange,newRange:p.newRange,partial:!v,editor:this.editor,transaction:e,combinedTransform:d})})});let h=d.mapping;d.steps.forEach((p,f)=>{var g,m;if(p instanceof Kr){let v=h.slice(f).map(p.from,-1),C=h.slice(f).map(p.to),b=h.invert().map(v,-1),S=h.invert().map(C),E=(g=d.doc.nodeAt(v-1))==null?void 0:g.marks.some(P=>P.eq(p.mark)),x=(m=d.doc.nodeAt(C))==null?void 0:m.marks.some(P=>P.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:b,to:S},newRange:{from:v,to:C},partial:!!(x||E),editor:this.editor,transaction:e,combinedTransform:d})}})};(r=(n=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:n.async)==null||r?setTimeout(o,0):o()}}),ik=Xe.create({name:"drop",addProseMirrorPlugins(){return[new Te({key:new Be("tiptapDrop"),props:{handleDrop:(e,t,i,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:i,moved:n})}}})]}}),nk=Xe.create({name:"editable",addProseMirrorPlugins(){return[new Te({key:new Be("editable"),props:{editable:()=>this.editor.options.editable}})]}}),rk=new Be("focusEvents"),ok=Xe.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new Te({key:rk,props:{handleDOMEvents:{focus:(t,i)=>{e.isFocused=!0;let n=e.state.tr.setMeta("focus",{event:i}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,i)=>{e.isFocused=!1;let n=e.state.tr.setMeta("blur",{event:i}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),sk=Xe.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{let{selection:l,doc:c}=a,{empty:d,$anchor:u}=l,{pos:h,parent:p}=u,f=u.parent.isTextblock&&h>0?a.doc.resolve(h-1):u,g=f.parent.type.spec.isolating,m=u.pos-u.parentOffset,v=g&&f.parent.childCount===1?m===u.pos:Me.atStart(c).from===h;return!d||!p.type.isTextblock||p.textContent.length||!v||v&&u.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r=w({},n),o=T(w({},n),{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return Y1()||BP()?o:r},addProseMirrorPlugins(){return[new Te({key:new Be("clearDocument"),appendTransaction:(e,t,i)=>{if(e.some(g=>g.getMeta("composition")))return;let n=e.some(g=>g.docChanged)&&!t.doc.eq(i.doc),r=e.some(g=>g.getMeta("preventClearDocument"));if(!n||r)return;let{empty:o,from:s,to:a}=t.selection,l=Me.atStart(t.doc).from,c=Me.atEnd(t.doc).to;if(o||!(s===l&&a===c)||!ou(i.doc))return;let h=i.tr,p=Rf({state:i,transaction:h}),{commands:f}=new Pf({editor:this.editor,state:p});if(f.clearNodes(),!!h.steps.length)return h}})]}}),ak=Xe.create({name:"paste",addProseMirrorPlugins(){return[new Te({key:new Be("tiptapPaste"),props:{handlePaste:(e,t,i)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:i})}}})]}}),lk=Xe.create({name:"tabindex",addProseMirrorPlugins(){return[new Te({key:new Be("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),ck=Xe.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];let{nodeExtensions:e}=kl(this.extensions);return[{types:e.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{let i=t.getAttribute("dir");return i&&(i==="ltr"||i==="rtl"||i==="auto")?i:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new Te({key:new Be("textDirection"),props:{attributes:()=>{let e=this.options.direction;return e?{dir:e}:{}}}})]}}),SV=class Pl{constructor(t,i,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=i,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let i=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}i=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:i,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;let t=this.resolvedPos.start(this.resolvedPos.depth-1),i=this.resolvedPos.doc.resolve(t);return new Pl(i,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new Pl(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new Pl(t,this.editor)}get children(){let t=[];return this.node.content.forEach((i,n)=>{let r=i.isBlock&&!i.isTextblock,o=i.isAtom&&!i.isText,s=this.pos+n+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;let a=this.resolvedPos.doc.resolve(s);if(!r&&a.depth<=this.depth)return;let l=new Pl(a,this.editor,r,r?i:null);r&&(l.actualDepth=this.depth+1),t.push(new Pl(a,this.editor,r,r?i:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){let t=this.children;return t[t.length-1]||null}closest(t,i={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===t)if(Object.keys(i).length>0){let o=r.node.attrs,s=Object.keys(i);for(let a=0;a<s.length;a+=1){let l=s[a];if(o[l]!==i[l])break}}else n=r;r=r.parent}return n}querySelector(t,i={}){return this.querySelectorAll(t,i,!0)[0]||null}querySelectorAll(t,i={},n=!1){let r=[];if(!this.children||this.children.length===0)return r;let o=Object.keys(i);return this.children.forEach(s=>{n&&r.length>0||(s.node.type.name===t&&o.every(l=>i[l]===s.node.attrs[l])&&r.push(s),!(n&&r.length>0)&&(r=r.concat(s.querySelectorAll(t,i,n))))}),r}setAttribute(t){let{tr:i}=this.editor.state;i.setNodeMarkup(this.from,void 0,w(w({},this.node.attrs),t)),this.editor.view.dispatch(i)}},xV=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function EV(e,t,i){let n=document.querySelector(`style[data-tiptap-style${i?`-${i}`:""}]`);if(n!==null)return n;let r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute(`data-tiptap-style${i?`-${i}`:""}`,""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}var dk=class extends dV{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:Vz,createMappablePosition:Gz},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:o})=>this.options.onDrop(n,r,o)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),this.on("delete",this.options.onDelete);let t=this.createDoc(),i=LP(t,this.options.autofocus);this.editorState=tf.create({doc:t,schema:this.schema,selection:i||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){let e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=EV(xV,this.options.injectNonce))}setOptions(e={}){this.options=w(w({},this.options),e),!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){let i=VP(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;let t=this.state.plugins,i=t;if([].concat(e).forEach(r=>{let o=typeof r=="string"?`${r}$`:r.key;i=i.filter(s=>!s.key.startsWith(o))}),t.length===i.length)return;let n=this.state.reconfigure({plugins:i});return this.view.updateState(n),n}createExtensionManager(){var e,t;let n=[...this.options.enableCoreExtensions?[nk,ZP.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),ek,ok,sk,lk,ik,ak,tk,ck.configure({direction:this.options.textDirection})].filter(r=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[r.name]!==!1:!0):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r?.type));this.extensionManager=new bV(n,this)}createCommandManager(){this.commandManager=new Pf({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=W1(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),e=W1(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new tu(e,T(w({},this.options.editorProps),{attributes:w({role:"textbox"},(t=this.options.editorProps)==null?void 0:t.attributes),dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews}));let i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.prependClass(),this.injectCSS();let n=this.view.dom;n.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(c=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(c)});return}let{state:t,transactions:i}=this.state.applyTransaction(e),n=!this.state.selection.eq(t.selection),r=i.includes(e),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!r)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:i.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let s=i.findLast(c=>c.getMeta("focus")||c.getMeta("blur")),a=s?.getMeta("focus"),l=s?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(e.getMeta("preventUpdate")||!i.some(c=>c.docChanged)||o.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:i.slice(1)})}getAttributes(e){return Z1(this.state,e)}isActive(e,t){let i=typeof e=="string"?e:null,n=typeof e=="string"?t:e;return zz(this.state,i,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Q1(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t=`

`,textSerializers:i={}}=e||{};return Oz(this.state.doc,{blockSeparator:t,textSerializers:w(w({},UP(this.schema)),i)})}get isEmpty(){return ou(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var i;return((i=this.$doc)==null?void 0:i.querySelector(e,t))||null}$nodes(e,t){var i;return((i=this.$doc)==null?void 0:i.querySelectorAll(e,t))||null}$pos(e){let t=this.state.doc.resolve(e);return new SV(t,this)}get $doc(){return this.$pos(0)}};function fr(e){return new Mf({find:e.find,handler:({state:t,range:i,match:n})=>{let r=rt(e.getAttributes,void 0,n);if(r===!1||r===null)return null;let{tr:o}=t,s=n[n.length-1],a=n[0];if(s){let l=a.search(/\S/),c=i.from+a.indexOf(s),d=c+s.length;if(Df(i.from,i.to,t.doc).filter(p=>p.mark.type.excluded.find(g=>g===e.type&&g!==p.mark.type)).filter(p=>p.to>c).length)return null;d<i.to&&o.delete(d,i.to),c>i.from&&o.delete(i.from+l,c);let h=i.from+l+s.length;o.addMark(i.from+l,h,e.type.create(r||{})),o.removeStoredMark(e.type)}},undoable:e.undoable})}function uk(e){return new Mf({find:e.find,handler:({state:t,range:i,match:n})=>{let r=rt(e.getAttributes,void 0,n)||{},{tr:o}=t,s=i.from,a=i.to,l=e.type.create(r);if(n[1]){let c=n[0].lastIndexOf(n[1]),d=s+c;d>a?d=a:a=d+n[1].length;let u=n[0][n[0].length-1];o.insertText(u,s+n[0].length-1),o.replaceWith(d,a,l)}else if(n[0]){let c=e.type.isInline?s:s-1;o.insert(c,e.type.create(r)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()},undoable:e.undoable})}function su(e){return new Mf({find:e.find,handler:({state:t,range:i,match:n})=>{let r=t.doc.resolve(i.from),o=rt(e.getAttributes,void 0,n)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e.type))return null;t.tr.delete(i.from,i.to).setBlockType(i.from,i.from,e.type,o)},undoable:e.undoable})}function gr(e){return new Mf({find:e.find,handler:({state:t,range:i,match:n,chain:r})=>{let o=rt(e.getAttributes,void 0,n)||{},s=t.tr.delete(i.from,i.to),l=s.doc.resolve(i.from).blockRange(),c=l&&ml(l,e.type,o);if(!c)return null;if(s.wrap(l,c),e.keepMarks&&e.editor){let{selection:u,storedMarks:h}=t,{splittableMarks:p}=e.editor.extensionManager,f=h||u.$to.parentOffset&&u.$from.marks();if(f){let g=f.filter(m=>p.includes(m.type.name));s.ensureMarks(g)}}if(e.keepAttributes){let u=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(u,o).run()}let d=s.doc.resolve(i.from-1).nodeBefore;d&&d.type===e.type&&bn(s.doc,i.from-1)&&(!e.joinPredicate||e.joinPredicate(n,d))&&s.join(i.from-1)},undoable:e.undoable})}function hk(e,t){let{selection:i}=e,{$from:n}=i;if(i instanceof Re){let o=n.index();return n.parent.canReplaceWith(o,o+1,t)}let r=n.depth;for(;r>=0;){let o=n.index(r);if(n.node(r).contentMatchAt(o).matchType(t))return!0;r-=1}return!1}var RV={};q1(RV,{createAtomBlockMarkdownSpec:()=>PV,createBlockMarkdownSpec:()=>kV,createInlineMarkdownSpec:()=>FV,parseAttributes:()=>iw,parseIndentedBlocks:()=>Tf,renderNestedMarkdownContent:()=>au,serializeAttributes:()=>nw});function iw(e){if(!e?.trim())return{};let t={},i=[],n=e.replace(/["']([^"']*)["']/g,c=>(i.push(c),`__QUOTED_${i.length-1}__`)),r=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(r){let c=r.map(d=>d.trim().slice(1));t.class=c.join(" ")}let o=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(t.id=o[1]);let s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,c,d])=>{var u;let h=parseInt(((u=d.match(/__QUOTED_(\d+)__/))==null?void 0:u[1])||"0",10),p=i[h];p&&(t[c]=p.slice(1,-1))});let l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(d=>{d.match(/^[a-zA-Z][\w-]*$/)&&(t[d]=!0)}),t}function nw(e){if(!e||Object.keys(e).length===0)return"";let t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>t.push(`.${n}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([i,n])=>{i==="class"||i==="id"||(n===!0?t.push(i):n!==!1&&n!=null&&t.push(`${i}="${String(n)}"`))}),t.join(" ")}function PV(e){let{nodeName:t,name:i,parseAttributes:n=iw,serializeAttributes:r=nw,defaultAttributes:o={},requiredAttributes:s=[],allowedAttributes:a}=e,l=i||t,c=d=>{if(!a)return d;let u={};return a.forEach(h=>{h in d&&(u[h]=d[h])}),u};return{parseMarkdown:(d,u)=>{let h=w(w({},o),d.attributes);return u.createNode(t,h,[])},markdownTokenizer:{name:t,level:"block",start(d){var u;let h=new RegExp(`^:::${l}(?:\\s|$)`,"m"),p=(u=d.match(h))==null?void 0:u.index;return p!==void 0?p:-1},tokenize(d,u,h){let p=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),f=d.match(p);if(!f)return;let g=f[1]||"",m=n(g);if(!s.find(C=>!(C in m)))return{type:t,raw:f[0],attributes:m}}},renderMarkdown:d=>{let u=c(d.attrs||{}),h=r(u),p=h?` {${h}}`:"";return`:::${l}${p} :::`}}}function kV(e){let{nodeName:t,name:i,getContent:n,parseAttributes:r=iw,serializeAttributes:o=nw,defaultAttributes:s={},content:a="block",allowedAttributes:l}=e,c=i||t,d=u=>{if(!l)return u;let h={};return l.forEach(p=>{p in u&&(h[p]=u[p])}),h};return{parseMarkdown:(u,h)=>{let p;if(n){let g=n(u);p=typeof g=="string"?[{type:"text",text:g}]:g}else a==="block"?p=h.parseChildren(u.tokens||[]):p=h.parseInline(u.tokens||[]);let f=w(w({},s),u.attributes);return h.createNode(t,f,p)},markdownTokenizer:{name:t,level:"block",start(u){var h;let p=new RegExp(`^:::${c}`,"m"),f=(h=u.match(p))==null?void 0:h.index;return f!==void 0?f:-1},tokenize(u,h,p){var f;let g=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),m=u.match(g);if(!m)return;let[v,C=""]=m,b=r(C),S=1,E=v.length,x="",P=/^:::([\w-]*)(\s.*)?/gm,F=u.slice(E);for(P.lastIndex=0;;){let N=P.exec(F);if(N===null)break;let Y=N.index,X=N[1];if(!((f=N[2])!=null&&f.endsWith(":::"))){if(X)S+=1;else if(S-=1,S===0){let Z=F.slice(0,Y);x=Z.trim();let me=u.slice(0,E+Y+N[0].length),oe=[];if(x)if(a==="block")for(oe=p.blockTokens(Z),oe.forEach(re=>{re.text&&(!re.tokens||re.tokens.length===0)&&(re.tokens=p.inlineTokens(re.text))});oe.length>0;){let re=oe[oe.length-1];if(re.type==="paragraph"&&(!re.text||re.text.trim()===""))oe.pop();else break}else oe=p.inlineTokens(x);return{type:t,raw:me,attributes:b,content:x,tokens:oe}}}}}},renderMarkdown:(u,h)=>{let p=d(u.attrs||{}),f=o(p),g=f?` {${f}}`:"",m=h.renderChildren(u.content||[],`

`);return`:::${c}${g}

${m}

:::`}}}function _V(e){if(!e.trim())return{};let t={},i=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,n=i.exec(e);for(;n!==null;){let[,r,o,s]=n;t[r]=o||s,n=i.exec(e)}return t}function DV(e){return Object.entries(e).filter(([,t])=>t!=null).map(([t,i])=>`${t}="${i}"`).join(" ")}function FV(e){let{nodeName:t,name:i,getContent:n,parseAttributes:r=_V,serializeAttributes:o=DV,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=e,c=i||t,d=h=>{if(!l)return h;let p={};return l.forEach(f=>{let g=typeof f=="string"?f:f.name,m=typeof f=="string"?void 0:f.skipIfDefault;if(g in h){let v=h[g];if(m!==void 0&&v===m)return;p[g]=v}}),p},u=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(h,p)=>{let f=w(w({},s),h.attributes);if(a)return p.createNode(t,f);let g=n?n(h):h.content||"";return g?p.createNode(t,f,[p.createTextNode(g)]):p.createNode(t,f,[])},markdownTokenizer:{name:t,level:"inline",start(h){let p=a?new RegExp(`\\[${u}\\s*[^\\]]*\\]`):new RegExp(`\\[${u}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${u}\\]`),f=h.match(p),g=f?.index;return g!==void 0?g:-1},tokenize(h,p,f){let g=a?new RegExp(`^\\[${u}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${u}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${u}\\]`),m=h.match(g);if(!m)return;let v="",C="";if(a){let[,S]=m;C=S}else{let[,S,E]=m;C=S,v=E||""}let b=r(C.trim());return{type:t,raw:m[0],content:v.trim(),attributes:b}}},renderMarkdown:h=>{let p="";n?p=n(h):h.content&&h.content.length>0&&(p=h.content.filter(v=>v.type==="text").map(v=>v.text).join(""));let f=d(h.attrs||{}),g=o(f),m=g?` ${g}`:"";return a?`[${c}${m}]`:`[${c}${m}]${p}[/${c}]`}}}function Tf(e,t,i){var n,r,o,s;let a=e.split(`
`),l=[],c="",d=0,u=t.baseIndentSize||2;for(;d<a.length;){let h=a[d],p=h.match(t.itemPattern);if(!p){if(l.length>0)break;if(h.trim()===""){d+=1,c=`${c}${h}
`;continue}else return}let f=t.extractItemData(p),{indentLevel:g,mainContent:m}=f;c=`${c}${h}
`;let v=[m];for(d+=1;d<a.length;){let E=a[d];if(E.trim()===""){let P=a.slice(d+1).findIndex(Y=>Y.trim()!=="");if(P===-1)break;if((((r=(n=a[d+1+P].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:r.length)||0)>g){v.push(E),c=`${c}${E}
`,d+=1;continue}else break}if((((s=(o=E.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:s.length)||0)>g)v.push(E),c=`${c}${E}
`,d+=1;else break}let C,b=v.slice(1);if(b.length>0){let E=b.map(x=>x.slice(g+u)).join(`
`);E.trim()&&(t.customNestedParser?C=t.customNestedParser(E):C=i.blockTokens(E))}let S=t.createToken(f,C);l.push(S)}if(l.length!==0)return{items:l,raw:c}}function au(e,t,i,n){if(!e||!Array.isArray(e.content))return"";let r=typeof i=="function"?i(n):i,[o,...s]=e.content,a=t.renderChildren([o]),l=[`${r}${a}`];return s&&s.length>0&&s.forEach(c=>{let d=t.renderChildren([c]);if(d){let u=d.split(`
`).map(h=>h?t.indent(h):"").join(`
`);l.push(u)}}),l.join(`
`)}function MV(e,t,i={}){let{state:n}=t,{doc:r,tr:o}=n,s=e;r.descendants((a,l)=>{let c=o.mapping.map(l),d=o.mapping.map(l)+a.nodeSize,u=null;if(a.marks.forEach(p=>{if(p!==s)return!1;u=p}),!u)return;let h=!1;if(Object.keys(i).forEach(p=>{i[p]!==u.attrs[p]&&(h=!0)}),h){let p=e.type.create(w(w({},e.attrs),i));o.removeMark(c,d,e.type),o.addMark(c,d,p)}}),o.docChanged&&t.view.dispatch(o)}var gt=class pk extends tw{constructor(){super(...arguments),this.type="node"}static create(t={}){let i=typeof t=="function"?t():t;return new pk(i)}configure(t){return super.configure(t)}extend(t){let i=typeof t=="function"?t():t;return super.extend(i)}};function Rn(e){return new gV({find:e.find,handler:({state:t,range:i,match:n,pasteEvent:r})=>{let o=rt(e.getAttributes,void 0,n,r);if(o===!1||o===null)return null;let{tr:s}=t,a=n[n.length-1],l=n[0],c=i.to;if(a){let d=l.search(/\S/),u=i.from+l.indexOf(a),h=u+a.length;if(Df(i.from,i.to,t.doc).filter(f=>f.mark.type.excluded.find(m=>m===e.type&&m!==f.mark.type)).filter(f=>f.to>u).length)return null;h<i.to&&s.delete(h,i.to),u>i.from&&s.delete(i.from+d,u),c=i.from+d+a.length,s.addMark(i.from+d,c,e.type.create(o||{})),s.removeStoredMark(e.type)}}})}var TV="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xF6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",IV="\u03B5\u03BB1\u03C52\u0431\u04331\u0435\u043B3\u0434\u0435\u0442\u04384\u0435\u044E2\u043A\u0430\u0442\u043E\u043B\u0438\u043A6\u043E\u043C3\u043C\u043A\u04342\u043E\u043D1\u0441\u043A\u0432\u04306\u043E\u043D\u043B\u0430\u0439\u043D5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043A\u04403\u049B\u0430\u04373\u0570\u0561\u05753\u05D9\u05E9\u05E8\u05D0\u05DC5\u05E7\u05D5\u05DD3\u0627\u0628\u0648\u0638\u0628\u064A5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062F\u06464\u0628\u062D\u0631\u064A\u06465\u062C\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062F\u064A\u06296\u0639\u0644\u064A\u0627\u06465\u0645\u063A\u0631\u06285\u0645\u0627\u0631\u0627\u062A5\u06CC\u0631\u0627\u06465\u0628\u0627\u0631\u062A2\u0632\u0627\u06314\u064A\u062A\u06433\u06BE\u0627\u0631\u062A5\u062A\u0648\u0646\u06334\u0633\u0648\u062F\u0627\u06463\u0631\u064A\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064A\u06466\u0642\u0637\u06313\u0643\u0627\u062B\u0648\u0644\u064A\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064A\u0633\u064A\u06275\u0648\u0631\u064A\u062A\u0627\u0646\u064A\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067E\u0627\u06A9\u0633\u062A\u0627\u06467\u0680\u0627\u0631\u062A4\u0915\u0949\u092E3\u0928\u0947\u091F3\u092D\u093E\u0930\u09240\u092E\u094D3\u094B\u09245\u0938\u0902\u0917\u0920\u09285\u09AC\u09BE\u0982\u09B2\u09BE5\u09AD\u09BE\u09B0\u09A42\u09F0\u09A44\u0A2D\u0A3E\u0A30\u0A244\u0AAD\u0ABE\u0AB0\u0AA44\u0B2D\u0B3E\u0B30\u0B244\u0B87\u0BA8\u0BCD\u0BA4\u0BBF\u0BAF\u0BBE6\u0BB2\u0B99\u0BCD\u0B95\u0BC86\u0B9A\u0BBF\u0B99\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0BC2\u0BB0\u0BCD11\u0C2D\u0C3E\u0C30\u0C24\u0C4D5\u0CAD\u0CBE\u0CB0\u0CA44\u0D2D\u0D3E\u0D30\u0D24\u0D025\u0DBD\u0D82\u0D9A\u0DCF4\u0E04\u0E2D\u0E213\u0E44\u0E17\u0E223\u0EA5\u0EB2\u0EA73\u10D2\u10D42\u307F\u3093\u306A3\u30A2\u30DE\u30BE\u30F34\u30AF\u30E9\u30A6\u30C94\u30B0\u30FC\u30B0\u30EB4\u30B3\u30E02\u30B9\u30C8\u30A23\u30BB\u30FC\u30EB3\u30D5\u30A1\u30C3\u30B7\u30E7\u30F36\u30DD\u30A4\u30F3\u30C84\u4E16\u754C2\u4E2D\u4FE11\u56FD1\u570B1\u6587\u7F513\u4E9A\u9A6C\u900A3\u4F01\u4E1A2\u4F5B\u5C712\u4FE1\u606F2\u5065\u5EB72\u516B\u53662\u516C\u53F81\u76CA2\u53F0\u6E7E1\u70632\u5546\u57CE1\u5E971\u68072\u5609\u91CC0\u5927\u9152\u5E975\u5728\u7EBF2\u5927\u62FF2\u5929\u4E3B\u65593\u5A31\u4E502\u5BB6\u96FB2\u5E7F\u4E1C2\u5FAE\u535A2\u6148\u55842\u6211\u7231\u4F603\u624B\u673A2\u62DB\u80582\u653F\u52A11\u5E9C2\u65B0\u52A0\u57612\u95FB2\u65F6\u5C1A2\u66F8\u7C4D2\u673A\u67842\u6DE1\u9A6C\u95213\u6E38\u620F2\u6FB3\u95802\u70B9\u770B2\u79FB\u52A82\u7EC4\u7EC7\u673A\u67844\u7F51\u57401\u5E971\u7AD91\u7EDC2\u8054\u901A2\u8C37\u6B4C2\u8D2D\u72692\u901A\u8CA92\u96C6\u56E22\u96FB\u8A0A\u76C8\u79D14\u98DE\u5229\u6D663\u98DF\u54C12\u9910\u53852\u9999\u683C\u91CC\u62C93\u6E2F2\uB2F7\uB1371\uCEF42\uC0BC\uC1312\uD55C\uAD6D2",dw="numeric",uw="ascii",hw="alpha",du="asciinumeric",cu="alphanumeric",pw="domain",bk="emoji",AV="scheme",OV="slashscheme",rw="whitespace";function LV(e,t){return e in t||(t[e]=[]),t[e]}function ea(e,t,i){t[dw]&&(t[du]=!0,t[cu]=!0),t[uw]&&(t[du]=!0,t[hw]=!0),t[du]&&(t[cu]=!0),t[hw]&&(t[cu]=!0),t[cu]&&(t[pw]=!0),t[bk]&&(t[pw]=!0);for(let n in t){let r=LV(n,i);r.indexOf(e)<0&&r.push(e)}}function NV(e,t){let i={};for(let n in t)t[n].indexOf(e)>=0&&(i[n]=!0);return i}function Vi(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Vi.groups={};Vi.prototype={accepts(){return!!this.t},go(e){let t=this,i=t.j[e];if(i)return i;for(let n=0;n<t.jr.length;n++){let r=t.jr[n][0],o=t.jr[n][1];if(o&&r.test(e))return o}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,i,n){for(let r=0;r<e.length;r++)this.tt(e[r],t,i,n)},tr(e,t,i,n){n=n||Vi.groups;let r;return t&&t.j?r=t:(r=new Vi(t),i&&n&&ea(t,i,n)),this.jr.push([e,r]),r},ts(e,t,i,n){let r=this,o=e.length;if(!o)return r;for(let s=0;s<o-1;s++)r=r.tt(e[s]);return r.tt(e[o-1],t,i,n)},tt(e,t,i,n){n=n||Vi.groups;let r=this;if(t&&t.j)return r.j[e]=t,t;let o=t,s,a=r.go(e);if(a?(s=new Vi,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new Vi,o){if(n)if(s.t&&typeof s.t=="string"){let l=Object.assign(NV(s.t,n),i);ea(o,l,n)}else i&&ea(o,i,n);s.t=o}return r.j[e]=s,s}};var Ne=(e,t,i,n,r)=>e.ta(t,i,n,r),kt=(e,t,i,n,r)=>e.tr(t,i,n,r),fk=(e,t,i,n,r)=>e.ts(t,i,n,r),se=(e,t,i,n,r)=>e.tt(t,i,n,r),ro="WORD",fw="UWORD",yk="ASCIINUMERICAL",Sk="ALPHANUMERICAL",mu="LOCALHOST",gw="TLD",mw="UTLD",Lf="SCHEME",_l="SLASH_SCHEME",Cw="NUM",vw="WS",ww="NL",uu="OPENBRACE",hu="CLOSEBRACE",Nf="OPENBRACKET",Bf="CLOSEBRACKET",Hf="OPENPAREN",zf="CLOSEPAREN",Vf="OPENANGLEBRACKET",Gf="CLOSEANGLEBRACKET",Wf="FULLWIDTHLEFTPAREN",Uf="FULLWIDTHRIGHTPAREN",jf="LEFTCORNERBRACKET",qf="RIGHTCORNERBRACKET",$f="LEFTWHITECORNERBRACKET",Kf="RIGHTWHITECORNERBRACKET",Yf="FULLWIDTHLESSTHAN",Xf="FULLWIDTHGREATERTHAN",Jf="AMPERSAND",Qf="APOSTROPHE",Zf="ASTERISK",Yo="AT",eg="BACKSLASH",tg="BACKTICK",ig="CARET",Xo="COLON",bw="COMMA",ng="DOLLAR",mr="DOT",rg="EQUALS",yw="EXCLAMATION",kn="HYPHEN",pu="PERCENT",og="PIPE",sg="PLUS",ag="POUND",fu="QUERY",Sw="QUOTE",xk="FULLWIDTHMIDDLEDOT",xw="SEMI",vr="SLASH",gu="TILDE",lg="UNDERSCORE",Ek="EMOJI",cg="SYM",Rk=Object.freeze({__proto__:null,ALPHANUMERICAL:Sk,AMPERSAND:Jf,APOSTROPHE:Qf,ASCIINUMERICAL:yk,ASTERISK:Zf,AT:Yo,BACKSLASH:eg,BACKTICK:tg,CARET:ig,CLOSEANGLEBRACKET:Gf,CLOSEBRACE:hu,CLOSEBRACKET:Bf,CLOSEPAREN:zf,COLON:Xo,COMMA:bw,DOLLAR:ng,DOT:mr,EMOJI:Ek,EQUALS:rg,EXCLAMATION:yw,FULLWIDTHGREATERTHAN:Xf,FULLWIDTHLEFTPAREN:Wf,FULLWIDTHLESSTHAN:Yf,FULLWIDTHMIDDLEDOT:xk,FULLWIDTHRIGHTPAREN:Uf,HYPHEN:kn,LEFTCORNERBRACKET:jf,LEFTWHITECORNERBRACKET:$f,LOCALHOST:mu,NL:ww,NUM:Cw,OPENANGLEBRACKET:Vf,OPENBRACE:uu,OPENBRACKET:Nf,OPENPAREN:Hf,PERCENT:pu,PIPE:og,PLUS:sg,POUND:ag,QUERY:fu,QUOTE:Sw,RIGHTCORNERBRACKET:qf,RIGHTWHITECORNERBRACKET:Kf,SCHEME:Lf,SEMI:xw,SLASH:vr,SLASH_SCHEME:_l,SYM:cg,TILDE:gu,TLD:gw,UNDERSCORE:lg,UTLD:mw,UWORD:fw,WORD:ro,WS:vw}),io=/[a-z]/,lu=new RegExp("\\p{L}","u"),ow=new RegExp("\\p{Emoji}","u");var no=/\d/,sw=/\s/;var gk="\r",aw=`
`,BV="\uFE0F",HV="\u200D",lw="\uFFFC",If=null,Af=null;function zV(e=[]){let t={};Vi.groups=t;let i=new Vi;If==null&&(If=mk(TV)),Af==null&&(Af=mk(IV)),se(i,"'",Qf),se(i,"{",uu),se(i,"}",hu),se(i,"[",Nf),se(i,"]",Bf),se(i,"(",Hf),se(i,")",zf),se(i,"<",Vf),se(i,">",Gf),se(i,"\uFF08",Wf),se(i,"\uFF09",Uf),se(i,"\u300C",jf),se(i,"\u300D",qf),se(i,"\u300E",$f),se(i,"\u300F",Kf),se(i,"\uFF1C",Yf),se(i,"\uFF1E",Xf),se(i,"&",Jf),se(i,"*",Zf),se(i,"@",Yo),se(i,"`",tg),se(i,"^",ig),se(i,":",Xo),se(i,",",bw),se(i,"$",ng),se(i,".",mr),se(i,"=",rg),se(i,"!",yw),se(i,"-",kn),se(i,"%",pu),se(i,"|",og),se(i,"+",sg),se(i,"#",ag),se(i,"?",fu),se(i,'"',Sw),se(i,"/",vr),se(i,";",xw),se(i,"~",gu),se(i,"_",lg),se(i,"\\",eg),se(i,"\u30FB",xk);let n=kt(i,no,Cw,{[dw]:!0});kt(n,no,n);let r=kt(n,io,yk,{[du]:!0}),o=kt(n,lu,Sk,{[cu]:!0}),s=kt(i,io,ro,{[uw]:!0});kt(s,no,r),kt(s,io,s),kt(r,no,r),kt(r,io,r);let a=kt(i,lu,fw,{[hw]:!0});kt(a,io),kt(a,no,o),kt(a,lu,a),kt(o,no,o),kt(o,io),kt(o,lu,o);let l=se(i,aw,ww,{[rw]:!0}),c=se(i,gk,vw,{[rw]:!0}),d=kt(i,sw,vw,{[rw]:!0});se(i,lw,d),se(c,aw,l),se(c,lw,d),kt(c,sw,d),se(d,gk),se(d,aw),kt(d,sw,d),se(d,lw,d);let u=kt(i,ow,Ek,{[bk]:!0});se(u,"#"),kt(u,ow,u),se(u,BV,u);let h=se(u,HV);se(h,"#"),kt(h,ow,u);let p=[[io,s],[no,r]],f=[[io,null],[lu,a],[no,o]];for(let g=0;g<If.length;g++)Ko(i,If[g],gw,ro,p);for(let g=0;g<Af.length;g++)Ko(i,Af[g],mw,fw,f);ea(gw,{tld:!0,ascii:!0},t),ea(mw,{utld:!0,alpha:!0},t),Ko(i,"file",Lf,ro,p),Ko(i,"mailto",Lf,ro,p),Ko(i,"http",_l,ro,p),Ko(i,"https",_l,ro,p),Ko(i,"ftp",_l,ro,p),Ko(i,"ftps",_l,ro,p),ea(Lf,{scheme:!0,ascii:!0},t),ea(_l,{slashscheme:!0,ascii:!0},t),e=e.sort((g,m)=>g[0]>m[0]?1:-1);for(let g=0;g<e.length;g++){let m=e[g][0],C=e[g][1]?{[AV]:!0}:{[OV]:!0};m.indexOf("-")>=0?C[pw]=!0:io.test(m)?no.test(m)?C[du]=!0:C[uw]=!0:C[dw]=!0,fk(i,m,m,C)}return fk(i,"localhost",mu,{ascii:!0}),i.jd=new Vi(cg),{start:i,tokens:Object.assign({groups:t},Rk)}}function Pk(e,t){let i=VV(t.replace(/[A-Z]/g,a=>a.toLowerCase())),n=i.length,r=[],o=0,s=0;for(;s<n;){let a=e,l=null,c=0,d=null,u=-1,h=-1;for(;s<n&&(l=a.go(i[s]));)a=l,a.accepts()?(u=0,h=0,d=a):u>=0&&(u+=i[s].length,h++),c+=i[s].length,o+=i[s].length,s++;o-=u,s-=h,c-=u,r.push({t:d.t,v:t.slice(o-c,o),s:o-c,e:o})}return r}function VV(e){let t=[],i=e.length,n=0;for(;n<i;){let r=e.charCodeAt(n),o,s=r<55296||r>56319||n+1===i||(o=e.charCodeAt(n+1))<56320||o>57343?e[n]:e.slice(n,n+2);t.push(s),n+=s.length}return t}function Ko(e,t,i,n,r){let o,s=t.length;for(let a=0;a<s-1;a++){let l=t[a];e.j[l]?o=e.j[l]:(o=new Vi(n),o.jr=r.slice(),e.j[l]=o),e=o}return o=new Vi(i),o.jr=r.slice(),e.j[t[s-1]]=o,o}function mk(e){let t=[],i=[],n=0,r="0123456789";for(;n<e.length;){let o=0;for(;r.indexOf(e[n+o])>=0;)o++;if(o>0){t.push(i.join(""));for(let s=parseInt(e.substring(n,n+o),10);s>0;s--)i.pop();n+=o}else i.push(e[n]),n++}return t}var vu={defaultProtocol:"http",events:null,format:vk,formatHref:vk,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Ew(e,t=null){let i=Object.assign({},vu);e&&(i=Object.assign(i,e instanceof Ew?e.o:e));let n=i.ignoreTags,r=[];for(let o=0;o<n.length;o++)r.push(n[o].toUpperCase());this.o=i,t&&(this.defaultRender=t),this.ignoreTags=r}Ew.prototype={o:vu,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,i){let n=t!=null,r=this.o[e];return r&&(typeof r=="object"?(r=i.t in r?r[i.t]:vu[e],typeof r=="function"&&n&&(r=r(t,i))):typeof r=="function"&&n&&(r=r(t,i.t,i)),r)},getObj(e,t,i){let n=this.o[e];return typeof n=="function"&&t!=null&&(n=n(t,i.t,i)),n},render(e){let t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function vk(e){return e}function kk(e,t){this.t="token",this.v=e,this.tk=t}kk.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){let t=this.toString(),i=e.get("truncate",t,this),n=e.get("format",t,this);return i&&n.length>i?n.substring(0,i)+"\u2026":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=vu.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){let t=this,i=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",i,this),r=e.get("tagName",i,t),o=this.toFormattedString(e),s={},a=e.get("className",i,t),l=e.get("target",i,t),c=e.get("rel",i,t),d=e.getObj("attributes",i,t),u=e.getObj("events",i,t);return s.href=n,a&&(s.class=a),l&&(s.target=l),c&&(s.rel=c),d&&Object.assign(s,d),{tagName:r,attributes:s,content:o,eventListeners:u}}};function dg(e,t){class i extends kk{constructor(r,o){super(r,o),this.t=e}}for(let n in t)i.prototype[n]=t[n];return i.t=e,i}var Ck=dg("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),wk=dg("text"),GV=dg("nl"),Of=dg("url",{isLink:!0,toHref(e=vu.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){let e=this.tk;return e.length>=2&&e[0].t!==mu&&e[1].t===Xo}});var Pn=e=>new Vi(e);function WV({groups:e}){let t=e.domain.concat([Jf,Zf,Yo,eg,tg,ig,ng,rg,kn,Cw,pu,og,sg,ag,vr,cg,gu,lg]),i=[Qf,Xo,bw,mr,yw,pu,fu,Sw,xw,Vf,Gf,uu,hu,Bf,Nf,Hf,zf,Wf,Uf,jf,qf,$f,Kf,Yf,Xf],n=[Jf,Qf,Zf,eg,tg,ig,ng,rg,kn,uu,hu,pu,og,sg,ag,fu,vr,cg,gu,lg],r=Pn(),o=se(r,gu);Ne(o,n,o),Ne(o,e.domain,o);let s=Pn(),a=Pn(),l=Pn();Ne(r,e.domain,s),Ne(r,e.scheme,a),Ne(r,e.slashscheme,l),Ne(s,n,o),Ne(s,e.domain,s);let c=se(s,Yo);se(o,Yo,c),se(a,Yo,c),se(l,Yo,c);let d=se(o,mr);Ne(d,n,o),Ne(d,e.domain,o);let u=Pn();Ne(c,e.domain,u),Ne(u,e.domain,u);let h=se(u,mr);Ne(h,e.domain,u);let p=Pn(Ck);Ne(h,e.tld,p),Ne(h,e.utld,p),se(c,mu,p);let f=se(u,kn);se(f,kn,f),Ne(f,e.domain,u),Ne(p,e.domain,u),se(p,mr,h),se(p,kn,f);let g=se(p,Xo);Ne(g,e.numeric,Ck);let m=se(s,kn),v=se(s,mr);se(m,kn,m),Ne(m,e.domain,s),Ne(v,n,o),Ne(v,e.domain,s);let C=Pn(Of);Ne(v,e.tld,C),Ne(v,e.utld,C),Ne(C,e.domain,s),Ne(C,n,o),se(C,mr,v),se(C,kn,m),se(C,Yo,c);let b=se(C,Xo),S=Pn(Of);Ne(b,e.numeric,S);let E=Pn(Of),x=Pn();Ne(E,t,E),Ne(E,i,x),Ne(x,t,E),Ne(x,i,x),se(C,vr,E),se(S,vr,E);let P=se(a,Xo),F=se(l,Xo),N=se(F,vr),Y=se(N,vr);Ne(a,e.domain,s),se(a,mr,v),se(a,kn,m),Ne(l,e.domain,s),se(l,mr,v),se(l,kn,m),Ne(P,e.domain,E),se(P,vr,E),se(P,fu,E),Ne(Y,e.domain,E),Ne(Y,t,E),se(Y,vr,E);let X=[[uu,hu],[Nf,Bf],[Hf,zf],[Vf,Gf],[Wf,Uf],[jf,qf],[$f,Kf],[Yf,Xf]];for(let Z=0;Z<X.length;Z++){let[me,oe]=X[Z],re=se(E,me);se(x,me,re),se(re,oe,E);let _=Pn(Of);Ne(re,t,_);let k=Pn();Ne(re,i),Ne(_,t,_),Ne(_,i,k),Ne(k,t,_),Ne(k,i,k),se(_,oe,E),se(k,oe,E)}return se(r,mu,C),se(r,ww,GV),{start:r,tokens:Rk}}function UV(e,t,i){let n=i.length,r=0,o=[],s=[];for(;r<n;){let a=e,l=null,c=null,d=0,u=null,h=-1;for(;r<n&&!(l=a.go(i[r].t));)s.push(i[r++]);for(;r<n&&(c=l||a.go(i[r].t));)l=null,a=c,a.accepts()?(h=0,u=a):h>=0&&h++,r++,d++;if(h<0)r-=d,r<n&&(s.push(i[r]),r++);else{s.length>0&&(o.push(cw(wk,t,s)),s=[]),r-=h,d-=h;let p=u.t,f=i.slice(r-d,r);o.push(cw(p,t,f))}}return s.length>0&&o.push(cw(wk,t,s)),o}function cw(e,t,i){let n=i[0].s,r=i[i.length-1].e,o=t.slice(n,r);return new e(o,i)}var jV=typeof console<"u"&&console&&console.warn||(()=>{}),qV="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Ct={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function _k(){return Vi.groups={},Ct.scanner=null,Ct.parser=null,Ct.tokenQueue=[],Ct.pluginQueue=[],Ct.customSchemes=[],Ct.initialized=!1,Ct}function Rw(e,t=!1){if(Ct.initialized&&jV(`linkifyjs: already initialized - will not register custom scheme "${e}" ${qV}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Ct.customSchemes.push([e,t])}function $V(){Ct.scanner=zV(Ct.customSchemes);for(let e=0;e<Ct.tokenQueue.length;e++)Ct.tokenQueue[e][1]({scanner:Ct.scanner});Ct.parser=WV(Ct.scanner.tokens);for(let e=0;e<Ct.pluginQueue.length;e++)Ct.pluginQueue[e][1]({scanner:Ct.scanner,parser:Ct.parser});return Ct.initialized=!0,Ct}function ug(e){return Ct.initialized||$V(),UV(Ct.parser.start,e,Pk(Ct.scanner.start,e))}ug.scan=Pk;function hg(e,t=null,i=null){if(t&&typeof t=="object"){if(i)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);i=t,t=null}let n=new Ew(i),r=ug(e),o=[];for(let s=0;s<r.length;s++){let a=r[s];a.isLink&&(!t||a.t===t)&&n.check(a)&&o.push(a.toFormattedObject(n))}return o}var Pw="[\0- \xA0\u1680\u180E\u2000-\u2029\u205F\u3000]",KV=new RegExp(Pw),YV=new RegExp(`${Pw}$`),XV=new RegExp(Pw,"g");function JV(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function QV(e){return new Te({key:new Be("autolink"),appendTransaction:(t,i,n)=>{let r=t.some(c=>c.docChanged)&&!i.doc.eq(n.doc),o=t.some(c=>c.getMeta("preventAutolink"));if(!r||o)return;let{tr:s}=n,a=X1(i.doc,[...t]);if(ew(a).forEach(({newRange:c})=>{let d=zP(n.doc,c,p=>p.isTextblock),u,h;if(d.length>1)u=d[0],h=n.doc.textBetween(u.pos,u.pos+u.node.nodeSize,void 0," ");else if(d.length){let p=n.doc.textBetween(c.from,c.to," "," ");if(!YV.test(p))return;u=d[0],h=n.doc.textBetween(u.pos,c.to,void 0," ")}if(u&&h){let p=h.split(KV).filter(Boolean);if(p.length<=0)return!1;let f=p[p.length-1],g=u.pos+h.lastIndexOf(f);if(!f)return!1;let m=ug(f).map(v=>v.toObject(e.defaultProtocol));if(!JV(m))return!1;m.filter(v=>v.isLink).map(v=>T(w({},v),{from:g+v.start+1,to:g+v.end+1})).filter(v=>n.schema.marks.code?!n.doc.rangeHasMark(v.from,v.to,n.schema.marks.code):!0).filter(v=>e.validate(v.value)).filter(v=>e.shouldAutoLink(v.value)).forEach(v=>{Df(v.from,v.to,n.doc).some(C=>C.mark.type===e.type)||s.addMark(v.from,v.to,e.type.create({href:v.href}))})}}),!!s.steps.length)return s}})}function ZV(e){return new Te({key:new Be("handleClickLink"),props:{handleClick:(t,i,n)=>{var r,o;if(n.button!==0||!t.editable)return!1;let s=!1;if(e.enableClickSelection&&(s=e.editor.commands.extendMarkRange(e.type.name)),e.openOnClick){let a=null;if(n.target instanceof HTMLAnchorElement)a=n.target;else{let u=n.target,h=[];for(;u.nodeName!=="DIV";)h.push(u),u=u.parentNode;a=h.find(p=>p.nodeName==="A")}if(!a)return s;let l=Z1(t.state,e.type.name),c=(r=a?.href)!=null?r:l.href,d=(o=a?.target)!=null?o:l.target;a&&c&&(window.open(c,d),s=!0)}return s}}})}function eG(e){return new Te({key:new Be("handlePasteLink"),props:{handlePaste:(t,i,n)=>{let{shouldAutoLink:r}=e,{state:o}=t,{selection:s}=o,{empty:a}=s;if(a)return!1;let l="";n.content.forEach(d=>{l+=d.textContent});let c=hg(l,{defaultProtocol:e.defaultProtocol}).find(d=>d.isLink&&d.value===l);return!l||!c||r!==void 0&&!r(c.href)?!1:e.editor.commands.setMark(e.type,{href:c.href})}}})}function ta(e,t){let i=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(n=>{let r=typeof n=="string"?n:n.scheme;r&&i.push(r)}),!e||e.replace(XV,"").match(new RegExp(`^(?:(?:${i.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var kw=rn.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){Rw(e);return}Rw(e.scheme,e.optionalSlashes)})},onDestroy(){_k()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!ta(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{let t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:i=>!!ta(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!ta(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",We(this.options.HTMLAttributes,e),0]:["a",We(this.options.HTMLAttributes,T(w({},e),{href:""})),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var i;let n=((i=e.attrs)==null?void 0:i.href)||"";return`[${t.renderChildren(e)}](${n})`},addCommands(){return{setLink:e=>({chain:t})=>{let{href:i}=e;return this.options.isAllowedUri(i,{defaultValidate:n=>!!ta(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{let{href:i}=e||{};return i&&!this.options.isAllowedUri(i,{defaultValidate:n=>!!ta(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Rn({find:e=>{let t=[];if(e){let{protocols:i,defaultProtocol:n}=this.options,r=hg(e).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:s=>!!ta(s,i),protocols:i,defaultProtocol:n}));r.length&&r.forEach(o=>{this.options.shouldAutoLink(o.value)&&t.push({text:o.value,data:{href:o.href},index:o.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){let e=[],{protocols:t,defaultProtocol:i}=this.options;return this.options.autolink&&e.push(QV({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:r=>!!ta(r,t),protocols:t,defaultProtocol:i}),shouldAutoLink:this.options.shouldAutoLink})),e.push(ZV({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(eG({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),Dk=kw;var Dl=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);let r=t??{},{children:i}=r,n=xt(r,["children"]);if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,i]};var tG=/^\s*>\s$/,Fk=gt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return Dl("blockquote",T(w({},We(this.options.HTMLAttributes,e)),{children:Dl("slot",{})}))},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";let i=">",n=[];return e.content.forEach(r=>{let a=t.renderChildren([r]).split(`
`).map(l=>l.trim()===""?i:`${i} ${l}`);n.push(a.join(`
`))}),n.join(`
${i}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[gr({find:tG,type:this.type})]}});var iG=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,nG=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,rG=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,oG=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Mk=rn.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return Dl("strong",T(w({},We(this.options.HTMLAttributes,e)),{children:Dl("slot",{})}))},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[fr({find:iG,type:this.type}),fr({find:rG,type:this.type})]},addPasteRules(){return[Rn({find:nG,type:this.type}),Rn({find:oG,type:this.type})]}});var sG=/(^|[^`])`([^`]+)`(?!`)$/,aG=/(^|[^`])`([^`]+)`(?!`)/g,Tk=rn.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",We(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[fr({find:sG,type:this.type})]},addPasteRules(){return[Rn({find:aG,type:this.type})]}});var _w=4,lG=/^```([a-z]+)?[\s\n]$/,cG=/^~~~([a-z]+)?[\s\n]$/,Ik=gt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:_w,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;let{languageClassPrefix:i}=this.options;if(!i)return null;let o=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(s=>s.startsWith(i)).map(s=>s.replace(i,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",We(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var i;return((i=e.raw)==null?void 0:i.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var i;let n="",r=((i=e.attrs)==null?void 0:i.language)||"";return e.content?n=[`\`\`\`${r}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${r}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:t}=this.editor.state.selection,i=t.pos===1;return!e||t.parent.type.name!==this.name?!1:i||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;let i=(t=this.options.tabSize)!=null?t:_w,{state:n}=e,{selection:r}=n,{$from:o,empty:s}=r;if(o.parent.type!==this.type)return!1;let a=" ".repeat(i);return s?e.commands.insertContent(a):e.commands.command(({tr:l})=>{let{from:c,to:d}=r,p=n.doc.textBetween(c,d,`
`,`
`).split(`
`).map(f=>a+f).join(`
`);return l.replaceWith(c,d,n.schema.text(p)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;let i=(t=this.options.tabSize)!=null?t:_w,{state:n}=e,{selection:r}=n,{$from:o,empty:s}=r;return o.parent.type!==this.type?!1:s?e.commands.command(({tr:a})=>{var l;let{pos:c}=o,d=o.start(),u=o.end(),p=n.doc.textBetween(d,u,`
`,`
`).split(`
`),f=0,g=0,m=c-d;for(let x=0;x<p.length;x+=1){if(g+p[x].length>=m){f=x;break}g+=p[x].length+1}let C=((l=p[f].match(/^ */))==null?void 0:l[0])||"",b=Math.min(C.length,i);if(b===0)return!0;let S=d;for(let x=0;x<f;x+=1)S+=p[x].length+1;return a.delete(S,S+b),c-S<=b&&a.setSelection(ke.create(a.doc,S)),!0}):e.commands.command(({tr:a})=>{let{from:l,to:c}=r,h=n.doc.textBetween(l,c,`
`,`
`).split(`
`).map(p=>{var f;let g=((f=p.match(/^ */))==null?void 0:f[0])||"",m=Math.min(g.length,i);return p.slice(m)}).join(`
`);return a.replaceWith(l,c,n.schema.text(h)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:t}=e,{selection:i}=t,{$from:n,empty:r}=i;if(!r||n.parent.type!==this.type)return!1;let o=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!o||!s?!1:e.chain().command(({tr:a})=>(a.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:t}=e,{selection:i,doc:n}=t,{$from:r,empty:o}=i;if(!o||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;let a=r.after();return a===void 0?!1:n.nodeAt(a)?e.commands.command(({tr:c})=>(c.setSelection(Me.near(n.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[su({find:lG,type:this.type,getAttributes:e=>({language:e[1]})}),su({find:cG,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Te({key:new Be("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let i=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),r=n?JSON.parse(n):void 0,o=r?.mode;if(!i||!o)return!1;let{tr:s,schema:a}=e.state,l=a.text(i.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(ke.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}});var Ak=gt.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""});var Ok=gt.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",We(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:i,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:r,storedMarks:o}=i;if(r.$from.parent.type.spec.isolating)return!1;let{keepMarks:s}=this.options,{splittableMarks:a}=n.extensionManager,l=o||r.$to.parentOffset&&r.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:d})=>{if(d&&l&&s){let u=l.filter(h=>a.includes(h.type.name));c.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var Lk=gt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,We(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var i;let n=(i=e.attrs)!=null&&i.level?parseInt(e.attrs.level,10):1,r="#".repeat(n);return e.content?`${r} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>T(w({},e),{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>su({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var Nk=gt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",We(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!hk(t,t.schema.nodes[this.name]))return!1;let{selection:i}=t,{$to:n}=i,r=e();return Ff(i)?r.insertContentAt(n.pos,{type:this.name}):r.insertContent({type:this.name}),r.command(({state:o,tr:s,dispatch:a})=>{if(a){let{$to:l}=s.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(ke.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(Re.create(s.doc,l.pos)):s.setSelection(ke.create(s.doc,l.pos));else{let d=o.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,u=d?.create();u&&(s.insert(c,u),s.setSelection(ke.create(s.doc,c+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[uk({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}});var dG=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,uG=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,hG=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,pG=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Bk=rn.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",We(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[fr({find:dG,type:this.type}),fr({find:hG,type:this.type})]},addPasteRules(){return[Rn({find:uG,type:this.type}),Rn({find:pG,type:this.type})]}});var fG=Object.defineProperty,gG=(e,t)=>{for(var i in t)fG(e,i,{get:t[i],enumerable:!0})},mG="listItem",Hk="textStyle",zk=/^\s*([-+*])\s$/,Mw=gt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",We(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(mG,this.editor.getAttributes(Hk)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=gr({find:zk,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=gr({find:zk,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Hk),editor:this.editor})),[e]}}),Tw=gt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",We(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let i=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(r=>r.type==="paragraph"))i=t.parseChildren(e.tokens);else{let r=e.tokens[0];if(r&&r.type==="text"&&r.tokens&&r.tokens.length>0){if(i=[{type:"paragraph",content:t.parseInline(r.tokens)}],e.tokens.length>1){let s=e.tokens.slice(1),a=t.parseChildren(s);i.push(...a)}}else i=t.parseChildren(e.tokens)}return i.length===0&&(i=[{type:"paragraph",content:[]}]),{type:"listItem",content:i}},renderMarkdown:(e,t,i)=>au(e,t,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",i),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),vG={};gG(vG,{findListItemPos:()=>Cu,getNextListDepth:()=>Iw,handleBackspace:()=>Dw,handleDelete:()=>Fw,hasListBefore:()=>Uk,hasListItemAfter:()=>CG,hasListItemBefore:()=>jk,listItemHasSubList:()=>qk,nextListIsDeeper:()=>$k,nextListIsHigher:()=>Kk});var Cu=(e,t)=>{let{$from:i}=t.selection,n=Pt(e,t.schema),r=null,o=i.depth,s=i.pos,a=null;for(;o>0&&a===null;)r=i.node(o),r.type===n?a=o:(o-=1,s-=1);return a===null?null:{$pos:t.doc.resolve(s),depth:a}},Iw=(e,t)=>{let i=Cu(e,t);if(!i)return!1;let[,n]=jP(t,e,i.$pos.pos+4);return n},Uk=(e,t,i)=>{let{$anchor:n}=e.selection,r=Math.max(0,n.pos-2),o=e.doc.resolve(r).node();return!(!o||!i.includes(o.type.name))},jk=(e,t)=>{var i;let{$anchor:n}=t.selection,r=t.doc.resolve(n.pos-2);return!(r.index()===0||((i=r.nodeBefore)==null?void 0:i.type.name)!==e)},qk=(e,t,i)=>{if(!i)return!1;let n=Pt(e,t.schema),r=!1;return i.descendants(o=>{o.type===n&&(r=!0)}),r},Dw=(e,t,i)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!pr(e.state,t)&&Uk(e.state,t,i)){let{$anchor:a}=e.state.selection,l=e.state.doc.resolve(a.before()-1),c=[];l.node().descendants((h,p)=>{h.type.name===t&&c.push({node:h,pos:p})});let d=c.at(-1);if(!d)return!1;let u=e.state.doc.resolve(l.start()+d.pos+1);return e.chain().cut({from:a.start()-1,to:a.end()+1},u.end()).joinForward().run()}if(!pr(e.state,t)||!$P(e.state))return!1;let n=Cu(t,e.state);if(!n)return!1;let o=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=qk(t,e.state,o);return jk(t,e.state)&&!s?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},$k=(e,t)=>{let i=Iw(e,t),n=Cu(e,t);return!n||!i?!1:i>n.depth},Kk=(e,t)=>{let i=Iw(e,t),n=Cu(e,t);return!n||!i?!1:i<n.depth},Fw=(e,t)=>{if(!pr(e.state,t)||!qP(e.state,t))return!1;let{selection:i}=e.state,{$from:n,$to:r}=i;return!i.empty&&n.sameParent(r)?!1:$k(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():Kk(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},CG=(e,t)=>{var i;let{$anchor:n}=t.selection,r=t.doc.resolve(n.pos-n.parentOffset-2);return!(r.index()===r.parent.childCount-1||((i=r.nodeAfter)==null?void 0:i.type.name)!==e)},Aw=Xe.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i})=>{e.state.schema.nodes[i]!==void 0&&Fw(e,i)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i})=>{e.state.schema.nodes[i]!==void 0&&Fw(e,i)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{e.state.schema.nodes[i]!==void 0&&Dw(e,i,n)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:i,wrapperNames:n})=>{e.state.schema.nodes[i]!==void 0&&Dw(e,i,n)&&(t=!0)}),t}}}}),Vk=/^(\s*)(\d+)\.\s+(.*)$/,wG=/^\s/;function bG(e){let t=[],i=0,n=0;for(;i<e.length;){let r=e[i],o=r.match(Vk);if(!o)break;let[,s,a,l]=o,c=s.length,d=l,u=i+1,h=[r];for(;u<e.length;){let p=e[u];if(p.match(Vk))break;if(p.trim()==="")h.push(p),d+=`
`,u+=1;else if(p.match(wG))h.push(p),d+=`
${p.slice(c+2)}`,u+=1;else break}t.push({indent:c,number:parseInt(a,10),content:d.trim(),raw:h.join(`
`)}),n=u,i=u}return[t,n]}function Yk(e,t,i){var n;let r=[],o=0;for(;o<e.length;){let s=e[o];if(s.indent===t){let a=s.content.split(`
`),l=((n=a[0])==null?void 0:n.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:i.inlineTokens(l)});let d=a.slice(1).join(`
`).trim();if(d){let p=i.blockTokens(d);c.push(...p)}let u=o+1,h=[];for(;u<e.length&&e[u].indent>t;)h.push(e[u]),u+=1;if(h.length>0){let p=Math.min(...h.map(g=>g.indent)),f=Yk(h,p,i);c.push({type:"list",ordered:!0,start:h[0].number,items:f,raw:h.map(g=>g.raw).join(`
`)})}r.push({type:"list_item",raw:s.raw,tokens:c}),o=u}else o+=1}return r}function yG(e,t){return e.map(i=>{if(i.type!=="list_item")return t.parseChildren([i])[0];let n=[];return i.tokens&&i.tokens.length>0&&i.tokens.forEach(r=>{if(r.type==="paragraph"||r.type==="list"||r.type==="blockquote"||r.type==="code")n.push(...t.parseChildren([r]));else if(r.type==="text"&&r.tokens){let o=t.parseChildren([r]);n.push({type:"paragraph",content:o})}else{let o=t.parseChildren([r]);o.length>0&&n.push(...o)}}),{type:"listItem",content:n}})}var SG="listItem",Gk="textStyle",Wk=/^(\d+)\.\s$/,Ow=gt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){let n=e,{start:t}=n,i=xt(n,["start"]);return t===1?["ol",We(this.options.HTMLAttributes,i),0]:["ol",We(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];let i=e.start||1,n=e.items?yG(e.items,t):[];return i!==1?{type:"orderedList",attrs:{start:i},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{let t=e.match(/^(\s*)(\d+)\.\s+/),i=t?.index;return i!==void 0?i:-1},tokenize:(e,t,i)=>{var n;let r=e.split(`
`),[o,s]=bG(r);if(o.length===0)return;let a=Yk(o,0,i);return a.length===0?void 0:{type:"list",ordered:!0,start:((n=o[0])==null?void 0:n.number)||1,items:a,raw:r.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(SG,this.editor.getAttributes(Gk)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=gr({find:Wk,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,i)=>i.childCount+i.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=gr({find:Wk,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>w({start:+t[1]},this.editor.getAttributes(Gk)),joinPredicate:(t,i)=>i.childCount+i.attrs.start===+t[1],editor:this.editor})),[e]}}),xG=/^\s*(\[([( |x])?\])\s$/,EG=gt.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{let t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",We(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{let i=[];if(e.tokens&&e.tokens.length>0?i.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?i.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):i.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){let n=t.parseChildren(e.nestedTokens);i.push(...n)}return t.createNode("taskItem",{checked:e.checked||!1},i)},renderMarkdown:(e,t)=>{var i;let r=`- [${(i=e.attrs)!=null&&i.checked?"x":" "}] `;return au(e,t,r)},addKeyboardShortcuts(){let e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?T(w({},e),{Tab:()=>this.editor.commands.sinkListItem(this.name)}):e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:i,editor:n})=>{let r=document.createElement("li"),o=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=d=>{var u,h;a.ariaLabel=((h=(u=this.options.a11y)==null?void 0:u.checkboxLabel)==null?void 0:h.call(u,d,a.checked))||`Task item checkbox for ${d.textContent||"empty task item"}`};return c(e),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",d=>d.preventDefault()),a.addEventListener("change",d=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}let{checked:u}=d.target;n.isEditable&&typeof i=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:h})=>{let p=i();if(typeof p!="number")return!1;let f=h.doc.nodeAt(p);return h.setNodeMarkup(p,void 0,T(w({},f?.attrs),{checked:u})),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([d,u])=>{r.setAttribute(d,u)}),r.dataset.checked=e.attrs.checked,a.checked=e.attrs.checked,o.append(a,s),r.append(o,l),Object.entries(t).forEach(([d,u])=>{r.setAttribute(d,u)}),{dom:r,contentDOM:l,update:d=>d.type!==this.type?!1:(r.dataset.checked=d.attrs.checked,a.checked=d.attrs.checked,c(d),!0)}}},addInputRules(){return[gr({find:xG,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),RG=gt.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",We(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;let i=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return i!==void 0?i:-1},tokenize(e,t,i){let n=o=>{let s=Tf(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:i.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:n},i);return s?[{type:"taskList",raw:s.raw,items:s.items}]:i.blockTokens(o)},r=Tf(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,s)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:i.inlineTokens(o.mainContent),nestedTokens:s}),customNestedParser:n},i);if(r)return{type:"taskList",raw:r.raw,items:r.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),Xwe=Xe.create({name:"listKit",addExtensions(){let e=[];return this.options.bulletList!==!1&&e.push(Mw.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(Tw.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(Aw.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(Ow.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(EG.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(RG.configure(this.options.taskList)),e}});var Xk=gt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",We(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{let i=e.tokens||[];return i.length===1&&i[0].type==="image"?t.parseChildren([i[0]]):t.createNode("paragraph",void 0,t.parseInline(i))},renderMarkdown:(e,t)=>!e||!Array.isArray(e.content)?"":t.renderChildren(e.content),addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});var PG=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,kG=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Jk=rn.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",We(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[fr({find:PG,type:this.type})]},addPasteRules(){return[Rn({find:kG,type:this.type})]}});var Qk=gt.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""});var Zk=rn.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",We(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,i){let r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!r)return;let o=r[2].trim();return{type:"underline",raw:r[0],text:o,tokens:i.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function e_(e={}){return new Te({view(t){return new Lw(t,e)}})}var Lw=class{constructor(t,i){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=i.width)!==null&&n!==void 0?n:1,this.color=i.color===!1?void 0:i.color||"black",this.class=i.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let o=s=>{this[r](s)};return t.dom.addEventListener(r,o),{name:r,handler:o}})}destroy(){this.handlers.forEach(({name:t,handler:i})=>this.editorView.dom.removeEventListener(t,i))}update(t,i){this.cursorPos!=null&&i.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),i=!t.parent.inlineContent,n,r=this.editorView.dom,o=r.getBoundingClientRect(),s=o.width/r.offsetWidth,a=o.height/r.offsetHeight;if(i){let u=t.nodeBefore,h=t.nodeAfter;if(u||h){let p=this.editorView.nodeDOM(this.cursorPos-(u?u.nodeSize:0));if(p){let f=p.getBoundingClientRect(),g=u?f.bottom:f.top;u&&h&&(g=(g+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let m=this.width/2*a;n={left:f.left,right:f.right,top:g-m,bottom:g+m}}}}if(!n){let u=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*s;n={left:u.left-h,right:u.left+h,top:u.top,bottom:u.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",i),this.element.classList.toggle("prosemirror-dropcursor-inline",!i);let c,d;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,d=-pageYOffset;else{let u=l.getBoundingClientRect(),h=u.width/l.offsetWidth,p=u.height/l.offsetHeight;c=u.left-l.scrollLeft*h,d=u.top-l.scrollTop*p}this.element.style.left=(n.left-c)/s+"px",this.element.style.top=(n.top-d)/a+"px",this.element.style.width=(n.right-n.left)/s+"px",this.element.style.height=(n.bottom-n.top)/a+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let i=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=i&&i.inside>=0&&this.editorView.state.doc.nodeAt(i.inside),r=n&&n.type.spec.disableDropCursor,o=typeof r=="function"?r(this.editorView,i,t):r;if(i&&!o){let s=i.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Jp(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}};var bi=class e extends Me{constructor(t){super(t,t)}map(t,i){let n=t.resolve(i.map(this.head));return e.valid(n)?new e(n):Me.near(n)}content(){return we.empty}eq(t){return t instanceof e&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,i){if(typeof i.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(i.pos))}getBookmark(){return new Nw(this.anchor)}static valid(t){let i=t.parent;if(i.isTextblock||!_G(t)||!DG(t))return!1;let n=i.type.spec.allowGapCursor;if(n!=null)return n;let r=i.contentMatchAt(t.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(t,i,n=!1){e:for(;;){if(!n&&e.valid(t))return t;let r=t.pos,o=null;for(let s=t.depth;;s--){let a=t.node(s);if(i>0?t.indexAfter(s)<a.childCount:t.index(s)>0){o=a.child(i>0?t.indexAfter(s):t.index(s)-1);break}else if(s==0)return null;r+=i;let l=t.doc.resolve(r);if(e.valid(l))return l}for(;;){let s=i>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!Re.isSelectable(o)){t=t.doc.resolve(r+o.nodeSize*i),n=!1;continue e}break}o=s,r+=i;let a=t.doc.resolve(r);if(e.valid(a))return a}return null}}};bi.prototype.visible=!1;bi.findFrom=bi.findGapCursorFrom;Me.jsonID("gapcursor",bi);var Nw=class e{constructor(t){this.pos=t}map(t){return new e(t.map(this.pos))}resolve(t){let i=t.resolve(this.pos);return bi.valid(i)?new bi(i):Me.near(i)}};function t_(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function _G(e){for(let t=e.depth;t>=0;t--){let i=e.index(t),n=e.node(t);if(i==0){if(n.type.spec.isolating)return!0;continue}for(let r=n.child(i-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||t_(r.type))return!0;if(r.inlineContent)return!1}}return!0}function DG(e){for(let t=e.depth;t>=0;t--){let i=e.indexAfter(t),n=e.node(t);if(i==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let r=n.child(i);;r=r.firstChild){if(r.childCount==0&&!r.inlineContent||t_(r.type))return!0;if(r.inlineContent)return!1}}return!0}function i_(){return new Te({props:{decorations:IG,createSelectionBetween(e,t,i){return t.pos==i.pos&&bi.valid(i)?new bi(i):null},handleClick:MG,handleKeyDown:FG,handleDOMEvents:{beforeinput:TG}}})}var FG=H1({ArrowLeft:pg("horiz",-1),ArrowRight:pg("horiz",1),ArrowUp:pg("vert",-1),ArrowDown:pg("vert",1)});function pg(e,t){let i=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(n,r,o){let s=n.selection,a=t>0?s.$to:s.$from,l=s.empty;if(s instanceof ke){if(!o.endOfTextblock(i)||a.depth==0)return!1;l=!1,a=n.doc.resolve(t>0?a.after():a.before())}let c=bi.findGapCursorFrom(a,t,l);return c?(r&&r(n.tr.setSelection(new bi(c))),!0):!1}}function MG(e,t,i){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!bi.valid(n))return!1;let r=e.posAtCoords({left:i.clientX,top:i.clientY});return r&&r.inside>-1&&Re.isSelectable(e.state.doc.nodeAt(r.inside))?!1:(e.dispatch(e.state.tr.setSelection(new bi(n))),!0)}function TG(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof bi))return!1;let{$from:i}=e.state.selection,n=i.parent.contentMatchAt(i.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let r=ie.empty;for(let s=n.length-1;s>=0;s--)r=ie.from(n[s].createAndFill(null,r));let o=e.state.tr.replace(i.pos,i.pos,new we(r,0,0));return o.setSelection(ke.near(o.doc.resolve(i.pos+1))),e.dispatch(o),!1}function IG(e){if(!(e.selection instanceof bi))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Tt.create(e.doc,[wi.widget(e.selection.head,t,{key:"gapcursor"})])}var fg=200,ti=function(){};ti.prototype.append=function(t){return t.length?(t=ti.from(t),!this.length&&t||t.length<fg&&this.leafAppend(t)||this.length<fg&&t.leafPrepend(this)||this.appendInner(t)):this};ti.prototype.prepend=function(t){return t.length?ti.from(t).append(this):this};ti.prototype.appendInner=function(t){return new AG(this,t)};ti.prototype.slice=function(t,i){return t===void 0&&(t=0),i===void 0&&(i=this.length),t>=i?ti.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,i))};ti.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};ti.prototype.forEach=function(t,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length),i<=n?this.forEachInner(t,i,n,0):this.forEachInvertedInner(t,i,n,0)};ti.prototype.map=function(t,i,n){i===void 0&&(i=0),n===void 0&&(n=this.length);var r=[];return this.forEach(function(o,s){return r.push(t(o,s))},i,n),r};ti.from=function(t){return t instanceof ti?t:t&&t.length?new n_(t):ti.empty};var n_=(function(e){function t(n){e.call(this),this.values=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var i={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(r,o){return r==0&&o==this.length?this:new t(this.values.slice(r,o))},t.prototype.getInner=function(r){return this.values[r]},t.prototype.forEachInner=function(r,o,s,a){for(var l=o;l<s;l++)if(r(this.values[l],a+l)===!1)return!1},t.prototype.forEachInvertedInner=function(r,o,s,a){for(var l=o-1;l>=s;l--)if(r(this.values[l],a+l)===!1)return!1},t.prototype.leafAppend=function(r){if(this.length+r.length<=fg)return new t(this.values.concat(r.flatten()))},t.prototype.leafPrepend=function(r){if(this.length+r.length<=fg)return new t(r.flatten().concat(this.values))},i.length.get=function(){return this.values.length},i.depth.get=function(){return 0},Object.defineProperties(t.prototype,i),t})(ti);ti.empty=new n_([]);var AG=(function(e){function t(i,n){e.call(this),this.left=i,this.right=n,this.length=i.length+n.length,this.depth=Math.max(i.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,r,o,s){var a=this.left.length;if(r<a&&this.left.forEachInner(n,r,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(n,Math.max(r-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},t.prototype.forEachInvertedInner=function(n,r,o,s){var a=this.left.length;if(r>a&&this.right.forEachInvertedInner(n,r-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(n,Math.min(r,a),o,s)===!1)return!1},t.prototype.sliceInner=function(n,r){if(n==0&&r==this.length)return this;var o=this.left.length;return r<=o?this.left.slice(n,r):n>=o?this.right.slice(n-o,r-o):this.left.slice(n,o).append(this.right.slice(0,r-o))},t.prototype.leafAppend=function(n){var r=this.right.leafAppend(n);if(r)return new t(this.left,r)},t.prototype.leafPrepend=function(n){var r=this.left.leafPrepend(n);if(r)return new t(r,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t})(ti),Bw=ti;var OG=500,na=class e{constructor(t,i){this.items=t,this.eventCount=i}popEvent(t,i){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let r,o;i&&(r=this.remapping(n,this.items.length),o=r.maps.length);let s=t.tr,a,l,c=[],d=[];return this.items.forEach((u,h)=>{if(!u.step){r||(r=this.remapping(n,h+1),o=r.maps.length),o--,d.push(u);return}if(r){d.push(new Cr(u.map));let p=u.step.map(r.slice(o)),f;p&&s.maybeStep(p).doc&&(f=s.mapping.maps[s.mapping.maps.length-1],c.push(new Cr(f,void 0,void 0,c.length+d.length))),o--,f&&r.appendMap(f,o)}else s.maybeStep(u.step);if(u.selection)return a=r?u.selection.map(r.slice(o)):u.selection,l=new e(this.items.slice(0,n).append(d.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(t,i,n,r){let o=[],s=this.eventCount,a=this.items,l=!r&&a.length?a.get(a.length-1):null;for(let d=0;d<t.steps.length;d++){let u=t.steps[d].invert(t.docs[d]),h=new Cr(t.mapping.maps[d],u,i),p;(p=l&&l.merge(h))&&(h=p,d?o.pop():a=a.slice(0,a.length-1)),o.push(h),i&&(s++,i=void 0),r||(l=h)}let c=s-n.depth;return c>NG&&(a=LG(a,c),s-=c),new e(a.append(o),s)}remapping(t,i){let n=new Ud;return this.items.forEach((r,o)=>{let s=r.mirrorOffset!=null&&o-r.mirrorOffset>=t?n.maps.length-r.mirrorOffset:void 0;n.appendMap(r.map,s)},t,i),n}addMaps(t){return this.eventCount==0?this:new e(this.items.append(t.map(i=>new Cr(i))),this.eventCount)}rebased(t,i){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-i),o=t.mapping,s=t.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},r);let l=i;this.items.forEach(h=>{let p=o.getMirror(--l);if(p==null)return;s=Math.min(s,p);let f=o.maps[p];if(h.step){let g=t.steps[p].invert(t.docs[p]),m=h.selection&&h.selection.map(o.slice(l+1,p));m&&a++,n.push(new Cr(f,g,m))}else n.push(new Cr(f))},r);let c=[];for(let h=i;h<s;h++)c.push(new Cr(o.maps[h]));let d=this.items.slice(0,r).append(c).append(n),u=new e(d,a);return u.emptyItemCount()>OG&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let t=0;return this.items.forEach(i=>{i.step||t++}),t}compress(t=this.items.length){let i=this.remapping(0,t),n=i.maps.length,r=[],o=0;return this.items.forEach((s,a)=>{if(a>=t)r.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(i.slice(n)),c=l&&l.getMap();if(n--,c&&i.appendMap(c,n),l){let d=s.selection&&s.selection.map(i.slice(n));d&&o++;let u=new Cr(c.invert(),l,d),h,p=r.length-1;(h=r.length&&r[p].merge(u))?r[p]=h:r.push(u)}}else s.map&&n--},this.items.length,0),new e(Bw.from(r.reverse()),o)}};na.empty=new na(Bw.empty,0);function LG(e,t){let i;return e.forEach((n,r)=>{if(n.selection&&t--==0)return i=r,!1}),e.slice(i)}var Cr=class e{constructor(t,i,n,r){this.map=t,this.step=i,this.selection=n,this.mirrorOffset=r}merge(t){if(this.step&&t.step&&!t.selection){let i=t.step.merge(this.step);if(i)return new e(i.getMap().invert(),i,this.selection)}}},wr=class{constructor(t,i,n,r,o){this.done=t,this.undone=i,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}},NG=20;function BG(e,t,i,n){let r=i.getMeta(ia),o;if(r)return r.historyState;i.getMeta(VG)&&(e=new wr(e.done,e.undone,null,0,-1));let s=i.getMeta("appendedTransaction");if(i.steps.length==0)return e;if(s&&s.getMeta(ia))return s.getMeta(ia).redo?new wr(e.done.addTransform(i,void 0,n,gg(t)),e.undone,r_(i.mapping.maps),e.prevTime,e.prevComposition):new wr(e.done,e.undone.addTransform(i,void 0,n,gg(t)),null,e.prevTime,e.prevComposition);if(i.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=i.getMeta("composition"),l=e.prevTime==0||!s&&e.prevComposition!=a&&(e.prevTime<(i.time||0)-n.newGroupDelay||!HG(i,e.prevRanges)),c=s?Hw(e.prevRanges,i.mapping):r_(i.mapping.maps);return new wr(e.done.addTransform(i,l?t.selection.getBookmark():void 0,n,gg(t)),na.empty,c,i.time,a??e.prevComposition)}else return(o=i.getMeta("rebased"))?new wr(e.done.rebased(i,o),e.undone.rebased(i,o),Hw(e.prevRanges,i.mapping),e.prevTime,e.prevComposition):new wr(e.done.addMaps(i.mapping.maps),e.undone.addMaps(i.mapping.maps),Hw(e.prevRanges,i.mapping),e.prevTime,e.prevComposition)}function HG(e,t){if(!t)return!1;if(!e.docChanged)return!0;let i=!1;return e.mapping.maps[0].forEach((n,r)=>{for(let o=0;o<t.length;o+=2)n<=t[o+1]&&r>=t[o]&&(i=!0)}),i}function r_(e){let t=[];for(let i=e.length-1;i>=0&&t.length==0;i--)e[i].forEach((n,r,o,s)=>t.push(o,s));return t}function Hw(e,t){if(!e)return null;let i=[];for(let n=0;n<e.length;n+=2){let r=t.map(e[n],1),o=t.map(e[n+1],-1);r<=o&&i.push(r,o)}return i}function zG(e,t,i){let n=gg(t),r=ia.get(t).spec.config,o=(i?e.undone:e.done).popEvent(t,n);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(i?e.done:e.undone).addTransform(o.transform,t.selection.getBookmark(),r,n),l=new wr(i?a:o.remaining,i?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(ia,{redo:i,historyState:l})}var zw=!1,o_=null;function gg(e){let t=e.plugins;if(o_!=t){zw=!1,o_=t;for(let i=0;i<t.length;i++)if(t[i].spec.historyPreserveItems){zw=!0;break}}return zw}var ia=new Be("history"),VG=new Be("closeHistory");function s_(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Te({key:ia,state:{init(){return new wr(na.empty,na.empty,null,0,-1)},apply(t,i,n){return BG(i,n,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,i){let n=i.inputType,r=n=="historyUndo"?Vw:n=="historyRedo"?Gw:null;return!r||!t.editable?!1:(i.preventDefault(),r(t.state,t.dispatch))}}}})}function mg(e,t){return(i,n)=>{let r=ia.getState(i);if(!r||(e?r.undone:r.done).eventCount==0)return!1;if(n){let o=zG(r,i,e);o&&n(t?o.scrollIntoView():o)}return!0}}var Vw=mg(!1,!0),Gw=mg(!0,!0),xbe=mg(!1,!1),Ebe=mg(!0,!1);var Fbe=Xe.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{let t=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){let n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{let t=e?.node||this.editor.state.doc,i=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(i)}},addProseMirrorPlugins(){let e=!1;return[new Te({key:new Be("characterCount"),appendTransaction:(t,i,n)=>{if(e)return;let r=this.options.limit;if(r==null||r===0){e=!0;return}let o=this.storage.characters({node:n.doc});if(o>r){let s=o-r,a=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${r} characters. Content was automatically trimmed.`);let c=n.tr.deleteRange(a,l);return e=!0,c}e=!0},filterTransaction:(t,i)=>{let n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;let r=this.storage.characters({node:i.doc}),o=this.storage.characters({node:t.doc});if(o<=n||r>n&&o>n&&o<=r)return!0;if(r>n&&o>n&&o>r||!t.getMeta("paste"))return!1;let a=t.selection.$head.pos,l=o-n,c=a-l,d=a;return t.deleteRange(c,d),!(this.storage.characters({node:t.doc})>n)}})]}}),l_=Xe.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[e_(this.options)]}}),Lbe=Xe.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Te({key:new Be("focus"),props:{decorations:({doc:e,selection:t})=>{let{isEditable:i,isFocused:n}=this.editor,{anchor:r}=t,o=[];if(!i||!n)return Tt.create(e,[]);let s=0;this.options.mode==="deepest"&&e.descendants((l,c)=>{if(l.isText)return;if(!(r>=c&&r<=c+l.nodeSize-1))return!1;s+=1});let a=0;return e.descendants((l,c)=>{if(l.isText||!(r>=c&&r<=c+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&s-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(wi.node(c,c+l.nodeSize,{class:this.options.className}))}),Tt.create(e,o)}}})]}}),c_=Xe.create({name:"gapCursor",addProseMirrorPlugins(){return[i_()]},extendNodeSchema(e){var t;let i={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=rt(Pe(e,"allowGapCursor",i)))!=null?t:null}}}),Gbe=Xe.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something \u2026",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Te({key:new Be("placeholder"),props:{decorations:({doc:e,selection:t})=>{let i=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=t,r=[];if(!i)return null;let o=this.editor.isEmpty;return e.descendants((s,a)=>{let l=n>=a&&n<=a+s.nodeSize,c=!s.isLeaf&&ou(s);if((l||!this.options.showOnlyCurrent)&&c){let d=[this.options.emptyNodeClass];o&&d.push(this.options.emptyEditorClass);let u=wi.node(a,a+s.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});r.push(u)}return this.options.includeChildren}),Tt.create(e,r)}}})]}}),qbe=Xe.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){let{editor:e,options:t}=this;return[new Te({key:new Be("selection"),props:{decorations(i){return i.selection.empty||e.isFocused||!e.isEditable||Ff(i.selection)||e.view.dragging?null:Tt.create(i.doc,[wi.inline(i.selection.from,i.selection.to,{class:t.className})])}}})]}});function a_({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||t?.type===e}var d_=Xe.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;let t=new Be(this.name),i=this.options.node||((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,r])=>r).filter(r=>(this.options.notAfter||[]).concat(i).includes(r.name));return[new Te({key:t,appendTransaction:(r,o,s)=>{let{doc:a,tr:l,schema:c}=s,d=t.getState(s),u=a.content.size,h=c.nodes[i];if(d)return l.insert(u,h.create())},state:{init:(r,o)=>{let s=o.tr.doc.lastChild;return!a_({node:s,types:n})},apply:(r,o)=>{if(!r.docChanged||r.getMeta("__uniqueIDTransaction"))return o;let s=r.doc.lastChild;return!a_({node:s,types:n})}}})]}}),u_=Xe.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>Vw(e,t),redo:()=>({state:e,dispatch:t})=>Gw(e,t)}},addProseMirrorPlugins(){return[s_(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}});var GG=Xe.create({name:"starterKit",addExtensions(){var e,t,i,n;let r=[];return this.options.bold!==!1&&r.push(Mk.configure(this.options.bold)),this.options.blockquote!==!1&&r.push(Fk.configure(this.options.blockquote)),this.options.bulletList!==!1&&r.push(Mw.configure(this.options.bulletList)),this.options.code!==!1&&r.push(Tk.configure(this.options.code)),this.options.codeBlock!==!1&&r.push(Ik.configure(this.options.codeBlock)),this.options.document!==!1&&r.push(Ak.configure(this.options.document)),this.options.dropcursor!==!1&&r.push(l_.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&r.push(c_.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&r.push(Ok.configure(this.options.hardBreak)),this.options.heading!==!1&&r.push(Lk.configure(this.options.heading)),this.options.undoRedo!==!1&&r.push(u_.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&r.push(Nk.configure(this.options.horizontalRule)),this.options.italic!==!1&&r.push(Bk.configure(this.options.italic)),this.options.listItem!==!1&&r.push(Tw.configure(this.options.listItem)),this.options.listKeymap!==!1&&r.push(Aw.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&r.push(kw.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&r.push(Ow.configure(this.options.orderedList)),this.options.paragraph!==!1&&r.push(Xk.configure(this.options.paragraph)),this.options.strike!==!1&&r.push(Jk.configure(this.options.strike)),this.options.text!==!1&&r.push(Qk.configure(this.options.text)),this.options.underline!==!1&&r.push(Zk.configure((i=this.options)==null?void 0:i.underline)),this.options.trailingNode!==!1&&r.push(d_.configure((n=this.options)==null?void 0:n.trailingNode)),r}}),h_=GG;var p_=(()=>{class e{elRef=ce(ci);renderer=ce(b0);changeDetectorRef=ce(Nc);editor=De.required();outputFormat=De("html");onChange=()=>{};onTouched=()=>{};writeValue(i){this.editor().chain().setContent(i,{emitUpdate:!1}).run()}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.editor().setEditable(!i),this.renderer.setProperty(this.elRef.nativeElement,"disabled",i)}handleChange=({editor:i,transaction:n})=>{if(n.docChanged){if(this.changeDetectorRef.markForCheck(),this.outputFormat()==="html"){this.onChange(i.getHTML());return}this.onChange(i.getJSON())}};ngOnInit(){let i=this.editor(),{innerHTML:n}=this.elRef.nativeElement;this.elRef.nativeElement.innerHTML="",this.elRef.nativeElement.append(...Array.from(i.options.element?.childNodes||[])),i.setOptions({element:this.elRef.nativeElement}),n&&i.chain().setContent(n,{emitUpdate:!1}).run(),i.on("blur",()=>{this.onTouched()}),i.on("update",this.handleChange),i.on("selectionUpdate",()=>this.changeDetectorRef.markForCheck())}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,selectors:[["tiptap","editor",""],["","tiptap","","editor",""],["tiptap-editor","editor",""],["","tiptapEditor","","editor",""]],inputs:{editor:[1,"editor"],outputFormat:[1,"outputFormat"]},features:[it([{provide:zh,useExisting:Ih(()=>e),multi:!0}])]})}return e})();var f_=(()=>{class e{destroyRef=ce(S2);suppressEmit=!1;initialContent=De("");minHeight=De("300px");contentChange=Ce();editor=new dk({extensions:[h_.configure({heading:{levels:[1,2,3]}}),Dk.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline hover:text-blue-800"}})],editorProps:{attributes:{class:"prose prose-sm sm:prose lg:prose-lg xl:prose-xl focus:outline-none max-w-none p-4"}},content:this.initialContent()||"",onUpdate:({editor:i})=>{this.suppressEmit||this.contentChange.emit(i.getHTML())}});constructor(){ht(()=>{let i=this.initialContent()||"",n=this.editor.getHTML();i!==n&&(this.suppressEmit=!0,this.editor.commands.setContent(i,{emitUpdate:!1}),this.suppressEmit=!1)}),this.destroyRef.onDestroy(()=>{this.editor?.destroy()})}isBold(){return this.editor?.isActive("bold")??!1}isItalic(){return this.editor?.isActive("italic")??!1}isStrike(){return this.editor?.isActive("strike")??!1}isCode(){return this.editor?.isActive("code")??!1}isH1(){return this.editor?.isActive("heading",{level:1})??!1}isH2(){return this.editor?.isActive("heading",{level:2})??!1}isBulletList(){return this.editor?.isActive("bulletList")??!1}isOrderedList(){return this.editor?.isActive("orderedList")??!1}isBlockquote(){return this.editor?.isActive("blockquote")??!1}toggleBold(){this.editor?.chain().focus().toggleBold().run()}toggleItalic(){this.editor?.chain().focus().toggleItalic().run()}toggleStrike(){this.editor?.chain().focus().toggleStrike().run()}toggleCode(){this.editor?.chain().focus().toggleCode().run()}toggleH1(){this.editor?.chain().focus().toggleHeading({level:1}).run()}toggleH2(){this.editor?.chain().focus().toggleHeading({level:2}).run()}toggleBulletList(){this.editor?.chain().focus().toggleBulletList().run()}toggleOrderedList(){this.editor?.chain().focus().toggleOrderedList().run()}toggleBlockquote(){this.editor?.chain().focus().toggleBlockquote().run()}setLink(){let i=window.prompt("Enter URL:");i&&this.editor?.chain().focus().setLink({href:i}).run()}undo(){this.editor?.chain().focus().undo().run()}redo(){this.editor?.chain().focus().redo().run()}getHTML(){return this.editor?.getHTML()}getJSON(){return this.editor?.getJSON()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-tiptap-editor"]],inputs:{initialContent:[1,"initialContent"],minHeight:[1,"minHeight"]},outputs:{contentChange:"contentChange"},features:[it([di({lucideBold:N2,lucideItalic:U2,lucideStrikethrough:i3,lucideCode:z2,lucideHeading1:G2,lucideHeading2:W2,lucideList:$2,lucideListOrdered:q2,lucideQuote:J2,lucideUndo:n3,lucideRedo:Q2,lucideLink:j2})])],decls:31,vars:21,consts:[[1,"border","rounded-t-md","p-2","bg-muted/30","flex","flex-wrap","gap-1","items-center"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Bold (Ctrl+B)",3,"click"],["hlm","","name","lucideBold","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Italic (Ctrl+I)",3,"click"],["hlm","","name","lucideItalic","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Strikethrough",3,"click"],["hlm","","name","lucideStrikethrough","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Code",3,"click"],["hlm","","name","lucideCode","size","sm"],["hlmSeparator","","orientation","vertical",1,"h-6","mx-1"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Heading 1",3,"click"],["hlm","","name","lucideHeading1","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Heading 2",3,"click"],["hlm","","name","lucideHeading2","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Bullet List",3,"click"],["hlm","","name","lucideList","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Numbered List",3,"click"],["hlm","","name","lucideListOrdered","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Blockquote",3,"click"],["hlm","","name","lucideQuote","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Add Link",3,"click"],["hlm","","name","lucideLink","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Undo (Ctrl+Z)",3,"click"],["hlm","","name","lucideUndo","size","sm"],["hlmBtn","","type","button","variant","ghost","size","icon","title","Redo (Ctrl+Shift+Z)",3,"click"],["hlm","","name","lucideRedo","size","sm"],[1,"border","border-t-0","rounded-b-md","bg-background"],[1,"block",3,"editor"]],template:function(n,r){n&1&&(A(0,"div",0)(1,"button",1),de("click",function(){return r.toggleBold()}),le(2,"ng-icon",2),I(),A(3,"button",3),de("click",function(){return r.toggleItalic()}),le(4,"ng-icon",4),I(),A(5,"button",5),de("click",function(){return r.toggleStrike()}),le(6,"ng-icon",6),I(),A(7,"button",7),de("click",function(){return r.toggleCode()}),le(8,"ng-icon",8),I(),le(9,"div",9),A(10,"button",10),de("click",function(){return r.toggleH1()}),le(11,"ng-icon",11),I(),A(12,"button",12),de("click",function(){return r.toggleH2()}),le(13,"ng-icon",13),I(),le(14,"div",9),A(15,"button",14),de("click",function(){return r.toggleBulletList()}),le(16,"ng-icon",15),I(),A(17,"button",16),de("click",function(){return r.toggleOrderedList()}),le(18,"ng-icon",17),I(),le(19,"div",9),A(20,"button",18),de("click",function(){return r.toggleBlockquote()}),le(21,"ng-icon",19),I(),A(22,"button",20),de("click",function(){return r.setLink()}),le(23,"ng-icon",21),I(),le(24,"div",9),A(25,"button",22),de("click",function(){return r.undo()}),le(26,"ng-icon",23),I(),A(27,"button",24),de("click",function(){return r.redo()}),le(28,"ng-icon",25),I()(),A(29,"div",26),le(30,"tiptap-editor",27),I()),n&2&&(L(),At("bg-accent",r.isBold()),L(2),At("bg-accent",r.isItalic()),L(2),At("bg-accent",r.isStrike()),L(2),At("bg-accent",r.isCode()),L(3),At("bg-accent",r.isH1()),L(2),At("bg-accent",r.isH2()),L(3),At("bg-accent",r.isBulletList()),L(2),At("bg-accent",r.isOrderedList()),L(3),At("bg-accent",r.isBlockquote()),L(10),zr("min-height",r.minHeight()),ve("editor",r.editor))},dependencies:[Rt,hi,ui,Wh,p_],encapsulation:2,changeDetection:0})}return e})();var ma=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,i){let n=t?this.allAsyncListeners:this.allSyncListeners,r=n.get(e);return!r&&i&&(r=new Set,n.set(e,r)),r}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,i=!1){this.getListeners(e,i,!0).add(t)}removeEventListener(e,t,i=!1){let n=this.getListeners(e,i,!1);n&&(n.delete(t),n.size===0&&(i?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){let i=e.type;if(t&&"event"in e){let a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}let{frameworkOverrides:n}=this,r=a=>{let l=n?()=>n.wrapIncoming(a):a;t?this.dispatchAsync(l):l()},o=this.getListeners(i,t,!1);if((o?.size??0)>0){let a=new Set(o);for(let l of a)o?.has(l)&&r(()=>l(e))}let s=this.getGlobalListeners(t);if(s.size>0){let a=new Set(s);for(let l of a)r(()=>l(i,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){let t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;let e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(let t of e)t()}};function ao(e){return e==null||e===""?null:e}function pe(e){return e!=null&&e!==""}function mt(e){return!pe(e)}function Rb(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function Nu(e,t){let i=e?JSON.stringify(e):null,n=t?JSON.stringify(t):null;return i===n}function qG(e,t,i={}){i.transform&&(e=i.transform(e),t=i.transform(t));let n=e==null,r=t==null;if(e?.toNumber&&(e=e.toNumber()),t?.toNumber&&(t=t.toNumber()),n&&r)return 0;if(n)return-1;if(r)return 1;function o(s,a){return s>a?1:s<a?-1:0}if(typeof e!="string"||!i.accentedCompare)return o(e,t);try{return e.localeCompare(t)}catch{return o(e,t)}}var $G=/[&<>"']/g,KG={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function ac(e){return e?.toString().toString()??null}function _u(e){return ac(e)?.replace($G,t=>KG[t])??null}function g_(e){return typeof e=="string"&&e.startsWith("=")&&e.length>1}function xr(e){return e.eRootDiv.getRootNode()}function bt(e){return xr(e).activeElement}function Kt(e){let{gos:t,eRootDiv:i}=e,n=null,r=t.get("getDocument");return r&&pe(r)?n=r():i&&(n=i.ownerDocument),n&&pe(n)?n:document}function oy(e){let t=bt(e);return t===null||t===Kt(e).body}function HD(e){return Kt(e).defaultView||window}function sy(e){let t=null,i=null;try{t=Kt(e).fullscreenElement}catch{}finally{t||(t=xr(e));let n=t.querySelector("body");n?i=n:t instanceof ShadowRoot?i=t:t instanceof Document?i=t?.documentElement:i=t}return i}function YG(e){return sy(e)?.clientWidth??(window.innerWidth||-1)}function XG(e){return sy(e)?.clientHeight??(window.innerHeight||-1)}function $n(e,t,i){i==null||typeof i=="string"&&i==""?zD(e,t):Mn(e,t,i)}function Mn(e,t,i){e.setAttribute(VD(t),i.toString())}function zD(e,t){e.removeAttribute(VD(t))}function VD(e){return`aria-${e}`}function ss(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function JG(e){let t=e?.direction;return t==="asc"?"ascending":t==="desc"?"descending":t==="mixed"?"other":"none"}function QG(e){return e.getAttribute("aria-label")}function ec(e,t){$n(e,"label",t)}function Bu(e,t){$n(e,"labelledby",t)}function GD(e,t){$n(e,"live",t)}function ZG(e,t){$n(e,"atomic",t)}function eW(e,t){$n(e,"relevant",t)}function ay(e,t){$n(e,"invalid",t)}function tW(e,t){$n(e,"disabled",t)}function WD(e,t){$n(e,"hidden",t)}function Pb(e,t){Mn(e,"expanded",t)}function iW(e,t){Mn(e,"setsize",t)}function nW(e,t){Mn(e,"posinset",t)}function rW(e,t){Mn(e,"multiselectable",t)}function oW(e,t){Mn(e,"rowcount",t)}function Ug(e,t){Mn(e,"rowindex",t)}function sW(e,t){Mn(e,"rowspan",t)}function aW(e,t){Mn(e,"colcount",t)}function UD(e,t){Mn(e,"colindex",t)}function lW(e,t){Mn(e,"colspan",t)}function cW(e,t){Mn(e,"sort",t)}function dW(e){zD(e,"sort")}function jD(e,t){$n(e,"selected",t)}function uW(e,t){$n(e,"controls",t)}function hW(e,t){uW(e,t.id),Bu(t,e.id)}function m_(e,t){$n(e,"owns",t)}function gm(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var pW="[tabindex], input, select, button, textarea, [href]",qD="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function Du(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(qD)?!1:Ir(e)}function ot(e,t,i={}){let{skipAriaHidden:n}=i;e.classList.toggle("ag-hidden",!t),n||WD(e,!t)}function fW(e,t,i={}){let{skipAriaHidden:n}=i;e.classList.toggle("ag-invisible",!t),n||WD(e,!t)}function Hu(e,t){let i="disabled",n=t?o=>o.setAttribute(i,""):o=>o.removeAttribute(i);n(e);let r=e.querySelectorAll("input")??[];for(let o of r)n(o)}function da(e,t,i){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof i=="number"){if(++n>i)break}else if(e===i)break}return!1}function ya(e){let{height:t,width:i,borderTopWidth:n,borderRightWidth:r,borderBottomWidth:o,borderLeftWidth:s,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:d,marginTop:u,marginRight:h,marginBottom:p,marginLeft:f,boxSizing:g}=window.getComputedStyle(e),m=Number.parseFloat;return{height:m(t||"0"),width:m(i||"0"),borderTopWidth:m(n||"0"),borderRightWidth:m(r||"0"),borderBottomWidth:m(o||"0"),borderLeftWidth:m(s||"0"),paddingTop:m(a||"0"),paddingRight:m(l||"0"),paddingBottom:m(c||"0"),paddingLeft:m(d||"0"),marginTop:m(u||"0"),marginRight:m(h||"0"),marginBottom:m(p||"0"),marginLeft:m(f||"0"),boxSizing:g}}function ly(e){let t=ya(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function zu(e){let t=ya(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function $D(e){let{height:t,marginBottom:i,marginTop:n}=ya(e);return Math.floor(t+i+n)}function jg(e){let{width:t,marginLeft:i,marginRight:n}=ya(e);return Math.floor(t+i+n)}function KD(e){let t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:n,borderRightWidth:r,borderBottomWidth:o}=ya(e);return{top:t.top+(i||0),left:t.left+(n||0),right:t.right+(r||0),bottom:t.bottom+(o||0)}}function qg(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i)),i}function $g(e,t,i){i&&(t*=-1),e.scrollLeft=t}function ii(e){for(;e?.firstChild;)e.firstChild.remove()}function Wi(e){e?.parentNode&&e.remove()}function cy(e){return!!e.offsetParent}function Ir(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!cy(e)||window.getComputedStyle(e).visibility!=="visible")}function dy(e){let t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function YD(e,t,i){i&&i.nextSibling===t||(e.firstChild?i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t):e.appendChild(t))}function XD(e,t){for(let i=0;i<t.length;i++){let n=t[i],r=e.children[i];r!==n&&e.insertBefore(n,r)}}function gW(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}function Xu(e,t){if(t)for(let i of Object.keys(t)){let n=t[i];if(!i?.length||n==null)continue;let r=gW(i),o=n.toString(),s=o.replace(/\s*!important/g,""),a=s.length!=o.length?"important":void 0;e.style.setProperty(r,s,a)}}function Dg(e){return()=>{let t=e();return t?uy(t)||JD(t):!0}}function uy(e){return e.clientWidth<e.scrollWidth}function JD(e){return e.clientHeight<e.scrollHeight}function Kg(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Dr(e,t)}function Dr(e,t){t=hy(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function Fu(e,t){t=hy(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function hy(e){return typeof e=="number"?`${e}px`:e}function py(e){return e instanceof Node||e instanceof HTMLElement}function Ui(e,t,i){i==null||i===""?e.removeAttribute(t):e.setAttribute(t,i.toString())}function us(e,t,i){let r=HD(e).ResizeObserver,o=r?new r(i):null;return o?.observe(t),()=>o?.disconnect()}function go(e,t){let i=HD(e);i.requestAnimationFrame?i.requestAnimationFrame(t):i.webkitRequestAnimationFrame?i.webkitRequestAnimationFrame(t):i.setTimeout(t,0)}var QD="data-ref",Ww;function v_(){return Ww??(Ww=document.createTextNode(" ")),Ww.cloneNode()}function ns(e){let{attrs:t,children:i,cls:n,ref:r,role:o,tag:s}=e,a=document.createElement(s);if(n&&(a.className=n),r&&a.setAttribute(QD,r),o&&a.setAttribute("role",o),t)for(let l of Object.keys(t))a.setAttribute(l,t[l]);if(i)if(typeof i=="string")a.textContent=i;else{let l=!0;for(let c of i)c&&(typeof c=="string"?(a.appendChild(document.createTextNode(c)),l=!1):typeof c=="function"?a.appendChild(c()):(l&&(a.appendChild(v_()),l=!1),a.append(ns(c)),a.appendChild(v_())))}return a}var mW=["touchstart","touchend","touchmove","touchcancel","scroll"],vW=["wheel"],Uw={},ZD=(()=>{let e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return i=>{if(typeof Uw[i]=="boolean")return Uw[i];let n=document.createElement(e[i]||"div");return i="on"+i,Uw[i]=i in n}})();function CW(e,t){return!t||!e?!1:bW(t).indexOf(e)>=0}function wW(e){let t=[],i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}function bW(e){let t=e;return t.path?t.path:t.composedPath?t.composedPath():wW(t)}function yW(e,t,i){let n=SW(t),r;n!=null&&(r={passive:n}),e.addEventListener(t,i,r)}var SW=e=>{let t=mW.includes(e),i=vW.includes(e);if(t)return!0;if(i)return!1};function eF(e,t,i){if(i===0)return!1;let n=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(n,r)<=i}var zl=(e,t)=>{let i=e.identifier;for(let n=0,r=t.length;n<r;++n){let o=t[n];if(o.identifier===i)return o}return null};function Vu(e,t){return e.gos.isElementInThisInstance(t.target)}function xW(e,t,i){let r=e.getBoundingClientRect().height,o=YG(i)-2,s=XG(i)-2;if(!e.offsetParent)return;let l=KD(e.offsetParent),{clientY:c,clientX:d}=t,u=c-l.top-r/2,h=d-l.left-10,p=Kt(i),f=p.defaultView||window,g=f.pageYOffset||p.documentElement.scrollTop,m=f.pageXOffset||p.documentElement.scrollLeft;o>0&&h+e.clientWidth>o+m&&(h=o+m-e.clientWidth),h<0&&(h=0),s>0&&u+e.clientHeight>s+g&&(u=s+g-e.clientHeight),u<0&&(u=0),e.style.left=`${h}px`,e.style.top=`${u}px`}var Fg=(e,...t)=>{for(let i of t){let[n,r,o,s]=i;n.addEventListener(r,o,s),e.push(i)}},fy=e=>{if(e){for(let[t,i,n,r]of e)t.removeEventListener(i,n,r);e.length=0}},Al=e=>{e.cancelable&&e.preventDefault()};function EW(e,t){return t}function tF(e){return e?.getLocaleTextFunc()??EW}function RW(e,t,i,n){let r=t[i];return e.getLocaleTextFunc()(i,typeof r=="function"?r(n):r,n)}function PW(e){return(t,i,n)=>e({key:t,defaultValue:i,variableValues:n})}function kW(e){return(t,i,n)=>{let r=e?.[t];if(r&&n?.length){let o=0;for(;!(o>=n.length||r.indexOf("${variable}")===-1);)r=r.replace("${variable}",n[o++])}return r??i}}var Ai=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){let{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,i){this.localEventService||(this.localEventService=new ma),this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService?.removeEventListener(e,t,i)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){let i=[];for(let n of Object.keys(t)){let r=t[n];r&&i.push(this._setupListener(e,n,r))}return i}_setupListener(e,t,i){if(this.destroyed)return()=>null;let n;if(_W(e))e.__addEventListener(t,i),n=()=>(e.__removeEventListener(t,i),null);else{let r=DW(e);e instanceof HTMLElement?yW(e,t,i):r?e.addListener(t,i):e.addEventListener(t,i),n=r?()=>(e.removeListener(t,i),null):()=>(e.removeEventListener(t,i),null)}return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==n),null)}setupPropertyListener(e,t){let{gos:i}=this;i.addPropertyEventListener(e,t);let n=()=>(i.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==n),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;let i=e.join("-")+this.propertyListenerId++,n=r=>{if(r.changeSet){if(r.changeSet&&r.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=r.changeSet.id}let o={type:"propertyChanged",changeSet:r.changeSet,source:r.source};t(o)};for(let r of e)this.setupPropertyListener(r,n)}getLocaleTextFunc(){return tF(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){let i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.stubContext).createBean(e,i)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function _W(e){return e.__addEventListener!==void 0}function DW(e){return e.eventServiceType==="global"}var j=class extends Ai{},kb=new Set,mm=(e,t)=>{kb.has(t)||(kb.add(t),e())};mm._set=kb;var FW={pending:!1,funcs:[]},MW={pending:!1,funcs:[]};function _b(e,t="setTimeout",i){let n=t==="raf"?MW:FW;if(n.funcs.push(e),n.pending)return;n.pending=!0;let r=()=>{let o=n.funcs.slice();n.funcs.length=0,n.pending=!1;for(let s of o)s()};t==="raf"?go(i,r):window.setTimeout(r,0)}function Yt(e,t,i){let n;return function(...r){let o=this;return window.clearTimeout(n),n=window.setTimeout(function(){e.isAlive()&&t.apply(o,r)},i),n}}function C_(e,t){let i=0;return function(...n){let r=this,o=Date.now();o-i<t||(i=o,e.apply(r,n))}}function TW(e,t,i,n=100){let r=Date.now(),o=null,s=!1,a=()=>{o!=null&&(window.clearInterval(o),o=null)};e.addDestroyFunc(a);let l=()=>{let c=Date.now()-r>n;(t()||c)&&(i(),s=!0,a())};l(),s||(o=window.setInterval(l,10))}var iF=new Set(["__proto__","constructor","prototype"]);function IW(e,t){if(e!=null){if(Array.isArray(e)){for(let i=0;i<e.length;i++)t(i.toString(),e[i]);return}for(let i of Object.keys(e).filter(n=>!iF.has(n)))t(i,e[i])}}function Ii(e,t,i=!0,n=!1){pe(t)&&IW(t,(r,o)=>{let s=e[r];s!==o&&(n&&s==null&&o!=null&&typeof o=="object"&&o.constructor===Object&&(s={},e[r]=s),w_(o)&&w_(s)&&!Array.isArray(s)?Ii(s,o,i,n):(i||o!==void 0)&&(e[r]=o))})}function w_(e){return typeof e=="object"&&e!==null}var AW=(()=>{let e=class oo{static applyGlobalGridOptions(i){if(!oo.gridOptions)return w({},i);let n={};return Ii(n,oo.gridOptions,!0,!0),oo.mergeStrategy==="deep"?Ii(n,i,!0,!0):n=w(w({},n),i),oo.gridOptions.context&&(n.context=oo.gridOptions.context),i.context&&(oo.mergeStrategy==="deep"&&n.context&&Ii(i.context,n.context,!0,!0),n.context=i.context),n}static applyGlobalGridOption(i,n){if(oo.mergeStrategy==="deep"){let r=OW(i);if(r&&typeof r=="object"&&typeof n=="object")return oo.applyGlobalGridOptions({[i]:n})[i]}return n}};return e.gridOptions=void 0,e.mergeStrategy="shallow",e})(),gy=AW;function OW(e){return gy.gridOptions?.[e]}var LW={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,refreshAfterGroupEdit:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,enableFilterHandlers:!1},nF="https://www.ag-grid.com";function as(e,t,...i){e.get("debug")&&console.log("AG Grid: "+t,...i)}function Mu(e,...t){mm(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function Vl(e,...t){mm(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var rF=new Set,Yg={},Gl={},Mg,oF=!1,sF=!1,NW=!1;function BW(e){let[t,i]=e.version.split(".")||[],[n,r]=Mg.split(".")||[];return t===n&&i===r}function HW(e){Mg||(Mg=e.version);let t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;e.version?BW(e)||Vl(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${Mg}.`)):Vl(t(`'${e.moduleName}' is incompatible.`));let i=e.validate?.();i&&!i.isValid&&Vl(`${i.message}`)}function Gu(e,t,i=!1){i||(oF=!0),HW(e);let n=e.rowModels??["all"];rF.add(e);let r;t!==void 0?(sF=!0,Gl[t]===void 0&&(Gl[t]={}),r=Gl[t]):r=Yg;for(let o of n)r[o]===void 0&&(r[o]={}),r[o][e.moduleName]=e;if(e.dependsOn)for(let o of e.dependsOn)Gu(o,t,i)}function zW(e){delete Gl[e]}function Db(e,t,i){let n=r=>!!Yg[r]?.[e]||!!Gl[t]?.[r]?.[e];return n(i)||n("all")}function my(){return sF}function VW(e,t){let i=Gl[e]??{};return[...Object.values(Yg.all??{}),...Object.values(i.all??{}),...Object.values(Yg[t]??{}),...Object.values(i[t]??{})]}function GW(){return new Set(rF)}function WW(){return oF}function vy(){return NW}var vm=class{static register(e){Gu(e,void 0)}static registerModules(e){for(let t of e)Gu(t,void 0)}},fe="35.0.0",b_=2e3,y_=100,aF="_version_",lF=null,Wl=`${nF}/javascript-data-grid`;function UW(e){lF=e}function jW(e){Wl=e}function cF(e,t,i){return lF?.(e,t)??[YW(e,t,i)]}function Cy(e,t,i,n,r){e(`${n?"warning":"error"} #${t}`,...cF(t,i,r))}function qW(e){if(!e)return String(e);let t={};for(let i of Object.keys(e))typeof e[i]!="object"&&typeof e[i]!="function"&&(t[i]=e[i]);return JSON.stringify(t)}function $W(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=qW(e)),t}function Tg(e){return e===void 0?"undefined":e===null?"null":e}function Fb(e,t){return`${e}?${t.toString()}`}function KW(e,t,i){let n=Array.from(t.entries()).sort((o,s)=>s[1].length-o[1].length),r=Fb(e,t);for(let[o,s]of n){if(o===aF)continue;let a=r.length-i;if(a<=0)break;let l="...",c=a+l.length,d=s.length-c>y_?s.slice(0,s.length-c)+l:s.slice(0,y_)+l;t.set(o,d),r=Fb(e,t)}return r}function dF(e,t){let i=new URLSearchParams;if(i.append(aF,fe),t)for(let o of Object.keys(t))i.append(o,$W(t[o]));let n=`${Wl}/errors/${e}`,r=Fb(n,i);return r.length<=b_?r:KW(n,i,b_)}var YW=(e,t,i)=>{let n=dF(e,t),r=`${i?i+` 
`:""}Visit ${n}`;return vy()?r:`${r}${i?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function J(...e){Cy(Mu,e[0],e[1],!0)}function Ze(...e){Cy(Vl,e[0],e[1],!1)}function Pu(e,t,i){Cy(Vl,e,t,!1,i)}function XW(e,t){let i=t[0];return`error #${i} `+cF(i,t[1],e).join(" ")}function Fr(...e){return XW(void 0,e)}function uF(e,t){return e.get("rowModelType")===t}function _t(e,t){return uF(e,"clientSide")}function Ju(e,t){return uF(e,"serverSide")}function ni(e,t){return e.get("domLayout")===t}function ua(e){return Jg(e)!==void 0}function hF(e){return typeof e.get("getRowHeight")=="function"}function JW(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function QW({gos:e,formula:t}){let i=e.get("rowNumbers");return i||!!t?.active&&i!==!1}function ls(e,t,i=!1,n){let{gos:r,environment:o}=e;if(n==null&&(n=o.getDefaultRowHeight()),hF(r)){if(i)return{height:n,estimated:!0};let l={node:t,data:t.data},c=r.getCallback("getRowHeight")(l);if(Mb(c))return c===0&&J(23),{height:Math.max(1,c),estimated:!1}}if(t.detail&&r.get("masterDetail"))return ZW(r);let s=r.get("rowHeight");return{height:s&&Mb(s)?s:n,estimated:!1}}function ZW(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};let t=e.get("detailRowHeight");return Mb(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function ha(e){let{environment:t,gos:i}=e,n=i.get("rowHeight");if(!n||mt(n))return t.getDefaultRowHeight();let r=t.refreshRowHeightVariable();return r!==-1?r:(J(24),t.getDefaultRowHeight())}function Mb(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function pF(e,t,i){let n=t[e.getDomDataKey()];return n?n[i]:void 0}function va(e,t,i,n){let r=e.getDomDataKey(),o=t[r];mt(o)&&(o={},t[r]=o),o[i]=n}function Ul(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function fF(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||ni(e,"print"))}function Er(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function Tb(e){let t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function gF(e){return e.get("grandTotalRow")}function mF(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function vF(e,t,i){return!!t.group&&!t.footer&&mF(e,i)}function tc(e){let t=e.getCallback("getRowId");return t===void 0?t:i=>{let n=t(i);return typeof n!="string"&&(mm(()=>J(25,{id:n}),"getRowIdString"),n=String(n)),n}}function eU(e,t){let i=e.get("groupHideParentOfSingleChild");return!!(i===!0||i==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function tU(e){let t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function jl(e){return e?.checkboxes??!0}function Ig(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function Xg(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function jw(e){return e?.hideDisabledCheckboxes??!1}function iU(e){return typeof e.get("rowSelection")!="string"}function ho(e){let t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function ql(e){let t=e.get("cellSelection")??!1;return(typeof t=="object"&&t.enableColumnSelection)??!1}function CF(e){let t=e.get("rowSelection")??"single";if(typeof t=="string"){let i=e.get("suppressRowClickSelection"),n=e.get("suppressRowDeselection");return i&&n?!1:i?"enableDeselection":n?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function nU(e){let t=CF(e);return t===!0||t==="enableSelection"}function rU(e){let t=CF(e);return t===!0||t==="enableDeselection"}function Ib(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function Jg(e){let t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function Wu(e){return Jg(e)==="multiRow"}function oU(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function Qg(e){let t=e.get("rowSelection");if(typeof t=="string"){let i=e.get("groupSelectsChildren"),n=e.get("groupSelectsFiltered");return i&&n?"filteredDescendants":i?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function wF(e,t=!0){let i=e.get("rowSelection");return typeof i!="object"?t?"all":void 0:i.mode==="multiRow"?i.selectAll:"all"}function sU(e){let t=e.get("rowSelection");return typeof t=="string"?!1:t?.mode==="multiRow"?t.ctrlASelectsRows??!1:!1}function Uu(e){let t=Qg(e);return t==="descendants"||t==="filteredDescendants"}function S_(e){let t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function aU(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function sn(e){return e.get("columnMenu")==="legacy"}function lU(e){return!sn(e)}function cU(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function bF(e,t,i){typeof e!="object"&&(e={});let n=w({},e);for(let r of i){let o=t[r];typeof o<"u"&&(n[r]=o)}return n}function yF(e,t){if(!e)return;let i={},n=!1;for(let s of Object.keys(e))i[s]=e[s],n=!0;if(!n)return;let r={type:"gridOptionsChanged",options:i};t.dispatchEvent(r);let o=w({type:"componentStateChanged"},i);t.dispatchEvent(o)}function _e(e,t){return e.addCommon(t)}function dU({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var uU={resizable:!0,sortable:!0},hU=0;function SF(){return hU++}function cs(e){return e instanceof Sa}var pU=["asc","desc",null],fU=[{type:"absolute",direction:"asc"},{type:"absolute",direction:"desc"},null],Sa=class extends j{constructor(e,t,i,n){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=n,this.isColumn=!0,this.instanceId=SF(),this.autoHeaderHeight=null,this.sortDef=jn(),this._wasSortExplicitlyRemoved=!1,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.formulaRef=null,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new ma,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=_u(i)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}initState(){let{colDef:e,beans:{sortSvc:t,pinnedCols:i,colFlex:n}}=this;t?.initCol(this);let r=e.hide;r!==void 0?this.visible=!r:this.visible=!e.initialHide,i?.initCol(this),n?.initCol(this)}setColDef(e,t,i){let n=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",i)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.initState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){let{gos:e,colDef:{field:t,tooltipField:i}}=this,n=e.get("suppressFieldDotNotation");this.fieldContainsDots=pe(t)&&t.includes(".")&&!n,this.tooltipFieldContainsDots=pe(i)&&i.includes(".")&&!n}initMinAndMaxWidths(){let e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}addPivotListener(){let e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:i=>{let n=e.recreateColDef(this.colDef);this.setColDef(n,n,i.source)}})}resetActualWidth(e){let t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t,i=e.width,n=e.initialWidth;return i!=null?t=i:n!=null?t=n:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);let i=this.frameworkEventListenerService?.wrap(e,t)??t;this.colEventSvc.addEventListener(e,i)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.colEventSvc.removeEventListener(e,i)}createColumnFunctionCallbackParams(e){return _e(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable({rowNode:e,column:this})??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??uU[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){let i=this.createColumnFunctionCallbackParams(e);return t(i)}return!1}createColumnEvent(e,t){return _e(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sortDef.direction}getSortDef(){return this.sortDef.direction?this.sortDef:null}getColDefAllowedSortTypes(){let e=[],{sort:t,initialSort:i}=this.colDef,n=t===null?t:po(t?.type),r=i===null?i:po(i?.type);return n&&e.push(n),r&&e.push(r),e}getSortingOrder(){let e=this.getColDefAllowedSortTypes().includes("absolute")?fU:pU;return(this.colDef.sortingOrder??this.gos.get("sortingOrder")??e).map(t=>jn(t))}getAvailableSortTypes(){let e=this.getSortingOrder().reduce((t,i)=>(i.direction&&t.push(i.type),t),this.getColDefAllowedSortTypes());return new Set(e)}get wasSortExplicitlyRemoved(){return this._wasSortExplicitlyRemoved}setSortDef(e,t=!1){t||(this._wasSortExplicitlyRemoved=!e.direction),this.sortDef=e}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.getSort()==="asc"}isSortDescending(){return this.getSort()==="desc"}isSortNone(){return mt(this.getSort())}isSorting(){return pe(this.getSort())}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return J(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){let i=e===!0;this.visible!==i&&(this.visible=i,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e?.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e?.isPadding())return{numberOfParents:0,isSpanningTotal:!1};let t=e.getPaddingLevel()+1,i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return _e(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(mt(this.colDef.colSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(mt(this.colDef.rowSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t,i=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}isAllowFormula(){return this.colDef.allowFormula===!0}dispatchColEvent(e,t,i){let n=this.createColumnEvent(e,t);i&&Ii(n,i),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function jn(e){return $l(e)?{direction:e.direction,type:e.type}:{direction:Cm(e),type:po(e)}}function rs(e){return e==="asc"||e==="desc"||e===null}function wy(e){return e==="default"||e==="absolute"}function $l(e){if(!e||typeof e!="object")return!1;let t=e;return wy(t.type)&&rs(t.direction)}function Ag(e,t){return e?t?e.type===t.type&&e.direction===t.direction:e?e.direction===null:!0:t?t.direction===null:!0}function Cm(e){return rs(e)?e:null}function po(e){return wy(e)?e:"default"}function Si(e){return e instanceof Og}var Og=class extends j{constructor(e,t,i,n){super(),this.colGroupDef=e,this.groupId=t,this.padding=i,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=SF(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(let t of this.children)cs(t)?e(t):Si(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(this.children)for(let t of this.children)cs(t)?e.push(t):Si(t)&&t.addLeafColumns(e)}getColumnGroupShow(){let e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();let e=this.onColumnVisibilityChanged.bind(this);for(let t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(let t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,i=!1,n=this.findChildrenRemovingPadding();for(let o=0,s=n.length;o<s;o++){let a=n[o];if(!a.isVisible())continue;let l=a.getColumnGroupShow();l==="open"?(e=!0,i=!0):l==="closed"?(t=!0,i=!0):(e=!0,t=!0)}let r=e&&t&&i;this.expandable!==r&&(this.expandable=r,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){let e=[],t=i=>{for(let n of i)Si(n)&&n.isPadding()?t(n.children):e.push(n)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},gU={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function x_(e,t,i){let n={},r=e.gos;return Object.assign(n,r.get("defaultColGroupDef")),Object.assign(n,t),r.validateColDef(n,i),n}var mU=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=Rb(e);let i=0;for(;;){let n=e??t;if(n?i!==0&&(n+="_"+i):n=i,!this.existingKeys[n]){let r=String(n);return e&&i>0&&J(273,{providedId:e,usedId:r}),this.existingKeys[r]=!0,r}i++}}},Bye=Object.freeze([]);function dt(e){if(e?.length)return e[e.length-1]}function hs(e,t,i){if(e===t)return!0;if(!e||!t)return e==null&&t==null;let n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r]&&!i?.(e[r],t[r]))return!1;return!0}function wu(e,t){if(e){for(let i of e)if(t(i))return!0}}function Mr(e,t){let i=e.indexOf(t);i>=0&&e.splice(i,1)}function E_(e,t,i){for(let n=0;n<t.length;n++)Mr(e,t[n]);for(let n=t.length-1;n>=0;n--)e.splice(i,0,t[n])}var wm="ag-Grid-AutoColumn",xF="ag-Grid-SelectionColumn",EF="ag-Grid-RowNumbersColumn";function RF(e){let t=[],i=n=>{for(let r=0;r<n.length;r++){let o=n[r];cs(o)?t.push(o):Si(o)&&i(o.getChildren())}};return i(e),t}function so(e){return e.reduce((t,i)=>t+i.getActualWidth(),0)}function Zg(e,t,i){let n={};if(!t)return;co(null,t,o=>{n[o.getInstanceId()]=o}),i&&co(null,i,o=>{n[o.getInstanceId()]=null});let r=Object.values(n).filter(o=>o!=null);e.context.destroyBeans(r)}function by(e){return e.getId().startsWith(wm)}function ps(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(xF)??!1}function lo(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(EF)??!1}function vU(e){return ps(e)||lo(e)}function em(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function CU(e,t){return hs(e,t,(i,n)=>i.getColId()===n.getColId())}function wU(e){e.map={};for(let t of e.list)e.map[t.getId()]=t}function Kl(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function Tu(e,t){let i=e===t,n=e.getColDef()===t,r=e.getColId()==t;return i||n||r}var bU=(e,t)=>(i,n)=>{let r={value1:void 0,value2:void 0},o=!1;return e&&(e[i]!==void 0&&(r.value1=e[i],o=!0),pe(n)&&e[n]!==void 0&&(r.value2=e[n],o=!0)),!o&&t&&(t[i]!==void 0&&(r.value1=t[i]),pe(n)&&t[n]!==void 0&&(r.value2=t[n])),r};function yU(e,t){let i=T(w({},e),{sort:void 0,colId:t}),n=PF(e);return n&&(i.sort=n.direction,i.sortType=n.type),i}function PF(e){let{sort:t,initialSort:i}=e,n=$l(t)||rs(t),r=$l(i)||rs(i);return n?jn(t):r?jn(i):null}var SU=(e,t)=>{Si(e)&&e.setupExpandable(),e.originalParent=t};function xU(e,t=null,i,n,r){let o=new mU,{existingCols:s,existingGroups:a,existingColKeys:l}=EU(n);o.addExistingKeys(l);let c=kF(e,t,0,i,s,o,a,r),{colGroupSvc:d}=e,u=d?.findMaxDepth(c,0)??0,h=d?d.balanceColumnTree(c,0,u,o):c;return co(null,h,SU),{columnTree:h,treeDepth:u}}function EU(e){let t=[],i=[],n=[];return e&&co(null,e,r=>{if(Si(r)){let o=r;i.push(o)}else{let o=r;n.push(o.getId()),t.push(o)}}),{existingCols:t,existingGroups:i,existingColKeys:n}}function kF(e,t,i,n,r,o,s,a){if(!t)return[];let{colGroupSvc:l}=e,c=new Array(t.length);for(let d=0;d<c.length;d++){let u=t[d];l&&FU(u)?c[d]=l.createProvidedColumnGroup(n,u,i,r,o,s,a):c[d]=RU(e,n,u,r,o,a)}return c}function RU(e,t,i,n,r,o){let s=kU(i,n);s&&n?.splice(s.idx,1);let a=s?.column;if(a){let l=Ab(e,i,a.getColId());a.setColDef(l,i,o),PU(e,a,l,o)}else{let l=r.getUniqueKey(i.colId,i.field),c=Ab(e,i,l);a=new Sa(c,i,l,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function _F(e,t,i,n,r,o,s,a){let{sortSvc:l,pinnedCols:c,colFlex:d}=e;i!==void 0&&t.setVisible(!i,a),l&&(l.updateColSort(t,n,a),r!==void 0&&l.setColSortIndex(t,r)),o!==void 0&&c?.setColPinned(t,o),s!==void 0&&d?.setColFlex(t,s)}function PU(e,t,i,n){_F(e,t,i.hide,i.sort,i.sortIndex,i.pinned,i.flex,n);let r=t.getFlex();if(!(r!=null&&r>0))if(i.width!=null)t.setActualWidth(i.width,n);else{let o=t.getActualWidth();t.setActualWidth(o,n)}}function kU(e,t){if(t)for(let i=0;i<t.length;i++){let n=t[i].getUserProvidedColDef();if(!n)continue;if(e.colId!=null){if(t[i].getId()===e.colId)return{idx:i,column:t[i]};continue}if(e.field!=null){if(n.field===e.field)return{idx:i,column:t[i]};continue}if(n===e)return{idx:i,column:t[i]}}}function Ab(e,t,i,n){let{gos:r,dataTypeSvc:o}=e,s={},a=r.get("defaultColDef");Ii(s,a,!1,!0);let l=_U(e,s,t,i);l&&DU(e,l,s);let c=s.cellDataType;Ii(s,t,!1,!0),c!==void 0&&(s.cellDataType=c);let d=r.get("autoGroupColumnDef"),u=Er(r);return t.rowGroup&&d&&u&&Ii(s,{sort:d.sort,initialSort:d.initialSort},!1,!0),o?.postProcess(s),o?.validateColDef(s),r.validateColDef(s,i,n),s}function _U(e,t,i,n){let r=e.dataTypeSvc?.updateColDefAndGetColumnType(t,i,n),o=i.type??r??t.type;return t.type=o,o?em(o):void 0}function DU(e,t,i){if(!t.length)return;let n=Object.assign({},gU),r=e.gos.get("columnTypes")||{};for(let o of Object.keys(r)){let s=r[o];o in n?J(34,{key:o}):(s.type&&J(35),n[o]=s)}for(let o of t){let s=n[o.trim()];s?Ii(i,s,!1,!0):J(36,{t:o})}}function FU(e){return e.children!==void 0}function co(e,t,i){if(t)for(let n=0;n<t.length;n++){let r=t[n];Si(r)&&co(r,r.getChildren(),i),i(r,e)}}function DF(e,t){let i=[],n=[],r=[];return e.forEach(s=>{let a=s.getColDef().lockPosition;a==="right"?r.push(s):a==="left"||a===!0?i.push(s):n.push(s)}),t.get("enableRtl")?[...r,...n,...i]:[...i,...n,...r]}function FF(e,t){let i=!0;return co(null,t,n=>{if(!Si(n))return;let r=n;if(!r.getColGroupDef()?.marryChildren)return;let a=[];for(let h of r.getLeafColumns()){let p=e.indexOf(h);a.push(p)}let l=Math.max.apply(Math,a),c=Math.min.apply(Math,a),d=l-c,u=r.getLeafColumns().length-1;d>u&&(i=!1)}),i}function MF(e,t){if(!e||e.length==0)return;let i=t(e[0]);for(let n=1;n<e.length;n++)if(i!==t(e[n]))return;return i}function TF(e,t,i){if(!t.length)return;let n=t.length===1?t[0]:null,r=MF(t,o=>o.getPinned());e.dispatchEvent({type:"columnPinned",pinned:r??null,columns:t,column:n,source:i})}function MU(e,t,i){if(!t.length)return;let n=t.length===1?t[0]:null,r=MF(t,o=>o.isVisible());e.dispatchEvent({type:"columnVisible",visible:r,columns:t,column:n,source:i})}function TU(e,t,i,n){e.dispatchEvent({type:t,columns:i,column:i&&i.length==1?i[0]:null,source:n})}function ic(e,t,i,n,r=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:r,finished:i,source:n})}function qn(e,t,i){let{colModel:n,rowGroupColsSvc:r,pivotColsSvc:o,autoColSvc:s,selectionColSvc:a,colAnimation:l,visibleCols:c,pivotResultCols:d,environment:u,valueColsSvc:h,eventSvc:p,gos:f}=e,g=n.getColDefCols()??[],m=a?.getColumns();if(!g.length&&!m?.length)return!1;if(t?.state&&!t.state.forEach)return J(32),!1;let v=(E,x,P,F,N)=>{if(!E)return;let Y=bU(x,t.defaultState),X=Y("flex").value1,Z=Y("sort").value1,me=Y("sortType").value1,oe=rs(Z)||wy(me),re=po(me),_=Cm(Z),k=oe?{type:re,direction:_}:void 0;if(_F(e,E,Y("hide").value1,k,Y("sortIndex").value1,Y("pinned").value1,X,i),X==null){let D=Y("width").value1;if(D!=null){let V=E.getColDef().minWidth??u.getDefaultColumnMinWidth();V!=null&&D>=V&&E.setActualWidth(D,i)}}N||!E.isPrimary()||(h?.syncColumnWithState(E,i,Y),r?.syncColumnWithState(E,i,Y,P),o?.syncColumnWithState(E,i,Y,F))},C=(E,x,P)=>{let F=IF(e,i),N=x.slice(),Y={},X={},Z=[],me=[],oe=[],re=0,_=r?.columns.slice()??[],k=o?.columns.slice()??[];for(let U of E){let G=U.colId;if(G.startsWith(wm)){Z.push(U),oe.push(U);continue}if(ps(G)){me.push(U),oe.push(U);continue}let O=P(G);O?(v(O,U,Y,X,!1),Mr(N,O)):(oe.push(U),re+=1)}let D=U=>v(U,null,Y,X,!1);N.forEach(D),r?.sortColumns(R_.bind(r,Y,_)),o?.sortColumns(R_.bind(o,X,k)),n.refreshCols(!1,i);let V=(U,G,z=[])=>{for(let O of G){let W=U(O.colId);Mr(z,W),v(W,O,null,null,!0)}z.forEach(D)};return V(U=>s?.getColumn(U)??null,Z,s?.getColumns()?.slice()),V(U=>a?.getColumn(U)??null,me,a?.getColumns()?.slice()),AU(t,n,f),c.refresh(i),p.dispatchEvent({type:"columnEverythingChanged",source:i}),F(),{unmatchedAndAutoStates:oe,unmatchedCount:re}};l?.start();let{unmatchedAndAutoStates:b,unmatchedCount:S}=C(t.state||[],g,E=>n.getColDefCol(E));if(b.length>0||pe(t.defaultState)){let E=d?.getPivotResultCols()?.list??[];S=C(b,E,x=>d?.getPivotResultCol(x)??null).unmatchedCount}return l?.finish(),S===0}function IU(e,t){let{colModel:i,autoColSvc:n,selectionColSvc:r,eventSvc:o,gos:s}=e,a=i.getColDefCols();if(!a?.length)return;let l=i.getColDefColTree(),c=RF(l),d=[],u=1e3,h=1e3,p=C=>{let b=AF(C);mt(b.rowGroupIndex)&&b.rowGroup&&(b.rowGroupIndex=u++),mt(b.pivotIndex)&&b.pivot&&(b.pivotIndex=h++),d.push(b)};n?.getColumns()?.forEach(p),r?.getColumns()?.forEach(p),c?.forEach(p),qn(e,{state:d},t);let f=n?.getColumns()??[],v=[...r?.getColumns()??[],...f,...a].map(C=>({colId:C.colId}));qn(e,{state:v,applyOrder:!0},t),o.dispatchEvent(_e(s,{type:"columnsReset",source:t}))}function IF(e,t){let{rowGroupColsSvc:i,pivotColsSvc:n,valueColsSvc:r,colModel:o,sortSvc:s,eventSvc:a}=e,l={rowGroupColumns:i?.columns.slice()??[],pivotColumns:n?.columns.slice()??[],valueColumns:r?.columns.slice()??[]},c=tm(e),d={};for(let u of c)d[u.colId]=u;return()=>{let u=(x,P,F,N)=>{let Y=P.map(N),X=F.map(N);if(hs(Y,X))return;let me=new Set(P);for(let re of F)me.delete(re)||me.add(re);let oe=[...me];a.dispatchEvent({type:x,columns:oe,column:oe.length===1?oe[0]:null,source:t})},h=x=>{let P=[];return o.forAllCols(F=>{let N=d[F.getColId()];N&&x(N,F)&&P.push(F)}),P},p=x=>x.getColId();u("columnRowGroupChanged",l.rowGroupColumns,i?.columns??[],p),u("columnPivotChanged",l.pivotColumns,n?.columns??[],p);let g=h((x,P)=>{let F=x.aggFunc!=null,N=F!=P.isValueActive(),Y=F&&x.aggFunc!=P.getAggFunc();return N||Y});g.length>0&&TU(a,"columnValueChanged",g,t),ic(a,h((x,P)=>x.width!=P.getActualWidth()),!0,t),TF(a,h((x,P)=>x.pinned!=P.getPinned()),t),MU(a,h((x,P)=>x.hide==P.isVisible()),t);let S=h((x,P)=>!Ag(P.getSortDef(),{type:po(x.sortType),direction:Cm(x.sort)})||x.sortIndex!=P.getSortIndex());S.length>0&&s?.dispatchSortChangedEvents(t,S);let E=tm(e);LU(c,E,t,o,a)}}function tm(e){let{colModel:t,rowGroupColsSvc:i,pivotColsSvc:n}=e,r=t.getColDefCols();if(mt(r)||!t.isAlive())return[];let o=i?.columns,s=n?.columns,a=[],l=d=>{let u=d.isRowGroupActive()&&o?o.indexOf(d):null,h=d.isPivotActive()&&s?s.indexOf(d):null,p=d.isValueActive()?d.getAggFunc():null,f=d.getSortIndex()!=null?d.getSortIndex():null;a.push({colId:d.getColId(),width:d.getActualWidth(),hide:!d.isVisible(),pinned:d.getPinned(),sort:d.getSort(),sortType:d.getSortDef()?.type,sortIndex:f,aggFunc:p,rowGroup:d.isRowGroupActive(),rowGroupIndex:u,pivot:d.isPivotActive(),pivotIndex:h,flex:d.getFlex()??null})};t.forAllCols(d=>l(d));let c=new Map(t.getCols().map((d,u)=>[d.getColId(),u]));return a.sort((d,u)=>{let h=c.has(d.colId)?c.get(d.colId):-1,p=c.has(u.colId)?c.get(u.colId):-1;return h-p}),a}function AF(e){let t=(m,v)=>m??v??null,i=e.getColDef(),n=jn(t(i.sort,i.initialSort)),r=n.direction,o=n.type,s=t(i.sortIndex,i.initialSortIndex),a=t(i.hide,i.initialHide),l=t(i.pinned,i.initialPinned),c=t(i.width,i.initialWidth),d=t(i.flex,i.initialFlex),u=t(i.rowGroupIndex,i.initialRowGroupIndex),h=t(i.rowGroup,i.initialRowGroup);u==null&&!h&&(u=null,h=null);let p=t(i.pivotIndex,i.initialPivotIndex),f=t(i.pivot,i.initialPivot);p==null&&!f&&(p=null,f=null);let g=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:r,sortType:o,sortIndex:s,hide:a,pinned:l,width:c,flex:d,rowGroup:h,rowGroupIndex:u,pivot:f,pivotIndex:p,aggFunc:g}}function AU(e,t,i){if(!e.applyOrder||!e.state)return;let n=[];for(let r of e.state)r.colId!=null&&n.push(r.colId);OU(t.cols,n,t,i)}function OU(e,t,i,n){if(e==null)return;let r=[],o={};for(let a of t){if(o[a])continue;let l=e.map[a];l&&(r.push(l),o[a]=!0)}let s=0;for(let a of e.list){let l=a.getColId();if(o[l]!=null)continue;l.startsWith(wm)?r.splice(s++,0,a):r.push(a)}if(r=DF(r,n),!FF(r,i.getColTree())){J(39);return}e.list=r}function LU(e,t,i,n,r){let o={};for(let d of t)o[d.colId]=d;let s={};for(let d of e)o[d.colId]&&(s[d.colId]=!0);let a=e.filter(d=>s[d.colId]),l=t.filter(d=>s[d.colId]),c=[];l.forEach((d,u)=>{let h=a?.[u];if(h&&h.colId!==d.colId){let p=n.getCol(h.colId);p&&c.push(p)}}),c.length&&r.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,finished:!0,source:i})}var R_=(e,t,i,n)=>{let r=e[i.getId()],o=e[n.getId()],s=r!=null,a=o!=null;if(s&&a)return r-o;if(s)return-1;if(a)return 1;let l=t.indexOf(i),c=t.indexOf(n),d=l>=0,u=c>=0;return d&&u?l-c:d?-1:1},NU=class extends j{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(Kl(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),Kl(e.source)))}createColsFromColDefs(e){let{beans:t}=this,{valueCache:i,colAutosize:n,rowGroupColsSvc:r,pivotColsSvc:o,valueColsSvc:s,visibleCols:a,eventSvc:l,groupHierarchyColSvc:c}=t,d=this.colDefs?IF(t,e):void 0;i?.expire();let u=this.colDefCols?.list,h=this.colDefCols?.tree,p=xU(t,this.colDefs,!0,h,e);Zg(t,this.colDefCols?.tree,p.columnTree);let f=p.columnTree,g=p.treeDepth,m=RF(f),v={};for(let C of m)v[C.getId()]=C;this.colDefCols={tree:f,treeDepth:g,list:m,map:v},this.createColumnsForService([c],this.colDefCols,e),r?.extractCols(e,u),o?.extractCols(e,u),s?.extractCols(e,u),this.ready=!0,this.changeEventsDispatching=!0,this.refreshCols(!0,e),this.changeEventsDispatching=!1,a.refresh(e),l.dispatchEvent({type:"columnEverythingChanged",source:e}),d&&(this.changeEventsDispatching=!0,d(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&n?.applyAutosizeStrategy()}refreshCols(e,t){if(!this.colDefCols)return;let i=this.cols?.tree;this.saveColOrder();let{autoColSvc:n,selectionColSvc:r,rowNumbersSvc:o,quickFilter:s,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:c,visibleCols:d,colViewport:u,eventSvc:h,formula:p}=this.beans,f=this.selectCols(a,this.colDefCols);p?.setFormulasActive(f),this.createColumnsForService([n,r,o],f,t);let g=JW(this.gos,this.showingPivotResult);(!e||g)&&this.restoreColOrder(f),this.positionLockedCols(f),l?.refresh(),s?.refreshCols(),this.setColSpanActive(),c?.setAutoHeightActive(f),d.clear(),u.clear(),hs(i,this.cols.tree)||h.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,i){for(let n of e)n&&(n.createColumns(t,r=>{this.lastOrder=r(this.lastOrder),this.lastPivotOrder=r(this.lastPivotOrder)},i),n.addColumns(t))}selectCols(e,t){let i=e?.getPivotResultCols()??null;this.showingPivotResult=i!=null;let{map:n,list:r,tree:o,treeDepth:s}=i??t;return this.cols={list:r.slice(),map:w({},n),tree:o.slice(),treeDepth:s},i&&(i.list.some(l=>this.cols?.map[l.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];let{beans:e,showingPivotResult:t,cols:i}=this,{valueColsSvc:n,selectionColSvc:r}=e,o=this.isPivotMode()&&!t,s=r?.isSelectionColumnEnabled(),a=QW(e),l=n?.columns;return i.list.filter(d=>{let u=by(d);if(o){let h=l?.includes(d);return u||h||s&&ps(d)||a&&lo(d)}else return u||d.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,i){qn(this.beans,{state:e.map(n=>({colId:typeof n=="string"?n:n.getColId(),hide:!t}))},i)}restoreColOrder(e){let t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;let i=t.filter(u=>e.map[u.getId()]!=null);if(i.length===0)return;if(i.length===e.list.length){e.list=i;return}let n=u=>{let h=u.getOriginalParent();return h?h.getChildren().length>1?!0:n(h):!1};if(!i.some(u=>n(u))){let u=new Set(i);for(let h of e.list)u.has(h)||i.push(h);e.list=i;return}let r=new Map;for(let u=0;u<i.length;u++){let h=i[u];r.set(h,u)}let o=e.list.filter(u=>!r.has(u));if(o.length===0){e.list=i;return}let s=(u,h)=>{let p=h?h.getOriginalParent():u.getOriginalParent();if(!p)return null;let f=null,g=null;for(let m of p.getChildren())if(!(m===h||m===u)){if(m instanceof Sa){let v=r.get(m);if(v==null)continue;(f==null||f<v)&&(f=v,g=m);continue}m.forEachLeafColumn(v=>{let C=r.get(v);C!=null&&(f==null||f<C)&&(f=C,g=v)})}return g??s(u,p)},a=[],l=new Map;for(let u of o){let h=s(u,null);if(h==null){a.push(u);continue}let p=l.get(h);p===void 0?l.set(h,u):Array.isArray(p)?p.push(u):l.set(h,[p,u])}let c=new Array(e.list.length),d=c.length-1;for(let u=a.length-1;u>=0;u--)c[d--]=a[u];for(let u=i.length-1;u>=0;u--){let h=i[u],p=l.get(h);if(p)if(Array.isArray(p))for(let f=p.length-1;f>=0;f--){let g=p[f];c[d--]=g}else c[d--]=p;c[d--]=h}e.list=c}positionLockedCols(e){e.list=DF(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(e){return this.colDefCols&&this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[],e)}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);let{visibleCols:i,eventSvc:n}=this.beans;i.refresh(t),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){let e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);let t=Kl(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){Zg(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){let{pivotResultCols:t,autoColSvc:i,selectionColSvc:n,groupHierarchyColSvc:r}=this.beans;wu(this.colDefCols?.list,e)||wu(i?.columns?.list,e)||wu(n?.columns?.list,e)||wu(r?.columns?.list,e)||wu(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){return this.cols?.map[e]??null}getColFromCollection(e,t){if(t==null)return null;let{map:i,list:n}=t;if(typeof e=="string"&&i[e])return i[e];for(let a=0;a<n.length;a++)if(Tu(n[a],e))return n[a];let{autoColSvc:r,selectionColSvc:o,groupHierarchyColSvc:s}=this.beans;return r?.getColumn(e)??o?.getColumn(e)??s?.getColumn(e)??null}};var OF=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){let t=this.existingIds[e],i;return typeof t!="number"?i=0:i=t+1,this.existingIds[e]=i,i}};function Qu(e,t,i){return i&&e.addDestroyFunc(()=>t.destroyBean(i)),i??e}var ae=null;function P_(e){return typeof e?.getGui=="function"}var LF=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){if(!e)return;if(e.includes(" ")){let n=(e||"").split(" ");if(n.length>1){for(let r of n)this.toggleCss(r,t);return}}this.cssClassStates[e]!==t&&e.length&&(this.getGui()?.classList.toggle(e,t),this.cssClassStates[e]=t)}},BU=0,lc=class extends Ai{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=BU++,this.cssManager=new LF(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(i=>[i.selector,i])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());let e="component-"+Object.getPrototypeOf(this)?.constructor?.name;for(let t of this.css??[])this.beans.environment.addGlobalCSS(t,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(QD):null}applyElementsToComponent(e,t,i,n=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){let r=this[t];if(r===ae)this[t]=n??e;else{let o=i?.[t];if(!this.suppressDataRefValidation&&!o)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${r}`)}}}createChildComponentsFromTags(e,t){let i=[];for(let n of e.childNodes??[])i.push(n);for(let n of i){if(!(n instanceof HTMLElement))continue;let r=this.createComponentFromElement(n,o=>{let s=o.getGui();if(s)for(let a of n.attributes??[])s.setAttribute(a.name,a.value)},t);if(r){if(r.addItems&&n.children.length){this.createChildComponentsFromTags(n,t);let o=Array.prototype.slice.call(n.children);r.addItems(o)}this.swapComponentForNode(r,e,n)}else n.childNodes&&this.createChildComponentsFromTags(n,t)}}createComponentFromElement(e,t,i){let n=e.nodeName,r=this.getDataRefAttribute(e),o=n.indexOf("AG-")===0,s=o?this.componentSelectors.get(n):null,a=null;if(s){let l=i&&r?i[r]:void 0;a=new s.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(o)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(e,r,i,a),a}swapComponentForNode(e,t,i){let n=e.getGui();t.replaceChild(n,i),t.insertBefore(document.createComment(i.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e,t){let i=t??this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(let n of e)n.setAttribute("tabindex",i.toString())}setTemplate(e,t,i){let n;typeof e=="string"||e==null?n=dy(e):n=ns(e),this.setTemplateFromElement(n,t,i)}setTemplateFromElement(e,t,i,n=!1){if(this.eGui=e,this.suppressDataRefValidation=n,t)for(let r=0;r<t.length;r++){let o=t[r];this.componentSelectors.set(o.selector,o)}this.wireTemplate(e,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let i=t;return e==null?null:(i||(i=this.eGui),py(e)?{element:e,parent:i}:{element:e.getGui(),parent:i})}prependChild(e,t){let{element:i,parent:n}=this.getContainerAndElement(e,t)||{};!i||!n||n.insertAdjacentElement("afterbegin",i)}appendChild(e,t){let{element:i,parent:n}=this.getContainerAndElement(e,t)||{};!i||!n||n.appendChild(i)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;let{skipAriaHidden:i}=t;fW(this.eGui,e,{skipAriaHidden:i})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;let{skipAriaHidden:i}=t;ot(this.eGui,e,{skipAriaHidden:i});let n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},st=class extends lc{};function NF(e){return typeof e=="object"&&!!e.component}function HU(e,t){return new wt(i=>{i(window.setInterval(e,t))})}var wt=class ku{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(i=>this.onDone(i),i=>this.onReject(i))}static all(t){return t.length?new ku(i=>{let n=t.length,r=new Array(n);t.forEach((o,s)=>{o.then(a=>{r[s]=a,n--,n===0&&i(r)})})}):ku.resolve()}static resolve(t=null){return new ku(i=>i(t))}then(t){return new ku(i=>{this.status===1?i(t(this.resolution)):this.waiters.push(n=>i(t(n)))})}onDone(t){this.status=1,this.resolution=t;for(let i of this.waiters)i(t)}onReject(t){}};function zU(e){return e?e.prototype&&"getGui"in e.prototype:!1}function BF(e,t,i,n){let{name:r}=i,o,s,a,l,c,d;if(t){let u=t,h=u[r+"Selector"],p=h?h(n):null,f=g=>{typeof g=="string"?o=g:g!=null&&g!==!0&&(e.isFrameworkComponent(g)?a=g:s=g)};p?(f(p.component),l=p.params,c=p.popup,d=p.popupPosition):f(u[r])}return{compName:o,jsComp:s,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:d}}var VU=class extends j{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,i,n=!1){return this.getCompDetails(this.gridOptions,e,t,i,n)}getCompDetails(e,t,i,n,r=!1){let{name:o,cellRenderer:s}=t,{compName:a,jsComp:l,fwComp:c,paramsFromSelector:d,popupFromSelector:u,popupPositionFromSelector:h}=BF(this.beans.frameworkOverrides,e,t,n),p,f,g=b=>{let S=this.registry.getUserComponent(o,b);S&&(l=S.componentFromFramework?void 0:S.component,c=S.componentFromFramework?S.component:void 0,p=S.params,f=S.processParams)};if(a!=null&&g(a),l==null&&c==null&&i!=null&&g(i),l&&s&&!zU(l)&&(l=this.agCompUtils?.adaptFunction(t,l)),!l&&!c){let{validation:b}=this.beans;r&&(a!==i||!i)?a?b?.isProvidedUserComp(a)||Ze(50,{compName:a}):i?b||Ze(260,T(w({},this.gos.getModuleErrorParams()),{propName:o,compName:i})):Ze(216,{name:o}):i&&!b&&Ze(146,{comp:i});return}let m=this.mergeParams(e,t,n,d,p,f),v=l==null,C=l??c;return{componentFromFramework:v,componentClass:C,params:m,type:t,popupFromSelector:u,popupPositionFromSelector:h,newAgStackInstance:()=>this.newAgStackInstance(C,v,m,t)}}newAgStackInstance(e,t,i,n){let r=!t,o;r?o=new e:o=this.frameworkCompWrapper.wrap(e,n.mandatoryMethods,n.optionalMethods,n),this.createBean(o);let s=o.init?.(i);return s==null?wt.resolve(o):s.then(()=>o)}mergeParams(e,t,i,n=null,r,o){let s=w(w({},i),r),l=e?.[t.name+"Params"];if(typeof l=="function"){let c=l(i);Ii(s,c)}else typeof l=="object"&&Ii(s,l);return Ii(s,n),o?o(s):s}},GU={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},WU={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},UU={name:"headerComponent",optionalMethods:["refresh"]},jU={name:"innerHeaderComponent"},qU={name:"innerHeaderGroupComponent"},$U={name:"headerGroupComponent"};var KU={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0};var YU={name:"loadingCellRenderer",cellRenderer:!0},XU={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},JU={name:"tooltipComponent"},yy={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},QU={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},ZU={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},ej={name:"loadingCellRenderer",cellRenderer:!0},tj={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},ij={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function nj(e,t){return e.getCompDetailsFromGridOptions(WU,"agDragAndDropImage",t,!0)}function rj(e,t,i){return e.getCompDetails(t,UU,"agColumnHeader",i)}function oj(e,t,i){return e.getCompDetails(t,jU,void 0,i)}function sj(e,t){let i=t.columnGroup.getColGroupDef();return e.getCompDetails(i,$U,"agColumnGroupHeader",t)}function aj(e,t,i){return e.getCompDetails(t,qU,void 0,i)}function lj(e,t){return e.getCompDetailsFromGridOptions(ZU,void 0,t,!0)}function cj(e,t){return e.getCompDetailsFromGridOptions(ej,"agLoadingCellRenderer",t,!0)}function dj(e,t){return e.getCompDetailsFromGridOptions(tj,"agGroupRowRenderer",t,!0)}function uj(e,t){return e.getCompDetailsFromGridOptions(ij,"agDetailCellRenderer",t,!0)}function k_(e,t,i){return e.getCompDetails(t,KU,void 0,i)}function __(e,t,i){return e.getCompDetails(t,YU,"agSkeletonCellRenderer",i,!0)}function HF(e,t,i){return e.getCompDetails(t,XU,"agCellEditor",i,!0)}function hj(e,t,i,n){let r=t.filter;return NF(r)&&(t={filter:r.component,filterParams:t.filterParams}),e.getCompDetails(t,yy,n,i,!0)}function pj(e,t,i){return e.getCompDetails(t,GU,"agDateInput",i,!0)}function fj(e,t){return e.getCompDetails(t.colDef,JU,"agTooltipComponent",t,!0)}function gj(e,t,i,n){return e.getCompDetails(t,QU,n,i)}function zF(e,t){return BF(e,t,yy)}function qw(e,t,i){return e.mergeParams(t,yy,i)}function ju(e){let t=e;return t?.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}function mj(e){return typeof e=="object"&&!!e.getComp}var B={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},vj=65,Cj=67,wj=86,bj=68,yj=90,Sj=89;function VF(e){let{keyCode:t}=e,i;switch(t){case vj:i=B.A;break;case Cj:i=B.C;break;case wj:i=B.V;break;case bj:i=B.D;break;case yj:i=B.Z;break;case Sj:i=B.Y;break;default:i=e.code}return i}var Sy=class extends lc{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){let e=this.parentComponent;e?.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},$w,Kw,Yw,Xw,Ob,Lb,Jw;function fs(){return $w===void 0&&($w=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),$w}function qu(){return Kw===void 0&&(Kw=/(firefox)/i.test(navigator.userAgent)),Kw}function GF(){return Yw===void 0&&(Yw=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Yw}function pa(){return Xw===void 0&&(Xw=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),Xw}function Nb(e){if(!e)return null;let t=e.tabIndex,i=e.getAttribute("tabIndex");return t===-1&&(i===null||i===""&&!qu())?null:t.toString()}function xj(){if(Jw!==void 0)return Jw;if(!document.body)return-1;let e=1e6,t=qu()?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){let n=e*2;if(i.style.height=n+"px",n>t||i.clientHeight!==n)break;e=n}return i.remove(),Jw=e,e}function Ej(){return Lb==null&&WF(),Lb}function WF(){let e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;i===0&&t.clientWidth===0&&(i=null),t.parentNode&&t.remove(),i!=null&&(Lb=i,Ob=i===0)}function UF(){return Ob==null&&WF(),Ob}var Bb=!1,im=0;function Rj(e){im>0||(e.addEventListener("keydown",nm),e.addEventListener("mousedown",nm))}function Pj(e){im>0||(e.removeEventListener("keydown",nm),e.removeEventListener("mousedown",nm))}function nm(e){let t=Bb,i=e.type==="keydown";i&&(e.ctrlKey||e.metaKey||e.altKey)||t!==i&&(Bb=i)}function kj(e){let t=Kt(e);return Rj(t),im++,()=>{im--,Pj(t)}}function jF(){return Bb}function Yl(e,t,i=!1){let n=pW,r=qD;t&&(r+=", "+t),i&&(r+=', [tabindex="-1"]');let o=Array.prototype.slice.apply(e.querySelectorAll(n)).filter(l=>Ir(l)),s=Array.prototype.slice.apply(e.querySelectorAll(r));return s.length?((l,c)=>l.filter(d=>c.indexOf(d)===-1))(o,s):o}function Ca(e,t=!1,i=!1,n=!1){let r=Yl(e,n?".ag-tab-guard":null,i),o=t?dt(r):r[0];return o?(o.focus({preventScroll:!0}),!0):!1}function xa(e,t,i,n){let r=Yl(t,i?':not([tabindex="-1"])':null),o=bt(e),s;i?s=r.findIndex(l=>l.contains(o)):s=r.indexOf(o);let a=s+(n?-1:1);return a<0||a>=r.length?null:r[a]}function qF(e,t=5){let i=0;for(;e&&Nb(e)===null&&++i<=t;)e=e.parentElement;return Nb(e)===null?null:e}var _j="ag-focus-managed",$F=class extends Ai{constructor(e,t={isStopPropagation:()=>!1,stopPropagation:()=>{}},i={}){super(),this.eFocusable=e,this.stopPropagationCallbacks=t,this.callbacks=i,this.callbacks=w({shouldStopEventPropagation:()=>!1,onTabKeyDown:n=>{if(n.defaultPrevented)return;let r=xa(this.beans,this.eFocusable,!1,n.shiftKey);r&&(r.focus(),n.preventDefault())}},i)}postConstruct(){let{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:i}}=this;e.classList.add(_j),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),i&&this.addManagedElementListeners(e,{focusout:i})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||this.stopPropagationCallbacks.isStopPropagation(t))return;let{callbacks:i}=this;if(i.shouldStopEventPropagation(t)){this.stopPropagationCallbacks.stopPropagation(t);return}t.key===B.TAB?i.onTabKeyDown(t):i.handleKeyDown&&i.handleKeyDown(t)}})}},Qw={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},Dj=class extends Ai{constructor(e,t){super(),this.stopPropagationCallbacks=t,this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;let{comp:i,eTopGuard:n,eBottomGuard:r,focusTrapActive:o,forceFocusOutWhenTabGuardsAreEmpty:s,isFocusableContainer:a,focusInnerElement:l,onFocusIn:c,onFocusOut:d,shouldStopEventPropagation:u,onTabKeyDown:h,handleKeyDown:p,isEmpty:f,eFocusableElement:g}=e;this.comp=i,this.eTopGuard=n,this.eBottomGuard=r,this.providedFocusInnerElement=l,this.eFocusableElement=g,this.focusTrapActive=!!o,this.forceFocusOutWhenTabGuardsAreEmpty=!!s,this.isFocusableContainer=!!a,this.providedFocusIn=c,this.providedFocusOut=d,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=h,this.providedHandleKeyDown=p,this.providedIsEmpty=f}postConstruct(){this.createManagedBean(new $F(this.eFocusableElement,this.stopPropagationCallbacks,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(let e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;let e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Yl(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;let t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){let t=Kt(this.beans),i=Yl(t.body,null,!0),n=i.indexOf(e?this.eTopGuard:this.eBottomGuard);if(n===-1)return;let r,o;e?(r=0,o=n):(r=n+1,o=i.length);let s=i.slice(r,o),a=this.gos.get("tabIndex");s.sort((l,c)=>{let d=Number.parseInt(l.getAttribute("tabindex")||"0"),u=Number.parseInt(c.getAttribute("tabindex")||"0");return u===a?1:d===a?-1:d===0?1:u===0?-1:d-u}),s[e?s.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;let t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();let i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(e=!1){let t=Yl(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return xa(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;let t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},Fj=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.includes("x"),this.scrollVertically=e.scrollAxis.includes("y"),this.scrollByTick=e.scrollByTick??20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(e,t=!1){let i=t||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;let n=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<n.left+r,this.tickRight=e.clientX>n.right-r,this.tickUp=e.clientY<n.top+r&&!i,this.tickDown=e.clientY>n.bottom-r&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){let t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){let t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},KF="ag-resizer-wrapper",Jo=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),Mj={tag:"div",cls:KF,children:[Jo("eTopLeft","topLeft"),Jo("eTop","top"),Jo("eTopRight","topRight"),Jo("eRight","right"),Jo("eBottomRight","bottomRight"),Jo("eBottom","bottom"),Jo("eBottomLeft","bottomLeft"),Jo("eLeft","left")]},Tj=class extends Ai{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=w({popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){let{clientHeight:t,clientWidth:i}=this.offsetParent,n=i/2-this.getWidth()/2,r=t/2-this.getHeight()/2;this.offsetElement(n,r,e)}initialisePosition(e){if(this.positioned)return;let{centered:t,forcePopupParentAsOffsetParent:i,minWidth:n,width:r,minHeight:o,height:s,x:a,y:l}=this.config;this.offsetParent||this.setOffsetParent();let c=0,d=0,u=Ir(this.element);if(u){let h=this.findBoundaryElement(),p=window.getComputedStyle(h);if(p.minWidth!=null){let f=h.offsetWidth-this.element.offsetWidth;d=Number.parseInt(p.minWidth,10)-f}if(p.minHeight!=null){let f=h.offsetHeight-this.element.offsetHeight;c=Number.parseInt(p.minHeight,10)-f}}if(this.minHeight=o||c,this.minWidth=n||d,r&&this.setWidth(r),s&&this.setHeight(s),(!r||!s)&&this.refreshSize(),t)this.center(e);else if(a||l)this.offsetElement(a,l,e);else if(u&&i){let h=this.boundaryEl,p=!0;if(h||(h=this.findBoundaryElement(),p=!1),h){let f=Number.parseFloat(h.style.top),g=Number.parseFloat(h.style.left);p?this.offsetElement(Number.isNaN(g)?0:g,Number.isNaN(f)?0:f,e):this.setPosition(g,f)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;let i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(i),this.moveElementDragListener=i):(this.dragSvc?.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}for(let t of Object.keys(e)){let i=!!e[t],n=this.getResizerElement(t),r={dragStartPixels:0,eElement:n,onDragStart:o=>this.onResizeStart(o,t),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,t)};(i||!this.isAlive()&&!i)&&(i?(this.dragSvc?.addDragSource(r),this.resizeListeners.push(r),n.style.pointerEvents="all"):n.style.pointerEvents="none",this.resizable[t]=i)}}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";let{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){let{popup:t}=this.config,i=this.element,n=!1;if(typeof e=="string"&&e.includes("%"))Fu(i,e),e=$D(i),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){let r=this.getAvailableHeight();r&&e>r&&(e=r)}this.getHeight()!==e&&(n?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?Fu(i,e):(i.style.height=`${e}px`,i.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:Number.parseFloat(e)))}getAvailableHeight(){let{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();let{clientHeight:i}=this.offsetParent;if(!i)return null;let n=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),o=e?this.position.y:n.top,s=e?0:r.top,a=0;if(t){let c=this.element.parentElement;if(c){let{bottom:d}=c.getBoundingClientRect();a=d-n.bottom}}return i+s-o-a}getWidth(){return this.element.offsetWidth}setWidth(e){let t=this.element,{popup:i}=this.config,n=!1;if(typeof e=="string"&&e.includes("%"))Dr(t,e),e=jg(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);let{clientWidth:r}=this.offsetParent,o=i?this.position.x:this.element.getBoundingClientRect().left;r&&e+o>r&&(e=r-o)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?Dr(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:Number.parseFloat(e)))}offsetElement(e=0,t=0,i){let{forcePopupParentAsOffsetParent:n}=this.config,r=n?this.boundaryEl:this.element;r&&(this.popupSvc?.positionPopup({ePopup:r,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:i}),this.setPosition(Number.parseFloat(r.style.left),Number.parseFloat(r.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;let t=()=>{let i=this.getAvailableHeight();this.element.style.setProperty("max-height",`${i}px`)};e&&this.popupSvc?(this.resizeObserverSubscriber?.(),this.resizeObserverSubscriber=us(this.beans,this.popupSvc?.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){let{e:t,isLeft:i,isTop:n,anywhereWithin:r,topBuffer:o}=e,s=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!i,!!r,s)?0:s,c=this.shouldSkipY(t,!!n,o,a)?0:a;return{movementX:l,movementY:c}}shouldSkipX(e,t,i,n){let r=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left,l=a<=0&&o.left>=e.clientX||o.right<=e.clientX&&o.right<=s.right;return l?!0:(t?l=n<0&&e.clientX>a+o.left||n>0&&e.clientX<a+o.left:i?l=n<0&&e.clientX>s.right||n>0&&e.clientX<a+o.left:l=n<0&&e.clientX>s.right||n>0&&e.clientX<s.right,l)}shouldSkipY(e,t,i=0,n){let r=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top,l=a<=0&&o.top>=e.clientY||o.bottom<=e.clientY&&o.bottom<=s.bottom;return l?!0:(t?l=n<0&&e.clientY>a+o.top+i||n>0&&e.clientY<a+o.top:l=n<0&&e.clientY>s.bottom||n>0&&e.clientY<s.bottom,l)}createResizeMap(){let e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;let e=this.element;e&&(e.appendChild(ns(Mj)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0,this.element.querySelector(`.${KF}`)?.remove(),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");let{popup:i,forcePopupParentAsOffsetParent:n}=this.config;!i&&!n&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){let t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(i=>!i.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){let e=this.getSiblings()||[],t=0,i=0;for(let n of e){let r=!!n.style.flex&&n.style.flex!=="0 0 auto";if(n===this.element)continue;let o=this.minHeight||0,s=this.minWidth||0;if(r){let a=window.getComputedStyle(n);a.minHeight&&(o=Number.parseInt(a.minHeight,10)),a.minWidth&&(s=Number.parseInt(a.minWidth,10))}else o=n.offsetHeight,s=n.offsetWidth;t+=o,i+=s}return{height:t,width:i}}applySizeToSiblings(e){let t=null,i=this.getSiblings();if(i){for(let n=0;n<i.length;n++){let r=i[n];r!==t&&(e?r.style.height=`${r.offsetHeight}px`:r.style.width=`${r.offsetWidth}px`,r.style.flex="0 0 auto",r===this.element&&(t=i[n+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;let{popup:t,forcePopupParentAsOffsetParent:i}=this.config,{isTop:n,isRight:r,isBottom:o,isLeft:s}=this.currentResizer,a=r||s,l=o||n,{movementX:c,movementY:d}=this.calculateMouseMovement({e,isLeft:s,isTop:n}),u=this.position.x,h=this.position.y,p=0,f=0;if(a&&c){let g=s?-1:1,m=this.getWidth(),v=m+c*g,C=!1;s&&(p=m-v,(u+p<=0||v<=this.minWidth)&&(C=!0,p=0)),C||this.setWidth(v)}if(l&&d){let g=n?-1:1,m=this.getHeight(),v=m+d*g,C=!1;n?(f=m-v,(h+f<=0||v<=this.minHeight)&&(C=!0,f=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&m<v&&this.getMinSizeOfSiblings().height+v>this.element.parentElement.offsetHeight&&(C=!0),C||this.setHeight(v)}this.updateDragStartPosition(e.clientX,e.clientY),((t||i)&&p||f)&&this.offsetElement(u+p,h+f)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){let e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;let{x:t,y:i}=this.position,n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());let{movementX:r,movementY:o}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+r,i+o),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){let e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},xy="T",Ij=new RegExp(`[${xy} ]`),Aj=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${xy}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function Rr(e,t){return e.toString().padStart(t,"0")}function an(e,t=!0,i=xy){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(r=>Rr(r,2)).join("-");return t&&(n+=i+[e.getHours(),e.getMinutes(),e.getSeconds()].map(r=>Rr(r,2)).join(":")),n}function vg(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),Rr(e.getDate(),2),Rr(e.getHours(),2),`:${Rr(e.getMinutes(),2)}`,`:${Rr(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,Rr(e.getDate(),2)].map(String):null}var Zw=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},D_=["January","February","March","April","May","June","July","August","September","October","November","December"],eb=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Hb(e,t){if(t==null)return an(e,!1);let i=Rr(e.getFullYear(),4),n={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>D_[e.getMonth()],MMM:()=>D_[e.getMonth()].slice(0,3),MM:()=>Rr(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${Zw(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${Zw(e.getDate())}`,DD:()=>Rr(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>eb[e.getDay()],ddd:()=>eb[e.getDay()].slice(0,3),dd:()=>eb[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${Zw(e.getDay())}`,d:()=>`${e.getDay()}`},r=new RegExp(Object.keys(n).join("|"),"g");return t.replace(r,o=>o in n?n[o]():o)}function Lg(e,t=!1){return!!qi(e,t)}function Oj(e){return Lg(e,!0)}function qi(e,t=!1,i){if(!e||!i&&!Aj.test(e))return null;let[n,r]=e.split(Ij);if(!n)return null;let o=n.split("-").map(p=>Number.parseInt(p,10));if(o.filter(p=>!isNaN(p)).length!==3)return null;let[s,a,l]=o,c=new Date(s,a-1,l);if(c.getFullYear()!==s||c.getMonth()!==a-1||c.getDate()!==l||!r&&t)return null;if(!r||r==="00:00:00")return c;let[d,u,h]=r.split(":").map(p=>Number.parseInt(p,10));if(d>=0&&d<24)c.setHours(d);else if(t)return null;if(u>=0&&u<60)c.setMinutes(u);else if(t)return null;if(h>=0&&h<60)c.setSeconds(h);else if(t)return null;return c}function zb(e){let{inputValue:t,allSuggestions:i,hideIrrelevant:n,filterByPercentageOfBestMatch:r}=e,o=(i??[]).map((l,c)=>({value:l,relevance:Lj(t,l),idx:c}));if(o.sort((l,c)=>l.relevance-c.relevance),n&&(o=o.filter(l=>l.relevance<Math.max(l.value.length,t.length))),o.length>0&&r&&r>0){let c=o[0].relevance*r;o=o.filter(d=>c-d.relevance<0)}let s=[],a=[];for(let l of o)s.push(l.value),a.push(l.idx);return{values:s,indices:a}}function Lj(e,t){let i=e.length,n=t.length;if(n===0)return i||0;let r=e.toLocaleLowerCase(),o=t.toLocaleLowerCase(),s;e.length<t.length&&(s=o,o=r,r=s,s=t,t=e,e=s);let a=new Uint16Array(n+1),l=new Uint16Array(n+1);for(let u=0;u<=n;u++)a[u]=u;let c=0,d=i/2-10;for(let u=1;u<=i;u++){let h=e[u-1],p=r[u-1];l[0]=u;for(let f=1;f<=n;f++){let g=t[f-1],m=o[f-1];if(p!==m){let v=l[f-1],C=a[f],b=a[f-1],S=v<C?v:C;b<S&&(S=b),l[f]=S+1|0;continue}if(c++,h===g&&c++,u>1&&f>1){let v=e[u-2],C=r[u-2],b=t[f-2],S=o[f-2];C===S&&(c++,v===b&&c++)}u<d&&c++,l[f]=a[f-1]}s=a,a=l,l=s}return a[n]/(c+1)}function YF(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}var Nj=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",Bj=class extends lc{constructor(e,t,i){super(t,i),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(Nj)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");let{labelSeparator:e,label:t,labelWidth:i,labelAlignment:n,disabled:r,labelEllipsis:o}=this.config;r!=null&&this.setDisabled(r),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),i!=null&&this.setLabelWidth(i),o!=null&&this.setLabelEllipsis(o),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){let{label:e,eLabel:t}=this;ii(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(ot(t,!1),ss(t,"presentation")):(ot(t,!0),ss(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){let e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){let i=this.getGui().classList;return i.toggle("ag-label-align-left",e==="left"),i.toggle("ag-label-align-right",e==="right"),i.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(Kg(this.eLabel,e),this)}setDisabled(e){e=!!e;let t=this.getGui();return Hu(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},XF=class extends Bj{constructor(e,t,i,n){super(e,t,i),this.className=n}postConstruct(){super.postConstruct();let{width:e,value:t,onValueChange:i,ariaLabel:n}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),i!=null&&this.onValueChange(i),n!=null&&this.setAriaLabel(n),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){let e=this.getAriaElement(),t=this.getLabelId(),i=this.getLabel();i==null||i==""||QG(e)!==null?Bu(e,""):Bu(e,t??"")}setAriaLabel(e){return ec(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Dr(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function Hj(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var ca=class extends XF{constructor(e,t,i="text",n="input"){super(e,e?.template??Hj(n),[],t),this.inputType=i,this.displayFieldTag=n,this.eLabel=ae,this.eWrapper=ae,this.eInput=ae}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);let{eLabel:e,eWrapper:t,eInput:i,className:n}=this;e.classList.add(`${n}-label`),t.classList.add(`${n}-input-wrapper`),i.classList.add(`${n}-input`),this.addCss("ag-input-field"),i.id=i.id||`ag-${this.getCompId()}-input`;let{inputName:r,inputWidth:o,inputPlaceholder:s,autoComplete:a,tabIndex:l}=this.config;r!=null&&this.setInputName(r),o!=null&&this.setInputWidth(o),s!=null&&this.setInputPlaceholder(s),a!=null&&this.setAutoComplete(a),this.addInputListeners(),this.activateTabIndex([i],l)}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,Ui(this.eInput,"type",e))}getInputElement(){return this.eInput}getWrapperElement(){return this.eWrapper}setInputWidth(e){return Kg(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){let t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return Ui(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return ec(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return Hu(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)Ui(this.eInput,"autocomplete",null);else{let t=typeof e=="string"?e:"off";Ui(this.eInput,"autocomplete",t)}return this}},Ey=class extends ca{constructor(e,t="ag-checkbox",i="checkbox"){super(e,t,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();let{readOnly:e,passive:t,name:i}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t),i!=null&&this.setName(i)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;let e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){let t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;let i=this.eInput;i.checked=e,i.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,i){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:i});let n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;let t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){let t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},Ry={selector:"AG-CHECKBOX",component:Ey},zj=class extends Ey{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){let t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}};var Ea=class extends ca{constructor(e,t="ag-text-field",i="text"){super(e,t,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){let i=this.eInput;return i.value!==e&&(i.value=pe(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}setCustomValidity(e){let t=this.eInput,i=e.length>0;t.setCustomValidity(e),i&&t.reportValidity(),ay(t,i)}preventDisallowedCharacters(){let e=new RegExp(`[${this.config.allowedCharPattern}]`),t=i=>{YF(i)&&i.key&&!e.test(i.key)&&i.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:i=>{i.clipboardData?.getData("text")?.split("").some(r=>!e.test(r))&&i.preventDefault()}})}},bm={selector:"AG-INPUT-TEXT-FIELD",component:Ea},Vj=class extends ca{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){let i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},Gj={selector:"AG-INPUT-TEXT-AREA",component:Vj},Py=class extends Ea{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();let e=this.eInput;this.addManagedListeners(e,{blur:()=>{let o=Number.parseFloat(e.value),s=isNaN(o)?"":this.normalizeValue(o.toString());this.value!==s&&this.setValue(s)},wheel:this.onWheel.bind(this)}),e.step="any";let{precision:t,min:i,max:n,step:r}=this.config;typeof t=="number"&&this.setPrecision(t),typeof i=="number"&&this.setMin(i),typeof n=="number"&&this.setMax(n),typeof r=="number"&&this.setStep(r)}onWheel(e){bt(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){let i=this.precision;if(i==null)return e;if(t){let r=Number.parseFloat(e).toFixed(i);return Number.parseFloat(r).toString()}let n=String(e).split(".");if(n.length>1){if(n[1].length<=i)return e;if(i>0)return`${n[0]}.${n[1].slice(0,i)}`}return n[0]}setMin(e){return this.min===e?this:(this.min=e,Ui(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,Ui(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,Ui(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(i=>super.setValue(i,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,i){if(pe(i)){let n=this.isScientificNotation(i);if(n&&this.eInput.validity.valid)return e(i);if(!n){i=this.adjustPrecision(i);let r=this.normalizeValue(i);n=i!=r}if(n)return t(i)}return e(i)}getValue(e=!1){let t=this.eInput;if(!t.validity.valid&&!e)return;let i=t.value;return this.isScientificNotation(i)?this.adjustPrecision(i,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},Wj={selector:"AG-INPUT-NUMBER-FIELD",component:Py},Uj=class extends Ea{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();let e=fs();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){bt(this.beans)===this.eInput&&e.preventDefault()}setMin(e){let t=e instanceof Date?an(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,Ui(this.eInput,"min",t),this)}setMax(e){let t=e instanceof Date?an(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,Ui(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,Ui(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return qi(this.getValue())??void 0}setDate(e,t){this.setValue(an(e??null,this.includeTime),t)}},JF={selector:"AG-INPUT-DATE-FIELD",component:Uj},jj=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",qj="ag-active-item",$j=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),Kj=class extends lc{constructor(e,t,i){super($j(e,t)),this.label=t,this.value=i,this.eText=ae}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){let t=this.getGui();t.classList.toggle(qj,e),jD(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){let i=this.getGui();nW(i,e),iW(i,t)}createTooltip(){let e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>uy(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){let e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},Yj=class extends lc{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(jj)}postConstruct(){let e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){let t=e.key;switch(t){case B.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{let i=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(i)}break;case B.DOWN:case B.UP:e.preventDefault(),this.navigate(t);break;case B.PAGE_DOWN:case B.PAGE_UP:case B.PAGE_HOME:case B.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){for(let t of e)this.addOption(t);return this}addOption(e){let{value:t,text:i}=e,n=i??t;return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(let e of this.listItems)e.destroy();ii(this.getGui()),this.listItems=[],this.refreshAriaRole()}updateOptions(e){let t=this.options!==e;return t&&(this.clearOptions(),this.addOptions(e)),t}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;let i=this.options.findIndex(n=>n.value===e);if(i!==-1){let n=this.options[i];this.value=n.value,this.displayValue=n.text,this.highlightItem(this.listItems[i]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();let e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){let t=e.getGui();if(!Ir(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;let i=this.getGui(),{scrollTop:n,clientHeight:r}=i,{offsetTop:o,offsetHeight:s}=t;(o+s>n+r||o<n)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){this.highlightedItem?.tooltipFeature?.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){this.highlightedItem?.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){let i=new Kj(this.cssIdentifier,t,e);i.setParentComponent(this);let n=this.createManagedBean(i);this.listItems.push(n),this.getGui().appendChild(n.getGui())}navigate(e){let t=e===B.DOWN,i,{listItems:n,highlightedItem:r}=this;if(!r)i=t?n[0]:dt(n);else{let s=n.indexOf(r)+(t?1:-1);s=Math.min(Math.max(s,0),n.length-1),i=n[s]}this.highlightItem(i)}navigateToPage(e){let{listItems:t,highlightedItem:i}=this;if(!i||t.length===0)return;let n=t.indexOf(i),r=this.options.length-1,o=t[0].getHeight(),s=Math.floor(this.getGui().clientHeight/o),a=-1;e===B.PAGE_HOME?a=0:e===B.PAGE_END?a=r:e===B.PAGE_DOWN?a=Math.min(n+s,r):e===B.PAGE_UP&&(a=Math.max(n-s,0)),a!==-1&&this.highlightItem(t[a])}refreshAriaRole(){ss(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();let e=this.listItems,t=e.length;e.forEach((i,n)=>{i.setIndex(n+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},Xj=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",Jj={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},Qj=class extends XF{constructor(e){if(super(e,e?.template||Jj,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=ae,this.eWrapper=ae,this.eDisplayField=ae,this.eIcon=ae,this.registerCSS(Xj),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;let{pickerGap:t,maxPickerHeight:i,variableWidth:n,minPickerWidth:r,maxPickerWidth:o}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!n,i!=null&&this.setPickerMaxHeight(i),r!=null&&this.setPickerMinWidth(r),o!=null&&this.setPickerMaxWidth(o)}postConstruct(){super.postConstruct(),this.setupAria();let e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);let t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});let{pickerIcon:i,inputWidth:n}=this.config;if(i){let r=this.beans.iconSvc.createIconNoSpan(i);r&&this.eIcon.appendChild(r)}n!=null&&this.setInputWidth(n)}setupAria(){let e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),Pb(e,!1),this.ariaRole&&ss(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){let t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case B.UP:case B.DOWN:case B.ENTER:case B.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case B.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());let e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){let e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));let t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:i,pickerAriaLabelValue:n,modalPicker:r=!0},maxPickerHeight:o,minPickerWidth:s,maxPickerWidth:a,variableWidth:l,beans:c,eWrapper:d}=this,u={modal:r,eChild:e,closeOnEsc:!0,closedCallback:()=>{let g=oy(c);this.beforeHidePicker(),g&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(i,n),anchorToElement:d};e.style.position="absolute";let h=c.popupSvc,p=h.addPopup(u);l?(s&&(e.style.minWidth=s),e.style.width=hy(jg(d)),a&&(e.style.maxWidth=a)):Kg(e,a??jg(d));let f=o??`${ly(h.getPopupParent())}px`;return e.style.setProperty("max-height",f),this.alignPickerToComponent(),p.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;let{pickerGap:e,config:{pickerType:t},beans:{popupSvc:i,gos:n},eWrapper:r,pickerComponent:o}=this,s=n.get("enableRtl")?"right":"left";i.positionPopupByComponent({type:t,eventSource:r,ePopup:o.getGui(),position:"under",alignSide:s,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);let e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;let t=this.getAriaElement();Pb(t,e);let i=this.eWrapper.classList;i.toggle("ag-picker-expanded",e),i.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return Kg(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},Zj=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",ky=class extends Qj{constructor(e){super(w({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox"},e)),this.registerCSS(Zj)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:Dg(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");let{options:e,value:t,placeholder:i}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),i&&t==null&&(this.eDisplayField.textContent=i),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){let e=this.createBean(new Yj("select"));this.listComponent=e,e.setParentComponent(this);let t=e.getAriaElement(),i=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",i),hW(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:n=>{n?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){this.listComponent?.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){let{key:t}=e;switch(t===B.TAB&&this.hidePicker(),t){case B.ENTER:case B.UP:case B.DOWN:case B.PAGE_UP:case B.PAGE_DOWN:case B.PAGE_HOME:case B.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case B.ESCAPE:super.onKeyDown(e);break;case B.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){let e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){for(let t of e)this.addOption(t);return this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}updateOptions(e){return this.listComponent?.updateOptions(e)&&this.setValue(void 0,!0),this}setValue(e,t,i){let{listComponent:n,config:{placeholder:r},eDisplayField:o,tooltipFeature:s}=this;if(this.value===e||!n)return this;if(i||n.setValue(e,!0),n.getValue()===this.getValue())return this;let l=n.getDisplayValue();return l==null&&r&&(l=r),o.textContent=l,s?.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},eq={selector:"AG-SELECT",component:ky};var tq=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-tab-guard{display:block;height:0;position:absolute;width:0}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',_y=typeof window!="object"||!window?.document?.fonts?.forEach,Vb=!1,nc=(e,t,i,n,r,o)=>{if(_y||Vb)return;n&&(e=`@layer ${CSS.escape(n).replaceAll("\\.",".")} { ${e} }`);let s=Xl.map.get(t);if(s||(s=[],Xl.map.set(t,s)),s.some(d=>d.css===e))return;let a=document.createElement("style");o&&a.setAttribute("nonce",o),a.dataset.agGlobalCss=i,a.textContent=e;let l={css:e,el:a,priority:r},c;for(let d of s){if(d.priority>r)break;c=d}if(c){c.el.insertAdjacentElement("afterend",a);let d=s.indexOf(c);s.splice(d+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),s.push(l)},QF=(e,t,i,n)=>{nc(tq,e,"shared",t,0,i),n?.forEach((r,o)=>r.forEach(s=>nc(s,e,o,t,0,i)))},iq=e=>{Xl.grids.add(e)},nq=e=>{if(Xl.grids.delete(e),Xl.grids.size===0){Xl.map=new WeakMap;for(let t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},F_,Xl=(F_=typeof window=="object"?window:{}).agStyleInjectionState??(F_.agStyleInjectionState={map:new WeakMap,grids:new Set}),ln=e=>new ZF(e),ts="$default",rq=0,ZF=class{constructor({feature:e,params:t,modeParams:i={},css:n,cssImports:r}){this.feature=e,this.css=n,this.cssImports=r,this.modeParams=w({[ts]:w(w({},i[ts]??{}),t??{})},i)}use(e,t,i){let n=this._inject;if(n==null){let{css:r}=this;if(r){let o=`ag-theme-${this.feature??"part"}-${++rq}`;typeof r=="function"&&(r=r()),r=`:where(.${o}) {
${r}
}
`;for(let s of this.cssImports??[])r=`@import url(${JSON.stringify(s)});
${r}`;n={css:r,class:o}}else n=!1;this._inject=n}return n&&e&&nc(n.css,e,n.class,t,1,i),n?n.class:!1}},oq=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),e8=e=>`--ag-${oq(e)}`,Tr=e=>`var(${e8(e)})`,sq=(e,t,i)=>Math.max(t,Math.min(i,e)),aq=e=>{let t=new Map;return i=>{let n=i;return t.has(n)||t.set(n,e(i)),t.get(n)}},on=e=>({ref:"accentColor",mix:e}),_n=e=>({ref:"foregroundColor",mix:e}),xi=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),lq=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),Ei={ref:"backgroundColor"},Ol={ref:"foregroundColor"},Vt={ref:"accentColor"},rm={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:_n(.15),chromeBackgroundColor:xi(.02),browserColorScheme:"light"},cq=T(w({},rm),{textColor:Ol,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:on(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:Ei,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Vt,toggleButtonOffBackgroundColor:xi(.3),toggleButtonSwitchBackgroundColor:Ei,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}}),dq=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],uq=aq(e=>(e=e.toLowerCase(),dq.find(t=>e.endsWith(t.toLowerCase()))??"length")),ym=e=>typeof e=="object"&&e?.ref?Tr(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,Dy=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){let t=Tr(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?Tr(e.onto):"transparent"}, ${t} ${sq(e.mix*100,0,100)}%)`}return!1},hq=ym,Ll=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,i=>i[0]==="-"?i:" "+Tr(i)+" ")})`:e&&"ref"in e?Tr(e.ref):!1,pq=ym,Gb=(e,t)=>typeof e=="string"?e:e===!0?Gb({},t):e===!1?t==="columnBorder"?Gb({color:"transparent"},t):"none":e&&"ref"in e?Tr(e.ref):t8(e.style??"solid")+" "+Ll(e.width??{ref:"borderWidth"})+" "+Dy(e.color??{ref:"borderColor"}),fq=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?Tr(e.ref):[Ll(e.offsetX??0),Ll(e.offsetY??0),Ll(e.radius??0),Ll(e.spread??0),Dy(e.color??{ref:"foregroundColor"})].join(" "),t8=ym,i8=e=>typeof e=="string"?e.includes(",")?e:M_(e):e&&"googleFont"in e?i8(e.googleFont):e&&"ref"in e?Tr(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),M_(t))).join(", "):!1,M_=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),gq=ym,n8=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?n8({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?Tr(e.ref):!1,mq=(e,t,i)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&i.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?Tr(e.ref):!1,vq={color:Dy,colorScheme:hq,length:Ll,scale:pq,border:Gb,borderStyle:t8,shadow:fq,image:n8,fontFamily:i8,fontWeight:gq,duration:mq},Cq=(e,t,i)=>{let n=uq(e);return vq[n](t,e,i)};var wq=e=>new r8(e),r8=class o8{constructor(t,i=[]){this.themeLogger=t,this.parts=i}withPart(t){return typeof t=="function"&&(t=t()),t instanceof ZF?new o8(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(ln({feature:t}))}withParams(t,i=ts){return this.withPart(ln({modeParams:{[i]:t}}))}_startUse({styleContainer:t,cssLayer:i,nonce:n,loadThemeGoogleFonts:r,moduleCss:o}){if(_y||Vb)return;yq(),QF(t,i,n,o);let s=bq(this);if(s.length>0)for(let a of s)r&&Sq(a,n);for(let a of this.parts)a.use(t,i,n)}_getCssClass(){return Vb?"ag-theme-quartz":this._cssClassCache??(this._cssClassCache=T_(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){let i={[ts]:w({},cq)};for(let n of T_(this.parts))for(let r of Object.keys(n.modeParams)){let o=n.modeParams[r];if(o){let s=i[r]??(i[r]={}),a=new Set;for(let l of Object.keys(o)){let c=o[l];c!==void 0&&(s[l]=c,a.add(l))}if(r===ts)for(let l of Object.keys(i)){let c=i[l];if(l!==ts)for(let d of a)delete c[d]}}}this._paramsCache=t=i}return t}_getPerInstanceCss(t){let i="##SELECTOR##",n=this._paramsCssCache;if(!n){let r="",o="",s=this._getModeParams();for(let l of Object.keys(s)){let c=s[l];if(l!==ts){let u=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;r+=u,o+=u}for(let d of Object.keys(c).sort()){let u=c[d],h=Cq(d,u,this.themeLogger);if(h===!1)this.themeLogger.error(107,{key:d,value:u});else{let p=e8(d),f=p.replace("--ag-","--ag-inherited-");r+=`	${p}: var(${f}, ${h});
`,o+=`	${f}: var(${p});
`}}l!==ts&&(r+=`}
`,o+=`}
`)}let a=`${i} {
${r}}
`;a+=`:has(> ${i}):not(${i}) {
${o}}
`,this._paramsCssCache=n=a}return n.replaceAll(i,`:where(.${t})`)}},T_=e=>{let t=new Map;for(let n of e)t.set(n.feature,n);let i=[];for(let n of e)(!n.feature||t.get(n.feature)===n)&&i.push(n);return i},bq=e=>{let t=new Set,i=o=>{if(Array.isArray(o))o.forEach(i);else{let s=o?.googleFont;typeof s=="string"&&t.add(s)}};return Object.values(e._getModeParams()).flatMap(o=>Object.values(o)).forEach(i),Array.from(t).sort()},I_=!1,yq=()=>{if(!I_){I_=!0;for(let e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},Sq=async(e,t)=>{let i=`@import url('https://${xq}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;nc(i,document.head,`googleFont:${e}`,void 0,0,t)},xq="fonts.googleapis.com",Eq=1,Rq=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=Eq++,e?.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(let t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];for(let t of e.beanClasses){let i=new t;i.beanName?this.beans[i.beanName]=i:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(i)}for(let t of e.derivedBeans??[]){let{beanName:i,bean:n}=t(this);this.beans[i]=n,this.createdBeans.push(n)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){let i=this.beans;for(let n of e)n.preWireBeans?.(i),n.wireBeans?.(i);for(let n of e)n.preConstruct?.();t&&e.forEach(t);for(let n of e)n.postConstruct?.()}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){if(this.destroyed)return;this.destroyed=!0;let e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],this.destroyCallback?.()}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},Pq=0,A_={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},kq=class extends Ai{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1,this.paramsClass=`ag-theme-params-${++Pq}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){let{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t);let i=e.get("themeStyleContainer"),n=typeof ShadowRoot<"u",r=n&&t.getRootNode()instanceof ShadowRoot;this.eStyleContainer=(typeof i=="function"?i():i)??(r?t:document.head),!i&&!r&&n&&_q(t,this.shadowRootError.bind(this),this.addDestroyFunc.bind(this)),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.getSizeEl(A_),this.initVariables(),this.addDestroyFunc(()=>nq(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){let{theme:i}=this,n;i?n=`${this.paramsClass} ${i._getCssClass()}`:n=this.applyLegacyThemeClasses();for(let r of Array.from(e.classList))r.startsWith("ag-theme-")&&e.classList.remove(r);if(n){let r=e.className;e.className=`${r}${r?" ":""}${n}${t?.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let i=!1;for(let n of Array.from(t.classList))n.startsWith("ag-theme-")&&(i=!0,e=e?`${e} ${n}`:n);i&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?nc(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(A_)}getCSSVariablePixelValue(e){let t=this.lastKnownValues.get(e);if(t!=null)return t;let i=this.measureSizeEl(e);return i==="detached"||i==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,i),i)}measureSizeEl(e){let t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";let i=t.offsetWidth;return i===tb?"no-styles":(this.sizesMeasured=!0,i)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=ns({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let i=this.getMeasurementContainer();t=ns({tag:"div"});let{border:n,noWarn:r}=e;n?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${tb}px)`)):t.style.width=`var(${e.cssName}, ${tb}px)`,i.appendChild(t),this.sizeEls.set(e,t);let o=this.measureSizeEl(e);o==="no-styles"&&!r&&this.varError(e);let s=us(this.beans,t,()=>{let a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==o&&(o=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>s()),t}handleThemeChange(){let{gos:e,theme:t}=this,i=e.get("theme"),n;if(i==="legacy")n=void 0;else{let r=i??this.getDefaultTheme();r instanceof r8?n=r:this.themeError(r)}n!==t&&this.handleNewTheme(n),this.postProcessThemeChange(n,i)}handleNewTheme(e){let{gos:t,eRootDiv:i,globalCSS:n}=this,r=this.getAdditionalCss();if(e){iq(this),QF(this.eStyleContainer,this.cssLayer,this.styleNonce,r);for(let[s,a]of n)nc(s,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);n.length=0}this.theme=e,e?._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:r});let o=this.eParamsStyle;if(!o){o=this.eParamsStyle=ns({tag:"style"});let s=t.get("styleNonce");s&&o.setAttribute("nonce",s),i.appendChild(o)}_y||(o.textContent=e?._getPerInstanceCss(this.paramsClass)||""),this.applyThemeClasses(i),this.fireStylesChangedEvent("themeChanged")}fireStylesChangedEvent(e){this.eventSvc.dispatchEvent({type:"stylesChanged",[e]:!0})}},tb=15538,_q=(e,t,i)=>{let n=60,r=setInterval(()=>{typeof ShadowRoot<"u"&&e.getRootNode()instanceof ShadowRoot&&(t(),clearInterval(r)),(cy(e)||--n<0)&&clearInterval(r)},1e3);i(()=>clearInterval(r))},Dq=class extends Ai{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(let t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...i){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));let n=this.dynamicBeans[e];if(n==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new n(...i)}},Fq=class extends Ai{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new ma}addListener(e,t,i){this.globalSvc.addEventListener(e,t,i)}removeListener(e,t,i){this.globalSvc.removeEventListener(e,t,i)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},s8=class extends Ai{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){let i="title",n=this.ctrl.getGui();n&&(e!=null&&(e!=""||t)?n.setAttribute(i,e):n.removeAttribute(i))}updateTooltipText(){let{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){let e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){this.tooltipManager?.prepareToShowTooltip()}attemptToHideTooltip(){this.tooltipManager?.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},Mq=1e3,Tq=1e3,O_=100,L_,Cg=!1,Iq=class extends Ai{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");let e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){let t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){let e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!pa()&&(Cg?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},O_):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){let t=e.relatedTarget,i=this.tooltipCtrl.getGui(),n=this.tooltipComp?.getGui();this.isInteractingWithTooltip||i.contains(t)||this.interactionEnabled&&n?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||Cg)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-L_<Mq}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){let e=this.getTooltipValue(),t=this.tooltipCtrl;if(!pe(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}let i=this.gos.addCommon(w({location:t.getLocation?.()??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0)},t.getAdditionalParams?.()));this.state=2,this.tooltipInstanceCount++;let n=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(i,n)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),L_=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}let n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");let r=this.getLocaleTextFunc(),o=this.popupSvc?.addPopup({eChild:n,ariaLabel:r("ariaLabelTooltip","Tooltip")});if(o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){let s=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:s}),this.setEventHandlers(s)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Kt(this.beans),{keydown:s=>{n.contains(s?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){let e=this.tooltipComp?.getGui(),t=bt(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){let t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){let e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent(T(w({},e),{mouseEvent:this.lastMouseEvent})):this.popupSvc?.positionPopupByComponent(T(w({},e),{eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");let e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,i=this.tooltipTrigger===0?Tq:0;window.setTimeout(()=>{e(),this.destroyBean(t)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(let e of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])e&&e();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){Cg=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},O_)}unlockService(){Cg=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},Aq=class extends s8{constructor(e,t,i){super(e,i),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},wg=0,Oq=200,Lq=class extends Ai{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}postConstruct(){this.addManagedEventListeners({stylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){let e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){let{ePopup:t,nudgeX:i,nudgeY:n,skipObserver:r}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){let t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){let{ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:r,eventSource:o,alignSide:s="left",position:a="over",type:l}=e,c=o.getBoundingClientRect(),d=this.getParentRect();this.setAlignedTo(o,t);let u=()=>{let h=c.left-d.left;s==="right"&&(h-=t.offsetWidth-c.width);let p;return a==="over"?(p=c.top-d.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,c,d,e.nudgeY||0)==="under"?p=c.top-d.top+c.height:p=c.top-t.offsetHeight-(n||0)*2-d.top),{x:h,y:p}};this.positionPopup({ePopup:t,nudgeX:i,nudgeY:n,keepWithinBounds:r,updatePosition:u,postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,l,t,o,null)})}positionPopupForMenu(e){let{eventSource:t,ePopup:i,event:n}=e,r=t.getBoundingClientRect(),o=this.getParentRect();this.setAlignedTo(t,i);let s=!1,a=()=>{let l=this.keepXYWithinBounds(i,r.top-o.top,0),c=i.clientWidth>0?i.clientWidth:200;s||(i.style.minWidth=`${c}px`,s=!0);let u=o.right-o.left-c,h;return this.gos.get("enableRtl")?(h=f(),h<0&&(h=p(),this.setAlignedStyles(i,"left")),h>u&&(h=0,this.setAlignedStyles(i,"right"))):(h=p(),h>u&&(h=f(),this.setAlignedStyles(i,"right")),h<0&&(h=0,this.setAlignedStyles(i,"left"))),{x:h,y:l};function p(){return r.right-o.left-2}function f(){return r.left-o.left-c}};this.positionPopup({ePopup:i,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,"subMenu",i,t,n instanceof MouseEvent?n:void 0)})}shouldRenderUnderOrAbove(e,t,i,n){let r=i.bottom-t.bottom,o=t.top-i.top,s=e.offsetHeight+n;return r>s?"under":o>s||o>r?"above":"under"}setAlignedStyles(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let n=this.popupList[i],{alignedToElement:r}=n;if(!r)return;let o=["right","left","over","above","under"];for(let s of o)r.classList.remove(`ag-has-popup-positioned-${s}`),e.classList.remove(`ag-popup-positioned-${s}`);t&&(r.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){let i=this.getPopupIndex(t);if(i!==-1){let n=this.popupList[i];n.alignedToElement=e}}positionPopup(e){let{ePopup:t,keepWithinBounds:i,nudgeX:n,nudgeY:r,skipObserver:o,updatePosition:s}=e,a={width:0,height:0},l=(c=!1)=>{let{x:d,y:u}=s();c&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,n&&(d+=n),r&&(u+=r),i&&(d=this.keepXYWithinBounds(t,d,1),u=this.keepXYWithinBounds(t,u,0)),t.style.left=`${d}px`,t.style.top=`${u}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!o){let c=us(this.beans,t,()=>l(!0));setTimeout(()=>c(),Oq)}}getParentRect(){let e=Kt(this.beans),t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),KD(t)}keepXYWithinBounds(e,t,i){let n=i===0,r=n?"clientHeight":"clientWidth",o=n?"top":"left",s=n?"height":"width",a=n?"scrollTop":"scrollLeft",l=Kt(this.beans),c=l.documentElement,d=this.getPopupParent(),u=e.getBoundingClientRect(),h=d.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),f=d===l.body,g=Math.ceil(u[s]),v=f?(n?$D:jg)(c)+c[a]:d[r];f&&(v-=Math.abs(p[o]-h[o]));let C=v-g;return Math.min(Math.max(t,0),Math.max(C,0))}addPopup(e){let{eChild:t,ariaLabel:i,ariaOwns:n,alwaysOnTop:r,positionCallback:o,anchorToElement:s}=e,a=this.getPopupIndex(t);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(t);let l=this.createPopupWrapper(t,!!r,i,n),c=this.addEventListenersToPopup(T(w({},e),{wrapperEl:l}));return o&&o(),this.addPopupToPopupList(t,l,c,s),{hideFunc:c}}initialisePopupPosition(e){let i=this.getPopupParent().getBoundingClientRect();pe(e.style.top)||(e.style.top=`${i.top*-1}px`),pe(e.style.left)||(e.style.left=`${i.left*-1}px`)}createPopupWrapper(e,t,i,n){let r=this.getPopupParent(),{environment:o,gos:s}=this.beans,a=ns({tag:"div"});return o.applyThemeClasses(a),a.classList.add("ag-popup"),e.classList.add(s.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||ss(e,"dialog"),i?ec(e,i):n&&(e.id||(e.id=`popup-component-${wg}`),m_(n,e.id)),a.appendChild(e),r.appendChild(a),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),a}addEventListenersToPopup(e){let t=this.beans,i=Kt(t),{wrapperEl:n,eChild:r,closedCallback:o,afterGuiAttached:s,closeOnEsc:a,modal:l,ariaOwns:c}=e,d=!1,u=g=>{if(!n.contains(bt(t)))return;g.key===B.ESCAPE&&!this.isStopPropagation(g)&&f({keyboardEvent:g})},h=g=>f({mouseEvent:g}),p=g=>f({touchEvent:g}),f=(g={})=>{let{mouseEvent:m,touchEvent:v,keyboardEvent:C,forceHide:b}=g;!b&&(this.isEventFromCurrentPopup({mouseEvent:m,touchEvent:v},r)||d)||(d=!0,n.remove(),i.removeEventListener("keydown",u),i.removeEventListener("mousedown",h),i.removeEventListener("touchstart",p),i.removeEventListener("contextmenu",h),this.eventSvc.removeListener("dragStarted",h),o&&o(m||v||C),this.removePopupFromPopupList(r,c))};return s&&s({hidePopup:f}),window.setTimeout(()=>{a&&i.addEventListener("keydown",u),l&&(i.addEventListener("mousedown",h),this.eventSvc.addListener("dragStarted",h),i.addEventListener("touchstart",p),i.addEventListener("contextmenu",h))},0),f}addPopupToPopupList(e,t,i,n){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:wg,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n),wg=wg+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let n=this.popupList[i];if(n.stopAnchoringPromise&&n.stopAnchoringPromise.then(o=>o&&o()),n.stopAnchoringPromise=void 0,n.isAnchored=!1,!t)return;let r=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:n.hideFunc});return n.stopAnchoringPromise=r,n.isAnchored=!0,r}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&m_(t,null),this.popupList=this.popupList.filter(i=>i.element!==e)}keepPopupPositionedRelativeTo(e){let t=this.getPopupParent(),i=t.getBoundingClientRect(),{element:n,ePopup:r}=e,o=n.getBoundingClientRect(),s=u=>Number.parseInt(u.substring(0,u.length-1),10),a=(u,h)=>{let p=i[u]-o[u],f=s(r.style[u]);return{initialDiff:p,lastDiff:p,initial:f,last:f,direction:h}},l=a("top",0),c=a("left",1),d=this.beans.frameworkOverrides;return new wt(u=>{d.wrapIncoming(()=>{HU(()=>{let h=t.getBoundingClientRect(),p=n.getBoundingClientRect();if(p.top==0&&p.left==0&&p.height==0&&p.width==0){e.hidePopup();return}let g=(m,v)=>{let C=s(r.style[v]);m.last!==C&&(m.initial=C,m.last=C);let b=h[v]-p[v];if(b!=m.lastDiff){let S=this.keepXYWithinBounds(r,m.initial+m.initialDiff-b,m.direction);r.style[v]=`${S}px`,m.last=S}m.lastDiff=b};g(l,"top"),g(c,"left")},200).then(h=>{u(()=>{h!=null&&window.clearInterval(h)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){let{mouseEvent:i,touchEvent:n}=e,r=i||n;if(!r)return!1;let o=this.getPopupIndex(t);if(o===-1)return!1;for(let s=o;s<this.popupList.length;s++){let a=this.popupList[s];if(CW(a.element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(e){let t=Kt(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){let i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){let t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=i.length,r=this.getWrapper(e);if(!r||n<=1||!t.contains(e))return;let o=[],s=[];for(let h of i)h!==r&&(h.classList.contains("ag-always-on-top")?s.push(h):o.push(h));let a=[],l=s.length,u=r.classList.contains("ag-always-on-top")||!l?[...o,...s,r]:[...o,r,...s];for(let h=0;h<=n;h++){let p=u[h];if(i[h]===u[h]||p===r)continue;let f=p.querySelectorAll("div");for(let g of f)g.scrollTop!==0&&a.push([g,g.scrollTop]);h===0?t.insertAdjacentElement("afterbegin",p):u[h-1].insertAdjacentElement("afterend",p)}for(;a.length;){let h=a.pop();h[0].scrollTop=h[1]}}handleThemeChange(e){if(e.themeChanged){let t=this.beans.environment;for(let i of this.popupList)t.applyThemeClasses(i.wrapper)}}},Nq=class extends Sy{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){let{value:t}=e,i=this.getGui();i.textContent=ac(t);let n=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();i.classList.add(`ag-${n}-tooltip`)}},a8=(e,t)=>{if(t!=null&&e?.setPointerCapture)try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},Bq=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;let i=t.pointerId;if(!a8(e,i))return null;let n={eElement:e,pointerId:i,onLost(r){zq(n,r)}};return e.addEventListener("lostpointercapture",n.onLost),n},Hq=e=>{if(!e)return;l8(e);let{eElement:t,pointerId:i}=e;if(t){try{t.releasePointerCapture(i)}catch{}e.eElement=null}},l8=e=>{let{eElement:t,onLost:i}=e;t&&i&&(t.removeEventListener("lostpointercapture",i),e.onLost=null)},zq=(e,t)=>{l8(e);let{eElement:i,pointerId:n}=e;i&&t.pointerId===n&&a8(i,n)},Fl,Nl,ib={passive:!0},Qo={passive:!1},yr=e=>{if(!Nl)Nl=new WeakSet;else if(Nl.has(e))return!1;return Nl.add(e),!0},Vq=class extends Ai{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){return this.drag?.start.target??null}isPointer(){return!!Fl?.has(xr(this.beans))}hasPointerCapture(){let e=this.drag?.pointerCapture;return!!(e&&this.beans.eRootDiv.hasPointerCapture?.(e.pointerId))}destroy(){this.drag&&this.cancelDrag();let e=this.dragSources;for(let t of e)N_(t);e.length=0,super.destroy()}removeDragSource(e){let t=this.dragSources;for(let i=0,n=t.length;i<n;++i){let r=t[i];if(r.params===e){t.splice(i,1),N_(r);break}}}addDragSource(e){if(!this.isAlive())return;let{eElement:t,includeTouch:i}=e,n=[],r;if(i){let c=t.style;c&&(r=c.touchAction,c.touchAction="none")}let o={handlers:n,params:e,oldTouchAction:r};this.dragSources.push(o),Fg(n,[t,"pointerdown",c=>this.onPointerDown(e,c),Qo],[t,"mousedown",c=>this.onMouseDown(e,c)]);let l=this.gos.get("suppressTouch");i&&!l&&Fg(n,[t,"touchstart",d=>this.onTouchStart(e,d),Qo])}cancelDrag(e){let t=this.drag;e??(e=t?.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),t?.params.onDragCancel?.(),this.destroyDrag()}shouldPreventMouseEvent(e){let t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&Vu(this.beans,e)&&!Du(rb(e))}initDrag(e,...t){this.drag=e;let i=this.beans,n=a=>this.onScroll(a),r=a=>this.onKeyDown(a),o=xr(i),s=Kt(i);Fg(e.handlers,[o,"contextmenu",Al],[o,"keydown",r],[s,"scroll",n,{capture:!0}],[s.defaultView||window,"scroll",n],...t)}destroyDrag(){this.dragging=!1;let e=this.drag;if(e){let t=e.rootEl;Fl?.get(t)===e&&Fl.delete(t),this.drag=null,Hq(e.pointerCapture),fy(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;let i=this.beans;if(Nl?.has(t))return;let n=t.pointerType;if(n==="touch"&&(i.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),Du(rb(t))))||!t.isPrimary||n==="mouse"&&t.button!==0)return;this.destroyDrag();let r=xr(i),o=e.eElement,s=t.pointerId,a=new nb(r,e,t,s);Fl??(Fl=new WeakMap),Fl.set(r,a);let l=h=>{h.pointerId===s&&this.onMouseOrPointerMove(h)},c=h=>{h.pointerId===s&&this.onMouseOrPointerUp(h)},d=h=>{h.pointerId===s&&yr(h)&&this.cancelDrag()},u=h=>this.draggingPreventDefault(h);this.initDrag(a,[r,"pointerup",c],[r,"pointercancel",d],[r,"pointermove",l,Qo],[r,"touchmove",u,Qo],[o,"mousemove",u,Qo]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):yr(t)}onTouchStart(e,t){if(this.gos.get("suppressTouch")||!e.includeTouch||!yr(t)||Du(rb(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){this.dragging&&Al(t);return}this.destroyDrag();let n=this.beans,r=xr(n),o=new nb(r,e,t.touches[0]),s=h=>this.onTouchMove(h),a=h=>this.onTouchUp(h),l=h=>this.onTouchCancel(h),c=h=>this.draggingPreventDefault(h),d=xr(n),u=t.target??e.eElement;this.initDrag(o,[u,"touchmove",s,ib],[u,"touchend",a,ib],[u,"touchcancel",l,ib],[d,"touchmove",c,Qo],[d,"touchend",a,Qo],[d,"touchcancel",l,Qo]),e.dragStartPixels===0&&this.onMove(o.start)}draggingPreventDefault(e){this.dragging&&Al(e)}onMouseDown(e,t){if(t.button!==0||Nl?.has(t)||this.isPointer())return;let i=this.beans;this.destroyDrag();let n=new nb(xr(i),e,t),r=a=>this.onMouseOrPointerMove(a),o=a=>this.onMouseOrPointerUp(a),s=xr(i);this.initDrag(n,[s,"mousemove",r],[s,"mouseup",o]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):yr(t)}onScroll(e){if(!yr(e))return;let t=this.drag,i=t?.lastDrag;i&&this.dragging&&t.params?.onDragging?.(i)}onMouseOrPointerMove(e){yr(e)&&(fs()&&Kt(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&Al(e),this.onMove(e))}onTouchCancel(e){let t=this.drag;!t||!yr(e)||zl(t.start,e.changedTouches)&&this.cancelDrag()}onTouchMove(e){let t=this.drag;if(!t||!yr(e))return;let i=zl(t.start,e.touches);i&&(this.onMove(i),this.draggingPreventDefault(e))}onMove(e){let t=this.drag;if(!t)return;t.lastDrag=e;let i=t.params;if(!this.dragging){let n=t.start,o=i.dragStartPixels??4;if(eF(e,n,o)||(this.dragging=!0,i.capturePointer&&(t.pointerCapture=Bq(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:i.eElement}),i.onDragStart?.(n),this.drag!==t)||(i.onDragging?.(n),this.drag!==t))return}i.onDragging?.(e)}onTouchUp(e){let t=this.drag;t&&yr(e)&&this.onUp(zl(t.start,e.changedTouches))}onMouseOrPointerUp(e){yr(e)&&this.onUp(e)}onUp(e){let t=this.drag;t&&(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,t.params.onDragStop?.(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===B.ESCAPE&&this.cancelDrag()}},N_=e=>{fy(e.handlers);let t=e.oldTouchAction;if(t!=null){let i=e.params.eElement.style;i&&(i.touchAction=t)}},nb=class{constructor(e,t,i,n=null){this.rootEl=e,this.params=t,this.start=i,this.pointerId=n,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},rb=e=>{let t=e.target;return t instanceof Element?t:null},Gq=class extends Ai{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.externalDropZoneCount=0,this.lastDropTarget=null}addDragSource(e,t=!1){let i={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:n=>this.onDragStart(e,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(i),this.beans.dragSvc.addDragSource(i)}setDragImageCompIcon(e,t=!1){let i=this.dragImageComp;i&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,i.setIcon(e,t))}removeDragSource(e){let{dragSourceAndParamsList:t,beans:i}=this;for(let n=0,r=t.length;n<r;n++)if(t[n].dragSource===e){let o=t[n];i.dragSvc?.removeDragSource(o),t.splice(n,1);break}}destroy(){let{dragSourceAndParamsList:e,dropTargets:t,beans:i}=this,n=i.dragSvc;for(let r of e)n?.removeDragSource(r);e.length=0,t.length=0,this.externalDropZoneCount=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){let e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();let i=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-i.left,this.dragInitialSourcePointerOffsetY=t.clientY-i.top,e.onDragStarted?.(),this.createAndUpdateDragImageComp(e)}onDragStop(e){let{dragSource:t,lastDropTarget:i}=this;if(t?.onDragStopped?.(),i){let n=this.dropTargetEvent(i,e,!1);i.onDragStop?.(n)}this.clearDragAndDropProperties()}onDragCancel(){let{dragSource:e,lastDropTarget:t,lastMouseEvent:i}=this;if(e?.onDragCancelled?.(),t&&i){let n=this.dropTargetEvent(t,i,!1);t.onDragCancel?.(n)}this.clearDragAndDropProperties()}onDragging(e,t=!1){this.positionDragImageComp(e);let i=this.findCurrentDropTarget(e),{lastDropTarget:n,dragSource:r,dragItem:o}=this,s=!1;if(i!==n){if(s=!0,n){let a=this.dropTargetEvent(n,e,t);n.onDragLeave?.(a)}if(n!==null&&!i?this.handleExit(r,o):n===null&&i&&this.handleEnter(r,o),i){let a=this.dropTargetEvent(i,e,t);i.onDragEnter?.(a)}this.lastDropTarget=i}else if(i){let a=this.dropTargetEvent(i,e,t);i.onDragging?.(a),a?.changed&&(s=!0)}this.lastMouseEvent=e,s&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){let t=e.getContainer(),i=e.getSecondaryContainers?.(),n=i?.length;if(!n)return[[t]];let r=new Array(n+1);r[0]=[t];for(let o=0;o<n;++o)r[o+1]=i[o];return r}isMouseOnDropTarget(e,t){let i=this.getAllContainersFromDropTarget(t),n=!1,r=(a,l)=>{for(let c of l){let{width:d,height:u,left:h,right:p,top:f,bottom:g}=c.getBoundingClientRect();if(d===0||u===0)return!1;let m=a.clientX>=h&&a.clientX<p,v=a.clientY>=f&&a.clientY<g;if(!m||!v)return!1}return!0};for(let a of i)if(r(e,a)){n=!0;break}let{eElement:o,type:s}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(o)?!1:n&&t.isInterestedIn(s,o)}findCurrentDropTarget(e){let t=[],i=this.dropTargets;for(let s=0,a=i.length;s<a;++s){let l=i[s];this.isMouseOnDropTarget(e,l)&&t.push(l)}let n=t.length;if(n===0)return null;if(n===1)return t[0];let o=xr(this.beans).elementsFromPoint(e.clientX,e.clientY);for(let s=0,a=o.length;s<a;++s){let l=o[s];for(let c=0,d=t.length;c<d;c++){let u=t[c],h=this.getAllContainersFromDropTarget(u),p=!1;for(let f=0,g=h.length;f<g&&!p;f++){let m=h[f];for(let v=0,C=m.length;v<C;v++)if(m[v]===l){p=!0;break}}if(p)return u}}return null}addDropTarget(e){this.dropTargets.push(e),e.external&&this.externalDropZoneCount++}removeDropTarget(e){let t=e.getContainer(),i=this.dropTargets,n=0;for(let r=0,o=i.length;r<o;++r){let s=i[r];if(s.getContainer()===t){s.external&&--this.externalDropZoneCount;continue}n!==r&&(i[n]=s),++n}i.length=n}hasExternalDropZones(){return this.externalDropZoneCount>0}findExternalZone(e){let t=this.dropTargets;for(let i=0,n=t.length;i<n;++i){let r=t[i];if(r.external&&r.getContainer()===e)return r}return null}dropTargetEvent(e,t,i){let{dragSource:n,dragItem:r,lastDraggingEvent:o,lastMouseEvent:s,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,c=e.getContainer(),d=c.getBoundingClientRect(),{clientX:u,clientY:h}=t,p=u-(s?.clientX||0),f=h-(s?.clientY||0),g=this.createEvent({event:t,x:u-d.left,y:h-d.top,vDirection:f>0?"down":f<0?"up":null,hDirection:p<0?"left":p>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:n,fromNudge:i,dragItem:r,dropZoneTarget:c,dropTarget:o?.dropTarget??null,changed:!!o?.changed});return this.lastDraggingEvent=g,g}positionDragImageComp(e){let t=this.dragImageComp?.getGui();t&&xW(t,e,this.beans)}removeDragImageComp(e){this.dragImageComp===e&&(this.dragImageComp=null),e&&(e.getGui()?.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){let t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t?.then(i=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(i);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;let n=this.dragImageComp;n!==i&&(this.dragImageComp=i,this.removeDragImageComp(n)),i&&(this.appendDragImageComp(i),this.updateDragImageComp())})}appendDragImageComp(e){let t=e.getGui(),i=t.style;i.position="absolute",i.zIndex="9999",this.beans.dragSvc?.hasPointerCapture()&&(i.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),i.top="20px",i.left="20px";let n=sy(this.beans);n?n.appendChild(t):this.warnNoBody()}updateDragImageComp(){let{dragImageComp:e,dragSource:t,lastDropTarget:i,lastDraggingEvent:n,dragImageLastLabel:r}=this;if(!e)return;this.setDragImageCompIcon(i?.getIconName?.(n)??null);let o=t?.dragItemName;typeof o=="function"&&(o=o(n)),o||(o=""),r!==o&&(this.dragImageLastLabel=o,e.setLabel(o))}},Wq=class extends Ai{constructor(e,t){super(),this.comp=e,this.stopPropagationCallbacks=t}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();let{eTopGuard:t,eBottomGuard:i,eFocusableElement:n,stopPropagationCallbacks:r}=this,o=[t,i],s={setTabIndex:v=>{for(let C of o)v==null?C.removeAttribute("tabindex"):C.setAttribute("tabindex",v)}};this.addTabGuards(t,i);let{focusTrapActive:a=!1,onFocusIn:l,onFocusOut:c,focusInnerElement:d,handleKeyDown:u,onTabKeyDown:h,shouldStopEventPropagation:p,isEmpty:f,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:m}=e;this.tabGuardCtrl=this.createManagedBean(new Dj({comp:s,focusTrapActive:a,eTopGuard:t,eBottomGuard:i,eFocusableElement:n,onFocusIn:l,onFocusOut:c,focusInnerElement:d,handleKeyDown:u,onTabKeyDown:h,shouldStopEventPropagation:p,isEmpty:f,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:m},r))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){let t=Kt(this.beans).createElement("div"),i=e==="top"?Qw.TAB_GUARD_TOP:Qw.TAB_GUARD_BOTTOM;return t.classList.add(Qw.TAB_GUARD,i),ss(t,"presentation"),t}addTabGuards(e,t){let i=this.eFocusableElement;i.prepend(e),i.append(t)}removeAllChildrenExceptTabGuards(){let e=[this.eTopGuard,this.eBottomGuard];ii(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,i){py(t)||(t=t.getGui());let{eBottomGuard:n}=this;n?n.before(t):e(t,i)}destroy(){let{eTopGuard:e,eBottomGuard:t}=this;Wi(e),Wi(t),super.destroy()}},Uq=class extends lc{initialiseTabGuard(e,t){this.tabGuardFeature=this.createManagedBean(new Wq(this,t)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}};var jq=class extends Gq{createEvent(e){return _e(this.gos,e)}createDragImageComp(e){let{gos:t,beans:i}=this;return nj(i.userCompFactory,_e(t,{dragSource:e}))?.newAgStackInstance()}handleEnter(e,t){e?.onGridEnter?.(t)}handleExit(e,t){e?.onGridExit?.(t)}warnNoBody(){J(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){let i={getContainer:e,isInterestedIn:n=>n===1||n===0,getIconName:()=>"notAllowed"};this.addDropTarget(i),t.addDestroyFunc(()=>this.removeDropTarget(i))}};function c8(e,t){return e+"_"+t}function It(e){return e instanceof $u}var $u=class extends j{constructor(e,t,i,n){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=i,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=_u(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return c8(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){let e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(let e of this.displayedChildren)It(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){let t=dt(this.displayedChildren).getLeft();this.setLeft(t)}else{let e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;for(let t of this.displayedChildren??[])e+=t.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(let t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(let t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){let e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){for(let t of this.displayedChildren??[])cs(t)?e.push(t):It(t)&&t.addDisplayedLeafColumns(e)}addLeafColumns(e){for(let t of this.children??[])cs(t)?e.push(t):It(t)&&t.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){let e=this.getParent();return!this.isPadding()||!e?.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e?.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(let i of this.children??[]){if(It(i)&&!i.displayedChildren?.length)continue;switch(i.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(i);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(i);break;default:this.displayedChildren.push(i);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},B_="row-group-",Fy="t-",My="b-",qq=0,ds=class{constructor(e){this.id=void 0,this.destroyed=!1,this._groupData=void 0,this.master=!1,this.detail=void 0,this.rowIndex=null,this.field=null,this.rowGroupColumn=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=qq++,this.alreadyRendered=!1,this.formulaRowIndex=null,this.hovered=!1,this.__selected=!1,this.beans=e}get groupData(){let e=this._groupData;return e!==void 0?e:this.footer?this.sibling?.groupData:this.beans.groupStage?.loadGroupData(this)??null}set groupData(e){this._groupData=e}get allLeafChildren(){let e=this._leafs;return e===void 0?this.beans.groupStage?.loadLeafs?.(this)??null:e}set allLeafChildren(e){this._leafs=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){let{valueCache:i,eventSvc:n}=this.beans,r=this.data;this.data=e,i?.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();let o=this.createDataChangedEvent(e,r,t);if(this.__localEventService?.dispatchEvent(o),this.sibling){this.sibling.data=e;let a=this.sibling.createDataChangedEvent(e,r,t);this.sibling.__localEventService?.dispatchEvent(a)}n.dispatchEvent({type:"rowNodeDataChanged",node:this});let s=this.pinnedSibling;s&&(s.data=e,s.__localEventService?.dispatchEvent(s.createDataChangedEvent(e,r,t)),n.dispatchEvent({type:"rowNodeDataChanged",node:s}))}updateDataOnDetailNode(){let e=this.detailNode;e&&(e.data=this.data)}createDataChangedEvent(e,t,i){return{type:"dataChanged",node:this,oldData:t,newData:e,update:i}}getRowIndexString(){return this.rowIndex==null?(Ze(13),null):this.rowPinned==="top"?Fy+this.rowIndex:this.rowPinned==="bottom"?My+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){let{selectionSvc:i}=this.beans,n=i?.createDaemonNode?.(this),r=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),i&&(i.updateRowSelectable(this),i.syncInRowNode(this,n));let o=this.createDataChangedEvent(e,r,!1);this.__localEventService?.dispatchEvent(o)}setId(e){let t=tc(this.beans.gos);if(t)if(this.data){let i=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(B_)&&Ze(14,{groupPrefix:B_})}else this.id=void 0;else this.id=e}setRowTop(e){if(this.oldRowTop=this.rowTop,this.rowTop===e)return;this.rowTop=e,this.dispatchRowEvent("topChanged");let t=e!==null;this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,i){this.beans.expansionSvc?.setExpanded(this,e,t,i)}setDataValue(e,t,i){let{colModel:n,valueSvc:r,gos:o,editSvc:s}=this.beans,a=typeof e!="string"?e:n.getCol(e)??n.getColDefCol(e);if(!a)return!1;let l=r.getValueForDisplay({column:a,node:this,source:"api"}).value;if(o.get("readOnlyEdit")){let{beans:{eventSvc:d},data:u,rowIndex:h,rowPinned:p}=this;return d.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:h,rowPinned:p,column:a,colDef:a.colDef,data:u,node:this,oldValue:l,newValue:t,value:t,source:i}),!1}if(s&&!s.committing){let d=s.setDataValue({rowNode:this,column:a},t,i);if(d!=null)return d}let c=r.setValue(this,a,t,i);return this.dispatchCellChangedEvent(a,t,l),c&&this.pinnedSibling?.dispatchCellChangedEvent(a,t,l),c}updateHasChildren(){let e=this.group&&!this.footer||!!this.childrenAfterGroup?.length,{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,i){let n={type:"cellChanged",node:this,column:e,newValue:t,oldValue:i};this.__localEventService?.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){if(this.footer)return this.sibling.isSelected();let e=this.rowPinned&&this.pinnedSibling;return e?e.isSelected():this.__selected}depthFirstSearch(e){let t=this.childrenAfterGroup;if(t)for(let i=0,n=t.length;i<n;++i)t[i].depthFirstSearch(e);e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,i="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:i})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){(this.__localEventService??(this.__localEventService=new ma)).addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e);let i=this.__localEventService??(this.__localEventService=new ma);this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,i);let n=this.frameworkEventListenerService?.wrap(e,t)??t;i.addEventListener(e,n)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.removeLocalListener(e,i)}removeLocalListener(e,t){let i=this.__localEventService;i&&(i.removeEventListener(e,t),i.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(J(61),this.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;let e=[],t=this;for(;t?.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){let e=this.childStore;return e?e.getFirstNode():this.childrenAfterSort?.[0]??null}_destroy(e){if(this.destroyed)return!1;if(this.destroyed=!0,e?this.clearRowTopAndRowIndex():(this.setRowTop(null),this.setRowIndex(null)),!this.footer){let t=this.detailNode;t&&t._destroy(e);let i=this.sibling;i&&i._destroy(e)}return!0}};function $q(e,t,i){return _e(t,{type:i,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var Kq=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_groupData","_leafs","childStore","groupValue","oldRowTop","sticky","treeNodeFlags","treeParent"]),Yq=(e,t)=>{let i=new ds(t);for(let n of Object.keys(e))Kq.has(n)||(i[n]=e[n]);return i.oldRowTop=null,i},Wb=(e,t,i)=>{if(!i)return;let n=i.rowIndex;if(n==null)return;n+=t;let r=e.getRowCount();for(;n>=0&&n<r;){let o=e.getRow(n);if(!o||!o.footer&&!o.detail)return o;n+=t}},d8={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},Xq=new Set(Object.values(d8));function Zo(e,t){let i=e.filterUi;if(!i)return null;if(i.created)return i.promise;if(t)return null;let n=i.create(i.refreshed),r=i;return r.created=!0,r.promise=n,n}function Jq(e,t,i,n,r,o,s){return t.refresh?.(T(w({},i),{model:n,source:o,additionalEventAttributes:s})),e().then(a=>{if(a){let{filter:l,filterParams:c}=a;u8(l,c,n,r,o,s)}})}function u8(e,t,i,n,r,o){e?.refresh?.(T(w({},t),{model:i,state:n,source:r,additionalEventAttributes:o}))}function h8(e,t,i,n){let r=e();r?.created&&r.promise.then(o=>{let s=t();u8(o,r.filterParams,s,i()??{model:s},"ui",n)})}function H_(e){let t,i=!1,n,{action:r,filterParams:o,getFilterUi:s,getModel:a,getState:l,updateState:c,updateModel:d,processModelToApply:u}=e;switch(r){case"apply":{let h=l();n=h?.model??null,u&&(n=u(n)),t={state:h?.state,model:n},i=!0;break}case"clear":{t={model:null},o?.buttons?.includes("apply")||(i=!0,n=null);break}case"reset":{t={model:null},i=!0,n=null;break}case"cancel":{t={model:a()};break}}c(t),i?d(n):h8(s,a,l,{fromAction:r})}function $t(e,t){return e[t]??null}function Xt(e){return ns(e)}function Qq(e){return{tag:"div",cls:e}}var Zq=class extends st{constructor(e){let{className:t="ag-filter-apply-panel"}=e??{};super(Qq(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){let i=this.buttons;if(this.buttons=e,i===e)return;let n=this.getGui();ii(n);let r;this.destroyListeners();let o=document.createDocumentFragment(),s=this.className,a=({type:c,label:d})=>{let u=v=>{this.dispatchLocalEvent({type:c,event:v})};["apply","clear","reset","cancel"].includes(c)||J(75);let h=c==="apply",f=Xt({tag:"button",attrs:{type:h&&t?"submit":"button"},ref:`${c}FilterButton`,cls:`ag-button ag-standard-button ${s}-button${h?" "+s+"-apply-button":""}`,children:d});this.activateTabIndex([f]),h&&(r=f);let g=v=>{v.key===B.ENTER&&(v.preventDefault(),u(v))},m=this.listeners;f.addEventListener("click",u),m.push(()=>f.removeEventListener("click",u)),f.addEventListener("keydown",g),m.push(()=>f.removeEventListener("keydown",g)),o.append(f)};for(let c of e)a(c);this.eApply=r;let l=this.validationTooltipFeature;r&&!l?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!r&&l&&(this.validationTooltipFeature=this.destroyBean(l)),n.append(o)}getApplyButton(){return this.eApply}updateValidity(e,t=null){let i=this.eApply;i&&(Hu(i,!e),this.validationMessage=t,this.validationTooltipFeature?.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(let e of this.listeners)e();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}};var e$={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`,minDateValidation:e=>`Date must be after ${e[0]}`,maxDateValidation:e=>`Date must be before ${e[0]}`,strictMinValueValidation:e=>`Must be greater than ${e[0]}`,strictMaxValueValidation:e=>`Must be less than ${e[0]}`};function Pr(e,t,i){return RW(e,e$,t,i)}function Ty(e,t){let{debounceMs:i}=e;return Sm(e)?(i!=null&&J(71),0):i??t}function Sm(e){return(e.buttons?.indexOf("apply")??-1)>=0}function p8(e,t,i,n){let r=Pr(e,i);if(typeof t=="function"){let o=Pr(e,n);r=t({filterOptionKey:n,filterOption:o,placeholder:r})}else typeof t=="string"&&(r=t);return r}var t$=class extends st{constructor(e,t,i,n,r,o){super(),this.column=e,this.wrapper=t,this.eventParent=i,this.updateModel=n,this.isGlobalButtons=r,this.enableGlobalButtonCheck=o,this.hidePopup=null,this.applyActive=!1}postConstruct(){let{comp:e,params:t}=this.wrapper,i=t,n=i.useForm,r=n?"form":"div";this.setTemplate({tag:r,cls:"ag-filter-wrapper"}),n&&this.addManagedElementListeners(this.getGui(),{submit:o=>{o?.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=i,this.resetButtonsPanel(i),this.addManagedListeners(this.eventParent,w({filterParamsChanged:({column:o,params:s})=>{o===this.column&&this.resetButtonsPanel(s,this.params)},filterStateChanged:({column:o,state:s})=>{o===this.column&&this.eButtons?.updateValidity(s.valid!==!1)},filterAction:({column:o,action:s,event:a})=>{o===this.column&&this.afterAction(s,a)}},this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:o})=>{if(o!==this.isGlobalButtons){this.isGlobalButtons=o;let s=this.params;this.resetButtonsPanel(s,s,!0)}}}:void 0))}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,i){let{buttons:n,readOnly:r}=t??{},{buttons:o,readOnly:s,useForm:a}=e;if(!i&&r===s&&Nu(n,o))return;let l=o&&o.length>0&&!e.readOnly&&!this.isGlobalButtons,c=this.eButtons;if(l){let d=o.map(u=>{let h=`${u}Filter`;return{type:u,label:Pr(this,h)}});if(this.applyActive=Sm(this.params),!c){c=this.createBean(new Zq),this.appendChild(c.getGui());let u=this.column,h=p=>({event:f})=>{this.updateModel(u,p,{fromButtons:!0}),this.afterAction(p,f)};c?.addManagedListeners(c,{apply:h("apply"),clear:h("clear"),reset:h("reset"),cancel:h("cancel")}),this.eButtons=c}c.updateButtons(d,a)}else this.applyActive=!1,c&&(Wi(c.getGui()),this.eButtons=this.destroyBean(c))}close(e){let t=this.hidePopup;if(!t)return;let i=e,n=i?.key,r;(n===B.ENTER||n===B.SPACE)&&(r={keyboardEvent:i}),t(r),this.hidePopup=null}afterAction(e,t){let{params:i,applyActive:n}=this,r=i?.closeOnApply;switch(e){case"apply":{t?.preventDefault(),r&&n&&this.close(t);break}case"reset":{r&&n&&this.close();break}case"cancel":{r&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===B.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},i$={tag:"div",cls:"ag-filter"},n$=class extends st{constructor(e,t,i){super(i$),this.column=e,this.source=t,this.enableGlobalButtonCheck=i,this.wrapper=null}postConstruct(){this.beans.colFilter?.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){return this.wrapper?.then(e=>e.comp)??null}afterInit(){return this.wrapper?.then(()=>{})??wt.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.wrapper?.then(t=>{this.comp?.afterGuiAttached(e),t?.comp?.afterGuiAttached?.(e)})}afterGuiDetached(){this.wrapper?.then(e=>{e?.comp?.afterGuiDetached?.()})}createFilter(e){let{column:t,source:i,beans:{colFilter:n}}=this,r=n.getFilterUiForDisplay(t)??null;this.wrapper=r,r?.then(o=>{if(!o)return;let{isHandler:s,comp:a}=o,l;if(s){let c=!!this.enableGlobalButtonCheck,d=this.createBean(new t$(t,o,n,n.updateModel.bind(n),c&&n.isGlobalButtons,c));this.comp=d,l=d.getGui()}else l=a.getGui(),pe(l)||J(69,{guiFromFilter:l});this.appendChild(l),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:i,eGui:this.getGui()}):a.afterGuiAttached?.(this.afterGuiAttachedParams)})}onFilterDestroyed(e){let{source:t,column:i}=e;(t==="api"||t==="paramsUpdated")&&i.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(ii(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){this.beans.colFilter?.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},z_={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},V_=["january","february","march","april","may","june","july","august","september","october","november","december"];function r$(e,t){return e==null?-1:t==null?1:Number.parseFloat(e)-Number.parseFloat(t)}function G_(e){return e instanceof Date&&!isNaN(e.getTime())}var Ub={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:G_}),dateString:({dataTypeDefinition:e})=>({comparator:(t,i)=>{let n=e.dateParser(i);return i==null||n<t?-1:n>t?1:0},isValidDate:t=>typeof t=="string"&&G_(e.dateParser(t))}),dateTime:e=>Ub.date(e),dateTimeString:e=>Ub.dateString(e),object:()=>{},text:()=>{}},jb={number:()=>({comparator:r$}),boolean:({t:e})=>({valueFormatter:t=>pe(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:i=>{let n=e(i);return pe(n)?n:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(i,n)=>{if(i==="NaN")return t("invalidDate","Invalid Date");if(n===1&&i!=null){let r=V_[Number(i)-1];return t(r,z_[r])}return i??t("blanks","(Blanks)")},treeListPathGetter:i=>vg(i,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:i})=>({valueFormatter:n=>{let r=e(n);return pe(r)?r:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:n=>vg(t.dateParser(n??void 0),!1),treeListFormatter:(n,r)=>{if(r===1&&n!=null){let o=V_[Number(n)-1];return i(o,z_[o])}return n??i("blanks","(Blanks)")}}),dateTime:e=>{let t=jb.date(e);return t.treeListPathGetter=vg,t},dateTimeString(e){let t=e.dataTypeDefinition.dateParser,i=jb.dateString(e);return i.treeListPathGetter=n=>vg(t(n??void 0)),i},object:({formatValue:e,t})=>({valueFormatter:i=>{let n=e(i);return pe(n)?n:t("blanks","(Blanks)")}}),text:()=>{}};function o$(e,t,i,n,r,o,s){let a=t,l=i,c=e==="agSetColumnFilter";!l&&n.baseDataType==="object"&&!c&&(l=({column:p,node:f})=>r({column:p,node:f,value:o.valueSvc.getValue(p,f)}));let u=(c?jb:Ub)[n.baseDataType],h=u({dataTypeDefinition:n,formatValue:r,t:s});return a=typeof t=="object"?w(w({},h),t):h,{filterParams:a,filterValueGetter:l}}var s$={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},a$={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function l$(e,t=!1){return(t?a$:s$)[e??"text"]}var c$=class extends Tj{},f8="__ag_Grid_Stop_Propagation";function wa(e){e[f8]=!0}function uo(e){return e[f8]===!0}var g8={isStopPropagation:uo,stopPropagation:wa},Zu=class extends $F{constructor(e,t){super(e,g8,t)}},d$=class extends st{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){let e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new Zu(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new c$(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){let t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}areStatesEqual(e,t){return e===t}refresh(e){let t=e,i=this.params;this.params=t;let{source:n,state:r,additionalEventAttributes:o}=t;n==="colDef"&&this.updateParams(t,i);let s=this.state;this.state=r;let a=o?.fromAction;return(a&&a!=="apply"||r.model!==s.model||!this.areStatesEqual(r.state,s.state))&&this.setModelIntoUi(r.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=Sm(e),this.setupApplyDebounced()}doesFilterPass(e){J(283);let{getHandler:t,model:i,column:n}=this.params;return t().doesFilterPass(T(w({},e),{model:i,handlerParams:this.beans.colFilter.getHandlerParams(n)}))}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return J(284),this.params.model!=null}setupApplyDebounced(){let e=Ty(this.params,this.defaultDebounceMs),t=Yt(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return J(285),this.params.model}setModel(e){J(286);let{beans:t,params:i}=this;return t.colFilter.setModelForColumnLegacy(i.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){let{params:t,state:{valid:i=!0,model:n}}=this;if(!i)return!1;let r=!this.areModelsEqual(t.model,n);return r&&t.onAction("apply",e),r}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();let i=this.getModelFromUi(),n={model:i,state:this.getState(),valid:this.canApply(i)};this.state=n;let{params:r,gos:o,eventSvc:s,applyActive:a}=this;r.onStateChange(n),r.onUiChange(this.getUiChangeEventParams()),o.get("enableFilterHandlers")||s.dispatchEvent({type:"filterModified",column:r.column,filterInstance:this}),n.valid&&(e??(e=a?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced())}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e?.container,this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){let{positionableFeature:t,gos:i}=this;if(!t)return;let n=e==="floatingFilter"||e==="columnFilter";n?(t.restoreLastSize(),t.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(n)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e,t){return Pr(this,e,t)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function m8(e){return!!e.operator}function u$(e,t,i){if(t==null)return null;let n=null,{compName:r,jsComp:o,fwComp:s}=zF(e,t);return r?n={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[r]:o==null&&s==null&&t.filter===!0&&(n=i()),n}var Un={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},Iy=class extends j{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){let e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},i=t.autoHeight?Un.AUTO_HEIGHT:t.print?Un.PRINT:Un.NORMAL;this.view.updateLayoutClasses(i,t)}},es="Viewport",W_="fakeVScrollComp",ob=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],U_=100,sb=150,h$=class extends j{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=Yt(this,()=>this.lastScrollSource[1]=null,sb),this.resetLastVScrollDebounced=Yt(this,()=>this.lastScrollSource[0]=null,sb)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");let e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,i=>{this.centerRowsCtrl=i.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,es)});for(let e of ob){let t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){let e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),i=t?Yt(this,this.onVScroll.bind(this,es),U_):this.onVScroll.bind(this,es),n=t?Yt(this,this.onVScroll.bind(this,W_),U_):this.onVScroll.bind(this,W_);this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),this.registerScrollPartner(e,n)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(let t of[...ob,es]){if(this.lastScrollSource[1]===t)continue;let i=this.getViewportForSource(t);$g(i,e,this.enableRtl)}}getViewportForSource(e){return e===es?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;let t=this.centerRowsCtrl.eViewport,{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(1,i,!0))return;let n=qg(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===es?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;let{animationFrameSvc:i}=this;i?.setScrollTop(t),this.nextScrollTop=t,e===es?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,i?.active?i.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){let t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){let t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent(T(w({},t),{type:"bodyScrollEnd"}))},sb)}shouldBlockScrollUpdate(e,t,i=!1){return i&&!pa()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){let t=ly(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){let t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){let e=this.scrollLeft,t=!1;for(let i of ob)if(this.getViewportForSource(i).scrollLeft!==e){t=!0;break}t&&this.onHScroll(es)}scrollGridIfNeeded(e=!1){let t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){let n=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:n:e=Math.min(Math.max(e,0),n)),$g(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){let{lastOffsetHeight:i,lastScrollTop:n}=this;return{top:n,bottom:n+i}}this.isVerticalPositionInvalidated=!1;let{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){let t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){let{rowModel:i}=this.beans,n=i.getRowCount(),r=-1;for(let o=0;o<n;o++){let s=i.getRow(o);if(typeof e=="function"){if(s&&e(s)){r=o;break}}else if(e===s||e===s.data){r=o;break}}r>=0&&this.ensureIndexVisible(r,t)}ensureIndexVisible(e,t,i=0){if(ni(this.gos,"print"))return;let{rowModel:n}=this.beans,r=n.getRowCount();if(typeof e!="number"||e<0||e>=r){J(88,{index:e});return}this.clearRetryListeners();let{frameworkOverrides:o,pageBounds:s,rowContainerHeight:a,rowRenderer:l}=this.beans;o.wrapIncoming(()=>{let c=this.ctrlsSvc.getGridBodyCtrl(),d=n.getRow(e),u,h,p=0;this.invalidateVerticalScroll();do{let{stickyTopHeight:f,stickyBottomHeight:g}=c,m=d.rowTop,v=d.rowHeight,C=s.getPixelOffset(),b=d.rowTop-C,S=b+d.rowHeight,E=this.getVScrollPosition(),x=a.divStretchOffset,P=E.top+x,F=E.bottom+x,N=F-P,Y=a.getScrollPositionForPixel(b),X=a.getScrollPositionForPixel(S-N),Z=Math.min((Y+X)/2,b),me=P+f>b,oe=F-g<S,re=null;t==="top"?re=Y-f:t==="bottom"?re=X+g:t==="middle"?re=Z:me?re=Y-f:oe&&(X-Y>N?re=Y-f:re=X+g),re!==null&&(this.setVerticalScrollPosition(re),l.redraw({afterScroll:!0})),u=m!==d.rowTop||v!==d.rowHeight,h=f!==c.stickyTopHeight||g!==c.stickyBottomHeight,p++}while((u||h)&&p<10);if(this.animationFrameSvc?.flushAllFrames(),i<10&&(d?.stub||!this.beans.rowAutoHeight?.areRowsMeasured())){let f=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{let g=this.getVScrollPosition().top;f!==g&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=n.getRowCount())&&this.ensureIndexVisible(e,t,i+1)}})}})}clearRetryListeners(){for(let e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){let{colModel:i,frameworkOverrides:n}=this.beans,r=i.getCol(e);if(!r||r.isPinned()||!this.visibleCols.isColDisplayed(r))return;let o=this.getPositionedHorizontalScroll(r,t);n.wrapIncoming(()=>{o!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(o),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){let{columnBeforeStart:i,columnAfterEnd:n}=this.isColumnOutsideViewport(e),r=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),o=this.centerRowsCtrl.getCenterWidth(),s=this.enableRtl,a=(s?i:n)||r,l=s?n:i;t!=="auto"&&(a=t==="start",l=t==="end");let c=t==="middle";if(a||l||c){let{colLeft:d,colMiddle:u,colRight:h}=this.getColumnBounds(e);return c?u-o/2:a?s?h:d:s?d-o:h-o}return null}isColumnOutsideViewport(e){let{start:t,end:i}=this.getViewportBounds(),{colLeft:n,colRight:r}=this.getColumnBounds(e),o=this.enableRtl,s=o?t>r:i<r,a=o?i<n:t>n;return{columnBeforeStart:s,columnAfterEnd:a}}getColumnBounds(e){let t=this.enableRtl,i=this.visibleCols.bodyWidth,n=e.getActualWidth(),r=e.getLeft(),o=t?-1:1,s=t?i-r:r,a=s+n*o,l=s+n/2*o;return{colLeft:s,colMiddle:l,colRight:a}}getViewportBounds(){let e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),i=t,n=e+t;return{start:i,end:n,width:e}}},Ay=class extends j{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){let e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){let e=ni(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:i}=this.beans,n=t.bodyWidth,r=t.getColsLeftWidth(),o=t.getDisplayedColumnsRightWidth(),s;e?s=n+r+o:(s=n,this.addSpacer&&(this.gos.get("enableRtl")?r:o)===0&&i.verticalScrollShowing&&(s+=i.getScrollbarWidth())),this.callback(s)}},p$=class extends j{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){let{beans:e,centerContainerCtrl:t,gridBodyCtrl:i}=this,n=()=>{go(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(n),i.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){let{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();let i=this.centerContainerCtrl.getCenterWidth();i!==this.centerWidth&&(this.centerWidth=i,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){let e=this.gridBodyCtrl.eBodyViewport,t=ly(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;let e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){let e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function Ng(e,t,i,n){let r=t.getColDef().cellRendererParams?.suppressMouseEventHandling;return v8(e,t,i,n,r)}function f$(e,t,i,n){let r=t?.suppressMouseEventHandling;return v8(e,void 0,i,n,r)}function v8(e,t,i,n,r){return r?r(_e(e,{column:t,node:i,event:n})):!1}function C8(e,t,i){let n=t;for(;n;){let r=pF(e,n,i);if(r)return r;n=n.parentElement}return null}var om="cellCtrl";function Oy(e,t){return C8(e,t,om)}var sm="renderedRow";function g$(e,t){return C8(e,t,sm)}function qb(e,t,i,n,r){let o=n?n.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;let s=_e(e,{event:t,editing:r,column:n,node:i,data:i.data,colDef:n.getColDef()});return!!(o&&o(s))}function m$(e){let{pinnedRowModel:t,rowModel:i,rangeSvc:n,visibleCols:r}=e;if(!n||r.allCols.length===0)return;let o=t?.isEmpty("top")??!0,s=t?.isEmpty("bottom")??!0,a=o?null:"top",l,c;s?(l=null,c=i.getRowCount()-1):(l="bottom",c=t?.getPinnedBottomRowCount()??-1),n.setCellRange({rowStartIndex:0,rowStartPinned:a,rowEndIndex:c,rowEndPinned:l})}var v$=class extends j{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){let e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){let t=["dblclick","contextmenu","mouseover","mouseout","click",ZD("touchstart")?"touchstart":"mousedown"];for(let i of t){let n=this.processMouseEvent.bind(this,i);this.addManagedElementListeners(this.element,{[i]:n})}}processMouseEvent(e,t){if(!Vu(this.beans,t)||uo(t))return;let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(i?.column&&i.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,n,i)):(i&&i.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}getControlsForEventTarget(e){let{gos:t}=this;return{cellCtrl:Oy(t,e),rowCtrl:g$(t,e)}}processKeyboardEvent(e,t){let{cellCtrl:i,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):n?.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,i){let n=this.editSvc?.isEditing(e,{withOpenEditor:!0})??!1;!qb(this.gos,i,e.rowNode,e.column,n)&&t==="keydown"&&(!n&&this.beans.navigation?.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,n),YF(i)&&e.processCharacter(i)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(i,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,i){let{rowNode:n}=e,{focusSvc:r,navigation:o}=this.beans,a=r.getFocusedCell()?.column;if(!qb(this.gos,i,n,a,!1)){let c=i.key;if(t==="keydown")switch(c){case B.PAGE_HOME:case B.PAGE_END:case B.PAGE_UP:case B.PAGE_DOWN:o?.handlePageScrollingKey(i,!0);break;case B.LEFT:case B.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case B.UP:case B.DOWN:e.onKeyboardNavigate(i);break;case B.TAB:e.onTabKeyDown(i);break;default:}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",i))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!Vu(this.beans,e))return;let i=VF(e),{clipboardSvc:n,undoRedo:r}=this.beans;if(i===B.A)return this.onCtrlAndA(e);if(i===B.C)return this.onCtrlAndC(n,e);if(i===B.D)return this.onCtrlAndD(n,e);if(i===B.V)return this.onCtrlAndV(n,e);if(i===B.X)return this.onCtrlAndX(n,e);if(i===B.Y)return this.onCtrlAndY(r);if(i===B.Z)return this.onCtrlAndZ(r,e)}onCtrlAndA(e){let{beans:{rowModel:t,rangeSvc:i,selectionSvc:n},gos:r}=this;i&&ho(r)&&!sU(r)&&t.isRowsToRender()?m$(this.beans):n&&n.selectAllRowNodes({source:"keyboardSelectAll",selectAll:wF(r)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},w8=class extends j{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){let t=e.uiContainerHeight,i=t!=null?`${t}px`:"";this.eContainer.style.height=i,this.eViewport&&(this.eViewport.style.height=i)}},bg=e=>e.topRowCtrls,yg=e=>e.getStickyTopRowCtrls(),Sg=e=>e.getStickyBottomRowCtrls(),xg=e=>e.bottomRowCtrls,Eg=e=>e.allRowCtrls,ab=e=>e.getCtrls("top"),lb=e=>e.getCtrls("center"),cb=e=>e.getCtrls("bottom"),C$={center:{type:"center",name:"center-cols",getRowCtrls:Eg,getSpannedRowCtrls:lb},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:Eg,getSpannedRowCtrls:lb},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:Eg,getSpannedRowCtrls:lb},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:Eg},topCenter:{type:"center",name:"floating-top",getRowCtrls:bg,getSpannedRowCtrls:ab},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:bg,getSpannedRowCtrls:ab},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:bg,getSpannedRowCtrls:ab},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:bg},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:yg},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:yg},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:yg},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:yg},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:Sg},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:Sg},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:Sg},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:Sg},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:xg,getSpannedRowCtrls:cb},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:xg,getSpannedRowCtrls:cb},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:xg,getSpannedRowCtrls:cb},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:xg}};function b8(e){return`ag-${eh(e).name}-viewport`}function Bg(e){let t=eh(e);return t.container??`ag-${t.name}-container`}function w$(e){return`ag-${eh(e).name}-spanned-cells-container`}function eh(e){return C$[e]}var b$=["topCenter","topLeft","topRight"],y$=["bottomCenter","bottomLeft","bottomRight"],S$=["center","left","right"],x$=["center","left","right","fullWidth"],E$=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],R$=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],P$=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],y8=["stickyTopCenter","stickyTopLeft","stickyTopRight"],S8=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],k$=[...y8,"stickyTopFullWidth",...S8,"stickyBottomFullWidth"],_$=[...b$,...y$,...S$,...y8,...S8],D$=class extends j{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=eh(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new p$(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,i,n){this.comp=e,this.eContainer=t,this.eSpannedContainer=i,this.eViewport=n,this.createManagedBean(new v$(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();let{pinnedCols:r,rangeSvc:o}=this.beans,s=()=>this.onPinnedWidthChanged();this.forContainers(R$,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(r?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:s})}),this.forContainers(P$,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(r?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:s})}),this.forContainers(x$,()=>this.createManagedBean(new w8(this.eContainer,this.name==="center"?n:void 0))),o&&this.forContainers(_$,()=>this.createManagedBean(o.createDragListenerFeature(this.eContainer))),this.forContainers(E$,()=>this.createManagedBean(new Ay(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){let{spannedRowRenderer:e,gos:t}=this.beans,i=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i,displayedColumnsWidthChanged:i,displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),i(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{let n=this.options.getSpannedRowCtrls(e);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(k$.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}let t=()=>{let i=this.gos.get("ensureDomOrder"),n=ni(this.gos,"print");this.comp.setDomOrder(i||n)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){let{dragSvc:e}=this.beans;if(!e)return;let t=i=>{e.dragging&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){let t=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,i,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return zu(this.eViewport)}getCenterViewportScrollLeft(){return qg(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){let t=us(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return cy(this.eViewport)}getViewportScrollLeft(){return qg(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||uy(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){$g(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){let e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){let t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}let i=ni(this.gos,"print"),r=this.gos.get("embedFullWidthRows")||i,o=t.filter(s=>{let a=s.isFullWidth();return this.options.fullWidth?!r&&a:r||!a});this.comp.setRowCtrls({rowCtrls:o,useFlushSync:e})}},x8="ag-force-vertical-scroll",F$="ag-selectable",M$="ag-column-moving",T$=class extends j{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,i,n,r,o,s){this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=n,this.eBottom=r,this.eStickyTop=o,this.eStickyBottom=s,this.eCenterColsViewport=i.querySelector(`.${b8("center")}`),this.eFullWidthContainer=i.querySelector(`.${Bg("fullWidth")}`),this.eStickyTopFullWidthContainer=o.querySelector(`.${Bg("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=s.querySelector(`.${Bg("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new Iy(this.comp)),this.scrollFeature=this.createManagedBean(new h$(i)),this.beans.rowDragSvc?.setupRowDrag(i,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,i,r,o,s]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){let e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),i=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:i,rowResizeEnded:i}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){let t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){let e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){let{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();let i=t&&e.getScrollbarWidth()||0,n=UF()?16:0,r=`calc(100% + ${i+n}px)`;go(this.beans,()=>this.comp.setBodyViewportWidth(r)),this.updateScrollingClasses()}setGridRootRole(){let{rowGroupColsSvc:e,colModel:t,gos:i}=this,n=i.get("treeData");if(!n){let r=t.isPivotMode();n=(e?e.columns.length:0)>=(r?2:1)}this.comp.setGridRootRole(n?"treegrid":"grid")}addFocusListeners(e){for(let t of e)this.addManagedElementListeners(t,{focusin:i=>{let{target:n}=i,r=da(n,"ag-root",t);t.classList.toggle("ag-has-focus",!r)},focusout:i=>{let{target:n,relatedTarget:r}=i,o=t.contains(r),s=da(r,"ag-root",t);da(n,"ag-root",t)||(!o||s)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(M$,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(F$,e)}updateScrollingClasses(){let{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){let e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,i=t.isLastRowIndexKnown()?t.getRowCount():-1,n=i===-1?-1:e+i;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){let t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){let e=this.gos.get("alwaysShowVerticalScroll"),t=e?x8:null,i=ni(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&JD(this.eBodyViewport)}setupRowAnimationCssClass(){let{rowContainerHeight:e,environment:t}=this.beans,i=t.sizesMeasured,n=()=>{let r=i&&Ul(this.gos)&&!e.stretching,o=r?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(o,r)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({stylesChanged:()=>{!i&&t.sizesMeasured&&(i=!0,n())}})}addBodyViewportListener(){let{eBodyViewport:e,eStickyTop:t,eStickyBottom:i,eTop:n,eBottom:r,beans:{popupSvc:o,touchSvc:s}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),s?.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,o)});let l=this.onStickyWheel.bind(this);for(let d of[t,i,n,r])this.addManagedElementListeners(d,{wheel:l});let c=this.onHorizontalWheel.bind(this);for(let d of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(d).eContainer,{wheel:c});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){let{deltaX:t,deltaY:i,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(i))&&Vu(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){let{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){let{deltaX:t,deltaY:i,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(i))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){let{deltaX:t,deltaY:i}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||i})}onBodyViewportContextMenu(e,t,i){if(!e&&!i)return;this.gos.get("preventDefaultOnContextMenu")&&(e||i).preventDefault();let{target:n}=e||t;(n===this.eBodyViewport||n===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:i,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){let t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){let{pinnedRowModel:e,beans:{environment:t}}=this,i=e?.getPinnedTopTotalHeight(),n=e?.getPinnedBottomTotalHeight(),r=t.getPinnedRowBorderWidth(),o=t.getRowBorderWidth(),s=r-o,a=i?s+i:0,l=n?s+n:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{let t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){let t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),i=this.pinnedRowModel?.getPinnedTopTotalHeight()??0,n=0;t>0&&(n+=t),i>0&&(n+=i),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){let{pinnedRowModel:e,scrollVisibleSvc:t,comp:i}=this,n=e?.getPinnedBottomTotalHeight()??0,o=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,s=n+o;i.setStickyBottomBottom(`${s}px`)}};function I$(e,t){return Oy(e,t.target)?.getFocusedCellPosition()??null}function j_(e,t){let i=ni(e.gos,"normal"),n=t,r,o;n.clientX!=null||n.clientY!=null?(r=n.clientX,o=n.clientY):(r=n.x,o=n.y);let{pageFirstPixel:s}=e.pageBounds.getCurrentPagePixelRange();if(o+=s,i){let a=e.ctrlsSvc.getScrollFeature(),l=a.getVScrollPosition(),c=a.getHScrollPosition();r+=c.left,o+=l.top}return{x:r,y:o}}var E8=class extends st{constructor(e,t){super(),this.direction=t,this.eViewport=ae,this.eContainer=ae,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",GF()||pa())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=UF(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){let e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),i=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:i,touchend:i})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),go(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){let t=this.eViewport;TW(this,()=>Ir(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},A$={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},O$=class extends E8{constructor(){super(A$,"horizontal"),this.eLeftSpacer=ae,this.eRightSpacer=ae,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();let e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new Ay(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;let e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){let e=this.scrollVisibleSvc.verticalScrollShowing,t=this.visibleCols.getDisplayedColumnsRightWidth(),i=!this.enableRtl&&e,n=this.scrollVisibleSvc.getScrollbarWidth();i&&(t+=n),Dr(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let r=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(r+=n),Dr(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=n)}setScrollVisible(){let e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),n=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,o=i?0:n===0&&t?16:n,s=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),Fu(this.getGui(),o),Fu(this.eViewport,o),Fu(this.eContainer,o),o||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(s,100):s()}getScrollPosition(){return qg(this.eViewport,this.enableRtl)}setScrollPosition(e){Ir(this.eViewport)||this.attemptSettingScrollPosition(e),$g(this.eViewport,e,this.enableRtl)}},L$={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:O$},N$={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},B$=class extends E8{constructor(){super(N$,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new w8(this.eContainer));let{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){let{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,i=this.invisibleScrollbar,n=t&&e.getScrollbarWidth()||0,r=n===0&&i?16:n;this.toggleCss("ag-scrollbar-invisible",i),Dr(this.getGui(),r),Dr(this.eViewport,r),Dr(this.eContainer,r),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){let i=e.getGridBodyCtrl().eBodyViewport,n=this.getScrollPosition(),r=i.scrollTop;n!=r&&this.setScrollPosition(r,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!Ir(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},H$={selector:"AG-FAKE-VERTICAL-SCROLL",component:B$},z$="ag-column-first",V$="ag-column-last";function R8(e,t,i,n){return mt(e)?[]:W$(e.headerClass,e,t,i,n)}function P8(e,t,i){e.toggleCss(z$,i.isColAtEdge(t,"first")),e.toggleCss(V$,i.isColAtEdge(t,"last"))}function G$(e,t,i,n){return _e(t,{colDef:e,column:i,columnGroup:n})}function W$(e,t,i,n,r){if(mt(e))return[];let o;if(typeof e=="function"){let s=G$(t,i,n,r);o=e(s)}else o=e;return typeof o=="string"?[o]:Array.isArray(o)?[...o]:[]}function U$(e){let{rowIndex:t,rowPinned:i,column:n}=e;return`${t}.${i??"null"}.${n.getId()}`}function Ly(e,t){let i=e.column===t.column,n=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return i&&n&&r}function j$(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(pe(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function q$(e,t){return!e&&!t?!0:!e||!t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function $$(e){let t=0,i,{pinnedRowModel:n,rowModel:r,pageBounds:o}=e;return n?.getPinnedTopRowCount()?i="top":r.getRowCount()?(i=null,t=o.getFirstRow()):n?.getPinnedBottomRowCount()&&(i="bottom"),i===void 0?null:{rowIndex:t,rowPinned:i}}function K$(e){let t,i=null,{pinnedRowModel:n,pageBounds:r}=e,o=n?.getPinnedBottomRowCount(),s=n?.getPinnedTopRowCount();return o?(i="bottom",t=o-1):e.rowModel.getRowCount()?t=r.getLastRow():s&&(i="top",t=s-1),t===void 0?null:{rowIndex:t,rowPinned:i}}function fo(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Bl(e,t){let i=e.spannedRowRenderer?.getCellByPosition(t);if(i)return i;let n=e.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null}function Y$(e,t,i){let{rowModel:n,pinnedRowModel:r}=e,o;return o??(o=n?.getRowNode(t)),i?o??(o=r?.getPinnedRowById(t,i)):(o??(o=r?.getPinnedRowById(t,"top")),o??(o=r?.getPinnedRowById(t,"bottom"))),o}function am(e,t,i=!1){let{rowIndex:n,rowPinned:r}=t,{pageBounds:o,pinnedRowModel:s,rowModel:a}=e;if(n===0)return r==="top"?null:r==="bottom"&&a.isRowsToRender()?{rowIndex:o.getLastRow(),rowPinned:null}:s?.isRowsToRender("top")?{rowIndex:s.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(i){let l=r?void 0:a.getRow(n);return k8(e,l,!0)??{rowIndex:n-1,rowPinned:r}}return{rowIndex:n-1,rowPinned:r}}function q_(e,t,i=!1){let{rowIndex:n,rowPinned:r}=t,{pageBounds:o,pinnedRowModel:s,rowModel:a}=e;if(X$(e,t))return r==="bottom"?null:r==="top"&&a.isRowsToRender()?{rowIndex:o.getFirstRow(),rowPinned:null}:s?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(i){let l=r?void 0:a.getRow(n);return k8(e,l)??{rowIndex:n+1,rowPinned:r}}return{rowIndex:n+1,rowPinned:r}}function k8(e,t,i=!1){let{gos:n,rowRenderer:r}=e;if(!t?.sticky||!fF(n))return;let o=r.getStickyTopRowCtrls(),s=r.getStickyBottomRowCtrls(),a=!s.some(u=>u.rowNode.rowIndex===t.rowIndex),l=a?o:s,c=(i?-1:1)*(a?-1:1),d;for(let u=0;u<l.length;u++)if(l[u].rowNode.rowIndex===t.rowIndex){d=l[u+c];break}return d?{rowIndex:d.rowNode.rowIndex,rowPinned:null}:void 0}function X$(e,t){let{rowPinned:i,rowIndex:n}=t,{pinnedRowModel:r,pageBounds:o}=e;return i==="top"?(r?.getPinnedTopRowCount()??0)-1<=n:i==="bottom"?(r?.getPinnedBottomRowCount()??0)-1<=n:o.getLastRow()<=n}function J$(e,t,i){t.addManagedElementListeners(i,{keydown:n=>{if(!n.defaultPrevented&&n.key===B.TAB){let r=n.shiftKey;xa(e,i,!1,r)||rc(e,r)&&n.preventDefault()}}})}function Q$(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function fa(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.exclusive}function xm(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.exclusive}function rc(e,t,i=!1){let n=e.ctrlsSvc.get("gridCtrl");return!i&&n.focusNextInnerContainer(t)?!0:((i||!t&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(t),!1)}function Z$(e,t){let i=e.focusSvc,n=i.getFocusedCell();if(n&&t&&Ly(n,t)){let{rowIndex:r,rowPinned:o,column:s}=t;oy(e)&&i.setFocusedCell({rowIndex:r,column:s,rowPinned:o,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!jF()})}}function kr(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function Ny(e){let t=[],i=e.ctrlsSvc.getHeaderRowContainerCtrls();for(let n of i){if(!n)continue;let r=n.getGroupRowCount()||0;for(let o=0;o<r;o++){let s=n.getGroupRowCtrlAtIndex(o),a=t[o];if(s){let l=eK(e,s);(a==null||l>a)&&(t[o]=l)}}}return t}function eK(e,t){let n=e.colModel.isPivotMode()?iK(e):D8(e),r=t.getHeaderCellCtrls();for(let o of r){let{column:s}=o,a=s.getAutoHeaderHeight();a!=null&&a>n&&s.isAutoHeaderHeight()&&(n=a)}return n}function By(e){let i=e.colModel.isPivotMode()?tK(e):th(e);return e.colModel.forAllCols(n=>{let r=n.getAutoHeaderHeight();r!=null&&r>i&&n.isAutoHeaderHeight()&&(i=r)}),i}function th(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function _8(e){return e.gos.get("floatingFiltersHeight")??th(e)}function D8(e){return e.gos.get("groupHeaderHeight")??th(e)}function tK(e){return e.gos.get("pivotHeaderHeight")??th(e)}function iK(e){return e.gos.get("pivotGroupHeaderHeight")??D8(e)}function nK(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var rK=class extends j{setComp(e,t,i){this.comp=e,this.eGui=t;let{beans:n}=this,{headerNavigation:r,touchSvc:o,ctrlsSvc:s}=n;r&&this.createManagedBean(new Zu(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();let a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),o?.mockHeaderContextMenu(this,a),s.register("gridHeaderCtrl",this)}setupHeaderHeight(){let e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>go(this.beans,()=>e()),stylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){let{beans:e}=this,t=0,i=Ny(e).reduce((o,s)=>o+s,0),n=By(e);if(e.filterManager?.hasFloatingFilters()&&(t+=_8(e)),t+=i,t+=n,this.headerHeight===t)return;this.headerHeight=t;let r=`${t+1}px`;this.comp.setHeightAndMinHeight(r),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){let t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){let i=e.visibleCols.allCols.some(n=>n.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",i)}onTabKeyDown(e){let t=this.gos.get("enableRtl"),i=e.shiftKey,n=i!==t?"LEFT":"RIGHT",{beans:r}=this,{headerNavigation:o,focusSvc:s}=r;(o.navigateHorizontally(n,!0,e)||!i&&s.focusOverlay(!1)||rc(r,i,!0))&&e.preventDefault()}handleKeyDown(e){let t=null,{headerNavigation:i}=this.beans;switch(e.key){case B.LEFT:t="LEFT";case B.RIGHT:{pe(t)||(t="RIGHT"),i.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case B.UP:t="UP";case B.DOWN:{pe(t)||(t="DOWN"),i.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){let{relatedTarget:t}=e,{eGui:i,beans:n}=this;!t&&i.contains(bt(n))||i.contains(t)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,i){let{menuSvc:n,ctrlsSvc:r}=this.beans;if(!e&&!i||!n?.isHeaderContextMenuEnabled())return;let{target:o}=e??t;(o===this.eGui||o===r.getHeaderRowContainerCtrl()?.eViewport)&&n.showHeaderContextMenu(void 0,e,i)}},Hy=class extends st{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},oK={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},sK=class extends Hy{constructor(e){super(oK,e),this.eResize=ae,this.eHeaderCompWrapper=ae,this.headerCompVersion=0}postConstruct(){let e=this.getGui(),t=()=>{let n=this.ctrl.getSelectAllGui();n&&(this.eResize.insertAdjacentElement("afterend",n),this.addDestroyFunc(()=>n.remove()))},i={setWidth:n=>e.style.width=n,toggleCss:(n,r)=>this.toggleCss(n,r),setUserStyles:n=>Xu(e,n),setAriaSort:n=>n?cW(e,n):dW(e),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerComp,refreshSelectAllGui:t,removeSelectAllGui:()=>this.ctrl.getSelectAllGui()?.remove()};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0),t()}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.headerCompGui?.remove(),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;let t=this.headerCompVersion;e.newAgStackInstance().then(i=>this.afterCompCreated(t,i))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},aK={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},lK=class extends Hy{constructor(e){super(aK,e),this.eResize=ae,this.eHeaderCompWrapper=ae}postConstruct(){let e=this.getGui(),t=(n,r)=>r!=null?e.setAttribute(n,r):e.removeAttribute(n),i={toggleCss:(n,r)=>this.toggleCss(n,r),setUserStyles:n=>Xu(e,n),setHeaderWrapperHidden:n=>{n?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:n=>{n!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${n}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",n!=null)},setResizableDisplayed:n=>ot(this.eResize,n),setWidth:n=>e.style.width=n,setAriaExpanded:n=>t("aria-expanded",n),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){let t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}let i=this.getGui(),n=e.getGui();this.eHeaderCompWrapper.appendChild(n),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(i)}},cK={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},dK=class extends Hy{constructor(e){super(cK,e),this.eFloatingFilterBody=ae,this.eButtonWrapper=ae,this.eButtonShowMainFilter=ae}postConstruct(){let e=this.getGui(),t={toggleCss:(i,n)=>this.toggleCss(i,n),setUserStyles:i=>Xu(e,i),addOrRemoveBodyCssClass:(i,n)=>this.eFloatingFilterBody.classList.toggle(i,n),setButtonWrapperDisplayed:i=>ot(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>e.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp?.getGui().remove(),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp)}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached?.()}}},uK=class extends st{constructor(e){super({tag:"div",cls:e.headerRowClass,role:"row"}),this.ctrl=e,this.headerComps={}}postConstruct(){this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),Ug(this.getGui(),this.ctrl.getAriaRowIndex());let t={setHeight:i=>this.getGui().style.height=i,setTop:i=>this.getGui().style.top=i,setHeaderCtrls:(i,n)=>this.setHeaderCtrls(i,n),setWidth:i=>this.getGui().style.width=i,setRowIndex:i=>Ug(this.getGui(),i)};this.ctrl.setComp(t,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;let i=this.headerComps;this.headerComps={};for(let n of e){let r=n.instanceId,o=i[r];delete i[r],o==null&&(o=this.createHeaderComp(n),this.getGui().appendChild(o.getGui())),this.headerComps[r]=o}if(Object.values(i).forEach(n=>{n.getGui().remove(),this.destroyBean(n)}),t){let n=Object.values(this.headerComps);n.sort((o,s)=>{let a=o.getCtrl().column.getLeft(),l=s.getCtrl().column.getLeft();return a-l});let r=n.map(o=>o.getGui());XD(this.getGui(),r)}}createHeaderComp(e){let t;switch(this.ctrl.type){case"group":t=new lK(e);break;case"filter":t=new dK(e);break;default:t=new sK(e);break}return this.createBean(t),t.setParentComponent(this),t}},zy=class extends j{constructor(e,t,i,n){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=n,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){let{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?dt(t):this.columnOrGroup}postConstruct(){let e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){let{gos:e,colAnimation:t}=this.beans,i=e.get("suppressColumnMoveAnimation"),n=pe(this.columnOrGroup.getOldLeft());t?.isActive()&&n&&!i?this.animateInLeft():this.onLeftChanged()}animateInLeft(){let e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),i=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=i,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===i&&this.setLeft(i)})}onLeftChanged(){let e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){let{gos:i,visibleCols:n}=this.beans;if(!ni(i,"print")||e.getPinned()==="left")return t;let o=n.getColsLeftWidth();if(e.getPinned()==="right"){let s=n.bodyWidth;return o+s+t}return o+t}setLeft(e){if(pe(e)&&(this.eCell.style.left=`${e}px`),It(this.columnOrGroup)){let t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&lW(this.ariaEl,t.length)}}},hK=0,F8="headerCtrl",Vy=class extends j{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+hK++}postConstruct(){let e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,i,n,r){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,i,n,r),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){let{headerRowIndex:t,column:i}=this.beans.focusSvc.focusedHeader,n=i.getDefinition(),r=n?.suppressHeaderKeyboardEvent;if(!pe(r))return!1;let o=_e(this.gos,{colDef:n,column:i,headerRowIndex:t,event:e});return!!r(o)}getWrapperHasFocus(){return bt(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){let e=this.column.getDefinition();if(!e)return;let{headerStyle:t}=e,i;if(typeof t=="function"){let n=this.getHeaderClassParams();i=t(n)}else i=t;i&&this.comp.setUserStyles(i)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){let{wrapperElement:t,checkMeasuringCallback:i,compBean:n}=e,{beans:r}=this,o=u=>{if(!this.isAlive()||!n.isAlive())return;let{paddingTop:h,paddingBottom:p,borderBottomWidth:f,borderTopWidth:g}=ya(this.eGui),m=h+p+f+g,C=t.offsetHeight+m;if(u<5){let S=!Kt(r)?.contains(t),E=C==0;if(S||E){_b(()=>o(u+1),"raf",r);return}}this.setColHeaderHeight(this.column,C)},s=!1,a,l=()=>{let u=this.column.isAutoHeaderHeight();u&&!s&&c(),!u&&s&&d()},c=()=>{s=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),o(0),a=us(this.beans,t,()=>o(0))},d=()=>{s=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),n.addDestroyFunc(()=>d()),n.addManagedListeners(this.column,{widthChanged:()=>s&&o(0)}),n.addManagedEventListeners({sortChanged:()=>{s&&window.setTimeout(()=>o(0))}}),i&&i(l)}onDisplayedColumnsChanged(){let{comp:e,column:t,beans:i,eGui:n}=this;!e||!t||!n||(P8(e,t,i.visibleCols),UD(n,i.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){let e=fa(this.beans);this.eGui&&Ui(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){let t=bt(this.beans),i=e.key===B.LEFT||e.key===B.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)return;if((this.isResizing||i)&&(e.preventDefault(),e.stopImmediatePropagation()),(e.ctrlKey||e.metaKey)&&VF(e)===B.C)return this.beans.clipboardSvc?.copyToClipboard();if(!i)return;let o=e.key===B.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;let s=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(s,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(o)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){let t=this.getResizeDiff(e),{pinnedCols:i}=this.beans;return i?i.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){let{gos:t,column:i}=this,n=e.key===B.LEFT!==t.get("enableRtl"),r=i.getPinned(),o=t.get("enableRtl");return r&&o!==(r==="right")&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){let t=this.getWrapperHasFocus();switch(e.key){case B.PAGE_DOWN:case B.PAGE_UP:case B.PAGE_HOME:case B.PAGE_END:t&&e.preventDefault()}}addDomData(e){let t=F8,{eGui:i,gos:n}=this;va(n,i,t,this),e.addDestroyFunc(()=>va(n,i,t,null))}focus(e){if(!this.isAlive())return!1;let{eGui:t}=this;return t?(this.lastFocusEvent=e||null,t.focus()):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,i){let n=e??t,{menuSvc:r,gos:o}=this.beans;o.get("preventDefaultOnContextMenu")&&n.preventDefault(),r?.isHeaderContextMenuEnabled(i)&&r.showHeaderContextMenu(i,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;let{eventSvc:i}=this;e.isColumn?i.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):i.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},pK=class extends Vy{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,i,n,r){this.comp=e;let{rowCtrl:o,column:s,beans:a}=this,{colResize:l,context:c,colHover:d,rangeSvc:u}=a,h=Qu(this,c,r);this.setGui(t,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:f=>this.setRefreshFunction("measuring",f),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(o.pinned,s,i,e,this)):ot(i,!1),d?.createHoverFeature(h,[s],t),u?.createRangeHighlightFeature(h,s,e),h.createManagedBean(new zy(s,t,a)),h.createManagedBean(new Zu(t,{shouldStopEventPropagation:f=>this.shouldStopEventPropagation(f),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),h.addManagedListeners(s,{colDefChanged:()=>this.refresh(),formulaRefChanged:()=>this.refresh(),headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});let p=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:p,columnRowGroupChanged:p,columnPivotChanged:p,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return _e(t.gos,{colDef:i,column:e,floatingFilter:!1})}setupUserComp(){let e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){let e=this.createParams(),t=this.column.getColDef();return rj(this.beans.userCompFactory,t,e)}createParams(){let{menuSvc:e,sortSvc:t,colFilter:i,gos:n}=this.beans;return _e(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!i&&(!this.openFilterEnabled||sn(this.gos)),showColumnMenu:(o,s)=>{e?.showColumnMenu({column:this.column,buttonElement:o,positionBy:"button",onClosedCallback:s})},showColumnMenuAfterMouseClick:(o,s)=>{e?.showColumnMenu({column:this.column,mouseEvent:o,positionBy:"mouse",onClosedCallback:s})},showFilter:o=>{e?.showFilterMenu({column:this.column,buttonElement:o,containerType:"columnFilter",positionBy:"button"})},progressSort:o=>{t?.progressSort(this.column,!!o,"uiColumnSorted")},setSort:(o,s)=>{t?.setSortForColumn(this.column,jn(o),!!s,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(o,s)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(o,s)}})}setupSelectAll(e){let{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature?.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{let i=t.createSelectAllFeature(this.column);i&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(i),this.selectAllFeature?.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!i&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===B.SPACE?this.selectAllFeature?.onSpaceKeyDown(e):e.key===B.ENTER?this.onEnterKeyDown(e):e.key===B.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){let{column:t,gos:i,sortable:n,beans:r}=this,o=!1;(e.ctrlKey||e.metaKey)&&(o=this.showMenuOnKeyPress(e,!0)),o||(!e.altKey&&ql(i)?r.rangeSvc?.handleColumnSelection(t,e):n&&r.sortSvc?.progressSort(t,e.shiftKey,"uiColumnSorted"))}showMenuOnKeyPress(e,t){let i=this.comp.getUserCompInstance();return $_(i)&&i.onMenuKeyboardShortcut(t)?(e.preventDefault(),!0):!1}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),jF()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){let e=()=>{let t=this.column.getColDef(),i=R8(t,this.gos,this.column,null),n=this.userHeaderClasses;this.userHeaderClasses=new Set(i);for(let r of i)n.has(r)?n.delete(r):this.comp.toggleCss(r,!0);for(let r of n)this.comp.toggleCss(r,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){let{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(let e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){let e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){let t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){let e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){let t=()=>{let i=this.column.getActualWidth();this.comp.setWidth(`${i}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){let t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){let t=()=>{this.comp?.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){let t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){let t=()=>{let i=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",i),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){let e=()=>{let t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){let e=this.column.getHighlighted(),t=e===0,i=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",i)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){let{eGui:e,column:t,comp:i,beans:n}=this,r=Ny(this.beans),o=r.reduce((h,p)=>h+p,0)===0;if(i.toggleCss("ag-header-parent-hidden",o),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),i.toggleCss("ag-header-span-height",!1),i.toggleCss("ag-header-span-total",!1);return}let{numberOfParents:s,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();i.toggleCss("ag-header-span-height",s>0);let l=By(n);if(s===0){i.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}i.toggleCss("ag-header-span-total",a);let c=(this.column.getFirstRealParent()?.getLevel()??-1)+1,d=r.length-c,u=0;for(let h=0;h<d;h++)u+=r[r.length-1-h];e.style.setProperty("top",`${-u}px`),e.style.setProperty("height",`${l+u}px`)}refreshAriaSort(){let e=null,{beans:t,column:i,comp:n,sortable:r}=this;if(r){let o=this.getLocaleTextFunc(),s=t.sortSvc?.getDisplaySortForColumn(i)??null;n.setAriaSort(JG(s)),e=o("ariaSortableColumn","Press ENTER to sort")}else n.setAriaSort();this.setAriaDescriptionProperty("sort",e)}refreshAriaMenu(){let e=null;this.menuEnabled&&(e=this.getLocaleTextFunc()("ariaMenuColumn","Press ALT DOWN to open column menu")),this.setAriaDescriptionProperty("menu",e)}refreshAriaFilterButton(){let e=null,{openFilterEnabled:t,gos:i}=this;t&&!sn(i)&&(e=this.getLocaleTextFunc()("ariaFilterColumn","Press CTRL ENTER to open filter")),this.setAriaDescriptionProperty("filterButton",e)}refreshAriaFiltered(){let e=null;this.column.isFilterActive()&&(e=this.getLocaleTextFunc()("ariaColumnFiltered","Column Filtered")),this.setAriaDescriptionProperty("filter",e)}refreshAriaCellSelection(){let e=null,{gos:t,column:i,beans:n}=this;if(ql(t)){let o=this.getLocaleTextFunc(),s=n.rangeSvc?.isColumnInAnyRange(i);e=o("ariaColumnCellSelection",`Press CTRL+SPACE to ${s?"de":""}select all visible cells in this column`)}this.setAriaDescriptionProperty("cellSelection",e)}setAriaDescriptionProperty(e,t){let i=this.ariaDescriptionProperties;t!=null?i.set(e,t):i.delete(e)}announceAriaDescription(){let{beans:e,eGui:t,ariaDescriptionProperties:i}=this;if(!t.contains(bt(e)))return;let n=Array.from(i.keys()).sort((r,o)=>r==="filter"?-1:o.charCodeAt(0)-r.charCodeAt(0)).map(r=>i.get(r)).join(". ");e.ariaAnnounce?.announceValue(n,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered(),this.refreshAriaCellSelection()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){let t=r=>this.handleMouseOverChange(r.type==="mouseenter"),i=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},n=r=>this.handleContextMenuMouseEvent(r,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:n})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){let t=this.comp.getUserCompInstance();return $_(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function $_(e){return typeof e?.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var fK=0,db=class extends j{constructor(e,t,i){super(),this.rowIndex=e,this.pinned=t,this.type=i,this.instanceId=fK++,this.comp=null,this.allCtrls=[];let n="ag-header-row-column";i==="group"?n="ag-header-row-group":i==="filter"&&(n="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${n}`}setRowIndex(e){this.rowIndex=e,this.comp?.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=ni(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,i=!0){this.comp=e,t=Qu(this,this.beans.context,t),i&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){let t=this.onRowHeightChanged.bind(this),i=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:i,virtualColumnsChanged:n=>this.onVirtualColumnsChanged(n.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,stylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",i),e.addManagedPropertyListener("ensureDomOrder",n=>this.isEnsureDomOrder=n.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=ni(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;let e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){let{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;let{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0,t=Ny(this.beans);for(let r=0;r<t.length;r++){if(r===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[r]};e+=t[r]}let i=By(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:i};e+=i;let n=_8(this.beans);return{topOffset:e,rowHeight:n}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;let t=this.getUpdatedHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,i,e)}getUpdatedHeaderCtrls(){let e=this.ctrlsById;this.ctrlsById=new Map;let t=this.getColumnsInViewport();for(let n of t)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,e);let i=n=>{let{focusSvc:r,visibleCols:o}=this.beans;return r.isHeaderWrapperFocused(n)?o.isVisible(n.column):!1};if(e)for(let[n,r]of e)i(r)?this.ctrlsById.set(n,r):this.destroyBean(r);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,i){if(e.isEmptyGroup())return;let n=e.getUniqueId(),r;if(i&&(r=i.get(n),i.delete(n)),r&&r.column!=e&&(this.destroyBean(r),r=void 0),r==null)switch(this.type){case"filter":{r=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":r=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:r=this.createBean(new pK(e,this));break}t.set(n,r)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];let e=[];for(let t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){let i=this.allCtrls.find(r=>r.column==e);return i?i.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},gK=class extends j{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;let{pinnedCols:i,ctrlsSvc:n,colModel:r,colMoves:o}=this.beans;this.setupCenterWidth(),i?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(o,this.eViewport);let s=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:s,advancedFilterEnabledChanged:s});let a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;n.register(a,this),r.ready&&this.refresh()}getAllCtrls(){let e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){let{focusSvc:t,filterManager:i,visibleCols:n}=this.beans,r=0,o=t.getFocusHeaderToUseAfterRefresh(),s=()=>{let u=n.headerGroupRowCount;r=u,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));let h=this.groupsRowCtrls.length;if(h!==u){if(h>u){for(let p=u;p<h;p++)this.destroyBean(this.groupsRowCtrls[p]);this.groupsRowCtrls.length=u;return}for(let p=h;p<u;p++){let f=this.createBean(new db(p,this.pinned,"group"));this.groupsRowCtrls.push(f)}}},a=()=>{let u=r++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new db(u,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==u&&this.columnsRowCtrl.setRowIndex(u)},l=()=>{this.includeFloatingFilter=!!i?.hasFloatingFilters()&&!this.hidden;let u=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){u();return}e||u();let h=r++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==h&&this.filtersRowCtrl.setRowIndex(h):this.filtersRowCtrl=this.createBean(new db(h,this.pinned,"filter"))},c=this.getAllCtrls();s(),a(),l();let d=this.getAllCtrls();this.comp.setCtrls(d),this.restoreFocusOnHeader(t,o),c.length!==d.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){let t=i=>i?.getHeaderCellCtrls().find(n=>n.column===e);if(cs(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let i=0;i<this.groupsRowCtrls.length;i++){let n=t(this.groupsRowCtrls[i]);if(n)return n}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,i){let r=this.getAllCtrls()[e];return r?r.focusHeader(t,i):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){let i=e?.createBodyDropTarget(this.pinned,t);i&&this.createManagedBean(i)}restoreFocusOnHeader(e,t){if(!t)return;let{column:i}=t;i.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new Ay(e=>this.comp.setCenterWidth(`${e}px`),!0))}},mK=class extends j{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){let{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(Y_(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,i){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,i)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}hideFilterMenu(){Y_(this.beans)?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){let{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(sn(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&cs(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){let e=!this.isSuppressMenuHide();return!(pa()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!sn(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!sn(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){let e=this.gos,t=e.get("suppressMenuHide");return sn(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,i,n){let{positionBy:r,onClosedCallback:o}=t,s=t.column;if(r==="button"){let{buttonElement:a}=t;e?.showMenuAfterButtonClick(s,a,i,o,n)}else if(r==="mouse"){let{mouseEvent:a}=t;e?.showMenuAfterMouseEvent(s,a,i,o,n)}else if(s){let a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(s,"auto"),go(a,()=>{let c=l.getHeaderRowContainerCtrl(s.getPinned())?.getHeaderCtrlForColumn(s);c&&e?.showMenuAfterButtonClick(s,c.getAnchorElementForMenu(n),i,o,n)})}}};function K_(e,t,i){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",i))}function Y_(e){let{enterpriseMenuFactory:t,filterMenuFactory:i,gos:n}=e;return t&&sn(n)?t:i}var Em=class extends Sy{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},Rm=class extends st{constructor(){super()}};function vK(e,t,i){let n=ji(e,t,i);if(n){let{className:o}=n;if(typeof o=="string"&&o.includes("ag-icon")||typeof o=="object"&&o["ag-icon"])return n}let r=Xt({tag:"span"});return r.appendChild(n),r}function ji(e,t,i){let n=null;e==="smallDown"?J(262):e==="smallLeft"?J(263):e==="smallRight"&&J(264);let r=i?.getColDef().icons;if(r&&(n=r[e]),t.gos&&!n){let o=t.gos.get("icons");o&&(n=o[e])}if(n){let o;if(typeof n=="function")o=n();else if(typeof n=="string")o=n;else{J(38,{iconName:e});return}if(typeof o=="string")return dy(o);if(py(o))return o;J(133,{iconName:e});return}else{let o=t.registry.getIcon(e);return o||t.validation?.validateIcon(e),Xt({tag:"span",cls:`ag-icon ag-icon-${o??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var CK={tag:"div",cls:"ag-overlay-loading-center",children:[{tag:"span",ref:"eLoadingIcon",cls:"ag-loading-icon"},{tag:"span",ref:"eLoadingText",cls:"ag-loading-text"}]},wK=class extends Rm{constructor(){super(...arguments),this.eLoadingIcon=ae,this.eLoadingText=ae}init(e){let{beans:t,gos:i}=this,n=ao(i.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(n??CK),!n){let r=ji("overlayLoading",t,null);r&&this.eLoadingIcon.appendChild(r);let o=e.loading?.overlayText??this.getLocaleTextFunc()("loadingOoo","Loading...");this.eLoadingText.textContent=o,t.ariaAnnounce.announceValue(o,"overlay")}}},bK={tag:"div",cls:"ag-overlay-exporting-center",children:[{tag:"span",ref:"eExportingIcon",cls:"ag-loading-icon"},{tag:"span",ref:"eExportingText",cls:"ag-exporting-text"}]},yK=class extends Rm{constructor(){super(...arguments),this.eExportingIcon=ae,this.eExportingText=ae}init(e){let{beans:t}=this;this.setTemplate(bK);let i=ji("overlayExporting",t,null);i&&this.eExportingIcon.appendChild(i);let n=e.exporting?.overlayText??this.getLocaleTextFunc()("exportingOoo","Exporting...");this.eExportingText.textContent=n,t.ariaAnnounce.announceValue(n,"overlay")}},SK={tag:"span",cls:"ag-overlay-no-rows-center"},xK=class extends Rm{init(e){let{beans:t,gos:i}=this,n=ao(i.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(n??SK),!n){let r=e.noRows?.overlayText??this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=r,t.ariaAnnounce.announceValue(r,"overlay")}}},EK={tag:"span",cls:"ag-overlay-no-matching-rows-center"},RK=class extends Rm{init(e){let{beans:t}=this;this.setTemplate(EK);let i=e.noMatchingRows?.overlayText??this.getLocaleTextFunc()("noMatchingRows","No Matching Rows");this.getGui().textContent=i,t.ariaAnnounce.announceValue(i,"overlay")}},PK=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",kK={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},_K=class extends st{constructor(){super(),this.dragSource=null,this.eIcon=ae,this.eLabel=ae,this.eGhost=ae,this.registerCSS(PK)}postConstruct(){let e=t=>vK(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(kK),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){let{eGhost:i,eIcon:n,dragSource:r,dropIconMap:o,gos:s}=this;ii(n);let a=null;e||(e=r?.getDefaultIconName?r.getDefaultIconName():"notAllowed"),a=o[e],i.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),n.classList.toggle("ag-shake-left-to-right",t),!(a===o.hide&&s.get("suppressDragLeaveHidesColumns"))&&a&&n.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},DK=".ag-checkbox-cell{height:100%}",FK={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},MK=class extends st{constructor(){super(FK,[Ry]),this.eCheckbox=ae,this.registerCSS(DK)}init(e){this.refresh(e);let{eCheckbox:t,beans:i}=this,n=t.getInputElement();n.setAttribute("tabindex","-1"),GD(n,"polite"),this.addManagedListeners(n,{click:r=>{if(wa(r),t.isDisabled())return;let o=t.getValue();this.onCheckboxChanged(o)},dblclick:r=>{wa(r)}}),this.addManagedElementListeners(e.eGridCell,{keydown:r=>{if(r.key===B.SPACE&&!t.isDisabled()){e.eGridCell===bt(i)&&t.toggle();let o=t.getValue();this.onCheckboxChanged(o),r.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,i=!0,{value:n,column:r,node:o}=e;if(o.group&&r)if(typeof n=="boolean")t=n;else{let u=r.getColId();u.startsWith(wm)?t=n==null||n===""?void 0:n==="true":o.aggData&&o.aggData[u]!==void 0||o.sourceRowIndex>=0?t=n??void 0:i=!1}else t=n??void 0;let{eCheckbox:s}=this;if(!i){s.setDisplayed(!1);return}s.setValue(t);let a=e.disabled??!r?.isCellEditable(o);s.setDisabled(a);let l=this.getLocaleTextFunc(),c=gm(l,t),d=a?c:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${c})`;s.setInputAriaLabel(d)}onCheckboxChanged(e){let{params:t}=this,{column:i,node:n,value:r}=t,{editSvc:o}=this.beans;if(!i)return;let s={rowNode:n,column:i};o?.dispatchCellEvent(s,null,"cellEditingStarted",{value:r});let a=n.setDataValue(i,e,"ui");o?.dispatchCellEvent(s,null,"cellEditingStopped",{oldValue:r,newValue:e,valueChanged:a}),a||this.updateCheckbox(t)}},X_=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){let{all:t,visible:i,order:n}=this;t.has(e)||(t.add(e),i.add(e),n.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),Mr(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(let t of this.visible)if(t.id==e)return t}clear(){let{all:e,visible:t,order:i,queued:n}=this;e.clear(),n.clear(),t.clear(),i.length=0}sort(){let{sortSvc:e,rowNodeSorter:t,gos:i}=this.beans,n=e?.getSortOptions()??[],r=AK(this.order);if(this.order.sort((s,a)=>(s.pinnedSibling?.rowIndex??0)-(a.pinnedSibling?.rowIndex??0)),this.order=t?.doFullSort(this.order,n)??this.order,!r)return;let o=gF(i);o==="bottom"||o==="pinnedBottom"?this.order.push(r):this.order.unshift(r)}hide(e){let{all:t,visible:i}=this,n=i.size;return t.forEach(r=>e(r)?i.delete(r):i.add(r)),this.order=Array.from(i),this.sort(),n!=i.size}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function M8(e){if(e.level===-1)return!0;let t=e.parent;return t?.childrenAfterSort?.some(i=>i==e)?M8(t):!1}function ub(e,t){let{gos:i,rowModel:n,filterManager:r}=e;return Ju(i,n)?!n.getRowNode(t.id):r?.isAnyFilterPresent()?!M8(t):i.get("pivotMode")?!t.group:!1}function TK(e){return!!e.footer&&e.level===-1}function IK(e){return!!e.pinnedSibling&&TK(e.pinnedSibling)}function AK(e){let t=e.findIndex(IK);if(t>-1)return e.splice(t,1)?.[0]}var J_=class extends j{postConstruct(){let{gos:e,beans:t}=this;this.top=new X_(t,"top"),this.bottom=new X_(t,"bottom");let i=r=>ub(t,r.pinnedSibling),n=()=>{let r=e.get("isRowPinned");r&&e.get("enableRowPinning")&&t.rowModel.forEachNode(o=>this.pinRow(o,r(o)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({stylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:r})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow();let o=!1;this.forContainers(a=>{o||(o=a.hide(i))});let s=this.refreshRowPositions();(!r||s||o)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(LK),this.refreshRowPositions()},rowNodeDataChanged:({node:r})=>{(e.get("isRowPinnable")?.(r)??!0)||this.pinRow(r,null)},firstDataRendered:n}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(r=>r.hide(i)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:r})=>{this._grandTotalPinned=r==="pinnedBottom"?"bottom":r==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",n)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{let i=[];t.forEach(n=>i.push(n)),i.forEach(n=>this.pinRow(n,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,i){if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,BK(this.beans);return}let n=e.rowPinned??e.pinnedSibling?.rowPinned;if(n!=null&&t!=null&&t!=n){let s=e.rowPinned?e:e.pinnedSibling,a=e.rowPinned?e.pinnedSibling:e;this.pinRow(s,null,i),this.pinRow(a,t,i);return}let o=i&&NK(this.beans,e,i);if(o){o.forEach(s=>this.pinRow(s,t));return}if(t==null){let s=e.rowPinned?e:e.pinnedSibling,a=this.findPinnedRowNode(s);if(!a)return;a.delete(s);let l=s.pinnedSibling;hb(s),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(l)}else{let s=Q_(this.beans,e,t),a=this.getContainer(t);a.add(s),ub(this.beans,e)&&a.hide(l=>ub(this.beans,l.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0,i=n=>{if(n.rowHeightEstimated){let r=ls(this.beans,n);n.setRowTop(t),n.setRowHeight(r.height),t+=r.height,e=!0}};return this.bottom.forEach(i),t=0,this.top.forEach(i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return Z_(this.top)}getPinnedBottomTotalHeight(){return Z_(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){let e=t=>{let i=[];return this.forEachPinnedRow(t,n=>i.push(n.pinnedSibling.id)),i};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,i)=>{for(let n of e[i]){let r=this.beans.rowModel.getRowNode(n);r?this.pinRow(r,i):t.queue(n)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{let i=new Set;e.forEachQueued(n=>{let r=this.beans.rowModel.getRowNode(n);r&&i.add(r)});for(let n of i)e.unqueue(n.id),this.pinRow(n,t)})}pinGrandTotalRow(){let{gos:e,beans:t,_grandTotalPinned:i}=this,n=t.rowModel;if(!_t(e,n))return;let r=n.rootNode?.sibling;if(!r)return;let o=r.pinnedSibling,s=o&&this.findPinnedRowNode(o);if(i){if(s&&s.floating!==i&&(s.delete(o),hb(o)),!s||s.floating!==i){let a=Q_(t,r,i);this.getContainer(i).add(a)}}else{if(!s)return;s.delete(o),hb(o)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(i=>i.setRowHeight(i.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){let t=n=>OK(this.beans,n);if(e)return t(this.getContainer(e));let i=!1;return this.forContainers(n=>{let r=t(n);i||(i=r)}),i}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e?.dispatchRowEvent("rowPinned")}};function OK(e,t){let i=0,n=!1;return t.forEach((r,o)=>{if(n||(n=r.rowTop!==i),r.setRowTop(i),r.rowHeightEstimated||r.rowHeight==null){let s=ls(e,r).height;n||(n=r.rowHeight!==s),r.setRowHeight(s)}r.setRowIndex(o),i+=r.rowHeight}),n}function Q_(e,t,i){if(t.pinnedSibling)return t.pinnedSibling;let n=Yq(t,e);n.setRowTop(null),n.setRowIndex(null),n.rowPinned=i;let r=i==="top"?Fy:My;return n.id=`${r}${i}-${t.id}`,n.pinnedSibling=t,t.pinnedSibling=n,n}function hb(e){if(!e.pinnedSibling)return;e.rowPinned=null,e._destroy(!1);let t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function LK(e){let t=new Set;e.forEach(i=>{i.group&&t.add(i)}),t.forEach(i=>e.delete(i))}function NK(e,t,i){let{rowSpanSvc:n}=e,r=(i&&n?.isCellSpanning(i,t))??!1;if(i&&r)return n?.getCellSpan(i,t)?.spannedNodes}function Z_(e){let t=e.size();if(t===0)return 0;let i=e.getByIndex(t-1);return i===void 0?0:i.rowTop+i.rowHeight}function BK({gos:e,rowModel:t}){_t(e,t)&&t.refreshModel({step:"map"})}var eD=class extends j{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){let e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({stylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){let t=i=>{i.setRowHeight(i.rowHeight,!0)};bu(this.pinnedBottomRows,t),bu(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0,i=n=>{if(n.rowHeightEstimated){let r=ls(this.beans,n);n.setRowTop(t),n.setRowHeight(r.height),t+=r.height,e=!0}};return bu(this.pinnedBottomRows,i),t=0,bu(this.pinnedTopRows,i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){let i=this.getCache(t);if(e===void 0){i.order.length=0,i.cache={};return}let n=tc(this.gos),r=t==="top"?Fy:My,o=new Set(i.order),s=[],a=new Set,l=0,c=-1;for(let d of e){let u=n?.({data:d,level:0,rowPinned:t})??r+this.nextId++;if(a.has(u)){J(96,{id:u,data:d});continue}c++,a.add(u),s.push(u);let h=Iu(i,u);if(h!==void 0)h.data!==d&&h.updateData(d),l+=this.setRowTopAndRowIndex(h,l,c),o.delete(u);else{let p=new ds(this.beans);p.id=u,p.data=d,p.rowPinned=t,l+=this.setRowTopAndRowIndex(p,l,c),i.cache[u]=p,i.order.push(u)}}for(let d of o)Iu(i,d)?.clearRowTopAndRowIndex(),delete i.cache[d];i.order=s}setRowTopAndRowIndex(e,t,i){return e.setRowTop(t),e.setRowHeight(ls(this.beans,e).height),e.setRowIndex(i),e.rowHeight}getPinnedTopTotalHeight(){return tD(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return tD(this.pinnedBottomRows)}getPinnedTopRowCount(){return Kb(this.pinnedTopRows)}getPinnedBottomRowCount(){return Kb(this.pinnedBottomRows)}getPinnedTopRow(e){return $b(this.pinnedTopRows,e)}getPinnedBottomRow(e){return $b(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Iu(this.getCache(t),e)}forEachPinnedRow(e,t){return bu(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function tD(e){let t=Kb(e);if(t===0)return 0;let i=$b(e,t-1);return i===void 0?0:i.rowTop+i.rowHeight}function Iu(e,t){return e.cache[t]}function $b(e,t){return Iu(e,e.order[t])}function bu(e,t){e.order.forEach((i,n)=>{let r=Iu(e,i);r&&t(r,n)})}function Kb(e){return e.order.length}var HK=class extends j{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){let{gos:e}=this,t=()=>{let i=e.get("enableRowPinning"),n=gF(e),o=!!i||(n==="pinnedBottom"||n==="pinnedTop"),s=o?this.inner instanceof eD:this.inner instanceof J_;this.inner&&s&&this.destroyBean(this.inner),(s||!this.inner)&&(this.inner=this.createManagedBean(o?new J_:new eD))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,i){return this.inner.pinRow(e,t,i)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}},lm=e=>{let t=e.childrenAfterGroup;for(;t?.length;){let i=t[0];if(i.sourceRowIndex>=0)return i;t=i.childrenAfterGroup}},zK=(e,t,i,n)=>{if(!t.size||!e)return!1;let r=!1,o=e.length??0,s=-1;i&&(s=i.sourceRowIndex,i=s<0?lm(i):null,i&&(s=i.sourceRowIndex)),s<0||s>=o?s=o:n||++s;let a=s,l=Math.min(s,o-1);for(let u of t){let h=u.sourceRowIndex;h<a&&(a=h),h>l&&(l=h)}let c=a;for(let u=a;u<s;++u){let h=e[u];t.has(h)||(h.sourceRowIndex!==c&&(h.sourceRowIndex=c,e[c]=h,r=!0),++c)}let d=l;for(let u=l;u>=s;--u){let h=e[u];t.has(h)||(h.sourceRowIndex!==d&&(h.sourceRowIndex=d,e[d]=h,r=!0),--d)}for(let u of t)u.sourceRowIndex!==c&&(u.sourceRowIndex=c,e[c]=u,r=!0),++c;return r},Hg=class{constructor(){this.reordered=!1,this.removals=[],this.updates=new Set,this.adds=new Set}};function ih(e){return!!(e.rowPinned&&e.pinnedSibling)}function Dn(e,t,i,n){let r=t==="top";if(!i)return Dn(e,t,r?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),n);if(!n){let l=r?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return Dn(e,t,i,r?e.getPinnedTopRow(l-1):e.getPinnedBottomRow(l-1))}let o=!1,s=!1,a=[];return e.forEachPinnedRow(t,l=>{if(l===i&&!o){o=!0,a.push(l);return}if(o&&l===n){s=!0,a.push(l);return}o&&!s&&a.push(l)}),a}var VK={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},GK=class extends st{constructor(){super(VK,[Ry]),this.eCheckbox=ae}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){let e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:i}=this,n=t.isSelected(),r=gm(e,n),[o,s]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(o,s);i.setValue(n,!0),i.setInputAriaLabel(`${a} (${r})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getWrapperElement(),{dblclick:wa,click:n=>{wa(n),!this.eCheckbox.isDisabled()&&this.beans.selectionSvc?.handleSelectionEvent(n,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:r})=>{let o=typeof n=="object"?jw(n):void 0,s=typeof r=="object"?jw(r):void 0;o!==s&&this.onSelectableChanged()}),Ib(this.gos)||typeof this.getIsVisible()=="function"){let n=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:n}),this.addManagedListeners(this.rowNode,{dataChanged:n,cellChanged:n}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){let{column:e,rowNode:t,overrides:i,gos:n}=this,r=t.selectable,o=this.getIsVisible(),s;if(typeof o=="function"){let u=i?.callbackParams;if(!e)s=o(T(w({},u),{node:t,data:t.data}));else{let h=e.createColumnFunctionCallbackParams(t);s=o(w(w({},u),h))}}else s=o??!1;let a=r&&!s||!r&&s,l=r||s,c=n.get("rowSelection"),d=c&&typeof c!="string"?!jw(c):!!e?.getColDef().showDisabledCheckboxes;this.setVisible(l&&(a?d:!0)),this.setDisplayed(l&&(a?d:!0)),l&&this.eCheckbox.setDisabled(a),i?.removeHidden&&this.setDisplayed(l)}getIsVisible(){let e=this.overrides;if(e)return e.isVisible;let t=this.gos.get("rowSelection");return t&&typeof t!="string"?jl(t):this.column?.getColDef()?.checkboxSelection}},WK=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){let e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t,{rowModel:i,pinnedRowModel:n}=this;return t??(t=i.getRowNode(e)),n?.isManual()&&(t??(t=n.getPinnedRowById(e,"top")),t??(t=n.getPinnedRowById(e,"bottom"))),t}truncate(e){let t=this.getRange();if(t.length===0)return{keep:[],discard:[]};let i=t[0].id===this.rootId,n=t.findIndex(r=>r.id===e.id);if(n>-1){let r=t.slice(0,n),o=t.slice(n+1);return this.setEndRange(e),i?{keep:r,discard:o}:{keep:o,discard:r}}else return{keep:t,discard:[]}}extend(e,t=!1){let i=this.getRoot();if(i==null){let r=this.getRange().slice();return t&&e.depthFirstSearch(o=>!o.group&&r.push(o)),r.push(e),this.setRoot(e),{keep:r,discard:[]}}let n=this.getNodesInRange(i,e);if(!n)return this.setRoot(e),{keep:[e],discard:[]};if(n.find(r=>r.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{let r=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:r}}}getNodesInRange(e,t){let{pinnedRowModel:i,rowModel:n}=this;if(!i?.isManual())return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return Dn(i,"top",e,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){let r=Dn(i,"bottom",void 0,e),o=n.getRowCount(),s=n.getRow(o-1);return(n.getNodesInRangeForSelection(t,s)??[]).concat(r)}if(!e.rowPinned&&!t.rowPinned)return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return Dn(i,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){let r=Dn(i,"top",t,void 0),o=Dn(i,"bottom",void 0,e),s=n.getRow(0),a=n.getRow(n.getRowCount()-1);return r.concat(n.getNodesInRangeForSelection(s,a)??[]).concat(o)}if(!e.rowPinned&&t.rowPinned==="top")return Dn(i,"top",t,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){let r=Dn(i,"top",e,void 0),o=Dn(i,"bottom",void 0,t),s=n.getRow(0),a=n.getRow(n.getRowCount()-1);return r.concat(n.getNodesInRangeForSelection(s,a)??[]).concat(o)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return Dn(i,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){let r=Dn(i,"bottom",void 0,t),o=n.getRow(n.getRowCount());return(n.getNodesInRangeForSelection(e,o)??[]).concat(r)}return null}},UK=class extends j{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){let t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(bt(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;let t=this.createManagedBean(new Ey);this.cbSelectAll=t,t.addCss("ag-header-select-all"),ss(t.getGui(),"presentation"),this.showOrHideSelectAll();let i=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:i,paginationChanged:i,modelUpdated:i}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:r})=>{let o=s=>typeof s=="string"||!s||s.mode==="singleRow"?void 0:s.selectAll;o(n)!==o(r)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){let t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;let e=this.getSelectAllMode(),t=this.beans.selectionSvc,i=this.cbSelectAll,n=t.getSelectAllState(e);i.setValue(n);let r=t.hasNodesToSelect(e);i.setDisabled(!r),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){let t=this.getLocaleTextFunc(),{headerCellCtrl:i,cbSelectAll:n,cbSelectAllVisible:r}=this,o=n.getValue(),s=gm(t,o),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");i.setAriaDescriptionProperty("selectAll",r?`${a} (${s})`:null),n.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||i.announceAriaDescription()}checkSelectionType(e){return Wu(this.gos)?!0:(J(128,{feature:e}),!1)}checkRightRowModelType(e){let{gos:t,rowModel:i}=this.beans;return _t(t)||Ju(t)?!0:(J(129,{feature:e,rowModel:i.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;let e=this.cbSelectAll.getValue(),t=this.getSelectAllMode(),i="uiSelectAll";t==="currentPage"?i="uiSelectAllCurrentPage":t==="filtered"&&(i="uiSelectAllFiltered");let n={source:i,selectAll:t},r=this.beans.selectionSvc;e?r.selectAllRowNodes(n):r.deselectAllRowNodes(n)}isCheckboxSelection(){let{column:e,gos:t,beans:i}=this,o=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return T8(i,e)&&this.checkRightRowModelType(o)&&this.checkSelectionType(o)}getSelectAllMode(){let e=wF(this.gos,!1);if(e)return e;let{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:i}=this.column.getColDef();return t?"currentPage":i?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function T8({gos:e,selectionColSvc:t},i){let n=e.get("rowSelection"),r=i.getColDef(),{headerCheckboxSelection:o}=r,s=!1;if(typeof n=="object"){let l=ps(i),c=by(i);(Xg(n)==="autoGroupColumn"&&c||l&&t?.isSelectionColumnEnabled())&&(s=Ig(n))}else typeof o=="function"?s=o(_e(e,{column:i,colDef:r})):s=!!o;return s}var jK=class extends j{postConstruct(){let{gos:e,beans:t}=this;this.selectionCtx=new WK(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{let i=Ib(e);i!==this.isRowSelectable&&(this.isRowSelectable=i,this.updateSelectable())}),this.isRowSelectable=Ib(e),this.addManagedEventListeners({cellValueChanged:i=>this.updateRowSelectable(i.node),rowNodeDataChanged:i=>this.updateRowSelectable(i.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new GK}createSelectAllFeature(e){if(T8(this.beans,e))return new UK(e)}isMultiSelect(){return Wu(this.gos)}onRowCtrlSelected(e,t,i){let n=!!e.rowNode.isSelected();e.forEachGui(i,r=>{r.rowComp.toggleCss("ag-row-selected",n);let o=r.element;jD(o,n),o.contains(bt(this.beans))&&t(r)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;let t=e.isSelected(),i=this.beans.editSvc?.isEditing({rowNode:e});if(!e.selectable||i)return;let r=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(r,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!ih(e)||!ua(this.gos)}updateRowSelectable(e,t){let i=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,i,t),i}setRowSelectable(e,t,i){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),i)return;if(Uu(this.gos)){let r=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:r??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,i=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let n=0;n<e.childrenAfterGroup.length;n++){let r=e.childrenAfterGroup[n],o=r.isSelected();if(!r.selectable){let s=this.calculateSelectedFromChildren(r);if(s===null)continue;o=s}switch(o){case!0:t=!0;break;case!1:i=!0;break;default:return}}if(!(t&&i))return t?!0:i?!1:e.selectable?e.__selected:null}selectRowNode(e,t,i,n="api"){if(t&&e.destroyed)return!1;let r=!e.selectable&&t,o=e.__selected===t;if(r||o)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");let s=e.sibling;s&&s.footer&&s.__localEventService&&s.dispatchRowEvent("rowSelected");let a=e.pinnedSibling;return a?.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent(T(w({},$q(e,this.gos,"rowSelected")),{event:i||null,source:n})),!0}isCellCheckboxSelection(e,t){let i=this.gos.get("rowSelection");if(i&&typeof i!="string"){let n=ps(e)&&jl(i);return e.isColumnFunc(t,n)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,i,n){let{gos:r,selectionCtx:o}=this,s=e.isSelected(),a=Uu(r),l=nU(r),c=rU(r),d=this.isMultiSelect(),u=n==="rowClicked";if(u&&!(l||c))return null;if(t&&i&&d){let h=o.getRoot();if(h)if(h.isSelected()){let p=o.isInRange(e)?o.truncate(e):o.extend(e,a);return{deselect:p.discard,select:p.keep,reset:!1}}else{let p=o.extend(e,a);return{select:[],deselect:p.keep,reset:!1}}else return null}else if(t&&d){let h=o.selectAll?this.beans.rowModel.getRow(0):void 0,p=o.getRoot(h),f=o.isInRange(e)?o.truncate(e):o.extend(e,a);return{select:f.keep,deselect:f.discard,reset:o.selectAll||!!(p&&!p.isSelected())}}else if(i){if(u){let h=!s;return h&&!l||!h&&!c?null:(o.setRoot(e),{node:e,newValue:h,clearSelection:!1})}return o.setRoot(e),{node:e,newValue:!s,clearSelection:!d}}else{o.setRoot(e);let h=oU(r),p=Qg(r)==="filteredDescendants",f=u&&(!h||!l);if(p&&s===void 0&&_t(r))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!d||f};if(u){let g=s?!h:l;return g===s&&!f||g&&!l||!g&&!c?null:{node:e,newValue:g,clearSelection:!d||f,keepDescendants:e.group&&a}}return{node:e,newValue:!s,clearSelection:!d||f}}}},I8=class extends Uq{initialiseTabGuard(e){super.initialiseTabGuard(e,g8)}};var qK=500,$K=550,Rg,KK=e=>{if(!Rg)Rg=new WeakSet;else if(Rg.has(e))return!1;return Rg.add(e),!0},aa=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let i=this.eventSvc;if(!i){if(i===null)return;this.eventSvc=i=new ma;let n=this.onTouchStart.bind(this);this.startListener=n,this.eElement.addEventListener("touchstart",n,{passive:!0})}i.addEventListener(e,t)}removeEventListener(e,t){this.eventSvc?.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!KK(e))return;let t=e.touches[0];this.touchStart=t;let i=this.handlers;if(!i.length){let n=this.eElement,r=n.ownerDocument,o=this.onTouchMove.bind(this),s=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},c={passive:!1};Fg(i,[n,"touchmove",o,l],[r,"touchcancel",a,l],[r,"touchend",s,c],[r,"contextmenu",Al,c])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,this.eventSvc?.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},$K)}onTouchMove(e){let{moved:t,touchStart:i}=this;if(!t&&i){let n=zl(i,e.touches);n&&!eF(n,i,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){let t=this.touchStart;!t||!zl(t,e.changedTouches)||(this.moved||(this.eventSvc?.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&Al(e),this.cancel())}onTouchCancel(e){let t=this.touchStart;!t||!zl(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){let t=Date.now(),i=this.lastTapTime;i&&t-i>qK&&(this.eventSvc?.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),fy(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){let e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}};var Gy=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${nF}/${this.frameworkName}-data-grid`,jW(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function YK(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var XK=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],iD=Object.fromEntries(XK.map((e,t)=>[e,t]));function JK(e,t){let i=(e.beanName?iD[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,n=(t.beanName?iD[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return i-n}function QK(e,t){return e?.beanName==="gridDestroySvc"?-1:t?.beanName==="gridDestroySvc"?1:0}var ZK={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},eY={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},tY={tag:"div",cls:"ag-header-viewport",role:"rowgroup",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"presentation"}]},pb=class extends st{constructor(e){super(),this.eCenterContainer=ae,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();let e={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{let n=this.getGui();n.style.width=i,n.style.maxWidth=i,n.style.minWidth=i}};this.createManagedBean(new gK(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){let e=this.pinned=="left",t=this.pinned=="right",i=e?ZK:t?eY:tY;this.setTemplate(i),this.eRowContainer=this.eCenterContainer!==ae?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),e.getGui().remove()}setCtrls(e){let t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i,n=r=>{let o=r.getGui();o.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(o),i&&YD(this.eRowContainer,o,i),i=o};for(let r of e){let o=r.instanceId,s=t[o];delete t[o];let a=s||this.createBean(new uK(r));this.headerRowComps[o]=a,this.rowCompsList.push(a),n(a)}for(let r of Object.values(t))this.destroyRowComp(r)}},iY={tag:"div",cls:"ag-header",role:"presentation"},nY=class extends st{constructor(){super(iY)}postConstruct(){let e={toggleCss:(n,r)=>this.toggleCss(n,r),setHeightAndMinHeight:n=>{this.getGui().style.height=n,this.getGui().style.minHeight=n}};this.createManagedBean(new rK).setComp(e,this.getGui(),this.getFocusableElement());let i=n=>{this.createManagedBean(n),this.appendChild(n)};i(new pb("left")),i(new pb(null)),i(new pb("right"))}},rY={selector:"AG-HEADER-ROOT",component:nY},oY=class extends st{constructor(e,t,i,n,r){super(),this.cellCtrl=t,this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.gos=e.gos,this.column=t.column,this.rowNode=t.rowNode,this.eRow=n;let o=Xt({tag:"div",role:t.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":t.column.colIdSanitised}});this.eCell=o;let s;t.isCellSpanning()?(s=Xt({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),s.appendChild(o),this.setTemplateFromElement(s)):this.setTemplateFromElement(o),this.cellCssManager=new LF(()=>o),this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);let a={toggleCss:(l,c)=>this.cellCssManager.toggleCss(l,c),setUserStyles:l=>Xu(o,l),getFocusableElement:()=>o,setIncludeSelection:l=>this.includeSelection=l,setIncludeRowDrag:l=>this.includeRowDrag=l,setIncludeDndSource:l=>this.includeDndSource=l,setRenderDetails:(l,c,d)=>this.setRenderDetails(l,c,d),setEditDetails:(l,c,d)=>this.setEditDetails(l,c,d),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue(),refreshEditStyles:(l,c)=>this.refreshEditStyles(l,c)};t.setComp(a,o,s,this.eCellWrapper,i,r,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(e,t,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;let r=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(i||r)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)),this.rowDraggingComp?.refreshVisibility()}setEditDetails(e,t,i){e?this.createCellEditorInstance(e,t,i):this.destroyEditor()}removeControls(){let e=this.beans.context;this.checkboxSelectionComp=e.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=e.destroyBean(this.dndSourceComp),this.rowDraggingComp=e.destroyBean(this.rowDraggingComp)}refreshWrapper(e){let t=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=t||this.forceWrapper,n=i&&this.eCellWrapper==null;n&&(this.eCellWrapper=Xt({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));let r=!i&&this.eCellWrapper!=null;r&&(Wi(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssManager.toggleCss("ag-cell-value",!i);let o=!e&&i,s=o&&this.eCellValue==null;if(s){let c=this.cellCtrl.getCellValueClass();this.eCellValue=Xt({tag:"span",cls:c,role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue)}let a=!o&&this.eCellValue!=null;a&&(Wi(this.eCellValue),this.eCellValue=void 0);let l=n||r||s||a;return l&&this.removeControls(),!e&&t&&this.addControls(),l}addControls(){let{cellCtrl:e,eCellWrapper:t,eCellValue:i,includeRowDrag:n,includeDndSource:r,includeSelection:o}=this,s=a=>{a&&t.insertBefore(a.getGui(),i)};n&&this.rowDraggingComp==null&&(this.rowDraggingComp=e.createRowDragComp(),s(this.rowDraggingComp)),r&&this.dndSourceComp==null&&(this.dndSourceComp=e.createDndSource(),s(this.dndSourceComp)),o&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=e.createSelectionCheckbox(),s(this.checkboxSelectionComp))}createCellEditorInstance(e,t,i){let n=this.editorVersion,r=e.newAgStackInstance(),{params:o}=e;r.then(a=>this.afterCellEditorCreated(n,a,o,t,i)),mt(this.cellEditor)&&o.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){let t=this.getParentOfValue();ii(t);let i=ac(e);i!=null&&(t.textContent=i)}destroyRenderer(){let{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),Wi(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){let{context:e}=this.beans;(this.cellEditorPopupWrapper?.getGui().contains(bt(this.beans))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),this.hideEditorPopup?.(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),Wi(this.cellEditorGui),this.cellCtrl.disableEditorTooltipFeature(),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(this.cellRenderer?.refresh==null||this.cellRendererClass!==e.componentClass)return!1;let t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){let t=this.rendererVersion,i=o=>s=>{if(this.rendererVersion!==t||!this.isAlive())return;let l=o.newAgStackInstance(),c=this.afterCellRendererCreated.bind(this,t,o.componentClass);l?.then(c)},{animationFrameSvc:n}=this.beans,r;if(n?.active&&this.firstRender?r=(o,s=!1)=>{n.createTask(i(o),this.rowNode.rowIndex,"p2",o.componentFromFramework,s)}:r=o=>i(o)(),e.params?.deferRender&&!this.cellCtrl.rowNode.group){let{loadingComp:o,onReady:s}=this.cellCtrl.getDeferLoadingCellRenderer();o&&(r(o),s.then(()=>r(e,!0)))}else r(e)}afterCellRendererCreated(e,t,i){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(i);return}this.cellRenderer=i,this.cellRendererClass=t;let r=i.getGui();if(this.cellRendererGui=r,r!=null){let o=this.getParentOfValue();ii(o),o.appendChild(r)}}afterCellEditorCreated(e,t,i,n,r){let o=e!==this.editorVersion,{context:s}=this.beans;if(o){s.destroyBean(t);return}if(t.isCancelBeforeStart?.()){s.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){J(97,{colId:this.column.getId()}),s.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();let l=n||t.isPopup?.();l?this.addPopupCellEditor(i,r):this.addInCellEditor(),this.refreshEditStyles(!0,l),t.afterGuiAttached?.(),this.cellCtrl.enableEditorTooltipFeature(t),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){let{cellCssManager:i}=this;i.toggleCss("ag-cell-inline-editing",e&&!t),i.toggleCss("ag-cell-popup-editing",e&&!!t),i.toggleCss("ag-cell-not-inline-editing",!e||!!t)}addInCellEditor(){let{eCell:e}=this;e.contains(bt(this.beans))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),ii(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){let{gos:i,context:n,popupSvc:r,editSvc:o}=this.beans;i.get("editType")==="fullRow"&&J(98);let s=this.cellEditorPopupWrapper=n.createBean(o.createPopupEditorWrapper(e)),{cellEditor:a,cellEditorGui:l,eCell:c,rowNode:d,column:u,cellCtrl:h}=this,p=s.getGui();l&&p.appendChild(l);let f=i.get("stopEditingWhenCellsLoseFocus"),g=t??a.getPopupPosition?.()??"over",m=i.get("enableRtl"),v={ePopup:p,additionalParams:{column:u,rowNode:d},type:"popupCellEditor",eventSource:c,position:g,alignSide:m?"right":"left",keepWithinBounds:!0},C=r.positionPopupByComponent.bind(r,v),b=r.addPopup({modal:f,eChild:p,closeOnEsc:!0,closedCallback:()=>{h.onPopupEditorClosed()},anchorToElement:c,positionCallback:C,ariaOwns:c});b&&(this.hideEditorPopup=b.hideFunc)}detach(){this.getGui().remove()}destroy(){this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},sY=class extends st{constructor(e,t,i){super(),this.cellComps=new Map,this.beans=t,this.rowCtrl=e;let n=Xt({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(n,i),this.setTemplateFromElement(n);let r=n.style;this.domOrder=this.rowCtrl.getDomOrder();let o={setDomOrder:s=>this.domOrder=s,setCellCtrls:s=>this.setCellCtrls(s),showFullWidth:s=>this.showFullWidth(s),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,getFullWidthCellRendererParams:()=>this.fullWidthCellRendererParams,toggleCss:(s,a)=>this.toggleCss(s,a),setUserStyles:s=>Xu(n,s),setTop:s=>r.top=s,setTransform:s=>r.transform=s,setRowIndex:s=>n.setAttribute("row-index",s),setRowId:s=>n.setAttribute("row-id",s),setRowBusinessKey:s=>n.setAttribute("row-business-key",s),refreshFullWidth:s=>{let a=s();return this.fullWidthCellRendererParams=a,this.fullWidthCellRenderer?.refresh?.(a)??!1}};e.setComp(o,this.getGui(),i,void 0),this.addDestroyFunc(()=>{e.unsetComp(i)})}setInitialStyle(e,t){let i=this.rowCtrl.getInitialTransform(t);if(i)e.style.setProperty("transform",i);else{let n=this.rowCtrl.getInitialRowTop(t);n&&e.style.setProperty("top",n)}}showFullWidth(e){let t=n=>{if(this.isAlive()){let r=n.getGui();this.getGui().appendChild(r),this.rowCtrl.setupDetailRowAutoHeight(r),this.setFullWidthRowComp(n,e.params)}else this.beans.context.destroyBean(n)};e.newAgStackInstance().then(t)}setCellCtrls(e){let t=new Map(this.cellComps);for(let i of e){let n=i.instanceId;this.cellComps.has(n)?t.delete(n):this.newCellComp(i)}this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;let t=[];for(let i of e){let n=this.cellComps.get(i.instanceId);n&&t.push(n.getGui())}XD(this.getGui(),t)}newCellComp(e){let t=this.beans.editSvc?.isEditing(e,{withOpenEditor:!0})??!1,i=new oY(this.beans,e,this.rowCtrl.printLayout,this.getGui(),t);this.cellComps.set(e.instanceId,i),this.getGui().appendChild(i.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(e,t){this.fullWidthCellRenderer=e,this.fullWidthCellRendererParams=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer),this.fullWidthCellRendererParams=void 0})}destroyCells(e){for(let t of e.values()){if(!t)return;let i=t.cellCtrl.instanceId;if(this.cellComps.get(i)!==t)return;t.detach(),t.destroy(),this.cellComps.delete(i)}}};function aY(e,t,i){let n=!!i.gos.get("enableCellSpan")&&!!t.getSpannedRowCtrls,r={tag:"div",ref:"eContainer",cls:Bg(e),role:"rowgroup"};if(t.type==="center"||n){let o={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${w$(e)}`,role:"presentation"};return r.role="presentation",{tag:"div",ref:"eViewport",cls:`ag-viewport ${b8(e)}`,role:"rowgroup",children:[r,n?o:null]}}return r}var lY=class extends st{constructor(e){super(),this.eViewport=ae,this.eContainer=ae,this.eSpannedContainer=ae,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=e?.name,this.options=eh(this.name)}postConstruct(){this.setTemplate(aY(this.name,this.options,this.beans));let e={setHorizontalScroll:i=>this.eViewport.scrollLeft=i,setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setSpannedRowCtrls:i=>this.setRowCtrls(i,!0),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>{this.eContainer.style.width=i,this.eSpannedContainer&&(this.eSpannedContainer.style.width=i)},setOffsetTop:i=>{let n=`translateY(${i})`;this.eContainer.style.transform=n,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=n)}};this.createManagedBean(new D$(this.name)).setComp(e,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(e,t){let{beans:i,options:n}=this,r=t?this.eSpannedContainer:this.eContainer,o=t?w({},this.rowCompsWithSpan):w({},this.rowCompsNoSpan),s={};t?this.rowCompsWithSpan=s:this.rowCompsNoSpan=s,this.lastPlacedElement=null;let a=[];for(let l of e){let c=l.instanceId,d=o[c],u;if(d)u=d,delete o[c];else{if(!l.rowNode.displayed)continue;u=new sY(l,i,n.type)}s[c]=u,a.push([u,!d])}this.removeOldRows(Object.values(o)),this.addRowNodes(a,r)}addRowNodes(e,t){let{domOrder:i}=this;for(let[n,r]of e){let o=n.getGui();i?this.ensureDomOrder(o,t):r&&t.appendChild(o)}}removeOldRows(e){for(let t of e)t.getGui().remove(),t.destroy()}ensureDomOrder(e,t){YD(t,e,this.lastPlacedElement),this.lastPlacedElement=e}},cY={selector:"AG-ROW-CONTAINER",component:lY};function yu(e,t){return t.map(i=>{let n=`e${i[0].toUpperCase()+i.substring(1)}RowContainer`;return e[n]={name:i},{tag:"ag-row-container",ref:n,attrs:{name:i}}})}function dY(e){let t={},i={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:yu(t,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:yu(t,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:yu(t,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:yu(t,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:yu(t,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},e?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:t,elementParams:i}}var uY=class extends st{constructor(){super(...arguments),this.eGridRoot=ae,this.eBodyViewport=ae,this.eStickyTop=ae,this.eStickyBottom=ae,this.eTop=ae,this.eBottom=ae,this.eBody=ae}postConstruct(){let{overlays:e,rangeSvc:t}=this.beans,i=e?.getOverlayWrapperSelector(),{paramsMap:n,elementParams:r}=dY(!!i);this.setTemplate(r,[...i?[i]:[],L$,H$,rY,cY],n);let o=(a,l)=>{let c=`${a}px`;l.style.minHeight=c,l.style.height=c},s={setRowAnimationCssOnBodyViewport:(a,l)=>this.setRowAnimationCssOnBodyViewport(a,l),setColumnCount:a=>aW(this.getGui(),a),setRowCount:a=>oW(this.getGui(),a),setTopHeight:a=>o(a,this.eTop),setBottomHeight:a=>o(a,this.eBottom),setTopInvisible:a=>this.eTop.classList.toggle("ag-invisible",a),setBottomInvisible:a=>this.eBottom.classList.toggle("ag-invisible",a),setStickyTopHeight:a=>this.eStickyTop.style.height=a,setStickyTopTop:a=>this.eStickyTop.style.top=a,setStickyTopWidth:a=>this.eStickyTop.style.width=a,setStickyBottomHeight:a=>{this.eStickyBottom.style.height=a,this.eStickyBottom.classList.toggle("ag-invisible",a==="0px")},setStickyBottomBottom:a=>this.eStickyBottom.style.bottom=a,setStickyBottomWidth:a=>this.eStickyBottom.style.width=a,setColumnMovingCss:(a,l)=>this.toggleCss(a,l),updateLayoutClasses:(a,l)=>{let c=[this.eBodyViewport.classList,this.eBody.classList];for(let d of c)d.toggle(Un.AUTO_HEIGHT,l.autoHeight),d.toggle(Un.NORMAL,l.normal),d.toggle(Un.PRINT,l.print);this.toggleCss(Un.AUTO_HEIGHT,l.autoHeight),this.toggleCss(Un.NORMAL,l.normal),this.toggleCss(Un.PRINT,l.print)},setAlwaysVerticalScrollClass:(a,l)=>this.eBodyViewport.classList.toggle(x8,l),registerBodyViewportResizeListener:a=>{let l=us(this.beans,this.eBodyViewport,a);this.addDestroyFunc(()=>l())},setPinnedTopBottomOverflowY:a=>this.eTop.style.overflowY=this.eBottom.style.overflowY=a,setCellSelectableCss:(a,l)=>{for(let c of[this.eTop,this.eBodyViewport,this.eBottom])c.classList.toggle(a,l)},setBodyViewportWidth:a=>this.eBodyViewport.style.width=a,setGridRootRole:a=>ss(this.eGridRoot,a)};this.ctrl=this.createManagedBean(new T$),this.ctrl.setComp(s,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(t&&ho(this.gos)||Wu(this.gos))&&rW(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){let i=this.eBodyViewport.classList;i.toggle("ag-row-animation",t),i.toggle("ag-row-no-animation",!t)}},hY={selector:"AG-GRID-BODY",component:uY},pY=class extends j{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.beans.context.getId());let{dragAndDrop:n,ctrlsSvc:r}=this.beans;n?.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new Iy(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");let o=us(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>o()),r.register("gridCtrl",this)}isDetailGrid(){return qF(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){let e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry?.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){let{view:t}=this;if(e===!1)t.setCursor(null);else{let i=e===1?"ew-resize":"ns-resize";t.setCursor(i)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){let t=this.getFocusableContainers(),{indexWithFocus:i,nextIndex:n}=this.getNextFocusableIndex(t,e);if(n<0||n>=t.length)return!1;if(n===0){if(i>0){let{visibleCols:r,focusSvc:o}=this.beans,s=r.allCols,a=dt(s);if(o.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[n],e)}focusInnerElement(e){if(this.gos.getCallback("focusGridInnerElement")?.({fromBottom:!!e}))return!0;let i=this.getFocusableContainers(),{focusSvc:n,visibleCols:r}=this.beans,o=r.allCols;if(e){if(i.length>1)return this.focusContainer(dt(i),e);let s=dt(o);if(n.focusGridView({column:s,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||fa(this.beans)){if(n.focusGridView({column:o[0],backwards:e}))return!0;for(let s=1;s<i.length;s++)if(Ca(i[s].getGui(),e))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){let t=this.view.getFocusableContainers(),{nextIndex:i}=this.getNextFocusableIndex(t,e),n=t[i];n?this.focusContainer(n):this.forceFocusOutOfContainer(e)}isFocusable(){let e=this.beans;return!xm(e)||!fa(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){let i=bt(this.beans),n=e.findIndex(o=>o.getGui().contains(i)),r=n+(t?-1:1);return{indexWithFocus:n,nextIndex:r}}focusContainer(e,t){e.setAllowFocus?.(!0);let i=Ca(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),i}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},fY=class extends I8{constructor(e){super(),this.gridBody=ae,this.sideBar=ae,this.pagination=ae,this.rootWrapperBody=ae,this.eGridDiv=e}postConstruct(){let e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:o=>this.addCss(o),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:o=>{this.getGui().style.userSelect=o??"",this.getGui().style.webkitUserSelect=o??""},setCursor:o=>{this.getGui().style.cursor=o??""}},t=this.createManagedBean(new pY),i=t.getOptionalSelectors(),n=this.createTemplate(i),r=[hY,...Object.values(i).filter(o=>!!o)];this.setTemplate(n,r),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>t.focusInnerElement(o),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!t.isFocusable()})}insertGridIntoDom(){let e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{e.remove(),as(this.gos,"Grid removed from DOM")})}updateLayoutClasses(e,t){let i=this.rootWrapperBody.classList,{AUTO_HEIGHT:n,NORMAL:r,PRINT:o}=Un,{autoHeight:s,normal:a,print:l}=t;i.toggle(n,s),i.toggle(r,a),i.toggle(o,l),this.toggleCss(n,s),this.toggleCss(r,a),this.toggleCss(o,l)}createTemplate(e){let t=e.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,i=e.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,n=e.statusBarSelector?{tag:"ag-status-bar"}:null,r=e.watermarkSelector?{tag:"ag-watermark"}:null,o=e.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[t,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},i]},n,o,r]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){if(!e&&this.pagination?.isDisplayed()){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){let e=[this.gridBody];for(let t of[this.sideBar,this.pagination])t&&e.push(t);return e.filter(t=>Ir(t.getGui()))}},Fe=(e,t)=>{for(let i of Object.keys(t))t[i]=e;return t},nD=w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w(w({dispatchEvent:"CommunityCore"},Fe("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0})),Fe("GridState",{getState:0,setState:0})),Fe("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0})),Fe("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0})),Fe("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0})),Fe("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0})),Fe("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0})),Fe("ValueCache",{expireValueCache:0})),Fe("CellApi",{getCellValue:0})),Fe("SharedMenu",{showColumnMenu:0,hidePopupMenu:0})),Fe("Sort",{onSortChanged:0})),Fe("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0})),Fe("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0})),Fe("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0})),Fe("HighlightChanges",{flashCells:0})),Fe("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0})),Fe("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0})),Fe("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0})),Fe("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0})),Fe("ColumnMove",{moveColumnByIndex:0,moveColumns:0})),Fe("ColumnResize",{setColumnWidths:0})),Fe("ColumnHover",{isColumnHovered:0})),Fe("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0})),Fe("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0})),Fe("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0})),Fe("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0})),Fe("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0})),Fe("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0})),Fe("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0})),Fe("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0})),Fe("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0})),Fe("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0})),Fe("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0})),Fe("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0})),Fe("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0})),Fe("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0})),Fe("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0})),Fe("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0})),Fe("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0})),Fe("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0})),Fe("ContextMenu",{showContextMenu:0})),Fe("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0})),Fe("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0})),Fe("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0})),Fe("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0})),Fe("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0})),Fe("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0})),Fe("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0})),Fe("StatusBar",{getStatusPanel:0})),Fe("AiToolkit",{getStructuredSchema:0})),fb={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},gY=(e,t)=>e.eventSvc.dispatchEvent(t),A8=class{};Reflect.defineProperty(A8,"name",{value:"GridApi"});var mY=class extends j{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new A8,this.fns=T(w({},fb),{dispatchEvent:gY}),this.preDestroyLink="";let{api:e}=this;for(let t of Object.keys(nD))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){let{fns:i,beans:n}=this;i!==fb&&(i[e]=n?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{let{beans:i,fns:{[e]:n}}=this;return n?n(i,...t):this.apiNotFound(e)}}}apiNotFound(e){let{beans:t,gos:i,preDestroyLink:n}=this;if(!t)J(26,{fnName:e,preDestroyLink:n});else{let r=nD[e];i.assertModuleRegistered(r,`api.${e}`)&&J(27,{fnName:e,module:r})}}destroy(){super.destroy(),this.fns=fb,this.beans=null}};function vY(e){return e.context.getId()}function CY(e){e.gridDestroySvc.destroy()}function wY(e){return e.gridDestroySvc.destroyCalled}function bY(e,t){return e.gos.get(t)}function yY(e,t,i){O8(e,{[t]:i})}function O8(e,t){e.gos.updateGridOptions({options:t})}function SY(e,t){let i=t.replace(/Module$/,"");return e.gos.isModuleRegistered(i)}var xY={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},EY=class extends st{constructor(e,t,i){super(xY),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(ji("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){let{rowNode:t,column:i,eCell:n,gos:r}=this,o=i.getColDef().dndSourceOnRowDrag,s=e.dataTransfer;if(s.setDragImage(n,0,0),o){let a=_e(r,{rowNode:t,dragEvent:e});o(a)}else try{let a=JSON.stringify(t.data);s.setData("application/json",a),s.setData("text/plain",a)}catch{}}checkVisibility(){let e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function RY(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function PY(e,t){let i=e.dragAndDrop?.findExternalZone(t.getContainer());i&&e.dragAndDrop?.removeDropTarget(i)}function kY(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}function _Y(e){let t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function DY(e,t){let i=e.rowDropHighlightSvc;if(!i)return;let n=t?.row,r=t?.dropIndicatorPosition;r!=="above"&&r!=="below"&&r!=="inside"&&(r="none");let o=n?.rowIndex;o==null||r==="none"?i.clear():i.set(n,r)}var FY=class extends Vq{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},MY=class extends j{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){let t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:i}=this.beans;return i.addDragSource(t),()=>i.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();let i=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(i)}setResizeIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},TY={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},Pg={skipAriaHidden:!0},IY=class extends st{constructor(e,t,i,n,r,o=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=n,this.dragStartPixels=r,this.alwaysVisible=o,this.dragSource=null,this.disabled=!1}isCustomGui(){return this.customGui!=null}postConstruct(){let{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate(TY),this.getGui().appendChild(ji("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){let{beans:e,rowNode:t}=this,i=this.refreshVisibility.bind(this);this.addManagedListeners(e.eventSvc,{rowDragVisibilityChanged:i}),this.addManagedListeners(t,{dataChanged:i,cellChanged:i}),this.refreshVisibility()}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;let{beans:e,column:t,rowNode:i}=this,{gos:n,dragAndDrop:r,rowDragSvc:o}=e,s=o?.visibility,l=!(s==="suppress"||s==="hidden"&&!r?.hasExternalDropZones()),c=l;if(l&&!this.isCustomGui()&&t){let d=t.getColDef().rowDrag;if(d===!1)l=!1;else{let u=typeof d=="function";c=t.isRowDrag(i),l=u||c}}l&&c&&i.footer&&n.get("rowDragManaged")&&(c=!1,l=!0),c&&(c=l),l||this.setDisplayed(l,Pg),c||this.setVisible(c,Pg),this.setDisabled(!c||s==="disabled"&&!r?.hasExternalDropZones()),l&&this.setDisplayed(l,Pg),c&&this.setVisible(c,Pg)}setDisabled(e){e!==this.disabled&&(this.disabled=e,this.getGui()?.classList?.toggle("ag-drag-handle-disabled",e))}getSelectedNodes(){let e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];let i=this.beans.selectionSvc?.getSelectedNodes()??[];return i.indexOf(e)!==-1?i:[e]}getDragItem(){let{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;let t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:n=>{n?.preventDefault()}})[0]);let i=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:n=>this.getDragItemName(n,i),getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}getDragItemName(e,t){let i=e?.dragItem||this.getDragItem(),n=(e?.dropTarget?.rows.length??i.rowNodes?.length)||1,r=this.column?.getColDef()?.rowDragText??this.gos.get("rowDragText");if(r)return r(i,n);if(n!==1)return`${n} ${t("rowDragRows","rows")}`;let o=this.cellValueFn();return o||`1 ${t("rowDragRow","rows")}`}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},Ku=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){let{rowNode:i,children:n}=e;if(n)for(let r=0;r<n.length;++r)this.depthFirstSearchChangedPath(n[r],t);t(i)}depthFirstSearchEverything(e,t,i){let n=e.childrenAfterGroup;if(n)for(let r=0,o=n.length;r<o;++r){let s=n[r];s.childrenAfterGroup?this.depthFirstSearchEverything(s,t,i):i&&t(s)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){let n={rowNode:t,children:null};this.mapToItems[t.id]=n,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;){this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={});for(let n of t)this.nodeIdsToColumns[i.id][n.getId()]=!0;i=i.parent}}linkPathItems(e,t){let i=e;for(let n=0;n<t;n++){let r=this.mapToItems[i.id],o=this.mapToItems[i.parent.id];o.children||(o.children=[]),o.children.push(r),i=i.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;let i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;let i=this.nodeIdsToColumns[e.id];return t.filter(r=>i[r.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;let i=this.nodeIdsToColumns[e.id];return t.filter(r=>!i[r.getId()])}},AY=.25,OY=class extends j{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.autoScroll=null,this.autoScrollChanged=!1,this.autoScrollChanging=!1,this.autoScrollOldV=null}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,t=>{let i=()=>t.gridBodyCtrl.scrollFeature.getVScrollPosition().top,n=new Fj({scrollContainer:t.gridBodyCtrl.eBodyViewport,scrollAxis:"y",getVerticalPosition:i,setVerticalPosition:r=>t.gridBodyCtrl.scrollFeature.setVerticalScrollPosition(r),onScrollCallback:()=>{let r=i();if(this.autoScrollOldV!==r){this.autoScrollOldV=r,this.autoScrollChanging=!0;return}let o=this.autoScrollChanging;this.autoScrollChanged=o,this.autoScrollChanging=!1,o&&(e.dragAndDrop?.nudge(),this.autoScrollChanged=!1)}});this.autoScroll=n,this.clearAutoScroll()})}destroy(){super.destroy(),this.clearAutoScroll(),this.autoScroll=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){return e?.dropTarget?.allowed===!1||this.beans.rowDragSvc.visibility!=="visible"?"notAllowed":"move"}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];let t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){let i=this.beans.selectionSvc?.getSelectedNodes();if(i&&i.indexOf(t)>=0)return i.slice().sort(LY)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){let{lastDraggingEvent:i,beans:n}=this;if(t){let a=this.getRowNodes(e);e.dragItem.rowNodes=a,oD(a,!0)}this.lastDraggingEvent=e;let r=e.fromNudge,o=this.makeRowsDrop(i,e,r,!1);n.rowDropHighlightSvc?.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e);let s=this.autoScroll;o?.rowDragManaged&&o.moved&&o.allowed&&o.sameGrid&&!o.suppressMoveWhenRowDragging&&(!r&&!s?.scrolling||this.autoScrollChanged)&&this.dropRows(o),s?.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,i,n){let{beans:r,gos:o}=this,s=this.newRowsDrop(t,n),a=r.rowModel;if(t.dropTarget=s,t.changed=!1,!s)return null;let{sameGrid:l,rootNode:c,source:d,target:u}=s;u??(u=a.getRow(a.getRowCount()-1)??null);let h=this.beans.groupEditSvc,p=!!h?.canSetParent(s),f=null;if(u?.footer){let m=Wb(a,-1,u)??Wb(a,1,u);p&&(f=u.sibling??c),u=m??null}u?.detail&&(u=u.parent),s.moved&&(s.moved=d!==u);let g=.5;if(u&&(l&&s.moved&&(f||!p)?g=d.rowIndex>u.rowIndex?-.5:.5:g=(s.y-u.rowTop-u.rowHeight/2)/u.rowHeight||0),!p&&l&&u&&s.moved&&_t(o)){let m=NY(a,s);m&&(g=d.rowIndex>m.rowIndex?-.5:.5,u=m,s.moved&&(s.moved=d!==u))}return s.target=u,s.newParent=f,s.pointerPos=BY(u,s.y),s.yDelta=g,h?.fixRowsDrop(s,p,i,g),this.validateRowsDrop(s,p,n),t.changed||(t.changed=rD(e?.dropTarget,s)),s}newRowsDrop(e,t){let{beans:i,gos:n}=this,r=i.rowModel.rootNode,o=_t(n)?n.get("rowDragManaged"):!1,s=n.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(e),{rowNode:l,rowNodes:c}=e.dragItem;if(c||(c=l?[l]:[]),l||(l=c[0]),!l||!r)return null;let d=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e),u=!0;o&&(!c.length||i.rowDragSvc.visibility!=="visible"||(s||!a)&&!d)&&(u=!1);let h=j_(i,e).y,p=this.getOverNode(h);return{api:i.gridApi,context:i.gridOptions.context,draggingEvent:e,rowDragManaged:o,suppressMoveWhenRowDragging:s,sameGrid:a,withinGrid:d,treeData:!1,rootNode:r,moved:l!==p,y:h,overNode:p,overIndex:p?.rowIndex??-1,pointerPos:"none",position:"none",source:l,target:p??null,newParent:null,rows:c,allowed:u,highlight:!t&&o&&s&&(d||!a),yDelta:0,inside:!1,droppedManaged:!1}}validateRowsDrop(e,t,i){let{source:n,target:r,yDelta:o,inside:s,moved:a,rowDragManaged:l,suppressMoveWhenRowDragging:c}=e;e.moved&&(e.moved=n!==r);let{position:d,fallbackPosition:u}=this.computeDropPosition(a,s,o);e.position=d,t||(e.newParent=null),this.enforceSuppressMoveWhenRowDragging(e,c,"initial");let h=(!l||e.allowed)&&this.gos.get("isRowValidDropPosition");h&&this.applyDropValidator(e,t,i,l,h),l&&(e.rows=this.filterRows(e)),this.beans.groupEditSvc?.clearNewSameParent(e,t),this.enforceSuppressMoveWhenRowDragging(e,c,"final"),e.position==="inside"&&(!e.allowed||!e.newParent)&&(e.position=u)}computeDropPosition(e,t,i){let n=i<0?"above":"below";return e?{position:t?"inside":n,fallbackPosition:n}:{position:"none",fallbackPosition:n}}enforceSuppressMoveWhenRowDragging(e,t,i){if(t){if(i==="initial"){e.moved||(e.allowed=!1);return}(!e.rows.length||e.position==="none")&&(e.allowed=!1)}}applyDropValidator(e,t,i,n,r){this.beans.groupEditSvc?.clearNewSameParent(e,t);let o=r(e);if(!o){e.allowed=!1;return}if(typeof o!="object")return;o.rows!==void 0&&(e.rows=o.rows??[]),t&&o.newParent!==void 0&&(e.newParent=o.newParent),o.target!==void 0&&(e.target=o.target),o.position&&(e.position=o.position),o.allowed!==void 0?e.allowed=o.allowed:n||(e.allowed=!0);let s=e.draggingEvent;o.changed&&s&&(s.changed=!0),!i&&o.highlight!==void 0&&(e.highlight=o.highlight)}addRowDropZone(e){if(!e.getContainer()){J(55);return}let t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){J(56);return}let i=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(r=>e.onDragEnter(this.rowDragEvent("rowDragEnter",r))),onDragLeave:e.onDragLeave&&(r=>e.onDragLeave(this.rowDragEvent("rowDragLeave",r))),onDragging:e.onDragging&&(r=>e.onDragging(this.rowDragEvent("rowDragMove",r))),onDragStop:e.onDragStop&&(r=>e.onDragStop(this.rowDragEvent("rowDragEnd",r))),onDragCancel:e.onDragCancel&&(r=>e.onDragCancel(this.rowDragEvent("rowDragCancel",r)))},n=w({isInterestedIn:r=>r===2,getIconName:()=>"move",external:!0},i);t.addDropTarget(n),this.addDestroyFunc(()=>t.removeDropTarget(n))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:i=>{this.onDragEnter(i),e?.onDragEnter?.(this.rowDragEvent("rowDragEnter",i))},onDragLeave:i=>{this.onDragLeave(i),e?.onDragLeave?.(this.rowDragEvent("rowDragLeave",i))},onDragging:i=>{this.onDragging(i),e?.onDragging?.(this.rowDragEvent("rowDragMove",i))},onDragStop:i=>{this.onDragStop(i),e?.onDragStop?.(this.rowDragEvent("rowDragEnd",i))},onDragCancel:i=>{this.onDragCancel(i),e?.onDragCancel?.(this.rowDragEvent("rowDragCancel",i))},fromGrid:!0}}getOverNode(e){let{pageBounds:t,rowModel:i}=this.beans,r=e>t.getCurrentPagePixelRange().pageLastPixel?-1:i.getRowIndexAtPixel(e);return r>=0?i.getRow(r):void 0}rowDragEvent(e,t){let i=this.beans,{dragItem:n,dropTarget:r,event:o,vDirection:s}=t,a=r?.rootNode===i.rowModel.rootNode,l=a?r.y:j_(i,t).y,c=a?r.overNode:this.getOverNode(l),d=a?r.overIndex:c?.rowIndex??-1;return{api:i.gridApi,context:i.gridOptions.context,type:e,event:o,node:n.rowNode,nodes:n.rowNodes,overIndex:d,overNode:c,y:l,vDirection:s,rowsDrop:r}}dispatchGridEvent(e,t){let i=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e,!1)}onDragStop(e){let t=this.lastDraggingEvent?.dropTarget??null,i=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),i?.allowed&&i.rowDragManaged&&(!t?.droppedManaged||rD(t,i))&&this.dropRows(i),this.stopDragging(e,!0)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e,!0)}stopDragging(e,t){this.clearAutoScroll(),this.beans.groupEditSvc?.stopDragging(t),this.beans.rowDropHighlightSvc?.fromDrag(null),oD(e.dragItem.rowNodes,!1),this.lastDraggingEvent=null}clearAutoScroll(){this.autoScroll?.ensureCleared(),this.autoScrollChanged=!1,this.autoScrollChanging=!1,this.autoScrollOldV=null}dropRows(e){return e.droppedManaged=!0,e.sameGrid?this.csrmMoveRows(e):this.csrmAddRows(e)}csrmAddRows({position:e,target:t,rows:i}){let n=tc(this.gos),r=this.beans.rowModel,o=i.filter(({data:a,rowPinned:l})=>!r.getRowNode(n?.({data:a,level:0,rowPinned:l})??a.id)).map(({data:a})=>a);if(o.length===0)return!1;let s;if(t){let a=t.sourceRowIndex>=0?t:lm(t);a&&(s=a.sourceRowIndex+(e==="above"?0:1))}return r.updateRowData({add:o,addIndex:s}),!0}filterRows(e){let{groupEditSvc:t}=this.beans,{rows:i,sameGrid:n}=e,r;for(let o=0,s=i.length;o<s;++o){let a=!0,l=i[o];(!l||l.footer||n&&l.destroyed&&!l.group||!this.csrmGetLeaf(l))&&(a=!1),a&&t&&!t.canDropRow(l,e)&&(a=!1),a?r?.push(l):r??(r=i.slice(0,o))}return r??i}csrmMoveRows(e){let t=this.beans.groupEditSvc;return t?.isGroupingDrop(e)?t.dropGroupEdit(e):this.csrmMoveRowsReorder(e)}csrmMoveRowsReorder({position:e,target:t,rows:i,newParent:n,rootNode:r}){let o=!1,s=new Set;for(let h of i){n&&h.parent!==n&&(h.treeParent=n,o=!0);let p=this.csrmGetLeaf(h);p&&s.add(p)}if(!o&&s.size===0)return!1;let a=this.beans.focusSvc,l=a.getFocusedCell(),c=l&&Bl(this.beans,l);if(s.size&&zK(r._leafs,s,t,e==="above")&&(o=!0),!o)return!1;let d=this.beans.rowModel,u=new Hg;return u.reordered=!0,d.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new Ku(!1,r),changedRowNodes:u}),c?c.focusCell():a.clearFocusedCell(),!0}csrmGetLeaf(e){if(e.sourceRowIndex>=0)return e.destroyed?void 0:e;let t=this.beans.groupEditSvc;return t?t.csrmFirstLeaf(e):lm(e)}},rD=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!hs(e.rows,t.rows)),LY=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,oD=(e,t)=>{for(let i=0,n=e?.length||0;i<n;++i){let r=e[i];r.dragging!==t&&(r.dragging=t,r.dispatchRowEvent("draggingChanged"))}},NY=(e,t)=>{let i=null,n=t.target;if(n&&t.rows.indexOf(n)<0)return null;let r=t.source;if(!n||!r)return null;let o=n.rowIndex-r.rowIndex,s=o<0?-1:1;o=t.suppressMoveWhenRowDragging?Math.abs(o):1;let a=new Set(t.rows);do{let l=Wb(e,s,n);if(!l)break;a.has(l)||(i=l,--o),n=l}while(o>0);return i},BY=(e,t)=>{let i=e?.rowTop,n=e?.rowHeight??0;if(i==null||!n||n<=0)return"none";let r=t-i,o=n*AY;return r<=o?"above":r>=n-o?"below":"inside"},HY=class extends j{constructor(){super(...arguments),this.beanName="rowDragSvc",this.rowDragFeature=null,this.visibility="suppress"}setupRowDrag(e,t){let i=t.createManagedBean(new OY(e)),n=this.beans.dragAndDrop;n.addDropTarget(i),t.addDestroyFunc(()=>n.removeDropTarget(i)),this.rowDragFeature=i;let r=()=>this.refreshVisibility();this.addManagedPropertyListeners(["rowDragManaged","suppressRowDrag","refreshAfterGroupEdit"],r),this.addManagedEventListeners({newColumnsLoaded:r,columnRowGroupChanged:r,columnPivotModeChanged:r,sortChanged:r,filterChanged:r}),this.visibility=this.computeVisibility()}createRowDragComp(e,t,i,n,r,o){return new IY(e,t,i,n,r,o)}createRowDragCompForRow(e,t){if(ho(this.gos))return;let i=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${i("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,i,n,r,o){let s=this.gos;return s.get("rowDragManaged")&&(!_t(s)||s.get("pagination"))?void 0:this.createRowDragComp(i,e,t,n,r,o)}cancelRowDrag(){this.rowDragFeature?.lastDraggingEvent&&this.beans.dragSvc?.cancelDrag()}computeVisibility(){let e=this.beans,t=e.gos;if(t.get("suppressRowDrag"))return"suppress";if(!t.get("rowDragManaged"))return"visible";let n=e.colModel.isPivotMode();return(n||e.rowGroupColsSvc?.columns?.length)&&!t.get("refreshAfterGroupEdit")?"hidden":n||e.filterManager?.isAnyFilterPresent()||e.sortSvc?.isSortActive()?"disabled":"visible"}refreshVisibility(){let e=this.visibility,t=this.computeVisibility();e!==t&&(this.visibility=t,this.eventSvc?.dispatchEvent({type:"rowDragVisibilityChanged"}))}},zY=class extends j{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){let e=this.row,t=this.dragging;!e||e?.rowIndex===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){let e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){let i=e!==this.row,n=e.uiLevel,r=t!==this.position,o=n!==this.uiLevel;this.dragging=!1,(i||r||o)&&(i&&this.clear(),this.uiLevel=n,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){let t=e?.dropTarget;if(t){let{highlight:i,target:n,position:r}=t;if(i&&n&&r!=="none"){this.set(n,r),this.dragging=!0;return}}this.dragging&&this.clear()}},L8={moduleName:"Drag",version:fe,beans:[FY]},VY={moduleName:"DragAndDrop",version:fe,dynamicBeans:{dndSourceComp:EY},icons:{rowDrag:"grip"}},N8={moduleName:"SharedDragAndDrop",version:fe,beans:[jq],dependsOn:[L8],userComponents:{agDragAndDropImage:_K},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},GY={moduleName:"RowDrag",version:fe,beans:[zY,HY],apiFunctions:{addRowDropZone:RY,removeRowDropZone:PY,getRowDropZoneParams:kY,getRowDropPositionIndicator:_Y,setRowDropPositionIndicator:DY},dependsOn:[N8]},WY={moduleName:"HorizontalResize",version:fe,beans:[MY],dependsOn:[L8]},UY=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",jY=class extends j{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;let{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;let e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){let{executeNextFuncs:i,executeLaterFuncs:n}=this;if(i.length===0&&n.length===0){e(),t();return}let r=o=>{for(;o.length;){let s=o.pop();s&&s()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),r(i)},0),window.setTimeout(()=>{t(),r(n)},200)})}};function qY(e,t,i){e.colMoves?.moveColumnByIndex(t,i,"api")}function $Y(e,t,i){e.colMoves?.moveColumns(t,i,"api")}var KY=class extends j{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;let t=e.dragItem.columns;if(t)for(let i of t)i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?this.columnsToAggregate.push(i):i.isAllowRowGroup()?this.columnsToGroup.push(i):i.isAllowPivot()&&this.columnsToPivot.push(i)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){let{valueColsSvc:t,rowGroupColsSvc:i,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&i?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&n?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function YY(e,t){!t||t.length<=1||t.filter(n=>e.indexOf(n)<0).length>0||t.sort((n,r)=>{let o=e.indexOf(n),s=e.indexOf(r);return o-s})}function XY(e){let t=[...e];for(let i of e){let n=null,r=i.getParent();for(;r!=null&&r.getDisplayedLeafColumns().length===1;)n=r,r=r.getParent();if(n!=null){let s=!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns();for(let a of s)t.includes(a)||t.push(a)}}return t}function JY(e,t,i,n){let r=n.allCols,o=null,s=null;for(let a=0;a<e.length;a++){let l=e[a],c=i.getProposedColumnOrder(t,l);if(!i.doesOrderPassRules(c))continue;let d=c.filter(h=>r.includes(h));if(s===null)s=d;else if(!hs(d,s))break;let u=ZY(c);(o===null||u<o.fragCount)&&(o={move:l,fragCount:u})}return o}function B8(e){let{isFromHeader:t,fromLeft:i,xPosition:n,fromEnter:r,fakeEvent:o,pinned:s,gos:a,colModel:l,colMoves:c,visibleCols:d}=e,{allMovingColumns:u}=e;t&&(u=XY(u));let h=u.slice();YY(l.getCols(),h);let p=tX({movingCols:h,draggingRight:i,xPosition:n,pinned:s,gos:a,colModel:l,visibleCols:d}),f=QY(h,l);if(p.length===0)return;let g=p[0];if(f!==null&&(t||!r)&&!o&&(!i&&g>=f||i&&g<=f))return;let v=JY(p,h,c,d);if(!v)return;let C=v.move;if(!(C>l.getCols().length-h.length))return{columns:h,toIndex:C}}function H8(e){let{columns:t,toIndex:i}=B8(e)||{},{finished:n,colMoves:r}=e;return!t||i==null?null:(r.moveColumns(t,i,"uiColumnMoved",n),n?null:{columns:t,toIndex:i})}function QY(e,t){let i=t.getCols(),n=e.map(l=>i.indexOf(l)).sort((l,c)=>l-c),r=n[0];return dt(n)-r!==n.length-1?null:r}function ZY(e){function t(n){let r=[],o=n.getOriginalParent();for(;o!=null;)r.push(o),o=o.getOriginalParent();return r}let i=0;for(let n=0;n<e.length-1;n++){let r=t(e[n]),o=t(e[n+1]);[r,o]=r.length>o.length?[r,o]:[o,r];for(let s of r)o.indexOf(s)===-1&&i++}return i}function eX(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function tX(e){let{movingCols:t,draggingRight:i,xPosition:n,pinned:r,gos:o,colModel:s,visibleCols:a}=e;if(o.get("suppressMovableColumns")||t.some(b=>b.getColDef().suppressMovable))return[];let c=eX(a,r),d=s.getCols(),u=c.filter(b=>t.includes(b)),h=c.filter(b=>!t.includes(b)),p=d.filter(b=>!t.includes(b)),f=0,g=n;if(i){let b=0;for(let S of u)b+=S.getActualWidth();g-=b}if(g>0){for(let b=0;b<h.length;b++){let S=h[b];if(g-=S.getActualWidth(),g<0)break;f++}i&&f++}let m;if(f>0){let b=h[f-1];m=p.indexOf(b)+1}else m=p.indexOf(h[0]),m===-1&&(m=0);let v=[m],C=(b,S)=>b-S;if(i){let b=m+1,S=d.length-1;for(;b<=S;)v.push(b),b++;v.sort(C)}else{let b=m,S=d.length-1,E=d[b];for(;b<=S&&c.indexOf(E)<0;)b++,v.push(b),E=d[b];b=m-1;let x=0;for(;b>=x;)v.push(b),b--;v.sort(C).reverse()}return v}function Yb(e){let{pinned:t,fromKeyboard:i,gos:n,ctrlsSvc:r,useHeaderRow:o,skipScrollPadding:s}=e,a=r.getHeaderRowContainerCtrl(t)?.eViewport,{x:l}=e;return a?(i&&(l-=a.getBoundingClientRect().left),n.get("enableRtl")&&(o&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!s&&(l+=r.get("center").getCenterViewportScrollLeft()),l):0}function gb(e,t){for(let i of e)i.moving=t,i.dispatchColEvent("movingChanged","uiColumnMoved")}var sD=7,Xb=100,kg=Xb/2,iX=5,nX=100,rX=class extends j{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!pe(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){let{pinned:e,lastDraggingEvent:t}=this,{dragItem:i}=t||{},n=i?.columns??[];for(let r of n){let o=r.getPinned();if(r.getColDef().lockPinned){if(o==e)return"move";continue}let s=i?.containerType;if(s===e||!e)return"move";if(e&&(!o||s!==e))return"pinned"}return"notAllowed"}onDragEnter(e){let t=e.dragItem,i=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(i,!0,"uiColumnDragged");else{let r=t.visibleState,o=(i||[]).filter(s=>r[s.getId()]&&!s.isVisible());this.setColumnsVisible(o,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(i,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,i=!1,n=!1){let{gos:r,ctrlsSvc:o}=this.beans,s=r.get("suppressMoveWhenColumnDragging");if(n&&!s){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!n&&mt(e.hDirection))return;let a=Yb({x:e.x,pinned:this.pinned,gos:r,ctrlsSvc:o});t||this.checkCenterForScrolling(a),s?this.handleColumnDragWhileSuppressingMovement(e,t,i,a,n):this.handleColumnDragWhileAllowingMovement(e,t,i,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,i){if(!e?.length)return;let n=e.filter(r=>!r.getColDef().lockVisible);n.length&&this.beans.colModel.setColsVisible(n,t,i)}finishColumnMoving(){this.clearHighlighted();let e=this.lastMovedInfo;if(!e)return;let{columns:t,toIndex:i}=e;this.beans.colMoves.moveColumns(t,i,"uiColumnMoved",!0)}updateDragItemContainerType(){let{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;let t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,i,n,r){let o=this.getAllMovingColumns(e,!0);if(r){let s=this.isAttemptingToPin(o);s&&this.attemptToPinColumns(o,void 0,!0);let{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(o,s)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:o,xPosition:l,fromEnter:t,fakeEvent:i,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(o,n)}}handleColumnDragWhileAllowingMovement(e,t,i,n,r){let o=this.getAllMovingColumns(e),s=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:o,isFromHeader:a,xPosition:n,fromLeft:s,fromEnter:t,fakeEvent:i}),c=H8(T(w({},l),{finished:r}));c&&(this.lastMovedInfo=c)}getAllMovingColumns(e,t=!1){let i=e.dragSource.getDragItem(),n=null;t?(n=i.columnsInSplit,n||(n=i.columns)):n=i.columns;let r=o=>o.getColDef().lockPinned?o.getPinned()==this.pinned:!0;return n?n.filter(r):[]}getMoveColumnParams(e){let{allMovingColumns:t,isFromHeader:i,xPosition:n,fromLeft:r,fromEnter:o,fakeEvent:s}=e,{gos:a,colModel:l,colMoves:c,visibleCols:d}=this.beans;return{allMovingColumns:t,isFromHeader:i,fromLeft:r,xPosition:n,pinned:this.pinned,fromEnter:o,fakeEvent:s,gos:a,colModel:l,colMoves:c,visibleCols:d}}highlightHoveredColumn(e,t){let{gos:i,colModel:n}=this.beans,r=i.get("enableRtl"),o=n.getCols().filter(d=>d.isVisible()&&d.getPinned()===this.pinned),s=null,a=null,l=null;for(let d of o){if(a=d.getActualWidth(),s=this.getNormalisedColumnLeft(d,0,r),s!=null){let u=s+a;if(s<=t&&u>=t){l=d;break}}s=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let d=o.length-1;d>=0;d--){let u=o[d],h=o[d].getParent();if(!h){l=u;break}let p=h?.getDisplayedLeafColumns();if(p.length){l=dt(p);break}}if(!l)return;s=this.getNormalisedColumnLeft(l,0,r),a=l.getActualWidth()}if(this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),l==null||s==null||a==null)return;let c;t-s<a/2?c=0:c=1,aD(l,c),this.lastHighlightedColumn={column:l,position:c}}getNormalisedXPositionInfo(e,t){let{gos:i,visibleCols:n}=this.beans,r=i.get("enableRtl"),{firstMovingCol:o,column:s,position:a}=this.getColumnMoveAndTargetInfo(e,t,r);if(!o||!s||a==null)return;let l=n.allCols,c=l.indexOf(o),d=l.indexOf(s),u=a===0,h=c<d||c===d&&!u,p=0;if(u?h&&(p-=1):h||(p+=1),d+p===c)return;let f=l[d+p];if(!f)return;let g=this.getNormalisedColumnLeft(f,20,r);return{fromLeft:h,xPosition:g}}getColumnMoveAndTargetInfo(e,t,i){let n=this.lastHighlightedColumn||{},{firstMovingCol:r,lastMovingCol:o}=oX(e);if(!r||!o||n.column||!t)return w({firstMovingCol:r},n);let a=this.getPinDirection()==="left";return{firstMovingCol:r,position:a?1:0,column:a!==i?r:o}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,i){let{gos:n,ctrlsSvc:r}=this.beans,o=e.getLeft();if(o==null)return null;let s=e.getActualWidth();return Yb({x:i?o+s-t:o+t,pinned:e.getPinned(),useHeaderRow:i,skipScrollPadding:!0,gos:n,ctrlsSvc:r})}isAttemptingToPin(e){let t=this.needToMoveLeft||this.needToMoveRight,i=this.failedMoveAttempts>sD;return t&&i||e.some(n=>n.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){let{allMovingColumns:t,xPosition:i,fromEnter:n,fakeEvent:r,fromLeft:o}=e,s=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:i,fromLeft:o,fromEnter:n,fakeEvent:r}),{columns:a,toIndex:l}=B8(s)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){let{lastHighlightedColumn:e}=this;e&&(aD(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;let t=this.beans.ctrlsSvc.get("center"),i=t.getCenterViewportScrollLeft(),n=i+t.getCenterWidth(),r,o;this.gos.get("enableRtl")?(r=e<i+kg,o=e>n-kg):(o=e<i+kg,r=e>n-kg),this.needToMoveRight=r,this.needToMoveLeft=o,o||r?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),nX),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*iX,e>Xb&&(e=Xb);let t=null,i=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;let{pinnedCols:n,dragAndDrop:r,gos:o}=this.beans;if(this.failedMoveAttempts<=sD+1||!n)return;if(r.setDragImageCompIcon("pinned"),!o.get("suppressMoveWhenColumnDragging")){let s=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(s,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,i=!1){let n=(e||[]).filter(s=>!s.getColDef().lockPinned);if(!n.length)return 0;i&&(t=this.getPinDirection());let{pinnedCols:r,dragAndDrop:o}=this.beans;return r?.setColsPinned(n,t,"uiColumnDragged"),i&&o.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function aD(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function oX(e){let t=e.length,i,n;for(let r=0;r<t;r++){if(!i){let o=e[r];o.getLeft()!=null&&(i=o)}if(!n){let o=e[t-1-r];o.getLeft()!=null&&(n=o)}if(i&&n)break}return{firstMovingCol:i,lastMovingCol:n}}var sX=class extends j{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){let{ctrlsSvc:e,dragAndDrop:t}=this.beans,i=this.pinned;e.whenReady(this,n=>{let r,o=n.gridBodyCtrl.eBodyViewport;switch(i){case"left":r=[[o,n.left.eContainer],[n.bottomLeft.eContainer],[n.topLeft.eContainer]];break;case"right":r=[[o,n.right.eContainer],[n.bottomRight.eContainer],[n.topRight.eContainer]];break;default:r=[[o,n.center.eViewport],[n.bottomCenter.eViewport],[n.topCenter.eViewport]];break}this.eSecondaryContainers=r}),this.moveColumnFeature=this.createManagedBean(new rX(i)),this.bodyDropPivotTarget=this.createManagedBean(new KY(i)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},aX=class extends j{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,i){let n=this.beans.colModel.getCols();if(!n)return;let r=n[e];this.moveColumns([r],t,i)}moveColumns(e,t,i,n=!0){let{colModel:r,colAnimation:o,visibleCols:s,eventSvc:a}=this.beans,l=r.getCols();if(!l)return;if(t>l.length-e.length){J(30,{toIndex:t});return}o?.start();let c=r.getColsForKeys(e);this.doesMovePassRules(c,t)&&(E_(r.getCols(),c,t),s.refresh(i),a.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,toIndex:t,finished:n,source:i})),o?.finish()}doesMovePassRules(e,t){let i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){let{colModel:t,gos:i}=this.beans;return!(!FF(e,t.getColTree())||!(r=>{let o=c=>c?c==="left"||c===!0?-1:1:0,s=i.get("enableRtl"),a=s?1:-1,l=!0;for(let c of r){let d=o(c.getColDef().lockPosition);s?d>a&&(l=!1):d<a&&(l=!1),a=d}return l})(e))}getProposedColumnOrder(e,t){let n=this.beans.colModel.getCols().slice();return E_(n,e,t),n}createBodyDropTarget(e,t){return new sX(e,t)}moveHeader(e,t,i,n,r){let{ctrlsSvc:o,gos:s,colModel:a,visibleCols:l,focusSvc:c}=this.beans,d=t.getBoundingClientRect(),u=d.left,h=It(i),p=h?d.width:i.getActualWidth(),f=e==="left"!==s.get("enableRtl"),g=Yb({x:f?u-20:u+p+20,pinned:n,fromKeyboard:!0,gos:s,ctrlsSvc:o}),m=c.focusedHeader;H8({allMovingColumns:h?i.getLeafColumns():[i],isFromHeader:!0,fromLeft:e==="right",xPosition:g,pinned:n,fromEnter:!1,fakeEvent:!1,gos:s,colModel:a,colMoves:this,visibleCols:l,finished:!0});let v;if(h){let C=i.getDisplayedLeafColumns();v=f?C[0]:dt(C)}else v=i;if(o.getScrollFeature().ensureColumnVisible(v,"auto"),(!r.isAlive()||s.get("ensureDomOrder"))&&m){let C;if(h){let b=i.getGroupId(),S=i.getLeafColumns();if(!S.length)return;let E=S[0].getParent();if(!E)return;C=lX(E,b)}else C=i;C&&c.focusHeaderPosition({headerPosition:T(w({},m),{column:C})})}}setDragSourceForHeader(e,t,i){let{gos:n,colModel:r,dragAndDrop:o,visibleCols:s}=this.beans,a=!n.get("suppressDragLeaveHidesColumns"),l=It(t),c=l?t.getProvidedColumnGroup().getLeafColumns():[t],u={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>dX(t,s.allCols):()=>cX(t),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),gb(c,!0)},onDragStopped:()=>gb(c,!1),onDragCancelled:()=>gb(c,!1),onGridEnter:h=>{if(a){let{columns:p=[],visibleState:f}=h??{},g=l?v=>!f||f[v.getColId()]:()=>!0,m=p.filter(v=>!v.getColDef().lockVisible&&g(v));r.setColsVisible(m,!0,"uiColumnMoved")}},onGridExit:h=>{if(a){let p=h?.columns?.filter(f=>!f.getColDef().lockVisible)||[];r.setColsVisible(p,!1,"uiColumnMoved")}}};return o.addDragSource(u,!0),u}};function lX(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function cX(e){let t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function dX(e,t){let i=e.getProvidedColumnGroup().getLeafColumns(),n={};for(let a of i)n[a.getId()]=a.isVisible();let r=[];for(let a of t)i.indexOf(a)>=0&&(r.push(a),Mr(i,a));for(let a of i)r.push(a);let o=[],s=e.getLeafColumns();for(let a of r)s.indexOf(a)!==-1&&o.push(a);return{columns:r,columnsInSplit:o,visibleState:n,containerType:o[0]?.pinned}}var uX={moduleName:"ColumnMove",version:fe,beans:[aX,jY],apiFunctions:{moveColumnByIndex:qY,moveColumns:$Y},dependsOn:[N8],css:[UY]},hX=class extends j{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){let i=this.getHeaderCellForColumn(e);if(!i)return-1;let n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||n.push(i),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(e){let t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){let i=document.createElement("form");i.style.position="fixed";let n=this.centerRowContainerCtrl.eContainer;for(let o of e)this.cloneItemIntoDummy(o,i);n.appendChild(i);let r=i.offsetWidth;return i.remove(),t=t??this.gos.get("autoSizePadding"),r+t}getHeaderCellForColumn(e){let t=null;for(let i of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){let n=i.getHtmlElementForColumnHeader(e);n!=null&&(t=n)}return t}cloneItemIntoDummy(e,t){let i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";let n=document.createElement("div"),r=n.classList;["ag-header-cell","ag-header-group-cell"].some(a=>i.classList.contains(a))?(r.add("ag-header","ag-header-row"),n.style.position="static"):r.add("ag-row");let s=e.parentElement;for(;s;){if(["ag-header-row","ag-row"].some(l=>s.classList.contains(l))){for(let l=0;l<s.classList.length;l++){let c=s.classList[l];c!="ag-row-position-absolute"&&r.add(c)}break}s=s.parentElement}n.appendChild(i),t.appendChild(n)}},z8={moduleName:"AutoWidth",version:fe,beans:[hX]};function pX(e,t,i=!0,n="api"){e.colResize?.setColumnWidths(t,!1,i,n)}var fX=class extends j{constructor(e,t,i,n){super(),this.comp=e,this.eResize=t,this.pinned=i,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}let{horizontalResizeSvc:e,gos:t,colAutosize:i}=this.beans,n=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!t.get("suppressAutoSize")&&i&&this.addDestroyFunc(i.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){let{columnsToResize:t,resizeStartWidth:i,resizeRatios:n,groupAfterColumns:r,groupAfterStartWidth:o,groupAfterRatios:s}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=i,this.resizeRatios=n,this.resizeTakeFromCols=r,this.resizeTakeFromStartWidth=o,this.resizeTakeFromRatios=s,this.toggleColumnResizing(!0)}onResizing(e,t,i="uiColumnResized"){let n=this.normaliseDragChange(t),r=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(r,i,e)}getInitialValues(e){let t=l=>l.reduce((c,d)=>c+d.getActualWidth(),0),i=(l,c)=>l.map(d=>d.getActualWidth()/c),n=this.getColumnsToResize(),r=t(n),o=i(n,r),s={columnsToResize:n,resizeStartWidth:r,resizeRatios:o},a=null;if(e&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){let l=a.getDisplayedLeafColumns(),c=s.groupAfterColumns=l.filter(u=>u.isResizable()),d=s.groupAfterStartWidth=t(c);s.groupAfterRatios=i(c,d)}else s.groupAfterColumns=void 0,s.groupAfterStartWidth=void 0,s.groupAfterRatios=void 0;return s}resizeLeafColumnsToFit(e){let t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();t>i.resizeStartWidth&&this.resizeColumns(i,t,e,!0)}resizeColumnsFromLocalValues(e,t,i=!0){if(!this.resizeCols||!this.resizeRatios)return;let n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,e,t,i)}resizeColumns(e,t,i,n=!0){let{columnsToResize:r,resizeStartWidth:o,resizeRatios:s,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,d=[];if(d.push({columns:r,ratios:s,width:t}),a){let u=t-o;d.push({columns:a,ratios:c,width:l-u})}this.beans.colResize?.resizeColumnSets({resizeSets:d,finished:n,source:i}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},gX=class extends j{constructor(e,t,i,n,r){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=n,this.ctrl=r}postConstruct(){let e=[],t,i,n=()=>{if(ot(this.eResize,t),!t)return;let{horizontalResizeSvc:s,colAutosize:a}=this.beans,l=s.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),i&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},r=()=>{for(let s of e)s();e.length=0},o=()=>{let s=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(s!==t||a!==i)&&(t=s,i=a,r(),n())};o(),this.addDestroyFunc(r),this.ctrl.setRefreshFunction("resize",o)}onResizing(e,t){let{column:i,lastResizeAmount:n,resizeStartWidth:r,beans:o}=this,s=this.normaliseResizeAmount(t),a=r+s,l=[{key:i,newWidth:a}],{pinnedCols:c,ctrlsSvc:d,colResize:u}=o;if(this.column.getPinned()){let h=c?.leftWidth??0,p=c?.rightWidth??0,f=zu(d.getGridBodyCtrl().eBodyViewport)-50;if(h+p+(s-n)>f)return}this.lastResizeAmount=s,u?.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e,i=this.pinned!=="left",n=this.pinned==="right";return this.gos.get("enableRtl")?i&&(t*=-1):n&&(t*=-1),t}},mX=class extends j{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,i,n){let r=[],{colModel:o,gos:s,visibleCols:a}=this.beans;for(let l of e){let c=o.getColDefCol(l.key)||o.getCol(l.key);if(!c)continue;if(r.push({width:l.newWidth,ratios:[1],columns:[c]}),s.get("colResizeDefault")==="shift"&&(t=!t),t){let u=a.getColAfter(c);if(!u)continue;let h=c.getActualWidth()-l.newWidth,p=u.getActualWidth()+h;r.push({width:p,ratios:[1],columns:[u]})}}r.length!==0&&this.resizeColumnSets({resizeSets:r,finished:i,source:n})}resizeColumnSets(e){let{resizeSets:t,finished:i,source:n}=e;if(!(!t||t.every(d=>vX(d)))){if(i){let d=t&&t.length>0?t[0].columns:null;ic(this.eventSvc,d,i,n)}return}let o=[],s=[];for(let d of t){let{width:u,columns:h,ratios:p}=d,f={},g={};for(let C of h)s.push(C);let m=!0,v=0;for(;m;){if(v++,v>1e3){Ze(31);break}m=!1;let C=[],b=0,S=u;h.forEach((x,P)=>{if(g[x.getId()])S-=f[x.getId()];else{C.push(x);let N=p[P];b+=N}});let E=1/b;C.forEach((x,P)=>{let F=P===C.length-1,N;F?N=S:(N=Math.round(p[P]*u*E),S-=N);let Y=x.getMinWidth(),X=x.getMaxWidth();N<Y?(N=Y,g[x.getId()]=!0,m=!0):X>0&&N>X&&(N=X,g[x.getId()]=!0,m=!0),f[x.getId()]=N})}for(let C of h){let b=f[C.getId()];C.getActualWidth()!==b&&(C.setActualWidth(b,n),o.push(C))}}let a=o.length>0,l=[];if(a){let{colFlex:d,visibleCols:u,colViewport:h}=this.beans;l=d?.refreshFlexedColumns({resizingCols:s,skipSetLeft:!0})??[],u.setLeftValues(n),u.updateBodyWidths(),h.checkViewportColumns()}let c=s.concat(l);(a||i)&&ic(this.eventSvc,c,i,n,l)}resizeHeader(e,t,i){if(!e.isResizable())return;let n=e.getActualWidth(),r=e.getMinWidth(),o=e.getMaxWidth(),s=Math.min(Math.max(n+t,r),o);this.setColumnWidths([{key:e,newWidth:s}],i,!0,"uiColumnResized")}createResizeFeature(e,t,i,n,r){return new gX(e,t,i,n,r)}createGroupResizeFeature(e,t,i,n){return new fX(e,t,i,n)}};function vX(e){let{columns:t,width:i}=e,n=0,r=0,o=!0;for(let l of t){let c=l.getMinWidth();n+=c||0;let d=l.getMaxWidth();d>0?r+=d:o=!1}let s=i>=n,a=!o||i<=r;return s&&a}var CX={moduleName:"ColumnResize",version:fe,beans:[mX],apiFunctions:{setColumnWidths:pX},dependsOn:[WY,z8]},wX=class extends j{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();let e=this.onWidthChanged.bind(this);for(let t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(let e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){let e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},bX=class extends Vy{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,i,n,r){let{column:o,beans:s}=this,{context:a,colNames:l,colHover:c,rangeSvc:d,colResize:u}=s;this.comp=e,r=Qu(this,a,r),this.setGui(t,r),this.displayName=l.getDisplayNameForColumnGroup(o,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(r),this.setupExpandable(r),this.setupTooltip(),this.refreshAnnouncement(),this.setupAutoHeight({wrapperElement:n,compBean:r}),this.setupUserComp(),this.addHeaderMouseListeners(r,n),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();let h=this.rowCtrl.pinned,p=o.getProvidedColumnGroup().getLeafColumns();c?.createHoverFeature(r,p,t),d?.createRangeHighlightFeature(r,o,e),r.createManagedBean(new zy(o,t,s)),r.createManagedBean(new wX(e,o)),u?this.resizeFeature=r.createManagedBean(u.createGroupResizeFeature(e,i,h,o)):e.setResizableDisplayed(!1),r.createManagedBean(new Zu(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(r,p),this.addManagedEventListeners({cellSelectionChanged:()=>this.refreshAnnouncement()}),r.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(r),r.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.getDefinition();return _e(t.gos,{colDef:i,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){let{gos:e,comp:t}=this,i=e.get("groupHeaderHeight");i!=null?i===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(i):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(let i of t)e.addManagedListeners(i,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,i)})}onLeafColumnHighlightChanged(e){let t=this.column.getDisplayedLeafColumns(),i=t[0]===e,n=dt(t)===e;if(!i&&!n)return;let r=e.getHighlighted(),o=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving()),s=!1,a=!1;if(o){let l=this.beans.gos.get("enableRtl"),c=r===1,d=r===0;i&&(l?a=c:s=d),n&&(l?s=d:a=c)}this.comp.toggleCss("ag-header-highlight-before",s),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){let{resizeFeature:i}=this;if(!i)return;let n=i.getInitialValues(t);i.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){let{colGroupSvc:e,userCompFactory:t,gos:i,enterpriseMenuFactory:n}=this.beans,r=this.column,o=r.getProvidedColumnGroup(),s=_e(i,{displayName:this.displayName,columnGroup:r,setExpanded:l=>{e.setColumnGroupOpened(o,l,"gridInitializing")},setTooltip:(l,c)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,c)},showColumnMenu:(l,c)=>n?.showMenuAfterButtonClick(o,l,"columnMenu",c),showColumnMenuAfterMouseClick:(l,c)=>n?.showMenuAfterMouseEvent(o,l,"columnMenu",c),eGridHeader:this.eGui}),a=sj(t,s);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e,t){let{column:i,comp:n,beans:{rangeSvc:r},gos:o}=this,s=d=>this.handleMouseOverChange(d.type==="mouseenter"),a=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",i.getProvidedColumnGroup()),l=d=>this.handleContextMenuMouseEvent(d,void 0,i.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:s,mouseleave:s,click:a,contextmenu:l}),n.toggleCss("ag-header-group-cell-selectable",ql(o));let c=r?.createHeaderGroupCellMouseListenerFeature(this.column,t);c&&this.createManagedBean(c)}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){let t=this.column.getProvidedColumnGroup();this.refreshExpanded();let i=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:i,expandableChanged:i})}refreshExpanded(){let{column:e}=this;this.expandable=e.isExpandable();let t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){let{column:e}=this,t=e.getColGroupDef(),i=R8(t,this.gos,null,e);e.isPadding()?(i.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(r=>r.isSpanHeaderHeight())&&i.push("ag-header-span-height")):(i.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&i.push("ag-header-cell-wrap-text"));for(let n of i)this.comp.toggleCss(n,!0)}setupMovingCss(e){let{column:t}=this,n=t.getProvidedColumnGroup().getLeafColumns(),r=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(let o of n)e.addManagedListeners(o,{movingChanged:r});r()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription())}handleKeyDown(e){if(super.handleKeyDown(e),!this.getWrapperHasFocus())return;let{column:i,expandable:n,gos:r,beans:o}=this,s=ql(r);if(e.key==B.ENTER){if(s&&!e.altKey)o.rangeSvc?.handleColumnSelection(i,e);else if(n){let a=!i.isExpanded();o.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),a,"uiColumnExpanded")}}}refreshAnnouncement(){let e,{gos:t,column:i,beans:n}=this;if(ql(t)){let o=this.getLocaleTextFunc(),s=n.rangeSvc?.isColumnInAnyRange(i);e=o("ariaColumnCellSelection",`Press CTRL+SPACE to ${s?"de":""}select all visible cells in this column group`)}this.ariaAnnouncement=e}announceAriaDescription(){let{beans:e,eGui:t,ariaAnnouncement:i}=this;!i||!t.contains(bt(e))||e.ariaAnnounce?.announceValue(i,"columnHeader")}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function yX(e,t,i){e.colGroupSvc?.setColumnGroupOpened(t,i,"api")}function SX(e,t,i){return e.colGroupSvc?.getColumnGroup(t,i)??null}function xX(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function EX(e,t,i){return e.colNames.getDisplayNameForColumnGroup(t,i)||""}function RX(e){return e.colGroupSvc?.getColumnGroupState()??[]}function PX(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function kX(e){e.colGroupSvc?.resetColumnGroupState("api")}function _X(e){return e.visibleCols.treeLeft}function DX(e){return e.visibleCols.treeCenter}function FX(e){return e.visibleCols.treeRight}function MX(e){return e.visibleCols.getAllTrees()}function TX(e,t){for(let i=0;i<t.length;i++){let n=e.indexOf(t[i]);n>=0&&(e[n]=e[e.length-1],e.pop())}}var IX=class extends j{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){let{colFlex:i,colModel:n,colGroupSvc:r,colViewport:o,selectionColSvc:s}=this.beans;t||this.buildTrees(n,r),r?.updateOpenClosedVisibility(),this.leftCols=mb(this.treeLeft),this.centerCols=mb(this.treeCenter),this.rightCols=mb(this.treeRight),s?.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(n),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),i?.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(n,this.leftCols,this.rightCols,e),o.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(let t of this.allCols){let i=t.getParent();for(;i;){if(!i.isPadding()){let n=i.getProvidedColumnGroup().getLevel()+1;n>e&&(e=n);break}i=i.getParent()}}return e}updateBodyWidths(){let e=so(this.centerCols),t=so(this.leftCols),i=so(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==i)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=i,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,i,n){let r,o;this.gos.get("enableRtl")?(r=t?t[0]:null,o=i?dt(i):null):(r=t?dt(t):null,o=i?i[0]:null);for(let s of e.getCols())s.setLastLeftPinned(s===r,n),s.setFirstRightPinned(s===o,n)}buildTrees(e,t){let i=e.getColsToShow(),n=i.filter(l=>l.getPinned()=="left"),r=i.filter(l=>l.getPinned()=="right"),o=i.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),s=new OF,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:n,idCreator:s,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:r,idCreator:s,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:o,idCreator:s,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){let t=e.getCols(),i=[],n=[],r=[];for(let o of t){let s=o.getPinned();s?s===!0||s==="left"?i.push(o):r.push(o):n.push(o)}this.ariaOrderColumns=i.concat(n).concat(r)}getAriaColIndex(e){let t;return It(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(let e of[this.treeLeft,this.treeRight,this.treeCenter])for(let t of e)It(t)&&t.checkLeft()}setLeftValuesOfCols(e){let{colModel:t}=this.beans;if(!t.getColDefCols())return;let n=t.getCols().slice(0),r=this.gos.get("enableRtl");for(let o of[this.leftCols,this.rightCols,this.centerCols]){if(r){let s=so(o);for(let a of o)s-=a.getActualWidth(),a.setLeft(s,e)}else{let s=0;for(let a of o)a.setLeft(s,e),s+=a.getActualWidth()}TX(n,o)}for(let o of n)o.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){let{leftCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){let{rightCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,i,n){let r=[],o=null;for(let s=0;s<t.length;s++){let a=t[s],l=t.length-s,c=Math.min(a.getColSpan(e),l),d=[a];if(c>1){let h=c-1;for(let p=1;p<=h;p++)d.push(t[s+p]);s+=h}let u;if(i){u=!1;for(let h of d)i(h)&&(u=!0)}else u=!0;u&&(r.length===0&&o&&(n&&n(a))&&r.push(o),r.push(a)),o=a}return r}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){let t=this.allCols,i=t.indexOf(e);return i>0?t[i-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};let e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};ga(this.treeCenter,!1,e),ga(this.treeLeft,!1,e),ga(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){let e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let i=0;i<t.length;i++){let n=this[t[i]];if(n.length)return e?dt(n):n[0]}return null}getColAfter(e){let t=this.allCols,i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getColsLeftWidth(){return so(this.leftCols)}getDisplayedColumnsRightWidth(){return so(this.rightCols)}isColAtEdge(e,t){let i=this.allCols;if(!i.length)return!1;let n=t==="first",r;if(It(e)){let o=e.getDisplayedLeafColumns();if(!o.length)return!1;r=n?o[0]:dt(o)}else r=e;return(n?i[0]:dt(i))===r}};function ga(e,t,i){if(e)for(let n=0;n<e.length;n++){let r=e[n];if(It(r)){let o=t?r.getDisplayedChildren():r.getChildren();ga(o,t,i)}i(r)}}function mb(e){let t=[];return ga(e,!0,i=>{cs(i)&&t.push(i)}),t}var AX=class extends j{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){let e=[],t=this.beans.colModel.getColTree();return co(null,t,i=>{Si(i)&&e.push({groupId:i.getGroupId(),open:i.isExpanded()})}),e}resetColumnGroupState(e){let t=this.beans.colModel.getColDefColTree();if(!t)return;let i=[];co(null,t,n=>{if(Si(n)){let r=n.getColGroupDef(),o={groupId:n.getGroupId(),open:r?r.openByDefault:void 0};i.push(o)}}),this.setColumnGroupState(i,e)}setColumnGroupState(e,t){let{colModel:i,colAnimation:n,visibleCols:r,eventSvc:o}=this.beans;if(!i.getColTree().length)return;n?.start();let a=[];for(let l of e){let c=l.groupId,d=l.open,u=this.getProvidedColGroup(c);u&&u.isExpanded()!==d&&(u.setExpanded(d),a.push(u))}r.refresh(t,!0),a.length&&o.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),n?.finish()}setColumnGroupOpened(e,t,i){let n;Si(e)?n=e.getId():n=e||"",this.setColumnGroupState([{groupId:n,open:t}],i)}getProvidedColGroup(e){let t=null;return co(null,this.beans.colModel.getColTree(),i=>{Si(i)&&i.getId()===e&&(t=i)}),t}getGroupAtDirection(e,t){let i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),r=t==="After"?dt(n):n[0],o=`getCol${t}`;for(;;){let s=this.beans.visibleCols[o](r);if(!s)return null;let a=this.getColGroupAtLevel(s,i);if(a!==e)return a}}getColGroupAtLevel(e,t){let i=e.getParent(),n,r;for(;n=i.getProvidedColumnGroup().getLevel(),r=i.getPaddingLevel(),!(n+r<=t);)i=i.getParent();return i}updateOpenClosedVisibility(){let e=this.beans.visibleCols.getAllTrees();ga(e,!1,t=>{It(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(It(e))return e;let i=this.beans.visibleCols.getAllTrees(),n=typeof t=="number",r=null;return ga(i,!1,o=>{if(It(o)){let s=o,a;n?a=e===s.getGroupId()&&t===s.getPartId():a=e===s.getGroupId(),a&&(r=s)}}),r}createColumnGroups(e){let{columns:t,idCreator:i,pinned:n,oldDisplayedGroups:r,isStandaloneStructure:o}=e,s=this.mapOldGroupsById(r),a=[],l=t;for(;l.length;){let c=l;l=[];let d=0,u=h=>{let p=d;d=h;let f=c[p],m=(It(f)?f.getProvidedColumnGroup():f).getOriginalParent();if(m==null){for(let C=p;C<h;C++)a.push(c[C]);return}let v=this.createColumnGroup(m,i,s,n,o);for(let C=p;C<h;C++)v.addChild(c[C]);l.push(v)};for(let h=1;h<c.length;h++){let p=c[h],g=(It(p)?p.getProvidedColumnGroup():p).getOriginalParent(),m=c[d],C=(It(m)?m.getProvidedColumnGroup():m).getOriginalParent();g!==C&&u(h)}d<c.length&&u(c.length)}return o||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,i,n,r,o,s){let a=r.getUniqueKey(t.groupId||null,null),l=x_(this.beans,t,a),c=new Og(l,a,!1,i);this.createBean(c);let d=this.findExistingGroup(t,o);d&&o.splice(d.idx,1);let u=d?.group;u&&c.setExpanded(u.isExpanded());let h=kF(this.beans,l.children,i+1,e,n,r,o,s);return c.setChildren(h),c}balanceColumnTree(e,t,i,n){let r=[];for(let o=0;o<e.length;o++){let s=e[o];if(Si(s)){let a=s,l=this.balanceColumnTree(a.getChildren(),t+1,i,n);a.setChildren(l),r.push(a)}else{let a,l;for(let c=t;c<i;c++){let d=n.getUniqueKey(null,null),u=x_(this.beans,null,d),h=new Og(u,d,!0,c);this.createBean(h),l&&l.setChildren([h]),l=h,a||(a=l)}if(a&&l)if(r.push(a),e.some(d=>Si(d))){l.setChildren([s]);continue}else{l.setChildren(e);break}r.push(s)}}return r}findDepth(e){let t=0,i=e;for(;i?.[0]&&Si(i[0]);)t++,i=i[0].getChildren();return t}findMaxDepth(e,t){let i=t;for(let n=0;n<e.length;n++){let r=e[n];if(Si(r)){let o=r,s=this.findMaxDepth(o.getChildren(),t+1);i<s&&(i=s)}}return i}balanceTreeForAutoCols(e,t){let i=[];for(let n of e){let r=n;for(let o=t-1;o>=0;o--){let s=new Og(null,`FAKE_PATH_${n.getId()}}_${o}`,!0,o);this.createBean(s),s.setChildren([r]),r.originalParent=s,r=s}t===0&&(n.originalParent=null),i.push(r)}return i}findExistingGroup(e,t){if(e.groupId!=null)for(let n=0;n<t.length;n++){let r=t[n];if(r.getColGroupDef()&&r.getId()===e.groupId)return{idx:n,group:r}}}createColumnGroup(e,t,i,n,r){let o=e.getGroupId(),s=t.getInstanceIdForKey(o),a=c8(o,s),l=i[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),pe(l)?l.reset():(l=new $u(e,o,s,n),r||this.createBean(l)),l}mapOldGroupsById(e){let t={},i=n=>{for(let r of n)if(It(r)){let o=r;t[r.getUniqueId()]=o,i(o.getChildren())}};return e&&i(e),t}setupParentsIntoCols(e,t){for(let i of e??[])if(i.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),i.parent=t,It(i)){let n=i;this.setupParentsIntoCols(n.getChildren(),n)}}},OX={moduleName:"ColumnGroup",version:fe,dynamicBeans:{headerGroupCellCtrl:bX},beans:[AX],apiFunctions:{getAllDisplayedColumnGroups:MX,getCenterDisplayedColumnGroups:DX,getColumnGroup:SX,getColumnGroupState:RX,getDisplayNameForColumnGroup:EX,getLeftDisplayedColumnGroups:_X,getProvidedColumnGroup:xX,getRightDisplayedColumnGroups:FX,resetColumnGroupState:kX,setColumnGroupOpened:yX,setColumnGroupState:PX}},LX={tag:"div",cls:"ag-skeleton-container"},NX=class extends st{constructor(){super(LX)}init(e){let t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>Bu(e.eParentOfValue)),Bu(e.eParentOfValue,t),e.deferRender?this.setupLoading(e):e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){let e=this.getLocaleTextFunc();this.getGui().textContent=e("loadingError","ERR");let t=e("ariaSkeletonCellLoadingFailed","Row failed to load");ec(this.getGui(),t)}setupLoading(e){let t=Xt({tag:"div",cls:"ag-skeleton-effect"}),i=e.node.rowIndex;if(i!=null){let o=75+25*(i%2===0?Math.sin(i):Math.cos(i));t.style.width=`${o}%`}this.getGui().appendChild(t);let n=this.getLocaleTextFunc(),r=e.deferRender?n("ariaDeferSkeletonCellLoading","Cell is loading"):n("ariaSkeletonCellLoading","Row data is loading");ec(this.getGui(),r)}refresh(e){return!1}},BX={moduleName:"CheckboxCellRenderer",version:fe,userComponents:{agCheckboxCellRenderer:MK}},HX={moduleName:"SkeletonCellRenderer",version:fe,userComponents:{agSkeletonCellRenderer:NX}};function zX(e,t){let i=e.colModel.getColDefCol(t);return i?i.getColDef():null}function VX(e){return e.colModel.getColumnDefs(!0)}function GX(e,t,i){return e.colNames.getDisplayNameForColumn(t,i)||""}function WX(e,t){return e.colModel.getColDefCol(t)}function UX(e){return e.colModel.getColDefCols()}function jX(e,t){return qn(e,t,"api")}function qX(e){return tm(e)}function $X(e){IU(e,"api")}function KX(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function YX(e){return e.visibleCols.isPinningLeft()}function XX(e){return e.visibleCols.isPinningRight()}function JX(e,t){return e.visibleCols.getColAfter(t)}function QX(e,t){return e.visibleCols.getColBefore(t)}function ZX(e,t,i){e.colModel.setColsVisible(t,i,"api")}function eJ(e,t,i){e.pinnedCols?.setColsPinned(t,i,"api")}function tJ(e){return e.colModel.getCols()}function iJ(e){return e.visibleCols.leftCols}function nJ(e){return e.visibleCols.centerCols}function rJ(e){return e.visibleCols.rightCols}function oJ(e){return e.visibleCols.allCols}function sJ(e){return e.colViewport.getViewportColumns()}function Jb(e,t){if(!e)return;let i=e,n={};for(let r of Object.keys(i)){if(t&&t.indexOf(r)>=0||iF.has(r))continue;let o=i[r];typeof o=="object"&&o!==null&&o.constructor===Object?n[r]=Jb(o):n[r]=o}return n}var aJ=class extends j{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,i,n,r=!1){let o=e.slice();t?o.sort((l,c)=>i.indexOf(l)-i.indexOf(c)):(i||r)&&o.sort((l,c)=>n.indexOf(l)-n.indexOf(c));let s=this.rowGroupColsSvc?.columns,a=this.pivotColsSvc?.columns;return this.buildColumnDefs(o,s,a)}buildColumnDefs(e,t=[],i=[]){let n=[],r={};for(let o of e){let s=this.createDefFromColumn(o,t,i),a=!0,l=s,c=o.getOriginalParent(),d=null;for(;c;){let u=null;if(c.isPadding()){c=c.getOriginalParent();continue}let h=r[c.getGroupId()];if(h){h.children.push(l),a=!1;break}if(u=this.createDefFromGroup(c),u&&(u.children=[l],r[u.groupId]=u,l=u,c=c.getOriginalParent()),c!=null&&d===c){a=!1;break}d=c}a&&n.push(l)}return n}createDefFromGroup(e){let t=Jb(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){let n=Jb(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?i.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=e.isVisible()?void 0:!0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSortDef(),n.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,n}},lJ=class extends j{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){let t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);let i=this.flexViewportWidth,{visibleCols:n,colDelayRenderSvc:r}=this.beans,o=n.centerCols,s=-1;if(e.resizingCols){let g=new Set(e.resizingCols);for(let m=o.length-1;m>=0;m--)if(g.has(o[m])){s=m;break}}let a=!1,l=o.map((g,m)=>{let v=g.getFlex(),C=v!=null&&v>0&&m>s;return a||(a=C),{col:g,isFlex:C,flex:Math.max(0,v??0),initialSize:g.getActualWidth(),min:g.getMinWidth(),max:g.getMaxWidth(),targetSize:0}});if(a?(r?.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(r),!i||!a)return[];let c=l.length,d=l.reduce((g,m)=>g+m.flex,0),u=i,h=(g,m)=>{g.frozenSize=m,g.col.setActualWidth(m,t),u-=m,d-=g.flex,c-=1},p=g=>g.frozenSize!=null;for(let g of l)g.isFlex||h(g,g.initialSize);for(;c>0;){let g=Math.round(d<1?u*d:u),m,v=0,C=0;for(let E of l){if(p(E))continue;m=E,C+=g*(E.flex/d);let x=C-v,P=Math.round(x);E.targetSize=P,v+=P}m&&(m.targetSize+=g-v);let b=0;for(let E of l){if(p(E))continue;let x=E.targetSize,P=Math.min(Math.max(x,E.min),E.max);b+=P-x,E.violationType=P===x?void 0:P<x?"max":"min",E.targetSize=P}let S=b===0?"all":b>0?"min":"max";for(let E of l)p(E)||(S==="all"||E.violationType===S)&&h(E,E.targetSize)}e.skipSetLeft||n.setLeftValues(t),e.updateBodyWidths&&n.updateBodyWidths();let f=l.filter(g=>g.isFlex&&!g.violationType).map(g=>g.col);if(e.fireResizedEvent){let g=l.filter(v=>v.initialSize!==v.frozenSize).map(v=>v.col),m=l.filter(v=>v.flex).map(v=>v.col);ic(this.eventSvc,g,!0,t,m)}return this.revealColumns(r),f}revealColumns(e){this.columnsHidden&&(e?.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){let{flex:t,initialFlex:i}=e.colDef;t!==void 0?e.flex=t:i!==void 0&&(e.flex=i)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function Au(e,t,i){if(!t||!e)return;if(!i)return e[t];let n=t.split("."),r=e;for(let o=0;o<n.length;o++){if(r==null)return;r=r[n[o]]}return r}var cJ=["dateTimeString","dateString","text","number","boolean","date"],dJ=class extends j{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===B.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:i}){return{cellEditorParams:{useFormatter:!0},comparator:(n,r)=>{let o=t.getColDefCol(i),s=o?.getColDef();if(!o||!s)return 0;let a=n==null?"":e({column:o,node:null,value:n}),l=r==null?"":e({column:o,node:null,value:r});return a===l?0:a>l?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){let e=this.getDefaultDataTypes(),t={},i={},n=d=>u=>{let{column:h,node:p,value:f}=u,g=h.getColDef().valueFormatter;return g===d.groupSafeValueFormatter&&(g=d.valueFormatter),this.beans.valueSvc.formatValue(h,p,f,g)};for(let d of Object.keys(e)){let u=e[d],h=T(w({},u),{groupSafeValueFormatter:dD(u,this.gos)});t[d]=h,i[d]=n(h)}let r=this.gos.get("dataTypeDefinitions")??{},o={};for(let d of Object.keys(r)){let u=r[d],h=this.processDataTypeDefinition(u,r,[d],e);h&&(t[d]=h,u.dataTypeMatcher&&(o[d]=u.dataTypeMatcher),i[d]=n(h))}let{valueParser:s,valueFormatter:a}=e.object,{valueParser:l,valueFormatter:c}=t.object;this.hasObjectValueParser=l!==s,this.hasObjectValueFormatter=c!==a,this.formatValueFuncs=i,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(o,e)}sortKeysInMatchers(e,t){let i=w({},e);for(let n of cJ)delete i[n],i[n]=e[n]??t[n].dataTypeMatcher;return i}processDataTypeDefinition(e,t,i,n){let r,o=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let s=n[o],a=t[o];if(s&&a&&(s=a),!cD(e,s,o))return;r=lD(s,e)}else{if(i.includes(o)){J(44);return}let s=t[o];if(!cD(e,s,o))return;let a=this.processDataTypeDefinition(s,t,[...i,o],n);if(!a)return;r=lD(a,e)}return T(w({},r),{groupSafeValueFormatter:dD(r,this.gos)})}updateColDefAndGetColumnType(e,t,i){let{cellDataType:n}=t,{field:r}=t;if(n===void 0&&(n=e.cellDataType),(n==null||n===!0)&&(n=this.canInferCellDataType(e,t)?this.inferCellDataType(r,i):!1),!n){e.cellDataType=!1;return}let o=this.dataTypeDefinitions[n];if(!o){J(47,{cellDataType:n});return}return e.cellDataType=n,o.groupSafeValueFormatter&&(e.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(e.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,o,i),o.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;let t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;let i=n=>{t.add(n.key)};e.__addEventListener("columnStateUpdated",i),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",i))}canInferCellDataType(e,t){let{gos:i}=this;if(!_t(i))return!1;let n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(vb(t,n))return!1;let r=t.type===null?e.type:t.type;if(r){let o=i.get("columnTypes")??{};if(em(r).some(a=>{let l=o[a.trim()];return l&&vb(l,n)}))return!1}return!vb(e,n)}inferCellDataType(e,t){if(!e)return;let i,n=this.getInitialData();if(n){let o=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");i=Au(n,e,o)}else this.initWaitForRowData(t);return i==null?void 0:Object.keys(this.dataTypeMatchers).find(o=>this.dataTypeMatchers[o](i))??"object"}getInitialData(){let e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{let t=this.beans.rowModel.rootNode?._leafs;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;let t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:i,eventSvc:n}=this.beans;t&&i&&(i.shouldQueueResizeOperations=!0);let[r]=this.addManagedEventListeners({rowDataUpdateStarted:o=>{let{firstRowData:s}=o;s&&(r?.(),this.isPendingInference=!1,this.processColumnsPendingInference(s,t),this.columnStateUpdatesPendingInference={},t&&i?.processResizeOperations(),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;let i=[];this.destroyColumnStateUpdateListeners();let n={},r={};for(let o of Object.keys(this.columnStateUpdatesPendingInference)){let s=this.columnStateUpdatesPendingInference[o],a=this.colModel.getCol(o);if(!a)return;let l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;let c=a.getColDef();if(t&&c.type&&c.type!==l.type){let d=hJ(a,s);d.rowGroup&&d.rowGroupIndex==null&&(n[o]=d),d.pivot&&d.pivotIndex==null&&(r[o]=d),i.push(d)}}t&&i.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,r)),i.length&&qn(this.beans,{state:i},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){let i={},{rowGroupColsSvc:n,pivotColsSvc:r}=this.beans;return n?.restoreColumnOrder(i,e),r?.restoreColumnOrder(i,t),Object.values(i)}resetColDefIntoCol(e,t){let i=e.getUserProvidedColDef();if(!i)return!1;let n=Ab(this.beans,i,e.getColId());return e.setColDef(n,i,t),!0}getDateStringTypeDefinition(e){let{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){let t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;let i=this.getDataTypeDefinition(e)?.dataTypeMatcher;return!i||e.getColDef().allowFormula&&this.beans.formula?.isFormula(t)?!0:i(t)}validateColDef(e){let t=i=>J(48,{property:i});if(e.cellDataType==="object"){let{object:i}=this.dataTypeDefinitions;e.valueFormatter===i.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===i.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){let t=e.cellDataType;if(!t||typeof t!="string")return;let{dataTypeDefinitions:i,beans:n,formatValueFuncs:r}=this,o=i[t];o&&n.colFilter?.setColDefPropsForDataType(e,o,r[t])}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,i,n){let r=this.formatValueFuncs[t],o=this.columnDefinitionPropsPerDataType[i.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:i,colId:n,formatValue:r});Object.assign(e,o)}getDateObjectTypeDef(e){let t=this.getLocaleTextFunc(),i=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:n=>qi(n.newValue&&String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):an(n.value,i)??"",dataTypeMatcher:n=>n instanceof Date}}getDateStringTypeDef(e){let t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:i=>qi(i)??void 0,dateFormatter:i=>an(i??null,t)??void 0,valueParser:i=>Lg(String(i.newValue))?i.newValue:null,valueFormatter:i=>Lg(String(i.value))?String(i.value):"",dataTypeMatcher:i=>typeof i=="string"&&Lg(i)}}getDefaultDataTypes(){let e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>t.newValue?.trim?.()===""?null:Number(t.newValue),valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:Rb(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>t.newValue==null?t.newValue:t.newValue?.trim?.()===""?null:String(t.newValue).toLowerCase()==="true",valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:T(w({},this.getDateStringTypeDef("dateTimeString")),{dataTypeMatcher:t=>typeof t=="string"&&Oj(t)}),object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>Rb(t.value)??""}}}destroyColumnStateUpdateListeners(){for(let e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function lD(e,t){let i=w(w({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...em(e.columnTypes),...em(t.columnTypes)]),i}function cD(e,t,i){return t?t.baseDataType!==e.baseDataType?(J(46),!1):!0:(J(45,{parentCellDataType:i}),!1)}function dD(e,t){if(e.valueFormatter)return i=>{if(i.node?.group){let n=(i.colDef.pivotValueColumn??i.column).getAggFunc();if(n){if(n==="first"||n==="last")return e.valueFormatter(i);if(e.baseDataType==="number"&&n!=="count"){if(typeof i.value=="number")return e.valueFormatter(i);if(typeof i.value=="object"){if(!i.value)return;if("toNumber"in i.value)return e.valueFormatter(T(w({},i),{value:i.value.toNumber()}));if("value"in i.value)return e.valueFormatter(T(w({},i),{value:i.value.value}))}}return}}else if(t.get("groupHideOpenParents")&&i.column.isRowGroupActive()&&typeof i.value=="string"&&!e.dataTypeMatcher?.(i.value))return;return e.valueFormatter(i)}}function uJ(e,t,i,n){if(!t[i])return!1;let r=e[i];return r===null?(t[i]=!1,!1):n===void 0?!!r:r===n}function vb(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([i,n])=>uJ(e,t,i,n))}function hJ(e,t){let i=AF(e);for(let n of t)delete i[n],n==="rowGroup"?delete i.rowGroupIndex:n==="pivot"&&delete i.pivotIndex;return i}var pJ={moduleName:"DataType",version:fe,beans:[dJ],dependsOn:[BX]},fJ={moduleName:"ColumnFlex",version:fe,beans:[lJ]},V8={moduleName:"ColumnApi",version:fe,beans:[aJ],apiFunctions:{getColumnDef:zX,getDisplayNameForColumn:GX,getColumn:WX,getColumns:UX,applyColumnState:jX,getColumnState:qX,resetColumnState:$X,isPinning:KX,isPinningLeft:YX,isPinningRight:XX,getDisplayedColAfter:JX,getDisplayedColBefore:QX,setColumnsVisible:ZX,setColumnsPinned:eJ,getAllGridColumns:tJ,getDisplayedLeftColumns:iJ,getDisplayedCenterColumns:nJ,getDisplayedRightColumns:rJ,getAllDisplayedColumns:oJ,getAllDisplayedVirtualColumns:sJ,getColumnDefs:VX}};function gJ(e){if(!e||e==null)return null;let t=/([a-z])([A-Z])/g,i=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(i,"$1 $2$3").replace(/\./g," ").split(" ").map(r=>r.substring(0,1).toUpperCase()+(r.length>1?r.substring(1,r.length):"")).join(" ")}var mJ=class extends j{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,i=!1){if(!e)return null;let n=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:r}=this.beans;return i&&r?r.getHeaderName(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,i){let n=t?.getColGroupDef();return n?this.getHeaderName(n,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,i,n,r){let o=e.headerValueGetter;if(o){let s=_e(this.gos,{colDef:e,column:t,columnGroup:i,providedColumnGroup:n,location:r});return typeof o=="function"?o(s):typeof o=="string"?this.beans.expressionSvc?.evaluate(o,s)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return gJ(e.field)}return""}},vJ=class extends j{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,i=!1){let{visibleCols:n}=this,r=n.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!r)){if(this.scrollWidth=e,this.scrollPosition=t,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){let s=n.bodyWidth;this.viewportLeft=s-t-e,this.viewportRight=s-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(i)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let i;switch(e){case"left":i=this.rowsOfHeadersToRenderLeft[t];break;case"right":i=this.rowsOfHeadersToRenderRight[t];break;default:i=this.rowsOfHeadersToRenderCenter[t];break}return i??[]}extractViewportColumns(){let e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||CJ(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;let t=e.getLeft()||0,i=t+e.getActualWidth(),n=this.viewportLeft-200,r=this.viewportRight+200,o=t<n&&i<n,s=t>r&&i>r;return!o&&!s}getViewportColumns(){let{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;let t=o=>{let s=o.getLeft();return pe(s)&&s>this.viewportLeft},i=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:n}=this,r=n.centerCols;return n.getColsForRow(e,r,i,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){let{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;let i=n=>{let r=new Set,o={};for(let s of n){let a=s.getParent(),l=s.isSpanHeaderHeight();for(;a&&!r.has(a);){if(l&&a.isPadding()){a=a.getParent();continue}let d=a.getProvidedColumnGroup().getLevel();o[d]??(o[d]=[]),o[d].push(a),r.add(a),a=a.getParent()}}return o};this.rowsOfHeadersToRenderLeft=i(e),this.rowsOfHeadersToRenderRight=i(t),this.rowsOfHeadersToRenderCenter=i(this.headerColsWithinViewport)}extractViewport(){let e=n=>`${n.getId()}-${n.getPinned()||"normal"}`;this.extractViewportColumns();let t=this.getViewportColumns().map(e).join("#"),i=this.colsWithinViewportHash!==t;return i&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),i}};function CJ(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var wJ=class extends j{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class i{refresh(){return!1}getGui(){return this.eGui}init(r){let o=t(r),s=typeof o;if(s==="string"||s==="number"||s==="boolean"){this.eGui=dy("<span>"+o+"</span>");return}if(o==null){this.eGui=Xt({tag:"span"});return}this.eGui=o}}return i}},bJ={moduleName:"CellRendererFunction",version:fe,beans:[wJ]},yJ=class extends Dq{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){let e=this.gos.get("components");if(e!=null)for(let t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){let{icons:t,userComponents:i,dynamicBeans:n,selectors:r}=e;if(i){let o=(s,a,l,c)=>{this.agGridDefaults[s]=a,(l||c)&&(this.agGridDefaultOverrides[s]={params:l,processParams:c})};for(let s of Object.keys(i)){let a=i[s];if(mj(a)&&(a=a.getComp(this.beans)),typeof a=="object"){let{classImp:l,params:c,processParams:d}=a;o(s,l,c,d)}else o(s,a)}}this.registerDynamicBeans(n);for(let o of r??[])this.selectors[o.selector]=o;if(t)for(let o of Object.keys(t))this.icons[o]=t[o]}getUserComponent(e,t){let i=(a,l,c,d)=>({componentFromFramework:l,component:a,params:c,processParams:d}),{frameworkOverrides:n}=this.beans,r=n.frameworkComponent(t,this.gos.get("components"));if(r!=null)return i(r,!0);let o=this.jsComps[t];if(o){let a=n.isFrameworkComponent(o);return i(o,a)}let s=this.agGridDefaults[t];if(s){let a=this.agGridDefaultOverrides[t];return i(s,!1,a?.params,a?.processParams)}return this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){return t?Fr(279,{name:e}):this.beans.validation?.missingDynamicBean(e)??Fr(256)}},SJ=23,xJ=class extends j{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(let e of this.readyCallbacks)e(this.params);this.readyCallbacks.length=0}},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){let e=Object.values(this.params);this.ready=e.length===SJ&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{let i=this.readyCallbacks.indexOf(t);i>=0&&this.readyCallbacks.splice(i,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){let{leftHeader:e,centerHeader:t,rightHeader:i}=this.params;return[e,i,t]}getHeaderRowContainerCtrl(e){let t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},EJ='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}.ag-drag-handle-disabled{opacity:.35;pointer-events:none}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-row-drag-indicator-color);border-radius:calc(var(--ag-row-drag-indicator-width)/2);content:"";height:var(--ag-row-drag-indicator-width);pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-exporting-wrapper,.ag-overlay-loading-wrapper,.ag-overlay-modal-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label,:where(.ag-header-group-cell-selectable) .ag-header-cell-comp-wrapper{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{color:var(--ag-subtle-text-color)}}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{margin-right:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{margin-left:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{color:var(--ag-subtle-text-color)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{margin-left:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{margin-right:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-column-drag-indicator-color);border-radius:calc(var(--ag-column-drag-indicator-width)/2);content:"";height:100%;position:absolute;top:0;width:var(--ag-column-drag-indicator-width)}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}:where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}}:where(.ag-ltr) :where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){&:after{right:-1px}}:where(.ag-rtl) :where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){&:after{left:-1px}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',RJ={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:Ei,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Vt,rangeSelectionBackgroundColor:on(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:on(.5),rangeHeaderHighlightColor:lq(.08),rowNumbersSelectedColor:on(.5),rowHoverColor:on(.08),columnHoverColor:on(.05),selectedRowBackgroundColor:on(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:Ei,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:_n(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:_n(.1),iconButtonActiveColor:Vt,iconButtonActiveBackgroundColor:on(.28),iconButtonActiveIndicatorColor:Vt,menuBorder:{color:_n(.2)},menuBackgroundColor:xi(.03),menuTextColor:xi(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:_n(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Vt},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:_n(.2)},panelBackgroundColor:Ei,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:_n(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:_n(.13)},selectCellBackgroundColor:_n(.07),selectCellBorder:{color:_n(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:Ei,filterPanelApplyButtonBackgroundColor:Vt,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:Ol,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:Ol,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:_n(.15),statusBarLabelColor:Ol,statusBarLabelFontWeight:500,statusBarValueColor:Ol,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"},rowDragIndicatorColor:{ref:"rangeSelectionBorderColor"},rowDragIndicatorWidth:2,columnDragIndicatorColor:{ref:"accentColor"},columnDragIndicatorWidth:2},PJ=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",G8={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},kJ=T(w({},G8),{cellBatchEditTextColor:"#f3d0b3"}),_J=()=>ln({feature:"batchEditStyle",params:G8,css:PJ}),DJ=_J(),W8=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",U8={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}};var FJ=()=>ln({feature:"buttonStyle",params:T(w({},U8),{buttonBackgroundColor:Ei,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Vt}}),css:W8}),MJ=FJ(),TJ=()=>ln({feature:"buttonStyle",params:T(w({},U8),{buttonBackgroundColor:Ei,buttonBorder:{color:Vt},buttonFontWeight:600,buttonTextColor:Vt,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBackgroundColor:Vt,buttonActiveTextColor:Ei}),css:W8}),IJ=TJ();var AJ=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}";var OJ=()=>ln({feature:"columnDropStyle",css:AJ}),Wy=OJ();var LJ={warn:(...e)=>{J(e[0],e[1])},error:(...e)=>{Ze(e[0],e[1])},preInitErr:(...e)=>{Pu(e[0],e[2],e[1])}},j8=()=>wq(LJ).withParams(RJ).withPart(MJ).withPart(Wy).withPart(DJ),NJ='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',BJ=()=>ln({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:Ei,checkboxUncheckedBorderColor:xi(.3),checkboxCheckedBackgroundColor:Vt,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:Ei,checkboxIndeterminateBackgroundColor:xi(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:Ei,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:NJ}),q8=BJ();var $8=()=>T(w(w({},rm),kJ),{backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:xi(.05),rowHoverColor:on(.15),selectedRowBackgroundColor:on(.2),menuBackgroundColor:xi(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:Ol,findMatchColor:Ei,findActiveMatchColor:Ei,checkboxUncheckedBorderColor:xi(.4),toggleButtonOffBackgroundColor:xi(.4),rowBatchEditBackgroundColor:xi(.1)});var HJ=()=>T(w({},$8()),{backgroundColor:"#1f2836"});var zJ=()=>ln({feature:"colorScheme",params:rm,modeParams:{light:rm,dark:$8(),"dark-blue":HJ()}}),K8=zJ();var VJ=`.ag-icon-aggregation:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24 6H8v2l8 8-8 8v2h16v-2H11l8-8-8-8h13z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-arrows:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.515 11.171 2.687 16l4.828 4.829-1.414 1.414L-.142 16l6.243-6.243zm16.97 0 1.414-1.414L32.142 16l-6.243 6.243-1.414-1.414L29.313 16zM16.028 13.2l2.829 2.828-2.829 2.829-2.828-2.829zm-4.857 11.285L16 29.313l4.829-4.828 1.414 1.414L16 32.142l-6.243-6.243zm0-16.97L9.757 6.101 16-.142l6.243 6.243-1.414 1.414L16 2.687z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-asc:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-aasc:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='%23000' d='M13.201 8.08q.65 0 1.135.222.487.222.759.618.27.396.279.919H14.19a.72.72 0 0 0-.293-.536q-.26-.191-.705-.192-.302.001-.51.086a.7.7 0 0 0-.32.23.56.56 0 0 0-.108.338.5.5 0 0 0 .065.273.7.7 0 0 0 .204.203q.127.083.295.146.168.06.36.102l.525.125q.382.086.701.229.32.143.554.35.234.21.362.49.131.284.134.648a1.6 1.6 0 0 1-.273.93q-.27.391-.777.608-.504.214-1.217.214-.708 0-1.232-.217a1.8 1.8 0 0 1-.816-.642q-.29-.428-.305-1.058h1.194q.02.294.17.49.15.195.402.294.253.097.573.097.313 0 .544-.09a.84.84 0 0 0 .362-.255.6.6 0 0 0 .129-.374q0-.195-.117-.33a.9.9 0 0 0-.337-.228 3.4 3.4 0 0 0-.54-.171l-.635-.16q-.738-.18-1.166-.562t-.426-1.03a1.53 1.53 0 0 1 .284-.927q.287-.396.79-.618a2.8 2.8 0 0 1 1.14-.223'/%3E%3Cpath fill='%23000' fill-rule='evenodd' d='M5.813 14H4.489l-.432-1.332H1.948L1.515 14H.19l2.017-5.84h1.592zm-3.551-2.296h1.481l-.718-2.21H2.98zM8.452 8.16q.645 0 1.075.19.43.191.648.531a1.4 1.4 0 0 1 .217.775q0 .343-.137.602-.137.256-.376.422a1.6 1.6 0 0 1-.542.231v.057q.333.015.624.188.294.175.476.489.183.31.183.74 0 .466-.231.831a1.56 1.56 0 0 1-.676.573Q9.265 14 8.609 14H6.114V8.16zM7.35 12.99h1.006q.517 0 .753-.196a.66.66 0 0 0 .237-.531.8.8 0 0 0-.116-.428.8.8 0 0 0-.334-.29 1.15 1.15 0 0 0-.511-.106H7.349zm0-2.386h.916q.254 0 .45-.09a.75.75 0 0 0 .313-.256.67.67 0 0 0 .118-.396.64.64 0 0 0-.226-.511q-.223-.195-.633-.194H7.35z' clip-rule='evenodd'/%3E%3Cpath fill='%23000' d='M7.166.377a.75.75 0 0 1 .919.066l3.333 3a.75.75 0 0 1-1.003 1.115L7.609 2.033 5.113 4.53a.75.75 0 0 1-1.06-1.06l3-3z'/%3E%3C/svg%3E")}.ag-icon-cancel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667A13.32 13.32 0 0 0 2.667 16c0 7.373 5.96 13.333 13.333 13.333S29.333 23.373 29.333 16 23.373 2.667 16 2.667m6.667 18.12-1.88 1.88L16 17.88l-4.787 4.787-1.88-1.88L14.12 16l-4.787-4.787 1.88-1.88L16 14.12l4.787-4.787 1.88 1.88L17.88 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-chart:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Echart%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M14 7h4v18h-4zM8 17h4v8H8zM20 13h4v12h-4z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-color-picker:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M23.907 17.587 10.574 4.254l-1.88 1.88 3.173 3.173-8.28 8.28 10.16 10.16zm-16.547 0 6.387-6.387 6.387 6.387zm18.387 2s-2.667 2.893-2.667 4.667c0 1.467 1.2 2.667 2.667 2.667s2.667-1.2 2.667-2.667c0-1.773-2.667-4.667-2.667-4.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-columns:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26 25H6V7h20zM12 11H8v12h4zm6 0h-4v12h4zm6 12V11h-4v12z' style='fill-rule:nonzero' transform='translate(0 -1)'/%3E%3C/svg%3E")}.ag-icon-contracted:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m12 6 10 10-10 10-2-2 8-8-8-8z'/%3E%3C/svg%3E")}.ag-icon-copy:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22 1.333H6A2.675 2.675 0 0 0 3.333 4v18.667H6V4h16zm4 5.334H11.333a2.675 2.675 0 0 0-2.667 2.667v18.667c0 1.467 1.2 2.667 2.667 2.667H26c1.467 0 2.667-1.2 2.667-2.667V9.334c0-1.467-1.2-2.667-2.667-2.667M26 28H11.333V9.333H26z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-cross:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.984 13.894 27.05 2.828l2.122 2.122-11.066 11.066 11.066 11.066-2.122 2.12-11.066-11.066L4.918 29.202l-2.12-2.12 11.066-11.066L2.798 4.95l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-csv:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='M.688-.226a.2.2 0 0 1-.017.074.28.28 0 0 1-.145.14.412.412 0 0 1-.234.013.28.28 0 0 1-.202-.168.468.468 0 0 1-.04-.19q0-.086.025-.155a.319.319 0 0 1 .182-.191.4.4 0 0 1 .134-.025q.087 0 .155.035a.3.3 0 0 1 .104.085.17.17 0 0 1 .036.097.06.06 0 0 1-.018.044.06.06 0 0 1-.042.019.06.06 0 0 1-.042-.013.2.2 0 0 1-.031-.046.2.2 0 0 0-.066-.079.16.16 0 0 0-.095-.027.17.17 0 0 0-.142.068.3.3 0 0 0-.053.193.4.4 0 0 0 .023.139.2.2 0 0 0 .067.083.2.2 0 0 0 .1.027q.063 0 .106-.031a.2.2 0 0 0 .065-.091.2.2 0 0 1 .023-.046q.014-.018.044-.018a.06.06 0 0 1 .044.018.06.06 0 0 1 .019.045' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 7.122 25.977)'/%3E%3Cpath d='M.622-.215a.2.2 0 0 1-.033.117.23.23 0 0 1-.098.081.4.4 0 0 1-.153.029.34.34 0 0 1-.175-.04.23.23 0 0 1-.079-.077.17.17 0 0 1-.031-.093q0-.027.019-.045a.06.06 0 0 1 .046-.019.06.06 0 0 1 .039.014.1.1 0 0 1 .027.044.3.3 0 0 0 .03.057q.015.023.044.038.03.015.076.015.065 0 .105-.03a.09.09 0 0 0 .04-.075.08.08 0 0 0-.022-.058.14.14 0 0 0-.056-.034 1 1 0 0 0-.092-.025.7.7 0 0 1-.129-.042.2.2 0 0 1-.083-.066.17.17 0 0 1-.03-.104q0-.058.032-.105a.2.2 0 0 1 .093-.07.4.4 0 0 1 .144-.025q.066 0 .114.016a.3.3 0 0 1 .08.044.2.2 0 0 1 .046.057q.015.03.015.058a.07.07 0 0 1-.018.046.06.06 0 0 1-.046.021q-.025 0-.038-.012a.2.2 0 0 1-.028-.041.2.2 0 0 0-.047-.063Q.387-.625.326-.625a.15.15 0 0 0-.09.025q-.035.024-.035.059 0 .021.012.037a.1.1 0 0 0 .032.027.4.4 0 0 0 .111.036q.06.015.11.031.048.018.083.042a.2.2 0 0 1 .054.062.2.2 0 0 1 .019.091' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 13.339 25.977)'/%3E%3Cpath d='m.184-.633.162.48.163-.483q.013-.038.019-.053a.062.062 0 0 1 .061-.039q.018 0 .034.009a.1.1 0 0 1 .025.025q.009.015.009.031L.654-.64l-.007.025-.009.024-.173.468-.019.051a.2.2 0 0 1-.021.042.1.1 0 0 1-.033.03.1.1 0 0 1-.049.012.1.1 0 0 1-.05-.011A.1.1 0 0 1 .26-.03a.2.2 0 0 1-.021-.042L.22-.123.05-.587.041-.612.033-.638.03-.662q0-.025.02-.046a.07.07 0 0 1 .05-.02q.037 0 .053.023.015.023.031.072' style='fill-rule:nonzero' transform='matrix(8.39799 0 0 12.455 18.94 25.977)'/%3E%3C/svg%3E")}.ag-icon-cut:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M13.775 15.198 3.835 2.945a1.501 1.501 0 0 1 2.33-1.89l14.997 18.488A6.003 6.003 0 0 1 29.657 25c0 3.311-2.688 6-6 6s-6-2.689-6-6c0-1.335.437-2.569 1.176-3.566l-3.127-3.855-3.001 3.7A5.97 5.97 0 0 1 14 25c0 3.311-2.689 6-6 6s-6-2.689-6-6a6.003 6.003 0 0 1 8.315-5.536zm9.882 6.702a3.1 3.1 0 0 0-3.1 3.1c0 1.711 1.389 3.1 3.1 3.1s3.1-1.389 3.1-3.1-1.389-3.1-3.1-3.1M8 21.95a3.05 3.05 0 1 0 .001 6.101A3.05 3.05 0 0 0 8 21.95m9.63-11.505 1.932 2.381 8.015-9.881a1.5 1.5 0 0 0-2.329-1.89z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-desc:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m26.667 16-1.88-1.88-7.453 7.44V5.333h-2.667V21.56l-7.44-7.453L5.334 16l10.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-adesc:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='%23000' d='M10.387 11.47a.75.75 0 0 1 1.06 1.06l-3 3-.113.093a.75.75 0 0 1-.919-.065l-3.333-3a.75.75 0 0 1 1.003-1.116l2.806 2.525zM13.201 3.08q.65 0 1.135.222.487.223.759.619.27.396.279.918H14.19a.72.72 0 0 0-.293-.536q-.26-.192-.705-.192-.302.001-.51.086a.7.7 0 0 0-.32.23.56.56 0 0 0-.108.338.5.5 0 0 0 .065.273.7.7 0 0 0 .204.203q.127.083.295.146.168.06.36.102l.525.125a3.7 3.7 0 0 1 .701.229q.32.143.554.35.234.21.362.492.131.282.134.647a1.6 1.6 0 0 1-.273.93 1.74 1.74 0 0 1-.777.607q-.504.214-1.217.214-.708 0-1.232-.217a1.8 1.8 0 0 1-.816-.641q-.29-.429-.305-1.059h1.194q.02.294.17.49.15.195.402.294.253.098.573.098.313 0 .544-.092a.84.84 0 0 0 .362-.254.6.6 0 0 0 .129-.373.5.5 0 0 0-.117-.33.9.9 0 0 0-.337-.23 3.4 3.4 0 0 0-.54-.17l-.635-.16q-.738-.18-1.166-.562t-.426-1.03a1.53 1.53 0 0 1 .284-.926q.287-.396.79-.62a2.8 2.8 0 0 1 1.14-.222'/%3E%3Cpath fill='%23000' fill-rule='evenodd' d='M5.813 9H4.489l-.432-1.332H1.948L1.515 9H.19l2.017-5.84h1.592zM2.262 6.704h1.481l-.718-2.21H2.98zM8.452 3.16q.645 0 1.075.19.43.192.648.53a1.4 1.4 0 0 1 .217.776q0 .342-.137.602a1.2 1.2 0 0 1-.376.423 1.6 1.6 0 0 1-.542.23v.058q.333.014.624.187.294.175.476.489.183.31.183.74 0 .465-.231.83a1.56 1.56 0 0 1-.676.574Q9.265 9 8.609 9H6.114V3.16zM7.35 7.99h1.006q.517 0 .753-.196a.66.66 0 0 0 .237-.531.8.8 0 0 0-.116-.428.8.8 0 0 0-.334-.291 1.15 1.15 0 0 0-.511-.106H7.349zm0-2.386h.916q.254 0 .45-.09a.75.75 0 0 0 .313-.256.67.67 0 0 0 .118-.397.64.64 0 0 0-.226-.51q-.223-.194-.633-.194H7.35z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m26.667 16-1.88-1.88-7.453 7.44V5.333h-2.667V21.56l-7.44-7.453L5.334 16l10.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-excel:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M384 131.9c-7.753-8.433-110.425-128.473-114.9-133L48-.1C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48zm-35.9 2.1H257V27.9zM30 479V27h200l1 105c0 13.3-1.3 29 12 29h111l1 318z' style='fill-rule:nonzero' transform='translate(3.934 -.054)scale(.06285)'/%3E%3Cpath d='m.052-.139.16-.234-.135-.208a.4.4 0 0 1-.028-.052.1.1 0 0 1-.01-.042.05.05 0 0 1 .018-.037.07.07 0 0 1 .045-.016q.03 0 .047.018a1 1 0 0 1 .047.066l.107.174.115-.174.024-.038.019-.026.021-.015a.1.1 0 0 1 .027-.005.06.06 0 0 1 .044.016.05.05 0 0 1 .018.039q0 .033-.038.089l-.141.211.152.234a.3.3 0 0 1 .03.051.1.1 0 0 1 .009.038.1.1 0 0 1-.008.031.1.1 0 0 1-.024.023.1.1 0 0 1-.034.008.1.1 0 0 1-.035-.008.1.1 0 0 1-.023-.022L.427-.067.301-.265l-.134.204-.022.034-.016.019a.1.1 0 0 1-.022.015.1.1 0 0 1-.03.005.06.06 0 0 1-.044-.016.06.06 0 0 1-.017-.047q0-.036.036-.088' style='fill-rule:nonzero' transform='matrix(17.82892 0 0 16.50777 10.371 25.928)'/%3E%3C/svg%3E")}.ag-icon-expanded:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 26 10 16 20 6l2 2-8 8 8 8z'/%3E%3C/svg%3E")}.ag-icon-eye-slash:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Eeye-slash%3C/title%3E%3Cpath fill='%23000' fill-rule='nonzero' d='M8.95 10.364 7 8.414 8.414 7l2.32 2.32A13.2 13.2 0 0 1 16.5 8c5.608 0 10.542 3.515 12.381 8.667L29 17l-.119.333a13 13 0 0 1-4.255 5.879l1.466 1.466-1.414 1.414-1.754-1.753A13.2 13.2 0 0 1 16.5 26c-5.608 0-10.542-3.515-12.381-8.667L4 17l.119-.333a13 13 0 0 1 4.83-6.303m1.445 1.445A11.02 11.02 0 0 0 6.148 17c1.646 4.177 5.728 7 10.352 7 1.76 0 3.441-.409 4.94-1.146l-1.878-1.878A5.06 5.06 0 0 1 16.5 22c-2.789 0-5.05-2.239-5.05-5 0-1.158.398-2.223 1.065-3.07zm1.855-.974 1.794 1.795A5.07 5.07 0 0 1 16.5 12c2.789 0 5.05 2.239 5.05 5 0 .9-.24 1.745-.661 2.474l2.305 2.306A11 11 0 0 0 26.852 17c-1.646-4.177-5.728-7-10.352-7-1.495 0-2.933.295-4.25.835'/%3E%3C/svg%3E")}.ag-icon-eye:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16.5 23c4.624 0 8.706-2.823 10.352-7-1.646-4.177-5.728-7-10.352-7s-8.706 2.823-10.352 7c1.646 4.177 5.728 7 10.352 7M4.119 15.667C5.958 10.515 10.892 7 16.5 7s10.542 3.515 12.381 8.667L29 16l-.119.333C27.042 21.485 22.108 25 16.5 25S5.958 21.485 4.119 16.333L4 16zM16.5 21c2.789 0 5.049-2.239 5.049-5s-2.26-5-5.049-5-5.049 2.239-5.049 5 2.26 5 5.049 5' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-filter:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m28 8-8 8v5l-6 6V16L6 8V6h22zM9 8l7 7v7l2-2v-5l7-7z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-first:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.273 22.12 18.153 16l6.12-6.12L22.393 8l-8 8 8 8zM7.727 8h2.667v16H7.727z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-group:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 7v1H9V7zm0-3v1H5.001V4zm-7 7H5v-1h2zm0-3H5V7h2zM3 5H1V4h2zm11 5v1H9v-1zm-7 4H5v-1h2zm7-1v1H9v-1z' style='fill-rule:nonzero' transform='matrix(2 0 0 2 0 -2)'/%3E%3C/svg%3E")}.ag-icon-last:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m7.727 9.88 6.12 6.12-6.12 6.12L9.607 24l8-8-8-8zM21.607 8h2.667v16h-2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M26.667 14.667H10.44l7.453-7.453L16 5.334 5.333 16.001 16 26.668l1.88-1.88-7.44-7.453h16.227z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-linked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M5.2 16a4.136 4.136 0 0 1 4.133-4.133h5.333V9.334H9.333a6.67 6.67 0 0 0-6.667 6.667 6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.333A4.136 4.136 0 0 1 5.2 16.002zm5.467 1.333h10.667v-2.667H10.667zm12-8h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133 4.136 4.136 0 0 1-4.133 4.133h-5.333v2.533h5.333a6.67 6.67 0 0 0 6.667-6.667 6.67 6.67 0 0 0-6.667-6.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-loading:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M17 29h-2v-8h2zm-3.586-9L7 26.414 5.586 25 12 18.586zm13 5L25 26.414 18.586 20 20 18.586zM29 17h-8v-2h8zm-18 0H3v-2h8zm2.414-5L12 13.414 5.586 7 7 5.586zm13-5L20 13.414 18.586 12 25 5.586zM17 11h-2V3h2z' style='fill-rule:nonzero' transform='translate(-3.692 -3.692)scale(1.23077)'/%3E%3C/svg%3E")}.ag-icon-maximize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M14 30H2V18h2.828v7.05l8.254-8.252 2.12 2.12-8.252 8.254H14zm4-28h12v12h-2.828V6.95l-8.254 8.252-2.12-2.12 8.252-8.254H18z'/%3E%3C/svg%3E")}.ag-icon-menu:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M20 13H0v-2h20zm0-6H0V5h20zm0-6H0v-2h20z' style='fill-rule:nonzero' transform='translate(6 9)'/%3E%3C/svg%3E")}.ag-icon-menu-alt:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M16 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6M16 27a3 3 0 1 0 0-6 3 3 0 0 0 0 6'/%3E%3C/svg%3E")}.ag-icon-minimize:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M2 18h12v12h-2.828v-7.05l-8.254 8.252-2.12-2.12 8.252-8.254H2zm28-4H18V2h2.828v7.05L29.082.798l2.12 2.12-8.252 8.254H30z'/%3E%3C/svg%3E")}.ag-icon-minus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658H7.901v-2.658z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-next:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.94 6 9.06 7.88 17.167 16 9.06 24.12 10.94 26l10-10z' style='fill-rule:nonzero' transform='translate(1)'/%3E%3C/svg%3E")}.ag-icon-none:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctitle%3Enone%3C/title%3E%3Cg fill='%23000' fill-rule='nonzero'%3E%3Cpath d='M23.708 14.645 16 6.939l-7.708 7.706 1.416 1.416L16 9.767l6.292 6.294zM23.708 20.355 16 28.061l-7.708-7.706 1.416-1.416L16 25.233l6.292-6.294z'/%3E%3C/g%3E%3C/svg%3E")}.ag-icon-not-allowed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M16 2.667C8.64 2.667 2.667 8.64 2.667 16S8.64 29.333 16 29.333 29.333 23.36 29.333 16 23.36 2.667 16 2.667M5.333 16c0-5.893 4.773-10.667 10.667-10.667 2.467 0 4.733.84 6.533 2.253L7.586 22.533A10.54 10.54 0 0 1 5.333 16M16 26.667c-2.467 0-4.733-.84-6.533-2.253L24.414 9.467A10.54 10.54 0 0 1 26.667 16c0 5.893-4.773 10.667-10.667 10.667' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-paste:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.334 4H19.76C19.2 2.453 17.733 1.333 16 1.333S12.8 2.453 12.24 4H6.667A2.675 2.675 0 0 0 4 6.667V28c0 1.467 1.2 2.667 2.667 2.667h18.667c1.467 0 2.667-1.2 2.667-2.667V6.667C28.001 5.2 26.801 4 25.334 4M16 4c.733 0 1.333.6 1.333 1.333s-.6 1.333-1.333 1.333-1.333-.6-1.333-1.333S15.267 4 16 4m9.333 24H6.666V6.667h2.667v4h13.333v-4h2.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m10.78 19.777-4.668-4.666s.032-1 .67-1.87c1.366-1.86 4.052-1.96 6.056-1.572l3.158-3.108c-.7-2.342 3.352-5.046 3.352-5.046l9.166 9.168q-.334.447-.67.894c-1.074 1.426-2.538 2.63-4.272 2.338l-3.32 3.218c.046.344.042.03.118 1.152.144 2.13-.64 4.324-2.632 5.34l-.746.364-4.798-4.798-7.292 7.294-1.416-1.416zm8.24-13.672c-.688.568-1.416 1.45-1.024 2.072l.49.722-4.986 4.988c-1.988-.506-4.346-.636-5.156.614l9.02 9.032q.14-.099.272-.21c1.226-1.08.764-3.04.498-4.9l4.79-4.79s1.47.938 2.936-.776l-6.79-6.79q-.026.019-.05.038' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-pivot:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M25.128 2.002c2.56.096 4.772 2.292 4.87 4.87a712 712 0 0 1 0 18.256c-.096 2.56-2.292 4.772-4.87 4.87a712 712 0 0 1-18.256 0c-2.558-.096-4.772-2.29-4.87-4.87a712 712 0 0 1 0-18.256c.096-2.56 2.292-4.772 4.87-4.87a712 712 0 0 1 18.256 0m2.966 7.954H9.892v18.136c5.086.13 10.18.098 15.264-.096 1.48-.094 2.746-1.35 2.84-2.84.192-5.064.226-10.134.098-15.2M3.968 24.1q.015.528.036 1.056c.094 1.484 1.354 2.746 2.84 2.84l1.012.036V24.1zM22 15.414l-.292.294-1.416-1.416L23 11.586l2.708 2.706-1.416 1.416-.292-.294v3.592c-.032 2.604-2.246 4.892-4.872 4.992L15.414 24l.294.292-1.416 1.416L11.586 23l2.706-2.708 1.416 1.416-.322.32c3.372.03 6.578-.164 6.614-3.034zM3.88 18.038c.002 1.346.012 2.694.038 4.04h3.938v-4.04zm.05-6.062a681 681 0 0 0-.044 4.042h3.97v-4.042zm5.962-7.99Q8.449 3.999 7.006 4c-1.57.02-2.946 1.348-3.004 2.922q-.02 1.517-.042 3.034h3.896v-2.02h2.036zm14.244-.016v3.966h3.898q-.017-.546-.038-1.092c-.094-1.48-1.35-2.746-2.84-2.84q-.51-.019-1.02-.034m-8.14-.054q-2.035.022-4.07.048v3.972h4.07zm6.106.008a213 213 0 0 0-4.07-.022v4.034h4.07z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-plus:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6.572 6.572a13.32 13.32 0 0 0 0 18.856 13.32 13.32 0 0 0 18.856 0 13.32 13.32 0 0 0 0-18.856 13.32 13.32 0 0 0-18.856 0m17.527 8.099v2.658h-6.77v6.77h-2.658v-6.77h-6.77v-2.658h6.77v-6.77h2.658v6.77z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-previous:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.94 7.88 20.06 6l-10 10 10 10 1.88-1.88L13.833 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m16 5.333-1.88 1.88 7.44 7.453H5.333v2.667H21.56l-7.44 7.453 1.88 1.88 10.667-10.667L16 5.332z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-save:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M15.708 2.355 8 10.061.292 2.355 1.708.939 8 7.233 14.292.939z' style='fill-rule:nonzero' transform='translate(8 14)'/%3E%3Cpath d='M5 26h22v2H5zM15 4h2v18h-2z'/%3E%3C/svg%3E")}.ag-icon-small-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 10.667 16 21.334l8.667-10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M21.333 7.334 10.666 16l10.667 8.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M10.667 24.666 21.334 16 10.667 7.333z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-small-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M7.334 21.333 16 10.666l8.667 10.667z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tick:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M11.586 22.96 27.718 6.828 29.84 8.95 11.586 27.202 2.4 18.016l2.12-2.122z'/%3E%3C/svg%3E")}.ag-icon-tree-closed:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m11.94 6-1.88 1.88L18.167 16l-8.107 8.12L11.94 26l10-10z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-tree-indeterminate:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M6 13.5h20v3H6z'/%3E%3C/svg%3E")}.ag-icon-tree-open:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M24.12 9.06 16 17.167 7.88 9.06 6 10.94l10 10 10-10z' style='fill-rule:nonzero' transform='translate(0 1)'/%3E%3C/svg%3E")}.ag-icon-unlinked:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M22.667 9.333h-5.333v2.533h5.333a4.136 4.136 0 0 1 4.133 4.133c0 1.907-1.307 3.507-3.08 3.973l1.947 1.947c2.173-1.107 3.667-3.32 3.667-5.92a6.67 6.67 0 0 0-6.667-6.667zm-1.334 5.334h-2.92l2.667 2.667h.253zM2.667 5.693 6.814 9.84A6.65 6.65 0 0 0 2.667 16a6.67 6.67 0 0 0 6.667 6.667h5.333v-2.533H9.334a4.136 4.136 0 0 1-4.133-4.133c0-2.12 1.613-3.867 3.68-4.093l2.76 2.76h-.973v2.667h3.64l3.027 3.027v2.307h2.307l5.347 5.333 1.68-1.68L4.362 4.002 2.669 5.695z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='m5.333 16 1.88 1.88 7.453-7.44v16.227h2.667V10.44l7.44 7.453L26.666 16 15.999 5.333 5.332 16z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-grip:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xml:space='preserve' style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2' viewBox='0 0 32 32'%3E%3Cpath d='M8 24H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 18H6v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zm6 0h-2v-4h2zM8 12H6V8h2zm6 0h-2V8h2zm6 0h-2V8h2zm6 0h-2V8h2z' style='fill-rule:nonzero'/%3E%3C/svg%3E")}.ag-icon-settings:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='%23000' d='M30 8h-4.1c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2v2h14.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30zm-9 4c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3M2 24h4.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30v-2H15.9c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2zm9-4c1.7 0 3 1.3 3 3s-1.3 3-3 3-3-1.3-3-3 1.3-3 3-3'/%3E%3C/svg%3E")}.ag-icon-column-arrow:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M11 4a1 1 0 0 1 1 1v22a1 1 0 1 1-2 0V5a1 1 0 0 1 1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 13a1 1 0 0 1 1-1h23.5a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1' clip-rule='evenodd'/%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M2 4h18v24H2zm2 2v20h14V6zM26.793 13 23 9.207l1.414-1.414L29.621 13l-5.207 5.207L23 16.793z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-un-pin:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='m6.112 15.111 3.272 3.271 1.436-1.402-2.476-2.479c.81-1.25 3.168-1.12 5.156-.614l4.986-4.988-.49-.722c-.392-.622.336-1.504 1.024-2.072l.008-.007.01-.006.032-.025 1.447 1.447 1.432-1.397-2.601-2.602s-4.052 2.704-3.352 5.046l-3.158 3.108c-2.004-.388-4.69-.288-6.056 1.572-.638.87-.67 1.87-.67 1.87m.581 11.582.014.014 5.502-5.501 4.783 4.783.746-.364c1.992-1.016 2.776-3.21 2.632-5.34-.055-.805-.068-.87-.088-.97-.008-.04-.017-.085-.03-.182l3.32-3.218c1.734.292 3.198-.912 4.272-2.338q.337-.447.67-.894l-.001-.001-.007-.007-.007-.007-.007-.007-3.87-3.87 1.585-1.584-1.414-1.414-14.381 14.38-1.237 1.209-5.69 5.687 1.417 1.416zM23.21 10.206l2.65 2.651c-1.465 1.714-2.935.776-2.935.776l-4.79 4.79q.041.291.087.583c.257 1.676.513 3.35-.585 4.317a4 4 0 0 1-.272.21l-3.739-3.744z' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-pinned-top:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='m16.708 10.878 8.708 8.706L24 21l-6.292-6.294V27h-2V14.706L9.416 21 8 19.584q4.348-4.344 8.691-8.69zM25 6H8v2h17z'/%3E%3C/svg%3E")}.ag-icon-pinned-bottom:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M16.708 22.122 8 13.416 9.416 12l6.292 6.294V6h2v12.294L24 12l1.416 1.416-8.691 8.69zM7.416 28h17v-2h-17z'/%3E%3C/svg%3E")}.ag-icon-chevron-up:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M3.479 10.521a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1-1.06 1.06l-3.47-3.47-3.47 3.47a.75.75 0 0 1-1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-down:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M12.521 5.461a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 1.06-1.06l3.47 3.47 3.47-3.47a.75.75 0 0 1 1.06 0' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-left:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M10.53 12.512a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 0-1.06l4-4a.75.75 0 0 1 1.06 1.06l-3.47 3.47 3.47 3.47a.75.75 0 0 1 0 1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-chevron-right:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E%3Cpath fill='currentColor' fill-rule='evenodd' d='M5.47 3.47a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06-1.06L8.94 8 5.47 4.53a.75.75 0 0 1 0-1.06' clip-rule='evenodd'/%3E%3C/svg%3E")}.ag-icon-filter-add:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M19.834 8H8c0 .304.06.612.258.842 2.716 2.854 6.682 5.548 6.742 7.974V21l2-1.5v-2.684c.056-2.267 2.968-4.417 5.49-6.75v3.087c-1.081.974-2.245 1.968-3.232 3.005a1.05 1.05 0 0 0-.258.682v3.66L13 25c0-2.74.066-5.482-.002-8.222a1.05 1.05 0 0 0-.256-.62C10.026 13.304 6.06 10.61 6 8.184V6h13.834z'/%3E%3Cpath fill='currentColor' d='M26 6h2.946v2.002H26v3.313h-2.002V8.002h-2.946V6h2.946V3.04H26z'/%3E%3C/svg%3E")}.ag-icon-edit:before{mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' fill='none' viewBox='0 0 32 32'%3E%3Cpath fill='currentColor' d='M6.222 25.778h1.611l14.834-14.811-1.611-1.611-14.834 14.81zM4 28v-4.733L22.644 4.656a2.26 2.26 0 0 1 1.567-.634q.423 0 .833.167.412.166.734.478l1.589 1.6q.333.322.483.733t.15.822q0 .423-.161.839-.162.416-.472.728L8.733 28zm17.856-17.833-.8-.811 1.61 1.61z'/%3E%3C/svg%3E")}`,GJ=ln({feature:"iconSet",css:VJ});var Y8={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>'},X8={aasc:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.2012 8.07928C13.6346 8.0793 14.0128 8.15365 14.3359 8.30193C14.6609 8.45018 14.9141 8.65595 15.0947 8.9201C15.2754 9.18439 15.3683 9.49109 15.374 9.83904H14.1904C14.1676 9.60898 14.0695 9.4303 13.8965 9.30291C13.7235 9.1756 13.4889 9.1115 13.1924 9.1115C12.9909 9.1115 12.8204 9.1404 12.6816 9.19744C12.543 9.25255 12.4364 9.32917 12.3623 9.42791C12.2901 9.52678 12.2539 9.63933 12.2539 9.76482C12.2501 9.8692 12.272 9.9604 12.3193 10.0383C12.3688 10.1162 12.4369 10.1843 12.5225 10.2414C12.6079 10.2964 12.7064 10.3451 12.8184 10.3869C12.9304 10.4268 13.0505 10.4609 13.1777 10.4894L13.7031 10.6144C13.9578 10.6715 14.1914 10.7479 14.4043 10.8429C14.6173 10.938 14.8021 11.0547 14.958 11.1935C15.1138 11.3323 15.2348 11.4957 15.3203 11.6838C15.4077 11.8719 15.4522 12.088 15.4541 12.3312C15.4522 12.6885 15.3611 12.9986 15.1807 13.2609C15.0019 13.5214 14.7427 13.7248 14.4043 13.8693C14.0678 14.0118 13.6617 14.0832 13.1865 14.0832C12.7153 14.0832 12.3048 14.0107 11.9551 13.8664C11.6071 13.7219 11.3345 13.5071 11.1387 13.2238C10.9449 12.9387 10.8435 12.5862 10.834 12.1662H12.0283C12.0416 12.362 12.0984 12.5252 12.1973 12.6564C12.298 12.7857 12.4323 12.8838 12.5996 12.9504C12.7688 13.0149 12.96 13.047 13.1729 13.047C13.3817 13.047 13.563 13.0169 13.7168 12.9562C13.8727 12.8954 13.9935 12.8106 14.0791 12.7023C14.1647 12.5939 14.208 12.469 14.208 12.3283C14.2079 12.1974 14.1686 12.0875 14.0908 11.9982C14.0148 11.9089 13.9022 11.8324 13.7539 11.7697C13.6076 11.707 13.4276 11.6501 13.2148 11.5988L12.5791 11.4387C12.0869 11.3189 11.6982 11.1318 11.4131 10.8771C11.128 10.6224 10.9855 10.2793 10.9873 9.84783C10.9854 9.49418 11.0804 9.18439 11.2705 8.9201C11.4625 8.65603 11.7261 8.45015 12.0605 8.30193C12.3951 8.15369 12.7754 8.07928 13.2012 8.07928Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M5.8125 14.0002H4.48926L4.05664 12.6681H1.94824L1.51465 14.0002H0.19043L2.20703 8.15935H3.79883L5.8125 14.0002ZM2.26172 11.7043H3.74316L3.02539 9.49334H2.98047L2.26172 11.7043Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8.45215 8.15935C8.88165 8.15935 9.24031 8.22251 9.52734 8.34978C9.81445 8.47717 10.0303 8.65477 10.1748 8.88103C10.3192 9.10536 10.3916 9.36368 10.3916 9.65642C10.3916 9.88452 10.3461 10.085 10.2549 10.258C10.1637 10.4289 10.0384 10.5696 9.87891 10.6799C9.72117 10.7882 9.54024 10.8657 9.33691 10.9113V10.9679C9.55917 10.9775 9.76716 11.0406 9.96094 11.1564C10.1568 11.2724 10.3158 11.4356 10.4375 11.6447C10.5591 11.8519 10.6201 12.099 10.6201 12.3859C10.6201 12.6958 10.5427 12.9727 10.3887 13.216C10.2366 13.4573 10.0113 13.6486 9.71289 13.7892C9.41443 13.9299 9.04655 14.0002 8.60938 14.0002H6.11426V8.15935H8.45215ZM7.34863 12.9904H8.35547C8.69943 12.9904 8.95057 12.9252 9.1084 12.7941C9.26621 12.661 9.34473 12.4834 9.34473 12.2629C9.34468 12.1014 9.30643 11.9587 9.22852 11.8351C9.15056 11.7116 9.03903 11.6145 8.89453 11.5441C8.75195 11.4738 8.58148 11.4387 8.38379 11.4387H7.34863V12.9904ZM7.34863 10.6037H8.26465C8.43369 10.6036 8.58376 10.5737 8.71484 10.5148C8.84793 10.454 8.95227 10.3683 9.02832 10.258C9.10628 10.1477 9.14551 10.0155 9.14551 9.8615C9.14546 9.65055 9.07008 9.48001 8.91992 9.35076C8.77165 9.22169 8.56064 9.15741 8.28711 9.1574H7.34863V10.6037Z" fill="black"/><path d="M7.16602 0.377127C7.44584 0.189493 7.82551 0.20905 8.08496 0.442557L11.418 3.44256C11.7257 3.71966 11.7507 4.19428 11.4736 4.50213C11.1966 4.80961 10.7228 4.83441 10.415 4.55779L7.60938 2.03338L5.11328 4.53045C4.82042 4.82326 4.34562 4.82322 4.05273 4.53045C3.75986 4.23757 3.75989 3.7628 4.05273 3.4699L7.05273 0.4699L7.16602 0.377127Z" fill="black"/></svg>',adesc:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.3867 11.4697C10.6796 11.1771 11.1544 11.1769 11.4473 11.4697C11.7399 11.7626 11.7399 12.2374 11.4473 12.5303L8.44727 15.5303L8.33398 15.623C8.05425 15.8106 7.67449 15.7909 7.41504 15.5576L4.08203 12.5576C3.77415 12.2805 3.74927 11.8059 4.02637 11.498C4.30342 11.1907 4.77722 11.1657 5.08496 11.4424L7.89062 13.9668L10.3867 11.4697Z" fill="black"/><path d="M13.2012 3.0791C13.6346 3.07912 14.0128 3.1535 14.3359 3.30176C14.6611 3.45006 14.9141 3.65661 15.0947 3.9209C15.2752 4.18513 15.3683 4.49104 15.374 4.83887H14.1904C14.1676 4.60882 14.0695 4.43012 13.8965 4.30273C13.7235 4.17546 13.4889 4.11133 13.1924 4.11133C12.9909 4.11133 12.8204 4.14023 12.6816 4.19727C12.5431 4.25236 12.4364 4.32902 12.3623 4.42773C12.2901 4.52659 12.2539 4.63919 12.2539 4.76465C12.2501 4.86901 12.272 4.96023 12.3193 5.03809C12.3688 5.11604 12.4369 5.18417 12.5225 5.24121C12.6079 5.29623 12.7064 5.34496 12.8184 5.38672C12.9304 5.42661 13.0505 5.46075 13.1777 5.48926L13.7031 5.61426C13.9578 5.67128 14.1914 5.74776 14.4043 5.84277C14.6172 5.93784 14.8021 6.05457 14.958 6.19336C15.1139 6.33216 15.2348 6.49633 15.3203 6.68457C15.4076 6.8727 15.4522 7.08885 15.4541 7.33203C15.4521 7.68929 15.3612 7.99944 15.1807 8.26172C15.0019 8.52216 14.7427 8.72465 14.4043 8.86914C14.0678 9.01165 13.6617 9.08301 13.1865 9.08301C12.7153 9.08299 12.3048 9.01057 11.9551 8.86621C11.6072 8.72173 11.3345 8.50786 11.1387 8.22461C10.9447 7.9394 10.8435 7.58622 10.834 7.16602H12.0283C12.0416 7.36176 12.0985 7.52509 12.1973 7.65625C12.298 7.78554 12.4323 7.88365 12.5996 7.9502C12.7688 8.01477 12.96 8.04785 13.1729 8.04785C13.3817 8.04781 13.5629 8.01678 13.7168 7.95605C13.8727 7.89522 13.9935 7.81051 14.0791 7.70215C14.1646 7.59387 14.2079 7.46965 14.208 7.3291C14.208 7.19796 14.1687 7.08739 14.0908 6.99805C14.0148 6.90868 13.9022 6.83228 13.7539 6.76953C13.6076 6.70685 13.4276 6.64993 13.2148 6.59863L12.5791 6.43848C12.0868 6.31871 11.6982 6.13163 11.4131 5.87695C11.1279 5.62221 10.9855 5.27916 10.9873 4.84766C10.9854 4.49404 11.0804 4.18517 11.2705 3.9209C11.4625 3.65661 11.7259 3.45006 12.0605 3.30176C12.3951 3.15353 12.7754 3.0791 13.2012 3.0791Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M5.8125 9H4.48926L4.05664 7.66797H1.94824L1.51465 9H0.19043L2.20703 3.15918H3.79883L5.8125 9ZM2.26172 6.7041H3.74316L3.02539 4.49414H2.98047L2.26172 6.7041Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8.45215 3.15918C8.88181 3.15918 9.24025 3.22322 9.52734 3.35059C9.81445 3.47798 10.0303 3.6546 10.1748 3.88086C10.3193 4.10518 10.3916 4.36351 10.3916 4.65625C10.3916 4.88432 10.3461 5.08484 10.2549 5.25781C10.1636 5.4289 10.0386 5.57039 9.87891 5.68066C9.72118 5.78898 9.54022 5.86549 9.33691 5.91113V5.96875C9.55913 5.9783 9.76719 6.04044 9.96094 6.15625C10.1568 6.27223 10.3158 6.43538 10.4375 6.64453C10.5591 6.85173 10.6201 7.09875 10.6201 7.38574C10.6201 7.69567 10.5427 7.97245 10.3887 8.21582C10.2366 8.45719 10.0113 8.64841 9.71289 8.78906C9.41442 8.9297 9.04658 8.99999 8.60938 9H6.11426V3.15918H8.45215ZM7.34863 7.99023H8.35547C8.69948 7.99023 8.95057 7.92504 9.1084 7.79395C9.26621 7.66085 9.34473 7.48325 9.34473 7.2627C9.34466 7.10125 9.3064 6.95844 9.22852 6.83496C9.15056 6.71143 9.03899 6.61427 8.89453 6.54395C8.75196 6.47365 8.58145 6.43848 8.38379 6.43848H7.34863V7.99023ZM7.34863 5.60352H8.26465C8.43369 5.60347 8.58376 5.57354 8.71484 5.51465C8.84791 5.45381 8.95228 5.36807 9.02832 5.25781C9.10623 5.14755 9.14551 5.01529 9.14551 4.86133C9.14542 4.65046 9.07002 4.48078 8.91992 4.35156C8.77163 4.22228 8.56087 4.15724 8.28711 4.15723H7.34863V5.60352Z" fill="black"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>'},WJ=(e={})=>{let t="";for(let i of[...Object.keys(Y8),...Object.keys(X8)]){let n=UJ(i,e.strokeWidth);t+=`.ag-icon-${i}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }
`}return t},UJ=(e,t=1.5)=>{let i=X8[e];if(i)return i;let n=Y8[e];if(!n)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},jJ=(e={})=>ln({feature:"iconSet",css:()=>WJ(e)});var qJ=jJ();var $J=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',KJ=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}";var YJ={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4};var XJ=()=>ln({feature:"inputStyle",params:T(w({},YJ),{inputBackgroundColor:Ei,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Vt},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:xi(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0}),css:()=>$J+KJ}),J8=XJ();var Q8='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}';var Z8={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1};var JJ=()=>ln({feature:"tabStyle",params:T(w({},Z8),{tabBarBorder:!0,tabBarBackgroundColor:_n(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:Ei}),css:Q8}),QJ=JJ();var ZJ=()=>ln({feature:"tabStyle",params:T(w({},Z8),{tabBarBorder:!0,tabBarBackgroundColor:{ref:"chromeBackgroundColor"},tabHoverTextColor:Vt,tabSelectedTextColor:Vt,tabSelectedUnderlineColor:Vt,tabSelectedUnderlineWidth:2,tabSelectedUnderlineTransitionDuration:"0.3s"}),css:Q8}),eQ=ZJ();var tQ=()=>j8().withPart(q8).withPart(K8).withPart(qJ).withPart(QJ).withPart(J8).withPart(Wy).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),iQ=tQ(),nQ=()=>j8().withPart(IJ).withPart(q8).withPart(K8).withPart(GJ).withPart(eQ).withPart(J8).withPart(Wy).withParams({accentColor:"#2196f3",selectedRowBackgroundColor:on(.3),inputFocusBorder:{color:on(.4)},focusShadow:{radius:2,spread:1.6,color:on(.4)},iconButtonHoverBackgroundColor:"transparent",iconButtonActiveBackgroundColor:"transparent",checkboxUncheckedBorderColor:xi(.45),checkboxIndeterminateBackgroundColor:xi(.45),checkboxIndeterminateBorderColor:xi(.45),checkboxBorderWidth:2,checkboxBorderRadius:2,fontSize:13,dataFontSize:14,headerFontWeight:700,borderRadius:3,wrapperBorderRadius:3,tabSelectedUnderlineColor:Vt,tabSelectedBorderWidth:0,tabSelectedUnderlineTransitionDuration:.3,sideButtonSelectedUnderlineColor:Vt,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineTransitionDuration:.3,sideButtonBorder:!1,sideButtonSelectedBorder:!1,sideButtonBarTopPadding:{calc:"spacing * 3"},sideButtonSelectedBackgroundColor:"transparent",sideButtonHoverTextColor:Vt,iconButtonHoverColor:Vt,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonSwitchInset:1,toggleButtonOffBackgroundColor:xi(.45),colorPickerThumbSize:13,colorPickerTrackSize:11,colorPickerThumbBorderWidth:2,colorPickerTrackBorderRadius:2,colorPickerColorBorderRadius:2}),Pm=nQ();var rQ={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},oQ={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},sQ={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},uD={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},hD={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},Cb={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},pD={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function aQ(e,t){for(let i of t.sort((n,r)=>n.moduleName.localeCompare(r.moduleName))){let n=i.css;n&&e.set(`module-${i.moduleName}`,n)}}var lQ=class extends kq{initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(uD),this.getSizeEl(hD),this.getSizeEl(Cb),this.getSizeEl(pD),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(pD)}getRowBorderWidth(){return this.getCSSVariablePixelValue(Cb)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(uD)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(hD)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(rQ)}getCellPaddingLeft(){let e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(oQ),i=this.getCSSVariablePixelValue(sQ);return e-1+i*t}getCellPadding(){let e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}refreshRowHeightVariable(){let{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),i=this.gos.get("rowHeight");if(i==null||isNaN(i)||!isFinite(i))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;let n=`${i}px`;return t!=n?(e.style.setProperty("--ag-line-height",n),i):t!=""?Number.parseFloat(t):-1}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),super.fireStylesChangedEvent(e)}refreshRowBorderWidthVariable(){let e=this.getCSSVariablePixelValue(Cb);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&Ze(t?106:239)}getAdditionalCss(){let e=new Map;return e.set("core",[EJ]),aQ(e,Array.from(GW())),e}getDefaultTheme(){return iQ}varError(e){J(9,{variable:e})}themeError(e){Ze(240,{theme:e})}shadowRootError(){Ze(293)}},cQ=class extends Fq{postConstruct(){let{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function eM(e,t,i){let n=e.visibleCols.headerGroupRowCount;if(i>=n)return{column:t,headerRowIndex:i};let r=t.getParent();for(;r&&r.getProvidedColumnGroup().getLevel()>i;)r=r.getParent();let o=t.isSpanHeaderHeight();return!r||o&&r.isPadding()?{column:t,headerRowIndex:n}:{column:r,headerRowIndex:r.getProvidedColumnGroup().getLevel()}}var dQ=class extends j{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,i=>{this.gridBodyCon=i.gridBodyCtrl});let t=Kt(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let i,{colModel:n,colGroupSvc:r,ctrlsSvc:o}=this.beans;if(typeof e=="string"?(i=n.getCol(e),i||(i=r?.getColumnGroup(e)??null)):i=e,!i)return null;let a=o.getHeaderRowContainerCtrl()?.getAllCtrls(),l=dt(a||[]).type==="filter",c=kr(this.beans)-1,d=-1,u=i;for(;u;)d++,u=u.getParent();let h=d;return t&&l&&h===c-1&&h++,h===-1?null:{headerRowIndex:h,column:i}}navigateVertically(e,t){let{focusSvc:i,visibleCols:n}=this.beans,{focusedHeader:r}=i;if(!r)return!1;let{headerRowIndex:o}=r,s=r.column,a=kr(this.beans),l=this.getHeaderRowType(o),c=n.headerGroupRowCount,{headerRowIndex:d,column:u,headerRowIndexWithoutSpan:h}=e==="UP"?uQ(l,s,o):hQ(s,o,c),p=!1;return d<0&&(d=0,u=s,p=!0),d>=a?(d=-1,this.currentHeaderRowWithoutSpan=-1):h!==void 0&&(this.currentHeaderRowWithoutSpan=h),!p&&!u?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:d,column:u},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,i){let{focusSvc:n,gos:r}=this.beans,o=w({},n.focusedHeader),s,a;this.currentHeaderRowWithoutSpan!==-1?o.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=o.headerRowIndex,e==="LEFT"!==r.get("enableRtl")?(a="Before",s=this.findHeader(o,a)):(a="After",s=this.findHeader(o,a));let l=r.getCallback("tabToNextHeader");if(t&&l){let c=n.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:s,direction:a});if(c){let{headerRowIndex:d}=n.focusedHeader||{};d!=null&&d!=o.headerRowIndex&&(this.currentHeaderRowWithoutSpan=d)}return c}return s||!t?n.focusHeaderPosition({headerPosition:s,direction:a,fromTab:t,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(o,a,i)}focusNextHeaderRow(e,t,i){let n=this.beans,r=e.headerRowIndex,o=null,s,a=kr(n),l=this.beans.visibleCols.allCols;if(t==="Before"){if(r<=0)return!1;o=dt(l),s=r-1,this.currentHeaderRowWithoutSpan-=1}else o=l[0],s=r+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:c,headerRowIndex:d}=eM(this.beans,o,s);return d>=a&&(d=-1),n.focusSvc.focusHeaderPosition({headerPosition:{column:c,headerRowIndex:d},direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(e,t="After"){if(e.getPinned())return;let i;if(It(e)){let n=e.getDisplayedLeafColumns();i=t==="Before"?dt(n):n[0]}else i=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(i)}findHeader(e,t){let{colGroupSvc:i,visibleCols:n}=this.beans,r=e.column;if(r instanceof $u){let l=r.getDisplayedLeafColumns();r=t==="Before"?l[0]:l[l.length-1]}let o=t==="Before"?n.getColBefore(r):n.getColAfter(r);if(!o)return;let s=n.headerGroupRowCount;if(e.headerRowIndex>=s)return{headerRowIndex:e.headerRowIndex,column:o};let a=i?.getColGroupAtLevel(o,e.headerRowIndex);return a?a.isPadding()&&o.isSpanHeaderHeight()?{headerRowIndex:n.headerGroupRowCount,column:o}:{headerRowIndex:e.headerRowIndex,column:a??o}:{headerRowIndex:o instanceof Sa&&o.isSpanHeaderHeight()?n.headerGroupRowCount:e.headerRowIndex,column:o}}getHeaderRowType(e){let t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function uQ(e,t,i){let n=i-1;if(e!=="filter"){let r=t instanceof Sa&&t.isSpanHeaderHeight(),o=t.getParent();for(;o&&(o.getProvidedColumnGroup().getLevel()>n||r&&o.isPadding());)o=o.getParent();if(o)return r?{column:o,headerRowIndex:o.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:n}:{column:o,headerRowIndex:n,headerRowIndexWithoutSpan:n}}return{column:t,headerRowIndex:n,headerRowIndexWithoutSpan:n}}function hQ(e,t,i){let n=t+1,r={column:e,headerRowIndex:n,headerRowIndexWithoutSpan:n};if(e instanceof $u){if(n>=i)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:i,headerRowIndexWithoutSpan:n};let s=e.getDisplayedChildren()[0];if(s instanceof $u&&s.isPadding()){let l=s.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(s=l)}r.column=s,s instanceof Sa&&s.isSpanHeaderHeight()&&(r.headerRowIndex=i,r.headerRowIndexWithoutSpan=n)}return r}var pQ=class extends j{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){let e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(kj(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;let e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){let{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(bt(this.beans),F8)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){let e=bt(this.beans);return this.isDomDataPresentInHierarchy(e,om)?!0:this.isDomDataPresentInHierarchy(e,sm)}isDomDataPresentInHierarchy(e,t){let i=e;for(;i;){if(pF(this.gos,i,t))return!0;i=i.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){let{rowIndex:t,rowPinned:i,column:n}=e,r={rowIndex:t,rowPinned:i,column:n,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i});return o&&(r.isFullWidthCell=o.isFullWidth()),r}clearFocusedCell(){if(this.focusedCell==null)return;let e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent(w({type:"cellFocusCleared"},e))}setFocusedCell(e){this.setFocusRecovered();let{column:t,rowIndex:i,rowPinned:n,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:o=!1,sourceEvent:s}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:i,rowPinned:ao(n),column:a};let l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent(T(w(w({type:"cellFocused"},l),this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams}),{forceBrowserFocus:r,preventScrollOnBrowserFocus:o,sourceEvent:s})),this.previousCellFocusParams=l}isCellFocused(e){return this.focusedCell==null?!1:Ly(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;let{column:t,rowCtrl:{rowIndex:i,pinned:n}}=e,{column:r,headerRowIndex:o}=this.focusedHeader;return t===r&&i===o&&n==r.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),fa(this.beans))return!1;let{direction:t,fromTab:i,allowUserOverride:n,event:r,fromCell:o,rowWithoutSpanValue:s,scroll:a=!0}=e,{headerPosition:l}=e;if(o&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(l);if(n){let c=this.focusedHeader,d=kr(this.beans);if(i){let u=this.gos.getCallback("tabToNextHeader");u&&(l=this.getHeaderPositionFromUserFunc({userFunc:u,direction:t,currentPosition:c,headerPosition:l,headerRowCount:d}))}else{let u=this.gos.getCallback("navigateToNextHeader");if(u&&r){let h={key:r.key,previousHeaderPosition:c,nextHeaderPosition:l,headerRowCount:d,event:r};l=u(h)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:t,event:r,fromCell:o,rowWithoutSpanValue:s,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(fa(this.beans))return!1;let{userFunc:t,headerPosition:i,direction:n,event:r}=e,o=this.focusedHeader,s=kr(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:n,currentPosition:o,headerPosition:i,headerRowCount:s});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:r})}getHeaderPositionFromUserFunc(e){let{userFunc:t,direction:i,currentPosition:n,headerPosition:r,headerRowCount:o}=e,a=t({backwards:i==="Before",previousHeaderPosition:n,nextHeaderPosition:r,headerRowCount:o});return a===!0?n:a===!1?null:a}focusProvidedHeaderPosition(e){let{headerPosition:t,direction:i,fromCell:n,rowWithoutSpanValue:r,event:o,scroll:s=!0}=e,{column:a,headerRowIndex:l}=t,{filterManager:c,ctrlsSvc:d,headerNavigation:u}=this.beans;if(this.focusedHeader&&nK(e.headerPosition,this.focusedHeader))return!1;if(l===-1)return c?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:o});s&&u?.scrollToColumn(a,i);let p=d.getHeaderRowContainerCtrl(a.getPinned())?.focusHeader(t.headerRowIndex,a,o)||!1;return u&&p&&(r!=null||n)&&(u.currentHeaderRowWithoutSpan=r??-1),p}focusFirstHeader(){if(this.overlays?.exclusive&&this.focusOverlay())return!0;let e=this.visibleCols.allCols[0];if(!e)return!1;let t=eM(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.exclusive&&this.focusOverlay(!0))return!0;let t=kr(this.beans)-1,i=dt(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===ao(t)}focusOverlay(e){let t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&Ca(t,e)}focusGridView(e){let{backwards:t=!1,canFocusOverlay:i=!0,event:n}=e;if(this.overlays?.exclusive)return i&&this.focusOverlay(t);if(xm(this.beans))return t&&!fa(this.beans)?this.focusLastHeader():i&&this.focusOverlay(t)?!0:t?!1:rc(this.beans,t);let r=t?K$(this.beans):$$(this.beans);if(r){let o=e.column??this.focusedHeader?.column,{rowIndex:s,rowPinned:a}=r,l=fo(this.beans,r);if(!o||!l||s==null)return!1;if(o.isSuppressNavigable(l)){let c=this.gos.get("enableRtl"),d;return!n||n.key===B.TAB?d=c?B.LEFT:B.RIGHT:d=n.key,this.beans.navigation?.navigateToNextCell(null,d,{rowIndex:s,column:o,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:s,column:o,rowPinned:a}),t&&this.rowRenderer.getRowByPosition(r)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(r,t)||(this.setFocusedCell({rowIndex:s,column:o,rowPinned:ao(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:s,rowPinned:a,column:o})),!0}return!!(i&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){let i=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:kr(this.beans)-1}}):this.focusGridView({column:i})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},fQ=class extends j{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){let{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){let e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;let t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){let e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),i=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==i)&&(this.horizontalScrollGap=t,this.verticalScrollGap=i,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){let e=this.gos.get("scrollbarWidth"),i=typeof e=="number"&&e>=0?e:Ej();i!=null&&(this.scrollbarWidth=i,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},gQ=class extends j{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;let{stateSvc:e,ctrlsSvc:t,context:i}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),i.destroy(),super.destroy()}},zg=new Set(["gridPreDestroyed","fillStart","pasteStart"]),mQ=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"];var Uy=mQ.reduce((e,t)=>(e[t]=cU(t),e),{}),Jl={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agExportingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agNoMatchingRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function fD(e){return`"${e}"`}var vQ=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),CQ={allowFormula:"Formula",aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?Jl[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:Jl[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?Jl[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{let t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(i=>t.includes(i))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},wQ=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:i})=>i?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},allowFormula:{supportedRowModels:["clientSide"]},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,i)=>i.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{let i=t.headerValueGetter;return typeof i=="function"||typeof i=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return Fr(262);if(t.smallLeft)return Fr(263);if(t.smallRight)return Fr(264)}return null}},sort:{validate:t=>$l(t.sort)||rs(t.sort)?null:`sort must be of type (SortDirection | SortDef), currently it is ${typeof t.sort=="object"?JSON.stringify(t.sort):Tg(t.sort)}`},initialSort:{validate:t=>$l(t.initialSort)||rs(t.initialSort)?null:`initialSort must be of non-null type (SortDirection | SortDef), currently it is ${typeof t.initialSort=="object"?JSON.stringify(t.initialSort):Tg(t.initialSort)}`},sortingOrder:{validate:t=>{let i=t.sortingOrder;if(Array.isArray(i)&&i.length>0){let n=i.filter(r=>!($l(r)||rs(r)));if(n.length>0)return`sortingOrder must be an array of type non-null (SortDirection | SortDef)[], incorrect items are: [${n.map(r=>typeof r=="string"||r==null?Tg(r):JSON.stringify(r)).join(", ")}]`}else if(!Array.isArray(i)||!i.length)return`sortingOrder must be an array with at least one element, currently it is [${i}]`;return null}},type:{validate:t=>{let i=t.type;return i instanceof Array?i.some(r=>typeof r!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof i=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:i})=>i?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:i,cellSelection:n,suppressRowTransform:r,enableCellSpan:o,rowDragEntireRow:s,enableCellTextSelection:a})=>typeof i=="object"&&i?.mode==="singleRow"&&i?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":r?"colDef.spanRows is not supported with suppressRowTransform.":o?s?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(t,{groupHierarchyConfig:i={}},n){let r=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),o=[];for(let s of t.groupHierarchy??[]){if(typeof s=="object"){n.validation?.validateColDef(s);continue}!r.has(s)&&!(s in i)&&o.push(fD(s))}if(o.length>0){let s=`The following parts of colDef.groupHierarchy are not recognised: ${o.join(", ")}.`,a=`Choose one of ${[...r].map(fD).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${s}
${a}`}return null}}}),bQ={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0,allowFormula:void 0},yQ=()=>Object.keys(bQ),SQ=()=>({objectName:"colDef",allProperties:yQ(),docsUrl:"column-properties/",deprecations:vQ(),validations:wQ()}),xQ=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],EQ=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","overlayComponentParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","activeOverlayParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","formulaDataSource","formulaFuncs","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],RQ=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector","suppressOverlays"],tM=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],PQ=["theme","rowSelection"],jy=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],iM=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","refreshAfterGroupEdit","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows","animateColumnResizing"],kQ=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","overlayComponent","loadingOverlayComponent","noRowsOverlayComponent","overlayComponentSelector","activeOverlay","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],_Q=()=>[...RQ,...EQ,...xQ,...tM,...kQ,...iM,...jy,...PQ],DQ=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function Sr(e,t,i){return typeof t=="number"||t==null?t==null||t>=i?null:`${e}: value should be greater than or equal to ${i}`:`${e}: value should be a number`}var FQ={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",refreshAfterGroupEdit:["RowGrouping","TreeData"],rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},MQ=()=>{let e={autoSizePadding:{validate({autoSizePadding:i}){return Sr("autoSizePadding",i,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:i}){return Sr("cacheBlockSize",i,1)}},cacheOverflowSize:{validate({cacheOverflowSize:i}){return Sr("cacheOverflowSize",i,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:i=>{let n=i.domLayout,r=["autoHeight","normal","print"];return n&&!r.includes(n)?`domLayout must be one of [${r.join()}], currently it's ${n}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,pinnedTopRowData:n,pinnedBottomRowData:r}){return i&&(n||r)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinnable:n,pinnedTopRowData:r,pinnedBottomRowData:o}){return n&&(r||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinned:n,pinnedTopRowData:r,pinnedBottomRowData:o}){return n&&(r||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&n?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:i={}},n,r){for(let o of Object.keys(i))r.validation?.validateColDef(i[o]);return null}},icons:{validate:({icons:i})=>{if(i){if(i.smallDown)return Fr(262);if(i.smallLeft)return Fr(263);if(i.smallRight)return Fr(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:i}){return Sr("infiniteInitialRowCount",i,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:i=>{if(typeof i.ssrmExpandAllAffectsAllRows=="boolean"){if(i.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(i.ssrmExpandAllAffectsAllRows&&typeof i.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:i}){return Sr("keepDetailRowsCount",i,1)}},paginationPageSize:{validate({paginationPageSize:i}){return Sr("paginationPageSize",i,1)}},paginationPageSizeSelector:{validate:i=>{let n=i.paginationPageSizeSelector;return typeof n=="boolean"||n==null||n.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:i}){return Sr("rowBuffer",i,0)}},rowClass:{validate:i=>typeof i.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:i}){return i&&typeof i=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':i&&typeof i!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":i&&i.mode!=="multiRow"&&i.mode!=="singleRow"?`Selection mode "${i.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:i=>{let n=i.rowStyle;return n&&typeof n=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:i}){return Sr("serverSideInitialRowCount",i,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:i=>{let n=i.sortingOrder;if(Array.isArray(n)&&n.length>0){let r=n.filter(o=>!jn(o));if(r.length>0)return`sortingOrder must be an array of type (SortDirection | SortDef)[], incorrect items are: ${r.map(o=>typeof o=="string"||o==null?Tg(o):JSON.stringify(o))}]`}else if(!Array.isArray(n)||!n.length)return`sortingOrder must be an array with at least one element, currently it's ${n}`;return null}},tooltipHideDelay:{validate:i=>i.tooltipHideDelay&&i.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:i=>i.tooltipShowDelay&&i.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:i=>{let n=i.rowModelType??"clientSide";switch(n){case"clientSide":{let{treeDataChildrenField:r,treeDataParentIdField:o,getDataPath:s,getRowId:a}=i;if(!r&&!o&&!s)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(r){if(s)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(o)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(o){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(s)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{let r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${n} row model.`;return i.isServerSideGroup&&i.getServerSideGroupKey?null:r}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:i}){return Sr("viewportRowModelBufferSize",i,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:i}){return Sr("viewportRowModelPageSize",i,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:i,showOpenedGroup:n}){return i?.field&&n?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":i?.valueGetter&&n?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:i=>{let n=i.renderingMode,r=["default","legacy"];return n&&!r.includes(n)?`renderingMode must be one of [${r.join()}], currently it's ${n}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:i})=>{if(!i)return null;let n=["fitCellContents","fitGridWidth","fitProvidedWidth"],r=i.type;return r!=="fitCellContents"&&r!=="fitGridWidth"&&r!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${n.map(o=>'"'+o+'"').join(", ")}, currently it's ${r}`:r==="fitProvidedWidth"&&typeof i.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${i.width}`:null}}},t={};for(let i of iM)t[i]={expectedType:"boolean"};for(let i of tM)t[i]={expectedType:"number"};return Ii(t,e),t},TQ=()=>({objectName:"gridOptions",allProperties:[..._Q(),...Object.values(Uy)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:DQ(),validations:MQ()}),IQ=0,AQ=0,gD="__ag_grid_instance",OQ=class extends j{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=AQ++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new ma,this.globalEventHandlerFactory=e=>(t,i)=>{if(!this.isAlive())return;let n=zg.has(t);if(n&&!e||!n&&e||!LQ(t))return;let r=(o,s)=>{let a=Uy[o],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(s))};if(this.gridReadyFired)r(t,i);else if(t==="gridReady"){r(t,i),this.gridReadyFired=!0;for(let o of this.queueEvents)r(o.eventName,o.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:i})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??LW[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return pe(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(i=>e(this.addCommon(i)))}updateGridOptions({options:e,force:t,source:i="api"}){let n={id:IQ++,properties:[]},r=[],{gridOptions:o,validation:s}=this;for(let a of Object.keys(e)){let l=gy.applyGlobalGridOption(a,e[a]);s?.warnOnInitialPropertyUpdate(i,a);let c=t||typeof l=="object"&&i==="api",d=o[a];if(c||d!==l){o[a]=l;let u={type:a,currentValue:l,previousValue:d,changeSet:n,source:i};r.push(u)}}this.validateGridOptions(this.gridOptions),n.properties=r.map(a=>a.type);for(let a of r)as(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(let i of Object.keys(e)){let n=e[i];if(n==null||n===!1)continue;let r=t[i];typeof r=="function"&&(r=r(e,this.gridOptions,this.beans)),r&&this.assertModuleRegistered(r,i)}}validateGridOptions(e){this.validateOptions(e,FQ),this.validation?.processGridOptions(e)}validateColDef(e,t,i){(i||!this.beans.dataTypeSvc?.isColPendingInference(t))&&(this.validateOptions(e,CQ),this.validation?.validateColDef(e))}assertModuleRegistered(e,t){let i=Array.isArray(e)?e.some(n=>this.isModuleRegistered(n)):this.isModuleRegistered(e);return i||Ze(200,T(w({},this.getModuleErrorParams()),{moduleName:e,reasonOrId:t})),i}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:my(),rowModelType:this.get("rowModelType"),isUmd:vy()}}isModuleRegistered(e){return Db(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[gD]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){let i=t[gD];if(pe(i))return i===this.instanceId;t=t.parentElement}return!1}};function LQ(e){return!!Uy[e]}var NQ=class extends j{constructor(e,t){super(),this.column=e,this.eGui=t,this.lastMovingChanged=0}postConstruct(){this.addManagedElementListeners(this.eGui,{click:e=>e&&this.onClick(e)}),this.addManagedListeners(this.column,{movingChanged:()=>{this.lastMovingChanged=Date.now()}})}onClick(e){let{sortSvc:t,rangeSvc:i,gos:n}=this.beans;if(!(ql(n)?e.altKey:!0))i?.handleColumnSelection(this.column,e);else if(this.column.isSortable()){let o=this.column.isMoving(),a=Date.now()-this.lastMovingChanged<50;o||a||t?.progressSortFromEvent(this.column,e)}}};function BQ(e,t){let i={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:i},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:i},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[e?{tag:"span",ref:"eColRef",cls:"ag-header-col-ref"}:null,{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:i},t?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var HQ=class extends st{constructor(){super(...arguments),this.eFilter=ae,this.eFilterButton=ae,this.eSortIndicator=ae,this.eMenu=ae,this.eLabel=ae,this.eText=ae,this.eColRef=ae,this.eSortOrder=ae,this.eSortAsc=ae,this.eSortDesc=ae,this.eSortMixed=ae,this.eSortNone=ae,this.eSortAbsoluteAsc=ae,this.eSortAbsoluteDesc=ae,this.isLoadingInnerComponent=!1}refresh(e){let t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||e.column.formulaRef!=this.currentRef||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){let i=w({},e);Ii(i,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(i)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){let{formula:i}=this.beans,n=e.template;return n?n?.trim?n.trim():n:BQ(!!i?.active,t)}init(e){this.params=e;let{sortSvc:t,touchSvc:i,rowNumbersSvc:n,userCompFactory:r}=this.beans,o=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!o),this.setTemplate(this.currentTemplate,o?[o]:void 0),this.eLabel&&(this.mouseListener??(this.mouseListener=this.createManagedBean(new NQ(e.column,this.eLabel)))),i?.setupForHeader(this),this.setMenu(),this.setupSort(),this.setupColumnRefIndicator(),n?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(r,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){let i=oj(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderComponent=n,this.eText&&this.eText.appendChild(n.getGui())):this.destroyBean(n))}))}setDisplayName(e){let{displayName:t}=e,i=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||i===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=ac(t))}addInIcon(e,t,i){let n=ji(e,this.beans,i);n&&t.appendChild(n)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){Wi(this.eMenu),this.eMenu=void 0;return}let{gos:e,eMenu:t,params:i}=this,n=sn(e);this.addInIcon(n?"menu":"menuAlt",t,i.column),t.classList.toggle("ag-header-menu-icon",!n);let r=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=r,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(r)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){let{currentSuppressMenuHide:t,params:i}=this;t||this.toggleMenuAlwaysShow(!0),i.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){let{params:t,gos:i,beans:n,eMenu:r,eFilterButton:o}=this,s=t.column,a=sn(i);if(e&&!a){if(n.menuSvc?.isFilterMenuInHeaderEnabled(s))return t.showFilter(o??r??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(r??o??this.getGui()),!0;return!1}setupSort(){let{sortSvc:e}=this.beans;if(!e)return;let{enableSorting:t,column:i}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));let{eSortIndicator:n,eSortOrder:r,eSortAsc:o,eSortDesc:s,eSortMixed:a,eSortNone:l,eSortAbsoluteAsc:c,eSortAbsoluteDesc:d}=this;n.attachCustomElements(r,o,s,a,l,c,d)}this.eSortIndicator.setupSort(i),this.currentSort&&e.setupHeader(this,i)}setupColumnRefIndicator(){let{eColRef:e,beans:{editModelSvc:t},params:i}=this;e&&(this.currentRef=i.column.formulaRef,e.textContent=this.currentRef,ot(e,!1),this.addManagedEventListeners({cellEditingStarted:()=>{let n=t?.getEditPositions(),r=!!this.currentRef&&!!n?.some(o=>o.column.isAllowFormula());ot(e,r)},cellEditingStopped:()=>{ot(e,!1)}}))}setupFilterIcon(){let{eFilter:e,params:t}=this;if(!e)return;let i=()=>{let n=t.column.isFilterActive();ot(e,n,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,i,"filterActive")}setupFilterButton(){let{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,i,n){if(!e)return Wi(t),!1;let r=this.params.column;return this.addInIcon(n,t,r),this.addManagedListeners(r,{filterChanged:i}),i(),!0}onFilterChangedButton(){let e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){let{eFilterButton:t,eMenu:i}=this;return e?t??i??this.getGui():i??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent=this.destroyBean(this.innerHeaderComponent),this.mouseListener=this.destroyBean(this.mouseListener)}},zQ={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},VQ=class extends st{constructor(){super(zQ),this.agOpened=ae,this.agClosed=ae,this.agLabel=ae,this.isLoadingInnerComponent=!1}init(e){let{userCompFactory:t,touchSvc:i}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),i?.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&J(89)}workOutInnerHeaderGroupComponent(e,t){let i=aj(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderGroupComponent=n,this.agLabel.appendChild(n.getGui())):this.destroyBean(n))}))}setupExpandIcons(){let{agOpened:e,agClosed:t,params:{columnGroup:i},beans:{colGroupSvc:n}}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);let r=l=>{if(uo(l))return;let c=!i.isExpanded();n.setColumnGroupOpened(i.getProvidedColumnGroup(),c,"uiColumnExpanded")};this.addTouchAndClickListeners(t,r),this.addTouchAndClickListeners(e,r);let o=l=>{wa(l)};this.addManagedElementListeners(t,{dblclick:o}),this.addManagedElementListeners(e,{dblclick:o}),this.addManagedElementListeners(this.getGui(),{dblclick:r}),this.updateIconVisibility();let s=i.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(s,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t){this.beans.touchSvc?.setupForHeaderGroupElement(this,e,t),this.addManagedElementListeners(e,{click:t})}updateIconVisibility(){let{agOpened:e,agClosed:t,params:{columnGroup:i}}=this;if(i.isExpandable()){let n=i.isExpanded();ot(e,n),ot(t,!n)}else ot(e,!1),ot(t,!1)}addInIcon(e,t){let i=ji(e,this.beans,null);i&&t.appendChild(i)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){let{agOpened:t,agClosed:i}=this;ot(t,!1),ot(i,!1)}}setupLabel(e){let{displayName:t,columnGroup:i}=e,{innerHeaderGroupComponent:n,isLoadingInnerComponent:r}=this,o=n||r;pe(t)&&!o&&(this.agLabel.textContent=ac(t)),this.toggleCss("ag-sticky-label",!i.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},GQ={moduleName:"ColumnHeaderComp",version:fe,userComponents:{agColumnHeader:HQ},icons:{menu:"menu",menuAlt:"menu-alt"}},WQ={moduleName:"ColumnGroupHeaderComp",version:fe,userComponents:{agColumnGroupHeader:VQ},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},UQ=class extends j{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&J(92)}createTask(e,t,i,n,r=!1){this.verify();let o=i;n&&this.batchFrameworkComps&&(o="f1");let s={task:e,index:t,createOrder:++this.taskCount,deferred:r};this.addTaskToList(this[o],s),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;let t=this.scrollGoingDown?1:-1;e.list.sort((i,n)=>i.deferred!==n.deferred?i.deferred?-1:1:i.index!==n.index?t*(n.index-i.index):n.createOrder-i.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){let{p1:t,p2:i,f1:n,destroyTasks:r,beans:o}=this,{ctrlsSvc:s,frameworkOverrides:a}=o,l=t.list,c=i.list,d=n.list,u=Date.now(),h=0,p=e<=0,f=s.getScrollFeature();for(;p||h<e;){if(!f.scrollGridIfNeeded()){let m;if(l.length)this.sortTaskList(t),m=l.pop().task;else if(c.length)this.sortTaskList(i),m=c.pop().task;else if(d.length)a.wrapOutgoing(()=>{for(;(p||h<e)&&!f.scrollGridIfNeeded();){if(d.length)this.sortTaskList(n),m=d.pop().task,m();else break;h=Date.now()-u}}),m=()=>{};else if(r.length)m=r.pop();else break;m()}h=Date.now()-u}l.length||c.length||d.length||r.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){let e=this.executeFrame.bind(this,60);go(this.beans,e)}isQueueEmpty(){return!this.ticking}},jQ={moduleName:"AnimationFrame",version:fe,beans:[UQ]},qQ=class extends j{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return ji(e,this.beans,t?.column)}},$Q=class extends j{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!pa())return;let t=(i,n,r)=>{let{rowCtrl:o,cellCtrl:s}=e.getControlsForEventTarget(r?.target??null);s?.column&&s.dispatchCellContextMenuEvent(r??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,r,o,s)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!pa()||ZD("dblclick"))return!1;let n=Date.now(),r=n-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=n,r})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){let{gos:t,sortSvc:i,menuSvc:n}=this.beans;if(t.get("suppressTouch"))return;let{params:r,eMenu:o,eFilterButton:s}=e,a=new aa(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());let l=e.shouldSuppressMenuHide(),c=l&&pe(o)&&r.enableMenu,d=a;if(c&&(d=new aa(o,!0),e.addDestroyFunc(()=>d.destroy())),r.enableMenu||n?.isHeaderContextMenuEnabled(r.column)){let u=c?"tap":"longTap",h=p=>r.showColumnMenuAfterMouseClick(p.touchStart);e.addManagedListeners(d,{[u]:h}),e.addManagedListeners(a,{longTap:h})}if(r.enableSorting){let u=h=>{let p=h.touchStart.target;l&&(o?.contains(p)||s?.contains(p))||i?.progressSort(r.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:u})}if(r.enableFilterButton&&s){let u=new aa(s,!0);e.addManagedListeners(u,{tap:()=>r.showFilter(s)}),e.addDestroyFunc(()=>u.destroy())}}setupForHeaderGroup(e){let t=e.params;if(this.beans.menuSvc?.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){let i=new aa(t.eGridHeader,!0),n=r=>t.showColumnMenuAfterMouseClick(r.touchStart);e.addManagedListeners(i,{longTap:n}),e.addDestroyFunc(()=>i.destroy())}}setupForHeaderGroupElement(e,t,i){let n=new aa(t,!0);e.addManagedListeners(n,{tap:i}),e.addDestroyFunc(()=>n.destroy())}mockContextMenu(e,t,i){if(!pa())return;let n=new aa(t),r=o=>{Vu(this.beans,o.touchEvent)&&i(void 0,o.touchStart,o.touchEvent)};e.addManagedListeners(n,{longTap:r}),e.addDestroyFunc(()=>n.destroy())}},KQ={moduleName:"Touch",version:fe,beans:[$Q]},YQ=class extends j{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){let i=e===B.UP,n=e===B.DOWN,r=e===B.LEFT,o,s,{pageBounds:a,gos:l,visibleCols:c,pinnedRowModel:d}=this.beans,{rowPinned:u}=t;if(i||n)u&&d?i?s=0:s=u==="top"?d.getPinnedTopRowCount()-1:d.getPinnedBottomRowCount()-1:s=i?a.getFirstRow():a.getLastRow(),o=t.column;else{let h=l.get("enableRtl");s=t.rowIndex,o=(r!==h?c.allCols:[...c.allCols].reverse()).find(f=>this.isCellGoodToFocusOn({rowIndex:s,rowPinned:null,column:f}))}return o?{rowIndex:s,rowPinned:u,column:o}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,n=!1;for(;!n;){switch(e){case B.UP:i=this.getCellAbove(i);break;case B.DOWN:i=this.getCellBelow(i);break;case B.RIGHT:i=this.gos.get("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case B.LEFT:i=this.gos.get("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,J(8,{key:e});break}i?n=this.isCellGoodToFocusOn(i):n=!0}return i}isCellGoodToFocusOn(e){let t=e.column,i,{pinnedRowModel:n,rowModel:r}=this.beans;switch(e.rowPinned){case"top":i=n?.getPinnedTopRow(e.rowIndex);break;case"bottom":i=n?.getPinnedBottomRow(e.rowIndex);break;default:i=r.getRow(e.rowIndex);break}return i?!this.isSuppressNavigable(t,i):!1}getCellToLeft(e){if(!e)return null;let t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;let t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;let t=this.rowSpanSvc?.getCellEnd(e)??e,i=q_(this.beans,t,!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getCellAbove(e){if(!e)return null;let t=this.rowSpanSvc?.getCellStart(e)??e,i=am(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){let{visibleCols:t,pagination:i}=this.beans,n=t.allCols,r=e.rowIndex,o=e.rowPinned,s=t.getColAfter(e.column);if(!s){s=n[0];let a=q_(this.beans,e,!0);if(mt(a)||!a.rowPinned&&!(i?.isRowInPage(a.rowIndex)??!0))return null;r=a?a.rowIndex:null,o=a?a.rowPinned:null}return{rowIndex:r,column:s,rowPinned:o}}getNextTabbedCellBackwards(e){let{beans:t}=this,{visibleCols:i,pagination:n}=t,r=i.allCols,o=e.rowIndex,s=e.rowPinned,a=i.getColBefore(e.column);if(!a){a=dt(r);let l=am(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(mt(l)||!l.rowPinned&&!(n?.isRowInPage(l.rowIndex)??!0))return null;o=l?l.rowIndex:null,s=l?l.rowPinned:null}return{rowIndex:o,column:a,rowPinned:s}}isSuppressNavigable(e,t){let{suppressNavigable:i}=e.colDef;if(typeof i=="boolean")return i;if(typeof i=="function"){let n=e.createColumnFunctionCallbackParams(t);return i(n)}return!1}};function XQ(e){return e.focusSvc.getFocusedCell()}function JQ(e){return e.focusSvc.clearFocusedCell()}function QQ(e,t,i,n){e.focusSvc.setFocusedCell({rowIndex:t,column:i,rowPinned:n,forceBrowserFocus:!0})}function ZQ(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function eZ(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function tZ(e,t,i=!1){let n=e.headerNavigation?.getHeaderPositionForColumn(t,i);n&&e.focusSvc.focusHeaderPosition({headerPosition:n})}var iZ=class extends j{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new nM,this.rowValidations=new rM,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;let i=this.getEditRow(e);t?i.delete(t):i.clear(),i.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;let i=e&&this.edits.get(e);if(i)return i;if(t.checkSiblings){let n=e.pinnedSibling;if(n)return this.getEditRow(n)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;let i=this.getEditRow(e),n=e.pinnedSibling,r=t&&n&&this.getEditRow(n);if(!i&&!r)return;let o=Object.assign({},e.data),s=(a,l)=>a.forEach(({pendingValue:c},d)=>{c!==Fn&&(l[d.getColId()]=c)});return i&&s(i,o),r&&s(r,o),o}getEdit(e,t){let i=this._getEdit(e);return t&&i?w({},i):i}_getEdit(e){if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&this.getEditRow(e.rowNode)?.get(e.column)}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;let t=new Map;return this.edits.forEach((i,n)=>{let r=new Map;i.forEach((l,a)=>{var c=l,{editorState:o}=c,s=xt(c,["editorState"]);return r.set(a,w({},s))}),t.set(n,r)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,i)=>{let n=new Map;t.forEach((r,o)=>n.set(o,w({},r))),this.edits.set(i,n)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);let i=this._getEdit(e),n=Object.assign(w(w({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}},i),t));return this.getEditRow(e.rowNode).set(e.column,n),n}clearEditValue(e){let{rowNode:t,column:i}=e;if(t)if(i){let n=this._getEdit(e);n&&(n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed")}else this.getEditRow(t)?.forEach(n=>{n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed"})}getState(e){if(!this.suspendEdits)return this.getEdit(e)?.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];let t=[];return(e??this.edits).forEach((i,n)=>{for(let o of i.keys()){let r=i.get(o),{editorState:s}=r,a=xt(r,["editorState"]);t.push(w({rowNode:n,column:o},a))}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){if(this.suspendEdits||this.edits.size===0)return!1;let{rowNode:i,column:n}=e,{withOpenEditor:r}=t;if(i){let o=this.getEditRow(i,t);return o?n?r?this.getEdit(e)?.state==="editing":o.has(n)??!1:o.size!==0?r?Array.from(o.values()).some(({state:s})=>s==="editing"):!0:!1:!1}return r?this.getEditPositions().some(({state:o})=>o==="editing"):this.edits.size>0}start(e){let t=this.getEditRow(e.rowNode)??new Map,{rowNode:i,column:n}=e;n&&!t.has(n)&&t.set(n,{editorValue:void 0,pendingValue:Fn,sourceValue:this.beans.valueSvc.getValue(n,i,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(i,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(let e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},nM=class{constructor(){this.cellValidations=new Map}getCellValidation(e){let{rowNode:t,column:i}=e||{};return this.cellValidations?.get(t)?.get(i)}hasCellValidation(e){return!e?.rowNode||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){let{rowNode:i,column:n}=e;this.cellValidations.has(i)||this.cellValidations.set(i,new Map),this.cellValidations.get(i).set(n,t)}clearCellValidation(e){let{rowNode:t,column:i}=e;this.cellValidations.get(t)?.delete(i)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},rM=class{constructor(){this.rowValidations=new Map}getRowValidation(e){let{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e?.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function qy(e,t={}){let{rowIndex:i,rowId:n,rowCtrl:r,rowPinned:o}=t;if(r)return r;let{rowModel:s,rowRenderer:a}=e,{rowNode:l}=t;return l||(n?l=Y$(e,n,o):i!=null&&(l=s.getRow(i))),a.getRowCtrls(l?[l]:[])?.[0]}function St(e,t={}){let{cellCtrl:i,colId:n,columnId:r,column:o}=t;if(i)return i;let s=e.colModel.getCol(n??r??Qb(o)),a=t.rowCtrl??qy(e,t),l=a?.getCellCtrl(s)??void 0;if(l)return l;let c=t.rowNode??a?.rowNode;if(c)return e.rowRenderer.getCellCtrls([c],[s])?.[0]}function mD(e){let{editSvc:t}=e;t?.isBatchEditing()?(is(e,{persist:!0}),Ql(e)):t?.stopEditing(void 0,{source:"api"})}function nZ(e,t,i){let{gos:n,popupSvc:r}=t;if(!n.get("stopEditingWhenCellsLoseFocus"))return;let o=s=>{let a=s.relatedTarget;if(Nb(a)===null){mD(t);return}let l=i.some(c=>c.contains(a))&&n.isElementInThisInstance(a);l||(l=!!r&&(r.getActivePopups().some(c=>c.contains(a))||r.isElementWithinCustomPopup(a))),l||mD(t)};for(let s of i)e.addManagedElementListeners(s,{focusout:o})}function Qb(e){if(e)return typeof e=="string"?e:e.getColId()}var Fn=Symbol("unedited");function oM(e,t={}){let i=[],n=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(let r of n){let o=r.comp?.getCellEditor();o&&i.push({ctrl:r,editor:ju(o)})}return i}var rZ=(e,t={})=>oM(e,t).map(i=>i.editor);function oZ(e,t,i,n,r,o){t.length===0&&i?.rowNode&&i?.column&&oc(e,i,{key:n,event:r,cellStartedEdit:o});let{valueSvc:s,editSvc:a,editModelSvc:l}=e,{rowNode:c,column:d}=i??{};for(let u of t){let{rowNode:h,column:p}=u,f=St(e,u);if(!f){if(h&&p){let m=s.getValue(p,h,void 0,"api"),b=(i?.rowNode===h&&i?.column===p&&n||void 0)??a?.getCellDataValue(u,!1)??s.getValueForDisplay({column:p,node:h})?.value??m??Fn;l?.setEdit(u,{pendingValue:sc(e,b,!1,p),sourceValue:m,state:"editing"})}continue}let g=o&&c===f.rowNode&&f.column===d;oc(e,{rowNode:c,column:f.column},{key:g?n:null,event:g?r:null,cellStartedEdit:g&&o})}}function _r({pendingValue:e,sourceValue:t}){return e===Fn&&(e=t),e!==t}function oc(e,t,i){let{key:n,event:r,cellStartedEdit:o,silent:s}=i??{},{editModelSvc:a,editSvc:l,gos:c,userCompFactory:d}=e,u=St(e,t),h=u?.comp?.getCellEditor(),p=aM(e,t,n,o&&!s),f=t.column.isAllowFormula(),g=a?.getEdit(t),m=p.value??g?.sourceValue;if(h){a?.setEdit(t,{editorValue:sc(e,m,!0,t.column),state:"editing"}),h.refresh?.(p);return}let v=t.column.getColDef(),C=HF(d,f?T(w({},v),{cellEditor:"agTextCellEditor"}):v,p);if(!C)return;let{popupFromSelector:b,popupPositionFromSelector:S}=C,E=b??!!v.cellEditorPopup,x=S??v.cellEditorPopupPosition;if(lM(C.params,r),!u)return;let{rangeFeature:P,rowCtrl:F,comp:N,onEditorAttachedFuncs:Y}=u;a?.setEdit(t,{editorValue:sc(e,m,!0,t.column),state:"editing"}),u.editCompDetails=C,Y.push(()=>P?.unsetComp()),N?.setEditDetails(C,E,x,c.get("reactiveCustomComponents")),F?.refreshRow({suppressFlash:!0});let X=a?.getEdit(t,!0);!s&&!X?.editorState?.cellStartedEditing&&(l?.dispatchCellEvent(t,r,"cellEditingStarted",{value:m}),a?.setEdit(t,{editorState:{cellStartedEditing:!0}}))}function sM(e,t,i){let n={editorValueExists:!1};if($y(e)&&(t.getValidationErrors?.()?.length??0)>0||i?.isCancelling)return n;if(i?.isStopping){let o=t?.isCancelAfterEnd?.();if(o)return T(w({},n),{isCancelAfterEnd:o})}return{editorValue:t.getValue(),editorValueExists:!0}}function aM(e,t,i,n){let{valueSvc:r,gos:o,editSvc:s}=e,a=e.gos.get("enableGroupEdit"),l=St(e,t),c=t.rowNode?.rowIndex??void 0,d=s?.isBatchEditing(),u=e.colModel.getCol(t.column.getId()),{rowNode:h,column:p}=t,f=l.comp?.getCellEditor(),g=s?.getCellDataValue(t,!1),m=g===void 0?f?sM(e,f)?.editorValue:void 0:g,v=m===Fn?r.getValueForDisplay({column:u,node:h})?.value:m,C=a?m:v;return p.isAllowFormula()&&e.formula?.isFormula(C)&&(C=e.formula?.normaliseFormula(C,!0)??C),_e(o,{value:C,eventKey:i??null,column:p,colDef:p.getColDef(),rowIndex:c,node:h,data:h.data,cellStartedEdit:n??!1,onKeyDown:l?.onKeyDown.bind(l),stopEditing:b=>{s.stopEditing(t,{source:d?"ui":"api",suppressNavigateAfterEdit:b}),cm(e,t)},eGridCell:l?.eGui,parseValue:b=>r.parseValue(u,h,b,l?.value),formatValue:l?.formatValue.bind(l),validate:()=>{s?.validateEdit()}})}function Vg(e,t){let{editModelSvc:i}=e;i?.getEditMap().forEach((n,r)=>{n.forEach((o,s)=>{!t&&(o.state==="editing"||o.pendingValue===Fn)||!_r(o)&&(o.state!=="editing"||t)&&i?.removeEdits({rowNode:r,column:s})})})}function sZ(e,t){let i=t.comp?.getCellEditor();if(!i?.refresh)return;let{eventKey:n,cellStartedEdit:r}=t.editCompDetails.params,{column:o}=t,s=aM(e,t,n,r),a=o.getColDef(),l=HF(e.userCompFactory,a,s);i.refresh(lM(l.params,n))}function lM(e,t){return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes(t?.key??"")||e.suppressPreventDefault:t?.preventDefault?.(),e}function is(e,t){for(let i of e.editModelSvc?.getEditPositions()??[]){let n=St(e,i);if(!n)continue;let r=n.comp?.getCellEditor();if(!r)continue;let{editorValue:o,editorValueExists:s,isCancelAfterEnd:a}=sM(e,r,t);a&&e.editModelSvc?.setEdit(i,{editorState:{isCancelAfterEnd:a}}),Gg(e,i,o,void 0,!s,t)}}function Gg(e,t,i,n,r,o){let{editModelSvc:s,valueSvc:a}=e;if(!s)return;let{rowNode:l,column:c}=t;if(!(l&&c))return;let d=s.getEdit(t,!0);if(!d?.sourceValue){let u={sourceValue:a.getValue(c,l,void 0,"api"),pendingValue:d?sc(e,d.editorValue,!1,c):Fn};o?.persist&&(u.state="changed"),d=s.setEdit(t,u)}s.setEdit(t,{editorValue:r?sc(e,d.sourceValue,!0,c):i}),o?.persist&&aZ(e,t)}function sc(e,t,i,n){let{formula:r}=e;return n.isAllowFormula()&&r?.isFormula(t)?r?.normaliseFormula(t,i)??t:t}function aZ(e,t){let{editModelSvc:i}=e,n=i?.getEdit(t,!0);i?.setEdit(t,{pendingValue:sc(e,n?.editorValue,!1,t.column)})}function Ql(e,t,i){t||(t=e.editModelSvc?.getEditPositions());for(let n of t??[])cm(e,n,i)}function cm(e,t,i){let n=e.gos.get("enableGroupEdit"),{editModelSvc:r}=e,o=St(e,t),s=r?.getEdit(t,!0);if(!o){s&&r?.setEdit(t,{state:"changed"});return}let{comp:a}=o;if(a&&!a.getCellEditor()){if(o?.refreshCell(),s){r?.setEdit(t,{state:"changed"});let c=n?vD(i,s):{valueChanged:!1,newValue:void 0,oldValue:s.sourceValue};CD(e,t,c,i)}return}if($y(e)){let c=a?.getCellEditor()?.getValidationErrors?.(),d=r?.getCellValidationModel();c?.length?d?.setCellValidation(t,{errorMessages:c}):d?.clearCellValidation(t)}r?.setEdit(t,{state:"changed"}),a?.setEditDetails(),a?.refreshEditStyles(!1,!1),o?.refreshCell({force:!0,suppressFlash:!0});let l=r?.getEdit(t);if(l&&l.state==="changed"){let c=n?vD(i,l):{valueChanged:_r(l)&&!i?.cancel,newValue:i?.cancel||l.editorState.isCancelAfterEnd?void 0:l?.editorValue??s?.pendingValue,oldValue:l?.sourceValue};CD(e,t,c,i)}}function vD(e,t){return e?.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:_r(t),oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function CD(e,t,i,{silent:n,event:r}={}){let{editSvc:o,editModelSvc:s}=e,a=s?.getEdit(t),{editorState:l}=a||{},{isCancelBeforeStart:c}=l||{};!n&&!c&&(o?.dispatchCellEvent(t,r,"cellEditingStopped",i),s?.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function $y(e){let{gos:t,colModel:i}=e,n=!!t.get("getFullRowEditValidationErrors"),r=i.getColumnDefs()?.filter(s=>s.editable).some(({cellEditorParams:s})=>{let{minLength:a,maxLength:l,getValidationErrors:c,min:d,max:u}=s||{};return a!==void 0||l!==void 0||c!==void 0||d!==void 0||u!==void 0}),o=e.gridApi.getCellEditorInstances().some(s=>s.getValidationElement||s.getValidationErrors);return r||n||o}function ba(e,t){if(!(t||$y(e)))return;let i=oM(e),n=new nM,{ariaAnnounce:r,localeSvc:o,editModelSvc:s,gos:a}=e,l=a.get("editType")==="fullRow",d=tF(o)("ariaValidationErrorPrefix","Cell Editor Validation");for(let h of i){let{ctrl:p,editor:f}=h,{rowNode:g,column:m}=p,v=f.getValidationErrors?.()??[],C=f.getValidationElement?.(!1)||!f.isPopup?.()&&p.eGui;if(C){let b=v!=null&&v.length>0,S=b?v.join(". "):"";ay(C,b),b&&r.announceValue(`${d} ${v}`,"editorValidation"),C instanceof HTMLInputElement?C.setCustomValidity(S):C.classList.toggle("invalid",b)}v?.length>0&&n.setCellValidation({rowNode:g,column:m},{errorMessages:v})}is(e,{persist:!1}),s?.setCellValidationModel(n);let u=new Set;for(let{ctrl:h}of i)u.add(h.rowCtrl);if(l){let h=lZ(e);s?.setRowValidationModel(h)}for(let h of u.values()){h.rowEditStyleFeature?.applyRowStyles();for(let p of h.getAllCellCtrls())p.tooltipFeature?.refreshTooltip(!0),p.editorTooltipFeature?.refreshTooltip(!0),p.editStyleFeature?.applyCellStyles?.()}}var lZ=e=>{let t=new rM,i=e.gos.get("getFullRowEditValidationErrors"),n=e.editModelSvc?.getEditMap();if(!n)return t;for(let r of n.keys()){let o=n.get(r);if(!o)continue;let s=[],{rowIndex:a,rowPinned:l}=r;for(let d of o.keys()){let u=o.get(d);if(!u)continue;let{editorValue:h,pendingValue:p,sourceValue:f}=u,g=h??(p===Fn?void 0:p)??f;s.push({column:d,colId:d.getColId(),rowIndex:a,rowPinned:l,oldValue:f,newValue:g})}let c=i?.({editorsState:s})??[];c.length>0&&t.setRowValidation({rowNode:r},{errorMessages:c})}return t};function cZ(e){ba(e,!0);let t=e.editModelSvc?.getCellValidationModel().getCellValidationMap();if(!t)return null;let i=[];return t.forEach((n,r)=>{n.forEach(({errorMessages:o},s)=>{i.push({column:s,rowIndex:r.rowIndex,rowPinned:r.rowPinned,messages:o??null})})}),i}function dZ(e,t,i,{rowNode:n,column:r},o){return _e(e.gos,{type:i,node:n,data:n.data,value:o,column:r,colDef:r.getColDef(),rowPinned:n.rowPinned,event:t,rowIndex:n.rowIndex})}function uZ(e,t=!1){return e===B.DELETE?!0:!t&&e===B.BACKSPACE?GF():!1}var hZ=class extends j{constructor(e,t,i,n){super(),this.cellCtrl=e,this.rowNode=i,this.rowCtrl=n,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){let t=e.key;switch(t){case B.ENTER:this.onEnterKeyDown(e);break;case B.F2:this.onF2KeyDown(e);break;case B.ESCAPE:this.onEscapeKeyDown(e);break;case B.TAB:this.onTabKeyDown(e);break;case B.BACKSPACE:case B.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case B.DOWN:case B.UP:case B.RIGHT:case B.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){let{cellCtrl:i,beans:n}=this;if(!n.editSvc?.isEditing(i,{withOpenEditor:!0})){if(e.shiftKey&&i.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{let r=i.getFocusedCellPosition();n.navigation?.navigateToNextCell(e,t,r,!0)}e.preventDefault()}}onShiftRangeSelect(e){let{rangeSvc:t,navigation:i}=this.beans;if(!t)return;let n=t.extendLatestRangeInDirection(e);n&&(e.key===B.LEFT||e.key===B.RIGHT?i?.ensureColumnVisible(n.column):i?.ensureRowVisible(n.rowIndex))}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){let{cellCtrl:i,beans:n,rowNode:r}=this,{gos:o,rangeSvc:s,eventSvc:a,editSvc:l}=n;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),uZ(e,o.get("enableCellEditingOnBackspace"))&&!l?.isEditing(i,{withOpenEditor:!0})){if(s&&ho(o))s.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){let{column:c}=i,d=this.beans.valueSvc.getDeleteValue(c,r);r.setDataValue(c,d,"cellClear")}}else l?.isEditing(i,{withOpenEditor:!0})||n.editSvc?.startEditing(i,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){let{cellCtrl:t,beans:i}=this,{editSvc:n,navigation:r}=i,o=n?.isEditing(t,{withOpenEditor:!0}),s=t.rowNode,a=n?.isRowEditing(s,{withOpenEditor:!0}),l=c=>{n?.startEditing(c,{startedEdit:!0,event:e,source:"edit"})&&e.preventDefault()};if(o||a){if(this.isCtrlEnter(e)){n?.applyBulkEdit(t,i?.rangeSvc?.getCellRanges()||[]);return}if(ba(i),n?.checkNavWithValidation(void 0,e)==="block-stop")return;n?.isEditing(t,{withOpenEditor:!0})?n?.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?n?.stopEditing({rowNode:s},{event:e,source:"edit"}):l(t)}else if(i.gos.get("enterNavigatesVertically")){let c=e.shiftKey?B.UP:B.DOWN;r?.navigateToNextCell(null,c,t.cellPosition,!1)}else{if(n?.hasValidationErrors())return;n?.hasValidationErrors(t)&&n.revertSingleCellEdit(t,!0),l(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===B.ENTER}onF2KeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.isEditing()&&(ba(this.beans),i?.checkNavWithValidation(void 0,e)==="block-stop")||i?.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.checkNavWithValidation(t,e)==="block-stop"&&i.revertSingleCellEdit(t),setTimeout(()=>{i?.stopEditing(t,{event:e,cancel:!0})})}processCharacter(e){let i=e.target!==this.eGui,{beans:{editSvc:n},cellCtrl:r}=this;if(i||n?.isEditing(r,{withOpenEditor:!0}))return;if(e.key===B.SPACE)this.onSpaceKeyDown(e);else if(n?.isCellEditable(r,"ui")){if(n?.hasValidationErrors()&&!n?.hasValidationErrors(r))return;n?.startEditing(r,{startedEdit:!0,event:e,source:"api"}),!r.editCompDetails?.params?.suppressPreventDefault&&e.preventDefault()}}onSpaceKeyDown(e){let{gos:t,editSvc:i}=this.beans,{rowNode:n}=this.cellCtrl;!i?.isEditing(this.cellCtrl,{withOpenEditor:!0})&&ua(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,n,"spaceKey"),e.preventDefault()}},pZ=class extends j{constructor(e,t,i){super(),this.cellCtrl=e,this.column=i,this.beans=t}onMouseEvent(e,t){if(!uo(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;let{eventSvc:t,rangeSvc:i,editSvc:n,editModelSvc:r,frameworkOverrides:o,gos:s}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:l}=this,{column:c,cellPosition:d,rowNode:u}=l,h=Ng(s,c,u,e);i&&a&&!h&&i.getCellRangeCount(d)>1&&i.intersectLastRange(!0);let p=l.createEvent(e,"cellClicked");p.isEventHandlingSuppressed=h,t.dispatchEvent(p);let f=c.getColDef();if(f.onCellClicked&&window.setTimeout(()=>{o.wrapOutgoing(()=>{f.onCellClicked(p)})},0),!h&&r?.getState(l)!=="editing"){let g=n?.isEditing(),m=r?.getCellValidationModel().getCellValidationMap().size??0,v=r?.getRowValidationModel().getRowValidationMap().size??0;if(g&&(m>0||v>0))return;n?.shouldStartEditing(l,e)?n?.startEditing(l,{event:e}):n?.shouldStopEditing(l,e)&&(this.beans.gos.get("editType")==="fullRow"?n?.stopEditing(l,{event:e,source:"edit"}):n?.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){let{column:t,beans:i,cellCtrl:n}=this,{eventSvc:r,frameworkOverrides:o,editSvc:s,editModelSvc:a,gos:l}=i,c=Ng(l,n.column,n.rowNode,e),d=t.getColDef(),u=n.createEvent(e,"cellDoubleClicked");if(u.isEventHandlingSuppressed=c,r.dispatchEvent(u),typeof d.onCellDoubleClicked=="function"&&window.setTimeout(()=>{o.wrapOutgoing(()=>{d.onCellDoubleClicked(u)})},0),!c&&s?.shouldStartEditing(n,e)&&a?.getState(n)!=="editing"){let h=s?.isEditing(),p=a?.getCellValidationModel().getCellValidationMap().size??0,f=a?.getRowValidationModel().getRowValidationMap().size??0;if(h&&(p>0||f>0))return;s?.startEditing(n,{event:e})}}onMouseDown(e){let{shiftKey:t}=e,i=e.target,{cellCtrl:n,beans:r}=this,{eventSvc:o,rangeSvc:s,rowNumbersSvc:a,focusSvc:l,gos:c,editSvc:d}=r,{column:u,rowNode:h,cellPosition:p}=n,f=Ng(c,u,h,e),g=()=>{let b=n.createEvent(e,"cellMouseDown");b.isEventHandlingSuppressed=f,o.dispatchEvent(b)};if(f){g();return}if(this.isRightClickInExistingRange(e))return;let m=s&&!s.isEmpty(),v=this.containsWidget(i),C=lo(u);if(!(a&&C&&!a.handleMouseDownOnCell(p,e))){if(!t||!m){let b=d?.isEditing(n),E=c.get("enableCellTextSelection")&&e.defaultPrevented,x=(fs()||E)&&!b&&!Du(i)&&!v;n.focusCell(x,e)}if(t&&m&&!l.isCellFocused(p)){e.preventDefault();let b=l.getFocusedCell();if(b){let{column:S,rowIndex:E,rowPinned:x}=b;d?.isEditing(b)&&d?.stopEditing(b),l.setFocusedCell({column:S,rowIndex:E,rowPinned:x,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}v||(s?.handleCellMouseDown(e,p),g())}}isRightClickInExistingRange(e){let{rangeSvc:t}=this.beans;if(t){let i=t.isCellInAnyRange(this.cellCtrl.cellPosition),n=dU(this.beans,e);if(i&&n)return!0}return!1}containsWidget(e){return da(e,"ag-selection-checkbox",3)||da(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),i?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),i?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;let t=this.cellCtrl.eGui,i=t.contains(e.target),n=t.contains(e.relatedTarget);return i&&n}},fZ=class extends j{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;let e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){let t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){let t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){let e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){let e=this.getColSpanningList();hs(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;let e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){let{column:e,rowNode:t}=this,i=e.getColSpan(t),n=[];if(i===1)n.push(e);else{let r=e,o=e.getPinned();for(let s=0;r&&s<i&&(n.push(r),r=this.beans.visibleCols.getColAfter(r),!(!r||mt(r)||o!==r.getPinned()));s++);}return n}onLeftChanged(){if(!this.eSetLeft)return;let e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=dt(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;let{visibleCols:t}=this.beans,i=t.getColsLeftWidth();if(this.column.getPinned()==="right"){let n=t.bodyWidth;return i+n+(e||0)}return i+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;let i=ha(this.beans)*this.rowSpan;this.eContent.style.height=`${i}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},gZ="ag-cell",mZ="ag-cell-auto-height",vZ="ag-cell-normal-height",CZ="ag-cell-focus",wZ="ag-cell-first-right-pinned",bZ="ag-cell-last-left-pinned",yZ="ag-cell-not-inline-editing",SZ="ag-cell-wrap-text",xZ=0,Zl=class extends j{constructor(e,t,i,n){super(),this.column=e,this.rowNode=t,this.rowCtrl=n,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.formulaTooltipFeature=void 0,this.beans=i,this.gos=i.gos,this.editSvc=i.editSvc,this.hasEdit=!!i.editSvc;let{colId:r}=e;this.instanceId=r+"-"+xZ++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){let{beans:e}=this;this.positionFeature=new fZ(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this),this.editStyleFeature=e.editSvc?.createCellStyleFeature(this),this.mouseListener=new pZ(this,e,this.column),this.keyboardListener=new hZ(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature(),this.enableFormulaTooltipFeature();let{rangeSvc:t}=e;t&&ho(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(this)),lo(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){let e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature(),this.disableFormulaTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}enableFormulaTooltipFeature(){this.formulaTooltipFeature=this.beans.tooltipSvc?.setupFormulaTooltip(this)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}disableFormulaTooltipFeature(){this.formulaTooltipFeature=this.beans.context.destroyBean(this.formulaTooltipFeature)}enableEditorTooltipFeature(e){this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=this.beans.tooltipSvc?.setupCellEditorTooltip(this,e),ba(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,i,n,r,o,s){if(this.comp=e,this.eGui=t,this.printLayout=r,s??(s=this),this.addDomData(s),this.addFeatures(),s.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,s),this.refreshFirstAndLastStyles(),this.checkFormulaError(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.editStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),this.rowResizeFeature?.refreshRowResizer(),o&&this.isCellEditable()||this.hasEdit&&this.editSvc?.isEditing(this,{withOpenEditor:!0})?this.editSvc?.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(let a of this.onCompAttachedFuncs)a();this.onCompAttachedFuncs=[]}}checkFormulaError(){let e=!!this.beans.formula?.getFormulaError(this.column,this.rowNode);this.eGui.classList.toggle("formula-error",e),this.formulaTooltipFeature?.refreshTooltip(),e?this.disableTooltipFeature():this.enableTooltipFeature()}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){let e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){let{beans:e,column:t}=this,{userCompFactory:i,ctrlsSvc:n,eventSvc:r}=e,o=t.getColDef(),s=this.createCellRendererParams();s.deferRender=!0;let a=__(i,o,s);if(n.getGridBodyCtrl()?.scrollFeature?.isScrolling()){let l,c=new wt(u=>{l=u}),[d]=this.addManagedListeners(r,{bodyScrollEnd:()=>{l(),d()}});return{loadingComp:a,onReady:c}}return{loadingComp:a,onReady:wt.resolve()}}showValue(e,t){let{beans:i,column:n,rowNode:r,rangeFeature:o}=this,{userCompFactory:s}=i,a=this.getValueToDisplay(),l,c=r.stub&&r.groupData?.[n.getId()]==null,d=n.getColDef();if(c||this.isCellRenderer()){let u=this.createCellRendererParams();!c||lo(n)?l=k_(s,d,u):l=__(s,d,u)}if(!l&&!c&&i.findSvc?.isMatch(r,n)){let u=this.createCellRendererParams();l=k_(s,T(w({},n.getColDef()),{cellRenderer:"agFindCellRenderer"}),u)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(r,{checkSiblings:!0})){let u=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});u&&(u.compDetails?l=u.compDetails:u.valueToDisplay&&(a=u.valueToDisplay))}this.comp.setRenderDetails(l,a,e),this.customRowDragComp?.refreshVisibility(),!t&&o&&go(i,()=>o?.refreshHandle()),this.rowResizeFeature?.refreshRowResizer()}setupControlComps(){let e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){let e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer",i="";return t&&(i=" ag-allow-overflow"),`${e}${i}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&ih(this.rowNode))&&!!e}isCheckboxSelection(e){let{rowSelection:t,groupDisplayType:i}=this.beans.gridOptions,n=Xg(t),r=ps(this.column);return i==="custom"&&n!=="selectionColumn"&&r?!1:e.checkboxSelection||r&&typeof t=="object"&&jl(t)}refreshShouldDestroy(){let e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource),r=this.isAutoHeight!=this.column.isAutoHeight();return t||i||n||r}onPopupEditorClosed(){let{editSvc:e}=this.beans;e?.isEditing(this,{withOpenEditor:!0})&&e?.stopEditing(this,{source:e?.isBatchEditing()?"ui":"api"})}stopEditing(e=!1){let{editSvc:t}=this.beans;return t?.stopEditing(this,{cancel:e,source:t?.isBatchEditing()?"ui":"api"})??!1}createCellRendererParams(){let{value:e,valueFormatted:t,column:i,rowNode:n,comp:r,eGui:o,beans:{valueSvc:s,gos:a,editSvc:l}}=this;return _e(a,{value:e,valueFormatted:t,getValue:()=>s.getValueForDisplay({column:i,node:n}).value,setValue:d=>l?.setDataValue({rowNode:n,column:i},d)||n.setDataValue(i,d),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:i.getPinned(),colDef:i.getColDef(),column:i,refreshCell:this.refreshCell.bind(this),eGridCell:o,eParentOfValue:r.getParentOfValue(),registerRowDragger:(d,u,h,p)=>this.registerRowDragger(d,u,p),setTooltip:(d,u)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(d,u),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){if(this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){let{editSvc:t,comp:i}=this;!i?.getCellEditor()&&t.isEditing(this,{withOpenEditor:!0})&&t.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:i}={}){let{editStyleFeature:n,customStyleFeature:r,rowCtrl:{rowEditStyleFeature:o},beans:{cellFlashSvc:s,filterManager:a},column:l,comp:c,suppressRefreshCell:d,tooltipFeature:u}=this;if(d)return;let{field:h,valueGetter:p,showRowGroup:f,enableCellChangeFlash:g}=l.getColDef(),m=h==null&&p==null&&f==null,v=e||m||i,C=!!c,b=this.updateAndFormatValue(C),S=v||b;if(C){if(S){this.showValue(!!i,!1);let E=a?.isSuppressFlashingCellsBecauseFiltering();!t&&!E&&g&&s?.flashCell(this),n?.applyCellStyles?.(),r?.applyUserStyles(),r?.applyClassesFromColDef(),o?.applyRowStyles(),this.checkFormulaError()}u?.refreshTooltip(),r?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){let t=this.value,i=this.valueFormatted,{value:n,valueFormatted:r}=this.beans.valueSvc.getValueForDisplay({column:this.column,node:this.rowNode,includeValueFormatted:!0});return this.value=n,this.valueFormatted=r,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(e,t){let i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}addDomData(e){let t=this.eGui;va(this.beans.gos,t,om,this),e.addDestroyFunc(()=>va(this.beans.gos,t,om,null))}createEvent(e,t){let{rowNode:i,column:n,value:r,beans:o}=this;return dZ(o,e,t,{rowNode:i,column:n},r)}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature?.getColSpanningList()??[]}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){let{comp:e,column:t,beans:i}=this;P8(e,t,i.visibleCols)}refreshAriaColIndex(){let e=this.beans.visibleCols.getAriaColIndex(this.column);UD(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){let{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){let i=this.editSvc?.allowedFocusTargetOnValidation(this);i&&i!==this||this.beans.focusSvc.setFocusedCell(T(w({},this.getFocusedCellPosition()),{forceBrowserFocus:e,sourceEvent:t}))}restoreFocus(e=!1){let{beans:{editSvc:t,focusSvc:i},comp:n}=this;if(!n||t?.isEditing(this)||!this.isCellFocused()||!i.shouldTakeFocus())return;let r=()=>{if(!this.isAlive())return;let o=n.getFocusableElement();this.isCellFocused()&&o.focus({preventScroll:!0})};if(e){setTimeout(r,0);return}r()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged(),this.rowResizeFeature?.refreshRowResizer()}onSuppressCellFocusChanged(e){let t=this.eGui;t&&(lo(this.column)&&(e=!0),Ui(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;let e=this.column.isFirstRightPinned();this.comp.toggleCss(wZ,e)}onLastLeftPinnedChanged(){if(!this.comp)return;let e=this.column.isLastLeftPinned();this.comp.toggleCss(bZ,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){let e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){let{beans:t}=this;if(xm(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}let i=this.isCellFocused(),n=t.editSvc?.isEditing(this)??!1;if(this.comp.toggleCss(CZ,i),i&&e?.forceBrowserFocus){let r=this.comp.getFocusableElement();if(n){let o=Yl(r,null,!0);o.length&&(r=o[0])}r.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}i&&e&&this.rowCtrl.announceDescription()}createCellPosition(){let{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:ao(t),column:this.column}}applyStaticCssClasses(){let{comp:e}=this;e.toggleCss(gZ,!0),e.toggleCss(yZ,!0);let t=this.column.isAutoHeight()==!0;e.toggleCss(mZ,t),e.toggleCss(vZ,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editSvc?.isEditing(this)?this.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){let e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(SZ,e)}dispatchCellContextMenuEvent(e){let t=this.column.getColDef(),i=this.createEvent(e,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout(()=>{n.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(i)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(bt(this.beans))??!1}createSelectionCheckbox(){let e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){let e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}let n=this.createRowDragComp(e,t,i);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}),n.refreshVisibility())}createRowDragComp(e,t,i){let n=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,i);if(n)return this.beans.context.createBean(n),n}cellEditorAttached(){for(let e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function Ky(e,t,i,n,r,o){if(i==null&&t==null)return;let s={},a={},l=(c,d)=>{for(let u of c.split(" "))u.trim()!=""&&d(u)};if(i){let c=Object.keys(i);for(let d=0;d<c.length;d++){let u=c[d],h=i[u],p;typeof h=="string"?p=e?e.evaluate(h,n):!0:typeof h=="function"&&(p=h(n)),l(u,f=>{p?s[f]=!0:a[f]=!0})}}if(t&&o)for(let c of Object.keys(t))l(c,d=>{s[d]||(a[d]=!0)});o&&Object.keys(a).forEach(o),Object.keys(s).forEach(r)}function wD(e){if(e.group)return e.level;let t=e.parent;return t?t.level+1:0}var EZ=class extends j{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){let i=this.gos,n=s=>{if(typeof s=="string")e.push(s);else if(Array.isArray(s))for(let a of s)e.push(a)},r=i.get("rowClass");r&&n(r);let o=i.getCallback("getRowClass");if(o){let s={data:t.data,node:t,rowIndex:t.rowIndex},a=o(s);n(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,i=>{e.push(i)},()=>{})}processRowClassRules(e,t,i){let{gos:n,expressionSvc:r}=this.beans,o=_e(n,{data:e.data,node:e,rowIndex:e.rowIndex});Ky(r,void 0,n.get("rowClassRules"),o,t,i)}processStylesFromGridOptions(e){let t=this.gos,i=t.get("rowStyle"),n=t.getCallback("getRowStyle"),r;if(n){let o={data:e.data,node:e,rowIndex:e.rowIndex};r=n(o)}if(r||i)return Object.assign({},i,r)}},RZ=0,dm=class extends j{constructor(e,t,i,n,r){super(),this.rowNode=e,this.useAnimationFrameForCreate=n,this.printLayout=r,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+RZ++,this.rowId=_u(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=wD(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=t.editSvc?.createRowStyleFeature(this),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;let e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=_u(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,i,n){let{context:r,focusSvc:o}=this.beans;n=Qu(this,r,n);let s={rowComp:e,element:t,containerType:i,compBean:n};this.allRowGuis.push(s),this.updateGui(i,s),this.initialiseRowComp(s);let a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,c=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!c&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();let d=this.fullWidthGui?.element;d&&!this.beans.editSvc?.isEditing(this)&&o.isRowFocused(a.rowIndex,a.rowPinned)&&o.shouldTakeFocus()&&setTimeout(()=>d.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){let t=e?"none":"";for(let i of this.allRowGuis)i.element.style.display=t}initialiseRowComp(e){let t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),ua(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);let i=e.rowComp,n=this.getInitialRowClasses(e.containerType);for(let r of n)i.toggleCss(r,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&Pb(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),va(t,e.element,sm,this),e.compBean.addDestroyFunc(()=>va(t,e.element,sm,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){let t=_u(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){let{containerType:t}=e;this.slideInAnimation[t]&&(_b(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(_b(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){let t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;let i=this.createBean(t,this.beans.context);this.rowDragComps.push(i),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==i),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(i,this.beans.context)})}setupFullWidth(e){let t=this.getPinnedForContainer(e.containerType),i=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(i)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){let e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;let t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){let{leftGui:e,centerGui:t,rightGui:i,beans:{visibleCols:n}}=this,r=!!e||!n.isPinningLeft(),o=!!t,s=!!i||!n.isPinningRight();return r&&o&&s}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){let{rowNode:e,gos:t,beans:{colModel:i}}=this,n=e.stub&&!t.get("suppressServerSideFullWidthLoadingRow")&&!t.get("groupHideOpenParents"),r=this.isNodeFullWidthCell(),o=t.get("masterDetail")&&e.detail,s=i.isPivotMode(),a=vF(t,e,s);n?this.rowType="FullWidthLoading":o?this.rowType="FullWidthDetail":r?this.rowType="FullWidth":a?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;let{animationFrameSvc:i}=this.beans;if(!i?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(i.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new Zl(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,i=null){let n={list:[],map:{}},r=(c,d,u)=>{u!=null?n.list.splice(u,0,d):n.list.push(d),n.map[c]=d},o=[];for(let c of t){let d=c.getInstanceId(),u=e.map[d];u&&!this.isCorrectCtrlForSpan(u)&&(u.destroy(),u=void 0),u||(u=this.getNewCellCtrl(c)),u&&r(d,u)}for(let c of e.list){let d=c.column.getInstanceId();if(n.map[d]!=null)continue;!this.isCellEligibleToBeRemoved(c,i)?o.push([d,c]):c.destroy()}if(o.length)for(let[c,d]of o){let u=n.list.findIndex(p=>p.column.getLeft()>d.column.getLeft()),h=u===-1?void 0:Math.max(u-1,0);r(c,d,h)}let{focusSvc:s,visibleCols:a}=this.beans,l=s.getFocusedCell();if(l&&l.column.getPinned()==i){let c=l.column.getInstanceId();if(!n.map[c]&&a.allCols.includes(l.column)){let u=this.createFocusedCellCtrl();if(u){let h=n.list.findIndex(f=>f.column.getLeft()>u.column.getLeft()),p=h===-1?void 0:Math.max(h-1,0);r(c,u,p)}}}return n}createFocusedCellCtrl(){let{focusSvc:e,rowSpanSvc:t}=this.beans,i=e.getFocusedCell();if(!i)return;let n=t?.getCellSpan(i.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(i))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(i.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(let t of this.allRowGuis){let i=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(i,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){let e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{let i=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);let n=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");let r=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}}isCellEligibleToBeRemoved(e,t){let{column:r}=e;if(r.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;let{visibleCols:o,editSvc:s}=this.beans,a=s?.isEditing(e),l=e.isCellFocused();return a||l?!(o.allCols.indexOf(r)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||ni(this.gos,"print")}listenOnDomOrder(e){let t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;let t=pe(this.rowNode.oldRowTop),{visibleCols:i}=this.beans,n=i.isPinningLeft(),r=i.isPinningRight();if(t){let{slideInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=n,o.right=r}else{let{fadeInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=n,o.right=r}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){let e=(s,a)=>s?s.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(s.element,a).params):!0,t=e(this.fullWidthGui,null),i=e(this.centerGui,null),n=e(this.leftGui,"left"),r=e(this.rightGui,"right");return t&&i&&n&&r}addListeners(){let{beans:e,gos:t,rowNode:i}=this,{expansionSvc:n,eventSvc:r,context:o,rowSpanSvc:s}=e;this.addManagedListeners(this.rowNode,w({heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this)},n?.getRowExpandedListeners(this)??{})),i.detail&&this.addManagedListeners(i.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(i,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(r,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),s&&this.addManagedListeners(s,{spannedCellsUpdated:({pinned:a})=>{a&&!i.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,o),this.tooltipFeature=this.destroyBean(this.tooltipFeature,o),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,o)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(let l of this.allRowGuis)this.addRowDraggerToRow(l);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,o)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(let e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(let t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(let e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(let i of this.getAllCellCtrls())i.refreshCell(e);for(let i of this.allRowGuis)this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.rowEditStyleFeature?.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){let e=this.beans.rowDropHighlightSvc,t=e?.row===this.rowNode?e.position:"none",i=t==="above",n=t==="inside",r=t==="below",o=t!=="none",s=i||r,a=this.rowNode.uiLevel,l=s&&a>0,c=l?a.toString():"0";for(let d of this.allRowGuis){let u=d.rowComp;u.toggleCss("ag-row-highlight-above",i),u.toggleCss("ag-row-highlight-inside",n),u.toggleCss("ag-row-highlight-below",r),u.toggleCss("ag-row-highlight-indent",l),o?d.element.style.setProperty("--ag-row-highlight-level",c):d.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){let e=this.rowNode.dragging;for(let t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:ao(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){let t=this.findFullWidthInfoForEvent(e);if(!t)return;let{rowGui:i,column:n}=t;if(!(i.element===e.target))return;let s=this.rowNode,{focusSvc:a,navigation:l}=this.beans,c=a.getFocusedCell(),d={rowIndex:s.rowIndex,rowPinned:s.rowPinned,column:c?.column??n};l?.navigateToNextCell(e,e.key,d,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||uo(e))return;let t=this.allRowGuis.find(a=>a.element.contains(e.target)),i=t?t.element:null,n=i===e.target,r=bt(this.beans),o=!1;i&&r&&(o=i.contains(r)&&r.classList.contains("ag-cell"));let s=null;!n&&!o&&(s=xa(this.beans,i,!1,e.shiftKey)),(this.isFullWidth()&&n||!s)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){let e=this.allRowGuis.find(t=>Ir(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){let t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(let i of this.allRowGuis)Ui(i.element,"tabindex",t)}onFullWidthRowFocused(e){let t=this.rowNode,i=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1,n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{let o=this.beans.colModel.getCol(e?.column)?.pinned;o?n=o==="right"?this.rightGui?.element:this.leftGui?.element:n=this.centerGui?.element}n&&(n.classList.toggle("ag-full-width-focus",i),i&&e?.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){let i={list:[],map:{}};for(let n of e.list)n!==t&&(i.list.push(n),i.map[n.column.getInstanceId()]=n);return i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){let{rowNode:i}=this;return _e(this.gos,{type:e,node:i,data:i.data,rowIndex:i.rowIndex,rowPinned:i.rowPinned,event:t})}createRowEventWithSource(e,t){let i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){if(uo(e))return;let t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;let t=this.findFullWidthRowGui(e.target),i=this.getColumnForFullWidth(t);if(!(!t||!i))return{rowGui:t,column:i}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){let{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=da(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;let{rangeSvc:t,focusSvc:i}=this.beans;t?.removeAllCellRanges();let n=this.findFullWidthInfoForEvent(e);if(!n)return;let{rowGui:r,column:o}=n,s=r.element,a=e.target,l=this.rowNode,c=e.defaultPrevented||fs();s&&s.contains(a)&&Du(a)&&(c=!1),i.setFocusedCell({rowIndex:l.rowIndex,column:o,rowPinned:l.rowPinned,forceBrowserFocus:c})}isSuppressMouseEvent(e){let{gos:t,rowNode:i}=this;if(this.isFullWidth()){let r=this.findFullWidthRowGui(e.target);return f$(t,r?.rowComp.getFullWidthCellRendererParams(),i,e)}let n=Oy(t,e.target);return n!=null&&Ng(t,n.column,i,e)}onRowClick(e){if(uo(e)||this.lastMouseDownOnDragger)return;let i=this.isSuppressMouseEvent(e),{eventSvc:n,selectionSvc:r}=this.beans,o=this.createRowEventWithSource("rowClicked",e);o.isEventHandlingSuppressed=i,n.dispatchEvent(o),!i&&r?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){let{gos:i,rowNode:n}=this,r=_e(i,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(s,a,l,c)=>this.addFullWidthRowDragging(s,a,l,c),setTooltip:(s,a)=>{i.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(s,a)}}),o=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return uj(o,r);case"FullWidthGroup":{let{value:s,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay({node:this.rowNode,includeValueFormatted:!0});return r.value=s,r.valueFormatted=a,dj(o,r)}case"FullWidthLoading":return cj(o,r);default:return lj(o,r)}}setupFullWidthRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,i="",n){let{rowDragSvc:r,context:o}=this.beans;if(!r||!this.isFullWidth())return;let s=r.createRowDragComp(()=>i,this.rowNode,void 0,e,t,n);this.createBean(s,o),this.addDestroyFunc(()=>{this.destroyBean(s,o)})}onUiLevelChanged(){let e=wD(this.rowNode);if(this.rowLevel!=e){let t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;for(let n of this.allRowGuis)n.rowComp.toggleCss(t,!0),n.rowComp.toggleCss(i,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){let e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(let i of this.allRowGuis)i.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){let e=[];if(this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(let t of e)for(let i of this.allRowGuis)i.rowComp.toggleCss(t,!0)}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{for(let t of this.allRowGuis)t.rowComp.toggleCss(e,!0)},e=>{for(let t of this.allRowGuis)t.rowComp.toggleCss(e,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){let t=this.getPinnedForContainer(e),i=this.isFullWidth(),{rowNode:n,beans:r}=this,o=[];o.push("ag-row"),o.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&o.push("ag-opacity-zero"),o.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&(o.push("ag-row-pinned"),r.pinnedRowModel?.isManual()&&o.push("ag-row-pinned-manual")),!n.isRowPinned()&&n.pinnedSibling&&o.push("ag-row-pinned-source"),n.isSelected()&&o.push("ag-row-selected"),n.footer&&o.push("ag-row-footer"),o.push("ag-row-level-"+this.rowLevel),n.stub&&o.push("ag-row-loading"),i&&o.push("ag-full-width-row"),r.expansionSvc?.addExpandedCss(o,n),n.dragging&&o.push("ag-row-dragging");let{rowStyleSvc:s}=r;return s&&(s.processClassesFromGridOptions(o,n),s.preProcessRowClassRules(o,n)),o.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&o.push("ag-row-first"),this.isLastRowOnPage()&&o.push("ag-row-last"),i&&(t==="left"&&o.push("ag-cell-last-left-pinned"),t==="right"&&o.push("ag-cell-first-right-pinned")),o}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;let{element:t,compBean:i}=e,{rowNode:n,beans:r,gos:o}=this;i.addManagedListeners(t,{pointerenter:s=>{s.pointerType==="mouse"&&n.dispatchRowEvent("mouseEnter")},pointerleave:s=>{s.pointerType==="mouse"&&n.dispatchRowEvent("mouseLeave")}}),i.addManagedListeners(n,{mouseEnter:()=>{!r.dragSvc?.dragging&&!o.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){let t=e?[e]:this.allRowGuis.map(i=>i.element);for(let i of t)i.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){let t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),n)}forEachGui(e,t){if(e)t(e);else for(let i of this.allRowGuis)t(i)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;let t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),r=hF(this.gos)?ls(this.beans,this.rowNode).height:void 0,o=r?`${Math.min(i,r)-2}px`:void 0;this.forEachGui(e,s=>{s.element.style.height=`${t}px`,o&&s.element.style.setProperty("--ag-line-height",o)})}destroyFirstPass(e=!1){this.active=!1;let{rowNode:t}=this;if(!e&&Ul(this.gos)&&!t.sticky)if(t.rowTop!=null){let r=this.roundRowTopToBounds(t.rowTop);this.setRowTop(r)}else for(let r of this.allRowGuis)r.rowComp.toggleCss("ag-opacity-zero",!0);this.fullWidthGui?.element.contains(bt(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);let i=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(i),this.beans.eventSvc.dispatchEvent(i),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;let e=t=>{for(let i of t.list)i.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){let{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){let e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;let i=this.beans.pageBounds.getPixelOffset();return e+i*(t?1:-1)}setRowTop(e){if(!this.printLayout&&pe(e)){let t=this.applyPaginationOffset(e),r=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(r)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";let t=this.rowNode,i;if(t.sticky)i=t.stickyRowTop;else{let n=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,r=this.applyPaginationOffset(n);i=t.isRowPinned()?r:this.beans.rowContainerHeight.getRealPixelPosition(r)}return i+"px"}setRowTopStyle(e){for(let t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let i=null;for(let n of this.getAllCellCtrls())n.column==e&&(i=n);if(i!=null||t)return i;for(let n of this.getAllCellCtrls())n?.getColSpanningList().indexOf(e)>=0&&(i=n);return i}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){let t=this.rowNode.getRowIndexString();if(t===null)return;let i=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),n=this.rowNode.rowIndex%2===0,r=i+this.rowNode.rowIndex+1;this.forEachGui(e,o=>{o.rowComp.setRowIndex(t),o.rowComp.toggleCss("ag-row-even",n),o.rowComp.toggleCss("ag-row-odd",!n),Ug(o.element,r)})}},PZ=class extends j{constructor(){super(),this.beanName="navigation",this.onPageDown=C_(this.onPageDown,100),this.onPageUp=C_(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){let i=e.key,n=e.altKey,r=e.ctrlKey||e.metaKey,o=!!this.beans.rangeSvc&&e.shiftKey,s=I$(this.gos,e),a=!1;switch(i){case B.PAGE_HOME:case B.PAGE_END:!r&&!n&&(this.onHomeOrEndKey(i),a=!0);break;case B.LEFT:case B.RIGHT:case B.UP:case B.DOWN:if(!s)return!1;r&&!n&&!o&&(this.onCtrlUpDownLeftRight(i,s),a=!0);break;case B.PAGE_DOWN:case B.PAGE_UP:!r&&!n&&(a=this.handlePageUpDown(i,s,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,i){return i&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===B.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:i,focusIndex:n,focusColumn:r,isAsync:o,rowPinned:s}){let{scrollFeature:a}=this.gridBodyCon;pe(i)&&!i.isPinned()&&a.ensureColumnVisible(i),pe(e)&&a.ensureIndexVisible(e,t),o||a.ensureIndexVisible(n);let{focusSvc:l,rangeSvc:c}=this.beans;l.setFocusedCell({rowIndex:n,column:r,rowPinned:s,forceBrowserFocus:!0}),c?.setRangeToCell({rowIndex:n,rowPinned:s,column:r})}onPageDown(e){let t=this.beans,i=wb(t),n=this.getViewportHeight(),{pageBounds:r,rowModel:o,rowAutoHeight:s}=t,a=r.getPixelOffset(),l=i.top+n,c=o.getRowIndexAtPixel(l+a);s?.active?this.navigateToNextPageWithAutoHeight(e,c):this.navigateToNextPage(e,c)}onPageUp(e){let t=this.beans,i=wb(t),{pageBounds:n,rowModel:r,rowAutoHeight:o}=t,s=n.getPixelOffset(),a=i.top,l=r.getRowIndexAtPixel(a+s);o?.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,i=!1){let{pageBounds:n,rowModel:r}=this.beans,o=this.getViewportHeight(),s=n.getFirstRow(),a=n.getLastRow(),l=n.getPixelOffset(),c=r.getRow(e.rowIndex),d=i?c?.rowHeight-o-l:o-l,u=c?.rowTop+d,h=r.getRowIndexAtPixel(u+l);if(h===e.rowIndex){let f=i?-1:1;t=h=e.rowIndex+f}let p;i?(p="bottom",h<s&&(h=s),t<s&&(t=s)):(p="top",h>a&&(h=a),t>a&&(t=a)),this.isRowTallerThanView(r.getRow(h))&&(t=h,p="top"),this.navigateTo({scrollIndex:t,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,i=!1){this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{let n=this.getNextFocusIndexForAutoHeight(e,i);this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){let i=t?-1:1,n=this.getViewportHeight(),{pageBounds:r,rowModel:o}=this.beans,s=r.getLastRow(),a=0,l=e.rowIndex;for(;l>=0&&l<=s;){let c=o.getRow(l);if(c){let d=c.rowHeight??0;if(a+d>n)break;a+=d}l+=i}return Math.max(0,Math.min(l,s))}getViewportHeight(){let e=this.beans,t=wb(e),i=this.beans.scrollVisibleSvc.getScrollbarWidth(),n=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=i),n}isRowTallerThanView(e){if(!e)return!1;let t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){let i=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),n=this.getNormalisedPosition(i),{rowIndex:r,rowPinned:o,column:s}=n??i,a=s;this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:a,focusIndex:r,focusColumn:a,rowPinned:o})}onHomeOrEndKey(e){let t=e===B.PAGE_HOME,{visibleCols:i,pageBounds:n,rowModel:r}=this.beans,o=i.allCols,s=t?n.getFirstRow():n.getLastRow(),a=r.getRow(s);if(!a)return;let l=(t?o:[...o].reverse()).find(c=>!c.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:s,scrollType:null,scrollColumn:l,focusIndex:s,focusColumn:l})}onTabKeyDown(e,t){let i=t.shiftKey,n=this.tabToNextCellCommon(e,i,t),r=this.beans,{ctrlsSvc:o,pageBounds:s,focusSvc:a,gos:l}=r;if(n!==!1){n?t.preventDefault():n===null&&o.get("gridCtrl").allowFocusForNextCoreContainer(i);return}if(i){let{rowIndex:c,rowPinned:d}=e.getRowPosition();(d?c===0:c===s.getFirstRow())&&(l.get("headerHeight")===0||fa(r)?rc(r,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof Zl&&e.focusCell(!0),(a.focusOverlay(!1)||rc(r,i))&&t.preventDefault()}tabToNextCell(e,t){let i=this.beans,{focusSvc:n,rowRenderer:r}=i,o=n.getFocusedCell();if(!o)return!1;let s=Bl(i,o);return!s&&(s=r.getRowByPosition(o),!s?.isFullWidth())?!1:!!this.tabToNextCellCommon(s,e,t,"api")}tabToNextCellCommon(e,t,i,n="ui"){let{editSvc:r,focusSvc:o}=this.beans,s,a=e instanceof Zl?e:e.getAllCellCtrls()?.[0];return r?.isEditing()?s=r?.moveToNextCell(a,t,i,n):s=this.moveToNextCellNotEditing(e,t,i),s===null?s:s||!!o.focusedHeader}moveToNextCellNotEditing(e,t,i){let n=this.beans.visibleCols.allCols,r;if(e instanceof dm){if(r=T(w({},e.getRowPosition()),{column:t?n[0]:dt(n)}),this.gos.get("embedFullWidthRows")&&i){let s=e.findFullWidthInfoForEvent(i);s&&(r.column=s.column)}}else r=e.getFocusedCellPosition();let o=this.findNextCellToFocusOn(r,{backwards:t,startEditing:!1});if(o===!1)return null;if(o instanceof Zl)o.focusCell(!0);else if(o)return this.tryToFocusFullWidthRow(o,t);return pe(o)}findNextCellToFocusOn(e,{backwards:t,startEditing:i,skipToNextEditableCell:n}){let r=e,o=this.beans,{cellNavigation:s,gos:a,focusSvc:l,rowRenderer:c,rangeSvc:d}=o;for(;;){e!==r&&(e=r),t||(r=this.getLastCellOfColSpan(r)),r=s.getNextTabbedCell(r,t);let u=a.getCallback("tabToNextCell");if(pe(u)){let g=u({backwards:t,editing:i,previousCellPosition:e,nextCellPosition:r||null});if(g===!0)r=e;else{if(g===!1)return!1;r={rowIndex:g.rowIndex,column:g.column,rowPinned:g.rowPinned}}}if(!r)return null;if(r.rowIndex<0){let f=kr(o);return l.focusHeaderPosition({headerPosition:{headerRowIndex:f+r.rowIndex,column:r.column},fromCell:!0}),null}let h=a.get("editType")==="fullRow";if(i&&(!h||n)&&!this.isCellEditable(r))continue;this.ensureCellVisible(r);let p=Bl(o,r);if(!p){let f=c.getRowByPosition(r);if(!f||!f.isFullWidth()||i)continue;return T(w({},f.getRowPosition()),{column:r?.column})}if(!s.isSuppressNavigable(p.column,p.rowNode))return p.setFocusedCellPosition(r),d?.setRangeToCell(r),p}}isCellEditable(e){let t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){let{pinnedRowModel:i,rowModel:n}=this.beans;return t==="top"?i?.getPinnedTopRow(e):t==="bottom"?i?.getPinnedBottomRow(e):n.getRow(e)}navigateToNextCell(e,t,i,n){let r=i,o=!1,s=this.beans,{cellNavigation:a,focusSvc:l,gos:c}=s;for(;r&&(r===i||!this.isValidNavigateCell(r));)c.get("enableRtl")?t===B.LEFT&&(r=this.getLastCellOfColSpan(r)):t===B.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=a.getNextCellToFocus(t,r),o=mt(r);if(o&&e&&e.key===B.UP&&(r={rowIndex:-1,rowPinned:null,column:i.column}),n){let u=c.getCallback("navigateToNextCell");if(pe(u)){let p=u({key:t,previousCellPosition:i,nextCellPosition:r||null,event:e});pe(p)?r={rowPinned:p.rowPinned,rowIndex:p.rowIndex,column:p.column}:r=null}}if(!r)return;if(r.rowIndex<0){let u=kr(s);l.focusHeaderPosition({headerPosition:{headerRowIndex:u+r.rowIndex,column:i.column},event:e||void 0,fromCell:!0});return}let d=this.getNormalisedPosition(r);d?this.focusPosition(d):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);let i=Bl(this.beans,e);return i?(e=i.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){let{visibleCols:i,rowRenderer:n,focusSvc:r,eventSvc:o}=this.beans,s=i.allCols;if(!n.getRowByPosition(e)?.isFullWidth())return!1;let l=r.getFocusedCell(),c={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?dt(s):s[0])};this.focusPosition(c);let d=t??(l!=null&&j$(c,l));return o.dispatchEvent({type:"fullWidthRowFocused",rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,fromBelow:d}),!0}focusPosition(e){let{focusSvc:t,rangeSvc:i}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),i?.setRangeToCell(e)}isValidNavigateCell(e){return!!fo(this.beans,e)}getLastCellOfColSpan(e){let t=Bl(this.beans,e);if(!t)return e;let i=t.getColSpanningList();return i.length===1?e:{rowIndex:e.rowIndex,column:dt(i),rowPinned:e.rowPinned}}ensureCellVisible(e){let t=fF(this.gos),i=this.beans.rowModel.getRow(e.rowIndex),n=t&&i?.sticky,{scrollFeature:r}=this.gridBodyCon;!n&&mt(e.rowPinned)&&r.ensureIndexVisible(e.rowIndex),e.column.isPinned()||r.ensureColumnVisible(e.column)}ensureColumnVisible(e){let t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function wb(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var kZ={moduleName:"KeyboardNavigation",version:fe,beans:[PZ,YQ,dQ],apiFunctions:{getFocusedCell:XQ,clearFocusedCell:JQ,setFocusedCell:QQ,setFocusedHeader:tZ,tabToNextCell:ZQ,tabToPreviousCell:eZ}},_Z=class extends j{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){let{pageBounds:e,pagination:t,rowModel:i}=this.beans;t?t.calculatePages():e.calculateBounds(0,i.getRowCount()-1)}},DZ=class extends j{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){let{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){let{topRowBounds:e,bottomRowBounds:t}=this,i=e?.rowTop??0,n=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:i,pageLastPixel:n}}calculateBounds(e,t){let{rowModel:i}=this.beans,n=i.getRowBounds(e);n&&(n.rowIndex=e),this.topRowBounds=n;let r=i.getRowBounds(t);r&&(r.rowIndex=t),this.bottomRowBounds=r,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){let e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},FZ=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",MZ=class extends j{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){let e=this.getWidth(),t=e>0;for(let i of this.elements)i&&(ot(i,t),Dr(i,e))}},TZ=class extends j{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});let e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){let{gos:e,visibleCols:t,eventSvc:i}=this.beans,n=ni(e,"print"),r=n?0:t.getColsLeftWidth(),o=n?0:t.getDisplayedColumnsRightWidth();r!=this.leftWidth&&(this.leftWidth=r,i.dispatchEvent({type:"leftPinnedWidthChanged"})),o!=this.rightWidth&&(this.rightWidth=o,i.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){let e=this.gridBodyCtrl.eBodyViewport,t=zu(e);if(t<=50)return;let i=this.getPinnedColumnsOverflowingViewport(t-50),n=this.gos.getCallback("processUnpinnedColumns"),{columns:r,hasLockedPinned:o}=i,s=r;!s.length&&!o||(n&&(s=n({columns:s,viewportWidth:t})),s?.length&&(s=s.filter(a=>!lo(a)),this.setColsPinned(s,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new MZ(e,t)}setColsPinned(e,t,i){let{colModel:n,colAnimation:r,visibleCols:o,gos:s}=this.beans;if(!n.cols||!e?.length)return;if(ni(s,"print")){J(37);return}r?.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;let l=[];for(let c of e){if(!c)continue;let d=n.getCol(c);d&&d.getPinned()!==a&&(this.setColPinned(d,a),l.push(d))}l.length&&(o.refresh(i),TF(this.eventSvc,l,i)),r?.finish()}initCol(e){let{pinned:t,initialPinned:i}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,i)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){let{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;let i=e.pinned==="left",n=e.pinned==="right";e.hidden=!0;let r=()=>{let o=i?this.leftWidth:this.rightWidth;if(o==null)return;let s=o==0,a=e.hidden!==s,l=this.gos.get("enableRtl"),c=t.getScrollbarWidth(),u=t.verticalScrollShowing&&(l&&i||!l&&n)?o+c:o;e.comp.setPinnedContainerWidth(`${u}px`),e.comp.setDisplayed(!s),a&&(e.hidden=s,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:r,rightPinnedWidthChanged:r,scrollVisibilityChanged:r,scrollbarWidthChanged:r})}getHeaderResizeDiff(e,t){if(t.getPinned()){let{leftWidth:n,rightWidth:r}=this,o=zu(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(n+r+e>o)if(o>n+r)e=o-n-r;else return 0}return e}getPinnedColumnsOverflowingViewport(e){let t=this.rightWidth??0,i=this.leftWidth??0,n=t+i,r=!1;if(n<e)return{columns:[],hasLockedPinned:r};let{visibleCols:o}=this.beans,s=[...o.leftCols],a=[...o.rightCols],l=0,c=0,d=0,u=[],h=n-d-e;for(;(c<s.length||l<a.length)&&h>0;){if(l<a.length){let p=a[l++];if(p.colDef.lockPinned){r=!0;continue}h-=p.getActualWidth(),u.push(p)}if(c<s.length&&h>0){let p=s[c++];if(p.colDef.lockPinned){r=!0;continue}h-=p.getActualWidth(),u.push(p)}}return{columns:u,hasLockedPinned:r}}},IZ={moduleName:"PinnedColumn",version:fe,beans:[TZ],css:[FZ]},AZ=class extends Ai{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=Yt(this,this.updateAnnouncement.bind(this),200)}postConstruct(){let e=this.beans,t=Kt(e),i=this.descriptionContainer=t.createElement("div");i.classList.add("ag-aria-description-container"),GD(i,"polite"),eW(i,"additions text"),ZG(i,!0),e.eRootDiv.appendChild(i)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;let e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}\u200B`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();let{descriptionContainer:e}=this;e&&(ii(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},OZ=class extends AZ{},LZ={moduleName:"Aria",version:fe,beans:[OZ]},NZ=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",bD="ag-delay-render",BZ=class extends j{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(bD)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;let{renderStatus:t,ctrlsSvc:i}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}i.getGridBodyCtrl().eGridBody.classList.remove(bD),this.alreadyRevealed=!0}},HZ={moduleName:"ColumnDelayRender",version:fe,beans:[BZ],css:[NZ]};function zZ(e){e.overlays?.showLoadingOverlay()}function VZ(e){e.overlays?.showNoRowsOverlay()}function GZ(e){e.overlays?.hideOverlay()}var WZ=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-exporting-wrapper,.ag-overlay-loading-wrapper,.ag-overlay-modal-wrapper{pointer-events:all}.ag-overlay-exporting-center,.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);display:flex;padding:var(--ag-spacing)}",UZ={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},cM=class extends st{constructor(){super(UZ),this.eOverlayWrapper=ae,this.activeOverlay=null,this.activePromise=null,this.activeCssClass=null,this.elToFocusAfter=null,this.overlayExclusive=!1,this.oldWrapperPadding=null,this.registerCSS(WZ)}handleKeyDown(e){if(e.key!==B.TAB||e.defaultPrevented||uo(e))return;let{beans:t,eOverlayWrapper:i}=this;if(i&&xa(t,i,!1,e.shiftKey))return;let r=!1;e.shiftKey?r=t.focusSvc.focusGridView({column:dt(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):r=rc(t,!1),r&&e.preventDefault()}updateLayoutClasses(e,t){let i=this.eOverlayWrapper;if(!i)return;let n=i.classList,{AUTO_HEIGHT:r,NORMAL:o,PRINT:s}=Un;n.toggle(r,t.autoHeight),n.toggle(o,t.normal),n.toggle(s,t.print)}postConstruct(){this.createManagedBean(new Iy(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setWrapperComp(this,!1),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)}),this.addManagedEventListeners({gridSizeChanged:this.refreshWrapperPadding.bind(this)})}setWrapperTypeClass(e){let t=this.eOverlayWrapper?.classList;if(!t){this.activeCssClass=null;return}this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,i){if(this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,this.overlayExclusive=i,!e)return this.refreshWrapperPadding(),wt.resolve();if(this.setWrapperTypeClass(t),this.setDisplayed(!0,{skipAriaHidden:!0}),this.refreshWrapperPadding(),i&&this.isGridFocused()){let n=bt(this.beans);n&&!oy(this.beans)&&(this.elToFocusAfter=n)}return e.then(n=>{let r=this.eOverlayWrapper;if(!r){this.destroyBean(n);return}if(this.activePromise!==e){this.activeOverlay!==n&&(this.destroyBean(n),n=null);return}this.activePromise=null,n&&(this.activeOverlay!==n&&(r.appendChild(n.getGui()),this.activeOverlay=n),i&&this.isGridFocused()&&Ca(r))}),e}refreshWrapperPadding(){if(!this.eOverlayWrapper){this.oldWrapperPadding=null;return}let e=!!this.activeOverlay||!!this.activePromise,t=0;e&&!this.overlayExclusive&&(t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0),t!==this.oldWrapperPadding&&(this.oldWrapperPadding=t,this.eOverlayWrapper.style.setProperty("padding-top",`${t}px`))}destroyActiveOverlay(){this.activePromise=null;let e=this.activeOverlay;if(!e){this.overlayExclusive=!1,this.elToFocusAfter=null,this.refreshWrapperPadding();return}let t=this.elToFocusAfter;this.elToFocusAfter=null,this.activeOverlay=null,this.overlayExclusive=!1,t&&!this.isGridFocused()&&(t=null),this.destroyBean(e);let i=this.eOverlayWrapper;i&&ii(i),t?.focus?.({preventScroll:!0}),this.refreshWrapperPadding()}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){let e=bt(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setWrapperComp(this,!0),super.destroy(),this.eOverlayWrapper=null}},jZ={selector:"AG-OVERLAY-WRAPPER",component:cM},qZ=["refresh"],nh=e=>({name:e,optionalMethods:qZ}),la={id:"agLoadingOverlay",overlayType:"loading",comp:nh("loadingOverlayComponent"),wrapperCls:"ag-overlay-loading-wrapper",exclusive:!0,compKey:"loadingOverlayComponent",paramsKey:"loadingOverlayComponentParams",isSuppressed:e=>{let t=e.get("loading");return t===!1||e.get("suppressLoadingOverlay")===!0&&t!==!0}},Hl={id:"agNoRowsOverlay",overlayType:"noRows",comp:nh("noRowsOverlayComponent"),wrapperCls:"ag-overlay-no-rows-wrapper",compKey:"noRowsOverlayComponent",paramsKey:"noRowsOverlayComponentParams",isSuppressed:e=>e.get("suppressNoRowsOverlay")},Yy={id:"agNoMatchingRowsOverlay",overlayType:"noMatchingRows",comp:nh("noMatchingRowsOverlayComponent"),wrapperCls:"ag-overlay-no-matching-rows-wrapper"},um={id:"agExportingOverlay",overlayType:"exporting",comp:nh("exportingOverlayComponent"),wrapperCls:"ag-overlay-exporting-wrapper",exclusive:!0},Wg={id:"activeOverlay",comp:nh("activeOverlay"),wrapperCls:"ag-overlay-modal-wrapper",exclusive:!0},$Z=e=>e?{agLoadingOverlay:la,agNoRowsOverlay:Hl,agNoMatchingRowsOverlay:Yy,agExportingOverlay:um}[e]??Wg:null,KZ=e=>e?{loading:la,noRows:Hl,noMatchingRows:Yy,exporting:um}[e]:null,YZ=class extends j{constructor(){super(...arguments),this.beanName="overlays",this.eWrapper=void 0,this.exclusive=!1,this.oldExclusive=!1,this.currentDef=null,this.showInitialOverlay=!0,this.userForcedNoRows=!1,this.exportsInProgress=0,this.newColumnsLoadedCleanup=null}postConstruct(){let e=this.gos;this.showInitialOverlay=_t(e);let t=()=>{this.userForcedNoRows||this.updateOverlay(!1)},[i,n,r,o]=this.addManagedEventListeners({newColumnsLoaded:t,rowCountReady:()=>{this.disableInitialOverlay(),t(),n()},rowDataUpdated:t,modelUpdated:t});this.newColumnsLoadedCleanup=i,this.addManagedPropertyListeners(["loading","activeOverlay","activeOverlayParams","overlayComponentParams","loadingOverlayComponentParams","noRowsOverlayComponentParams"],s=>this.onPropChange(new Set(s.changeSet?.properties)))}destroy(){this.doHideOverlay(),super.destroy(),this.eWrapper=void 0}setWrapperComp(e,t){this.isAlive()&&(t?this.eWrapper===e&&(this.eWrapper=void 0):this.eWrapper=e,this.updateOverlay(!1))}isVisible(){return!!this.currentDef}showLoadingOverlay(){this.showInitialOverlay=!1;let e=this.gos;if(!this.eWrapper||e.get("activeOverlay")||this.isDisabled(la))return;let t=e.get("loading");!t&&t!==void 0||this.doShowOverlay(la)}showNoRowsOverlay(){this.showInitialOverlay=!1;let e=this.gos;!this.eWrapper||e.get("activeOverlay")||e.get("loading")||this.isDisabled(Hl)||(this.userForcedNoRows=!0,this.doShowOverlay(Hl))}async showExportOverlay(e){let{gos:t,beans:i}=this;if(!this.eWrapper||t.get("activeOverlay")||t.get("loading")||this.isDisabled(um)||this.userForcedNoRows&&this.currentDef===Hl){e();return}let n=this.getDesiredDefWithOverride(um);if(!n){e();return}this.exportsInProgress++,this.focusedCell=i.focusSvc.getFocusedCell(),await this.doShowOverlay(n),await new Promise(o=>setTimeout(()=>o()));let r=Date.now();try{e()}finally{let o=Date.now()-r,s=Math.max(0,300-o),a=()=>{this.exportsInProgress--,this.exportsInProgress===0&&(this.updateOverlay(!1),Z$(i,this.focusedCell),this.focusedCell=null)};s>0?setTimeout(()=>a(),s):a()}}hideOverlay(){let e=this.gos;this.showInitialOverlay=!1;let t=this.userForcedNoRows;if(this.userForcedNoRows=!1,e.get("loading")){J(99);return}if(e.get("activeOverlay")){J(296);return}if(this.currentDef===Yy){J(297);return}this.doHideOverlay(),t&&this.getOverlayDef()!==Hl&&this.updateOverlay(!1)}getOverlayWrapperSelector(){return jZ}getOverlayWrapperCompClass(){return cM}onPropChange(e){let t=e.has("activeOverlay");if((t||e.has("loading"))&&this.updateOverlay(t))return;let i=this.currentDef,n=this.eWrapper?.activeOverlay;if(n&&i){let r=e.has("activeOverlayParams");if(i===Wg)r&&n.refresh?.(this.makeCompParams(!0));else{let o=i.paramsKey;(e.has("overlayComponentParams")||o&&e.has(o))&&n.refresh?.(this.makeCompParams(!1,o,i.overlayType))}}}updateOverlay(e){let t=this.eWrapper;if(!t)return this.currentDef=null,!1;let i=this.getDesiredDefWithOverride(),n=this.currentDef,r=i===Wg&&e;return i!==n?i?(this.doShowOverlay(i),!0):(this.disableInitialOverlay(),this.doHideOverlay()):r&&i?(t.hideOverlay(),this.doShowOverlay(i),!0):(i||this.disableInitialOverlay(),!1)}getDesiredDefWithOverride(e){let{gos:t}=this,i=$Z(t.get("activeOverlay"));return i||(i=e??this.getOverlayDef(),i&&this.isDisabled(i)&&(i=null)),i}getOverlayDef(){let{gos:e,beans:t}=this,{colModel:i,rowModel:n}=t,r=e.get("loading");if(r!==void 0){if(this.disableInitialOverlay(),r)return la}else if(this.showInitialOverlay){if(!this.isDisabled(la)&&(!e.get("columnDefs")||!i.ready||!e.get("rowData")))return la;this.disableInitialOverlay()}else this.disableInitialOverlay();let s=n.getOverlayType();return KZ(s)}disableInitialOverlay(){this.showInitialOverlay=!1,this.newColumnsLoadedCleanup?.(),this.newColumnsLoadedCleanup=null}doShowOverlay(e){let{gos:t,beans:i}=this,{userCompFactory:n}=i;this.currentDef=e;let r=e!==Wg,o=!!e.exclusive;this.exclusive=o;let s;(e.paramsKey&&t.get(e.paramsKey)||e.compKey&&t.get(e.compKey))&&(s=e.paramsKey);let a;r&&(t.get("overlayComponent")||t.get("overlayComponentSelector"))&&(a=n.getCompDetailsFromGridOptions({name:"overlayComponent",optionalMethods:["refresh"]},void 0,this.makeCompParams(!1,e.paramsKey,e.overlayType))),a??(a=n.getCompDetailsFromGridOptions(e.comp,r?e.id:void 0,this.makeCompParams(!r,s,e.overlayType),!1));let l=a?.newAgStackInstance()??null,c=this.eWrapper?this.eWrapper.showOverlay(l,e.wrapperCls,o):wt.resolve();return this.eWrapper?.refreshWrapperPadding(),this.setExclusive(o),c}makeCompParams(e,t,i){let{gos:n}=this,r=e?n.get("activeOverlayParams"):T(w(w({},n.get("overlayComponentParams")),t&&n.get(t)||null),{overlayType:i});return _e(n,r??{})}doHideOverlay(){let e=!1;this.currentDef&&(this.currentDef=null,e=!0),this.exclusive=!1;let t=this.eWrapper;return t&&(t.hideOverlay(),t.refreshWrapperPadding(),this.setExclusive(!1)),e}setExclusive(e){this.oldExclusive!==e&&(this.oldExclusive=e,this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"}))}isDisabled(e){let{gos:t}=this;return e.overlayType&&t.get("suppressOverlays")?.includes(e.overlayType)||e.isSuppressed?.(t)===!0}},XZ={moduleName:"Overlay",version:fe,userComponents:{agLoadingOverlay:wK,agNoRowsOverlay:xK,agNoMatchingRowsOverlay:RK,agExportingOverlay:yK},apiFunctions:{showLoadingOverlay:zZ,showNoRowsOverlay:VZ,hideOverlay:GZ},icons:{overlayLoading:"loading",overlayExporting:"loading"},beans:[YZ]},JZ=class extends j{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=xj(),as(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;let e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;as(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){let t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;let t=this.modelHeight-this.getUiBodyHeight(),i=e/t;return this.maxScrollY*i}},QZ=400,ZZ=class extends j{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{let e=()=>{for(let o of this.getAllCellCtrls())o.onCellSelectionChanged()},t=()=>{for(let o of this.getAllCellCtrls())o.updateRangeBordersIfRangeCount()},i=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},n=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>n()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{ho(this.gos)?i():n()}),ho(this.gos)&&i()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",n=>this.onSuppressCellFocusChanged(n.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:n,previousValue:r})=>{(!r&&n||r&&!n)&&this.redrawRows()});let{stickyRowSvc:e,gos:t,showRowGroupCols:i}=this.beans;if(i&&this.addManagedPropertyListener("showOpenedGroup",()=>{let n=i.columns;n.length&&this.refreshCells({columns:n,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{let n=this.gridBodyCtrl;n.setStickyTopHeight(0),n.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=ni(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){let e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new eee(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){let e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),i=this.cachedRowCtrls?.getEntries()??[];t.length>0||i.length>0?this.allRowCtrls=[...e,...t,...i]:this.allRowCtrls=e}isCellBeingRendered(e,t){let i=this.rowCtrlsByRowIndex[e];return!t||!i?!!i:i.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!i.getCellCtrl(t)||!i.isRowRendered()}updateCellFocus(e){for(let t of this.getAllCellCtrls())t.onCellFocused(e);for(let t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){if(e?.rowIndex!=null&&!e.rowPinned){let t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(let t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(let t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{let{cellFlashSvc:t}=this.beans;if(t)for(let i of this.getAllCellCtrls())t.onFlashCells(i,e)},columnHoverChanged:()=>{for(let e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(let e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(let e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(let e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();let e=this.colModel.getCols();for(let t of e){let i=l=>{for(let c of this.getAllCellCtrls())c.column===t&&l(c)},n=()=>{i(l=>l.onLeftChanged())},r=()=>{i(l=>l.onWidthChanged())},o=()=>{i(l=>l.onFirstRightPinnedChanged())},s=()=>{i(l=>l.onLastLeftPinnedChanged())},a=()=>{i(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",n),t.__addEventListener("widthChanged",r),t.__addEventListener("firstRightPinnedChanged",o),t.__addEventListener("lastLeftPinnedChanged",s),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",n),t.__removeEventListener("widthChanged",r),t.__removeEventListener("firstRightPinnedChanged",o),t.__removeEventListener("lastLeftPinnedChanged",s),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){let e=ni(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;let e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){let t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){let t=[];for(let i of this.getAllRowCtrls()){let n=i.getCellCtrl(e,!0)?.eGui;n&&t.push(n)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,i){let{pinnedRowModel:n,beans:r,printLayout:o}=this,s=Object.fromEntries(e.map(l=>[l.rowNode.id,l]));n?.forEachPinnedRow(t,(l,c)=>{let d=e[c];d&&n.getPinnedRowById(d.rowNode.id,t)===void 0&&(d.destroyFirstPass(),d.destroySecondPass()),l.id in s&&i?(e[c]=s[l.id],delete s[l.id]):e[c]=new dm(l,r,!1,!1,o)});let a=(t==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;e.length=a}onPinnedRowDataChanged(){let e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{let i=n=>{let r=n[e.rowIndex];r&&r.rowNode===e&&(r.destroyFirstPass(),r.destroySecondPass(),n[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){let{editSvc:t}=this.beans;if(t?.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(let n of e??[])this.redrawRow(n,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();let t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);let i=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&Ul(this.gos),r=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();let{stickyRowFeature:o,gos:s}=this;if(o){o.checkStickyRows();let a=o.extraTopHeight+o.extraBottomHeight;a&&this.updateContainerHeights(a)}this.recycleRows(r,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(s.get("enableRowPinning")?i:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){let t=e.newData||e.newPage,i=this.gos.get("suppressScrollOnNewData");t&&!i&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){let{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let i=this.pageBounds.getCurrentPageHeight();i===0&&(i=1),t.setModelHeight(i+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(Fr(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;let t=this.beans.focusSvc,i=this.findPositionToFocus(e);if(!i){t.focusHeaderPosition({headerPosition:{headerRowIndex:kr(this.beans)-1,column:e.column}});return}if(e.rowIndex!==i.rowIndex||e.rowPinned!=i.rowPinned){t.setFocusedCell(T(w({},i),{preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0}));return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(_e(this.gos,T(w({},i),{forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"})))}findPositionToFocus(e){let{pagination:t,pageBounds:i}=this.beans,n=e;for(n.rowPinned==null&&t&&i&&!t.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:i.getFirstRow()});n;){if(n.rowPinned==null&&i)if(n.rowIndex<i.getFirstRow()){if(n=am(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>i.getLastRow()&&(n={rowPinned:null,rowIndex:i.getLastRow()});let r=this.getRowByPosition(n);if(r?.isAlive())return T(w({},r.getRowPosition()),{column:e.column});n=am(this.beans,n)}return null}getAllCellCtrls(){let e=[],t=this.getAllRowCtrls(),i=t.length;for(let n=0;n<i;n++){let r=t[n].getAllCellCtrls(),o=r.length;for(let s=0;s<o;s++)e.push(r[s])}return e}getAllRowCtrls(){let{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),i=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...i,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,i){let n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,i)}refreshCells({rowNodes:e,columns:t,force:i,suppressFlash:n}={}){let r={force:i,newData:!1,suppressFlash:n};for(let o of this.getCellCtrls(e,t))o.refreshOrDestroyCell(r);this.refreshFullWidth(e)}refreshRows(e={}){for(let t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(let i of this.getRowCtrls(e)){if(!i.isFullWidth())continue;i.refreshFullWidth()||(t=!0,this.redrawRow(i.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){let t=Zb(e),i=this.getAllRowCtrls();return!e||!t?i:i.filter(n=>{let r=n.rowNode;return ey(r,t)})}getCellCtrls(e,t){let i;pe(t)&&(i={},t.forEach(r=>{let o=this.colModel.getCol(r);pe(o)&&(i[o.getId()]=!0)}));let n=[];for(let r of this.getRowCtrls(e))for(let o of r.getAllCellCtrls()){let s=o.column.getId();i&&!i[s]||n.push(o)}return n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){let t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){let e=[];for(let i of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[i].rowNode.id==null&&e.push(i);this.removeRowCtrls(e);let t={};for(let i of Object.values(this.rowCtrlsByRowIndex)){let n=i.rowNode;t[n.id]=i}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(let i of e){let n=this.rowCtrlsByRowIndex[i];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[i]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){let{focusSvc:t,animationFrameSvc:i}=this.beans,{afterScroll:n}=e,r,o=this.stickyRowFeature;o&&(r=t?.getFocusCellToUseAfterRefresh()||void 0);let s=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(o){l=o.checkStickyRows();let d=o.extraTopHeight+o.extraBottomHeight;d&&this.updateContainerHeights(d)}let c=this.firstRenderedRow!==s||this.lastRenderedRow!==a;if(!(n&&!l&&!c)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!l),r!=null)){let d=t?.getFocusCellToUseAfterRefresh();r!=null&&d==null&&(i?.flushAllFrames(),this.restoreFocusedCell(r))}}removeRowCompsNotToDraw(e,t){let i={};for(let o of e)i[o]=!0;let r=Object.keys(this.rowCtrlsByRowIndex).filter(o=>!i[o]);this.removeRowCtrls(r,t)}calculateIndexesToDraw(e){let t=[];for(let s=this.firstRenderedRow;s<=this.lastRenderedRow;s++)t.push(s);let i=this.beans.pagination,n=this.beans.focusSvc?.getFocusedCell()?.rowIndex;n!=null&&(n<this.firstRenderedRow||n>this.lastRenderedRow)&&(!i||i.isRowInPage(n))&&n<this.rowModel.getRowCount()&&t.push(n);let r=s=>{let a=s.rowNode.rowIndex;a==null||a===n||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(s)&&t.push(a)};for(let s of Object.values(this.rowCtrlsByRowIndex))r(s);if(e)for(let s of Object.values(e))r(s);t.sort((s,a)=>s-a);let o=[];for(let s=0;s<t.length;s++){let a=t[s],l=this.rowModel.getRow(a);l&&!l.sticky&&o.push(a)}return o}recycleRows(e,t=!1,i=!1){let n=this.calculateIndexesToDraw(e);(this.printLayout||i)&&(t=!1),this.removeRowCompsNotToDraw(n,!t);for(let r of n)this.createOrUpdateRowCtrl(r,e,t,i);if(e){let{animationFrameSvc:r}=this.beans;r?.active&&i&&!this.printLayout?r.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){let{visibleCols:e}=this.beans,t=e.isPinningLeft(),i=e.isPinningRight();(this.pinningLeft!==t||i!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=i,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){let e=[];for(let t of this.getFullWidthRowCtrls()){let i=t.rowNode.rowIndex;e.push(i.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){let t=Zb(e);return this.getAllRowCtrls().filter(i=>{if(!i.isFullWidth())return!1;let n=i.rowNode;return!(t!=null&&!ey(n,t))})}createOrUpdateRowCtrl(e,t,i,n){let r,o=this.rowCtrlsByRowIndex[e];if(o||(r=this.rowModel.getRow(e),pe(r)&&pe(t)&&t[r.id]&&r.alreadyRendered&&(o=t[r.id],t[r.id]=null)),!o)if(r||(r=this.rowModel.getRow(e)),pe(r))o=this.createRowCon(r,i,n);else return;r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=o}destroyRowCtrls(e,t){let i=[];if(e){for(let n of Object.values(e))if(n){if(this.cachedRowCtrls&&n.isCacheable()){this.cachedRowCtrls.addRow(n);continue}if(n.destroyFirstPass(!t),t){let r=n.instanceId;this.zombieRowCtrls[r]=n,i.push(()=>{n.destroySecondPass(),delete this.zombieRowCtrls[r]})}else n.destroySecondPass()}}t&&(i.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(let n of i)n()},QZ))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){let e=this.getRowBuffer(),t=ha(this.beans);return e*t}workOutFirstAndLastRowsToRender(){let{rowContainerHeight:e,pageBounds:t,rowModel:i}=this;e.updateOffset();let n,r;if(!i.isRowsToRender())n=0,r=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=t.getFirstRow(),r=t.getLastRow();else{let d=this.getRowBufferInPixels(),u=this.ctrlsSvc.getScrollFeature(),h=this.gos.get("suppressRowVirtualisation"),p=!1,f,g;do{let S=t.getPixelOffset(),{pageFirstPixel:E,pageLastPixel:x}=t.getCurrentPagePixelRange(),P=e.divStretchOffset,F=u.getVScrollPosition(),N=F.top,Y=F.bottom;h?(f=E+P,g=x+P):(f=Math.max(N+S-d,E)+P,g=Math.min(Y+S+d,x)+P),this.firstVisibleVPixel=Math.max(N+S,E)+P,this.lastVisibleVPixel=Math.min(Y+S,x)+P,p=this.ensureAllRowsInRangeHaveHeightsCalculated(f,g)}while(p);let m=i.getRowIndexAtPixel(f),v=i.getRowIndexAtPixel(g),C=t.getFirstRow(),b=t.getLastRow();m<C&&(m=C),v>b&&(v=b),n=m,r=v}let o=ni(this.gos,"normal"),s=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);o&&!s&&r-n>a&&(r=n+a);let l=n!==this.firstRenderedRow,c=r!==this.lastRenderedRow;(l||c)&&(this.firstRenderedRow=n,this.lastRenderedRow=r,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:r}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,go(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){let i=this.pinnedRowModel?.ensureRowHeightsValid(),n=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:r,rowModel:o}=this,s=o.ensureRowHeightsValid(e,t,r.getFirstRow(),r.getLastRow());return(s||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),n||s||i?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){let n=e.rowNode,r=this.focusSvc.isRowFocused(n.rowIndex,n.rowPinned),o=this.editSvc?.isEditing(e),s=n.detail;return r||o||s?!!this.isRowPresent(n):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,i){let n=this.cachedRowCtrls?.getRow(e)??null;if(n)return n;let r=i&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new dm(e,this.beans,t,r,this.printLayout)}getRenderedNodes(){let e=Object.values(this.rowCtrlsByRowIndex).map(n=>n.rowNode),t=this.getStickyTopRowCtrls().map(n=>n.rowNode),i=this.getStickyBottomRowCtrls().map(n=>n.rowNode);return[...t,...e,...i]}getRowByPosition(e){let t,{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find(n=>n.rowNode.rowIndex===i)||null,t||(t=this.getStickyBottomRowCtrls().find(n=>n.rowNode.rowIndex===i)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;let n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},eee=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){let t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e?.id==null)return null;let t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){let t=e.id,i=this.entriesMap[t];delete this.entriesMap[t],Mr(this.entriesList,i)}removeFromCache(e){let t=e.rowNode.id;delete this.entriesMap[t],Mr(this.entriesList,e)}getEntries(){return this.entriesList}};function Zb(e){if(!e)return;let t={top:{},bottom:{},normal:{}};for(let i of e){let n=i.id;switch(i.rowPinned){case"top":t.top[n]=i;break;case"bottom":t.bottom[n]=i;break;default:t.normal[n]=i;break}}return t}function ey(e,t){let i=e.id;switch(e.rowPinned){case"top":return t.top[i]!=null;case"bottom":return t.bottom[i]!=null;default:return t.normal[i]!=null}}var tee=class extends j{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){let{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=Er(e),this.firstLeaf=_t(e)?lm:iee,this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=Er(e))}doFullSort(e,t){let i=e.map((n,r)=>({currentPos:r,rowNode:n}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(n=>n.rowNode)}compareRowNodes(e,t,i){let n=t.rowNode,r=i.rowNode;for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.sort==="desc",c=this.getValue(n,a.column),d=this.getValue(r,a.column),u,h=this.getComparator(a,n);if(h)u=h(c,d,n,r,l);else{let f={accentedCompare:this.isAccentedSort};a.type==="absolute"&&(f.transform=nee),u=qG(c,d,f)}if(!isNaN(u)&&u!==0)return a.sort==="asc"?u:u*-1}return t.currentPos-i.currentPos}getComparator(e,t){let i=e.column.getColDef(),n=this.getComparatorFromColDef(i,e);if(n)return n;if(!i.showRowGroup)return;let r=!t.group&&i.field;if(!r)return;let o=this.beans.colModel.getColDefCol(r);if(o)return this.getComparatorFromColDef(o.getColDef(),e)}getComparatorFromColDef(e,t){let i=e.comparator;if(i!=null)return typeof i=="object"?i[po(t.type)]:i}getValue(e,t){if(this.primaryColumnsSortGroups&&e.rowGroupColumn===t)return this.getGroupDataValue(e,t);if(e.group&&t.getColDef().showRowGroup)return;let{valueSvc:i,formula:n}=this.beans,r=i.getValue(t,e,!1);return t.isAllowFormula()&&n?.isFormula(r)?n.resolveValue(t,e):r}getGroupDataValue(e,t){let{gos:i,valueSvc:n,colModel:r,showRowGroupCols:o}=this.beans;if(mF(i,r.isPivotActive())){let l=this.firstLeaf(e);return l&&n.getValue(t,l,!1)}let a=o?.getShowRowGroupCol(t.getId());if(a)return e.groupData?.[a.getId()]}},iee=e=>{if(e.data)return e;let t=e.childrenAfterGroup;for(;t?.length;){let i=t[0];if(i.data)return i;t=i.childrenAfterGroup}};function nee(e){if(!e)return e;let t=Number(e);return isNaN(t)?e:Math.abs(t)}function ree(e){e.sortSvc?.onSortChanged("api")}var sa=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),oee={tag:"span",cls:"ag-sort-indicator-container",children:[sa("Order","order"),sa("Asc","ascending-icon"),sa("Desc","descending-icon"),sa("Mixed","mixed-icon"),sa("AbsoluteAsc","absolute-ascending-icon"),sa("AbsoluteDesc","absolute-descending-icon"),sa("None","none-icon")]},Xy=class extends st{constructor(e){super(),this.eSortOrder=ae,this.eSortAsc=ae,this.eSortDesc=ae,this.eSortMixed=ae,this.eSortNone=ae,this.eSortAbsoluteAsc=ae,this.eSortAbsoluteDesc=ae,e||this.setTemplate(oee)}attachCustomElements(e,t,i,n,r,o,s){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=n,this.eSortNone=r,this.eSortAbsoluteAsc=o,this.eSortAbsoluteDesc=s}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addInIcon("sortAbsoluteAscending",this.eSortAbsoluteAsc,e),this.addInIcon("sortAbsoluteDescending",this.eSortAbsoluteDesc,e);let i=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",i),this.addManagedEventListeners({newColumnsLoaded:i,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(e,t,i){if(t==null)return;let n=ji(e,this.beans,i);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){let{eSortAsc:e,eSortDesc:t,eSortAbsoluteAsc:i,eSortAbsoluteDesc:n,eSortNone:r,column:o,gos:s,beans:a}=this,l=a.sortSvc.getDisplaySortForColumn(o),c=po(l?.type),d=Cm(l?.direction),u=o.getAvailableSortTypes(),h=u.has("default"),p=u.has("absolute"),f=c==="absolute",g=c==="default",m=d==="asc",v=d==="desc";if(e&&ot(e,m&&g&&h,{skipAriaHidden:!0}),t&&ot(t,v&&g&&h,{skipAriaHidden:!0}),r){let C=!o.getColDef().unSortIcon&&!s.get("unSortIcon");ot(r,!C&&!d,{skipAriaHidden:!0})}i&&ot(i,m&&f&&p,{skipAriaHidden:!0}),n&&ot(n,v&&f&&p,{skipAriaHidden:!0})}setupMultiSortIndicator(){let{eSortMixed:e,column:t,gos:i}=this;this.addInIcon("sortUnSort",e,t);let n=t.getColDef().showRowGroup;Er(i)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){let{eSortMixed:e,beans:t,column:i}=this;if(e){let n=t.sortSvc.getDisplaySortForColumn(i)?.direction==="mixed";ot(e,n,{skipAriaHidden:!0})}}updateSortOrder(){let{eSortOrder:e,column:t,beans:{sortSvc:i}}=this;if(!e)return;let n=i.getColumnsWithSortingOrdered(),r=i.getDisplaySortIndexForColumn(t)??-1,o=n.some(a=>i.getDisplaySortIndexForColumn(a)??!1),s=r>=0&&o;ot(e,s,{skipAriaHidden:!0}),r>=0?e.textContent=(r+1).toString():ii(e)}},see={selector:"AG-SORT-INDICATOR",component:Xy},aee=class extends j{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,i){let n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,i)}progressSortFromEvent(e,t){let n=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,n,"uiColumnSorted")}setSortForColumn(e,t,i,n){let{gos:r,showRowGroupCols:o}=this.beans,s=Er(r),a=[e];if(s&&e.getColDef().showRowGroup){let u=o?.getSourceColumnsForGroupColumn?.(e)?.filter(h=>h.isSortable());u&&(a=[e,...u])}for(let d of a)this.setColSort(d,t,n);let l=(i||r.get("alwaysMultiSort"))&&!r.get("suppressMultiSort"),c=[];if(!l){let d=this.clearSortBarTheseColumns(a,n);c.push(...d)}this.updateSortIndex(e),c.push(...a),this.dispatchSortChangedEvents(n,c)}updateSortIndex(e){let{gos:t,colModel:i,showRowGroupCols:n}=this.beans,r=Er(t),o=n?.getShowRowGroupCol(e.getId()),s=r&&o||e,a=this.getColumnsWithSortingOrdered();i.forAllCols(d=>this.setColSortIndex(d,null));let l=a.filter(d=>r&&d.getColDef().showRowGroup?!1:d!==s);(s.getSortDef()?[...l,s]:l).forEach((d,u)=>this.setColSortIndex(d,u))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{if(t.getSortDef())return e=!0,!0}),e}dispatchSortChangedEvents(e,t){let i={type:"sortChanged",source:e};t&&(i.columns=t),this.eventSvc.dispatchEvent(i)}clearSortBarTheseColumns(e,t){let i=[];return this.beans.colModel.forAllCols(n=>{e.includes(n)||(n.getSortDef()&&i.push(n),this.setColSort(n,void 0,t))}),i}getNextSortDirection(e){let t=e.getSortingOrder(),i=e.getSortDef(),r=t.findIndex(o=>Ag(o,i))+1;return r>=t.length&&(r=0),jn(t[r])}getIndexedSortMap(){let{gos:e,colModel:t,showRowGroupCols:i,rowGroupColsSvc:n}=this.beans,r=[];if(t.forAllCols(c=>{c.getSortDef()&&r.push(c)}),t.isPivotMode()){let c=Er(e);r=r.filter(d=>{let u=!!d.getAggFunc(),h=!d.isPrimary(),p=c?i?.getShowRowGroupCol(d.getId()):d.getColDef().showRowGroup;return u||h||p})}let o=n?.columns.filter(c=>!!c.getSortDef())??[],s={};r.forEach((c,d)=>s[c.getId()]=d),r.sort((c,d)=>{let u=c.getSortIndex(),h=d.getSortIndex();if(u!=null&&h!=null)return u-h;if(u==null&&h==null){let p=s[c.getId()],f=s[d.getId()];return p>f?1:-1}else return h==null?-1:1});let a=Er(e)&&!!o.length;a&&(r=[...new Set(r.map(c=>i?.getShowRowGroupCol(c.getId())??c))]);let l=new Map;if(r.forEach((c,d)=>l.set(c,d)),a)for(let c of o){let d=i.getShowRowGroupCol(c.getId());l.set(c,l.get(d))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}collectSortItems(e=!1){let t=[],i=this.getColumnsWithSortingOrdered();for(let n of i){let r=n.getSortDef()?.direction;if(!r)continue;let o=po(n.getSortDef()?.type),s={sort:r,type:o};e?s.colId=n.getId():s.column=n,t.push(s)}return t}getSortModel(){return this.collectSortItems(!0)}getSortOptions(){return this.collectSortItems()}canColumnDisplayMixedSort(e){let t=Er(this.gos),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){let t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSortDef();let n=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,r=n[0].getSortDef();return n.every(s=>Ag(s.getSortDef(),r))?r:{type:po(e.getSortDef()?.type),direction:"mixed"}}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t){let i=()=>{let{type:n,direction:r}=jn(t.getSortDef());if(e.toggleCss("ag-header-cell-sorted-asc",r==="asc"),e.toggleCss("ag-header-cell-sorted-desc",r==="desc"),e.toggleCss("ag-header-cell-sorted-abs-asc",n==="absolute"&&r==="asc"),e.toggleCss("ag-header-cell-sorted-abs-desc",n==="absolute"&&r==="desc"),e.toggleCss("ag-header-cell-sorted-none",!r),t.getColDef().showRowGroup){let a=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(l=>r==l.getSortDef()?.direction);e.toggleCss("ag-header-cell-sorted-mixed",a)}};e.addManagedEventListeners({sortChanged:i,columnRowGroupChanged:i})}initCol(e){let{sortIndex:t,initialSortIndex:i}=e.colDef,n=PF(e.colDef);n&&e.setSortDef(n,!0),t!==void 0?t!==null&&(e.sortIndex=t):i!==null&&(e.sortIndex=i)}updateColSort(e,t,i){t!==void 0&&this.setColSort(e,jn(t),i)}setColSort(e,t,i){Ag(e.getSortDef(),t)||(e.setSortDef(jn(t),t===void 0),e.dispatchColEvent("sortChanged",i)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new Xy(e)}getSortIndicatorSelector(){return see}},dM={moduleName:"Sort",version:fe,beans:[aee,tee],apiFunctions:{onSortChanged:ree},userComponents:{agSortIndicator:Xy},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",sortAbsoluteAscending:"aasc",sortAbsoluteDescending:"adesc"}},lee=class extends j{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{let e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){let{colModel:t,rowModel:i}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),i.start()}gridReady(){let{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),as(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){let t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,Kl(e.source))}}};function cee(e){e.valueCache?.expire()}function dee(e,t){let{colKey:i,rowNode:n,useFormatter:r}=t,o=e.colModel.getColDefCol(i)??e.colModel.getCol(i);if(mt(o))return null;let s=e.valueSvc.getValueForDisplay({column:o,node:n,includeValueFormatted:r});return r?s.valueFormatted??ac(s.value):s.value}var uee="paste",hee=class extends j{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){let{gos:e,rowModel:t}=this.beans;_t(e,t)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){let{gos:t,rowRenderer:i}=this.beans;if(e.source===uee||t.get("suppressChangeDetection"))return;let n=e.node,r=[n],o=this.clientSideRowModel,s=o?.rootNode;if(s&&!n.isRowPinned()){let a=t.get("aggregateOnlyChangedColumns"),l=new Ku(a,s);l.addParentNode(n.parent,[e.column]),o.doAggregate(l),l.forEachChangedNodeDepthFirst(c=>{r.push(c),c.sibling&&r.push(c.sibling)})}i.refreshCells({rowNodes:r})}},pee=class extends j{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);Ze(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(i){return Ze(16,{expression:e,params:t,e:i}),null}}createExpressionFunction(e){let t=this.cache;if(t[e])return t[e];let i=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",i);return t[e]=n,n}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},fee=class extends j{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){let e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){if(this.active){let n=this.cacheVersion;e.__cacheVersion!==n&&(e.__cacheVersion=n,e.__cacheData={}),e.__cacheData[t]=i}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},gee={moduleName:"ValueCache",version:fe,beans:[fee],apiFunctions:{expireValueCache:cee}},mee={moduleName:"Expression",version:fe,beans:[pee]},vee={moduleName:"ChangeDetection",version:fe,beans:[hee]},Cee={moduleName:"CellApi",version:fe,apiFunctions:{getCellValue:dee}},wee=class extends j{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc,this.formulaDataSvc=e.formulaDataSvc}postConstruct(){this.initialised||this.init()}init(){let{gos:e,valueCache:t}=this;this.executeValueGetter=t?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=Ju(e),this.cellExpressions=e.get("enableCellExpressions"),this.isTreeData=e.get("treeData"),this.initialised=!0;let i=n=>this.callColumnCellValueChangedHandler(n);this.eventSvc.addListener("cellValueChanged",i,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",i,!0)),this.addManagedPropertyListener("treeData",n=>this.isTreeData=n.currentValue)}getValueForDisplay(e){let{column:t,node:i,includeValueFormatted:n,useRawFormula:r,exporting:o,source:s="ui"}=e,{showRowGroupColValueSvc:a}=this.beans,l=!t&&i.group,c=t?.colDef.showRowGroup,d=!this.isTreeData||i.footer;if(a&&d&&(l||c)){let b=a.getGroupValue(i,t);if(b==null)return{value:null,valueFormatted:null};if(!n)return{value:b.value,valueFormatted:null};let S=a.formatAndPrefixGroupColValue(b,t,o);return{value:b.value,valueFormatted:S}}if(!t)return{value:i.key,valueFormatted:null};let u=i.leafGroup&&this.colModel.isPivotMode(),h=i.group&&i.expanded&&!i.footer&&!u,p=this.gos.get("groupSuppressBlankHeader")||!i.sibling,f=h&&!p,g=this.getValue(t,i,f,s),m=g,{formula:v}=this.beans,C=n&&!(o&&t.colDef.useValueFormatterForExport===!1);return t.isAllowFormula()&&v?.isFormula(g)&&(r?(g=v.normaliseFormula(g,!0),m=v.resolveValue(t,i)):(g=v.resolveValue(t,i),m=g)),{value:g,valueFormatted:C?this.formatValue(t,i,m):null}}getValue(e,t,i=!1,n="ui"){if(this.initialised||this.init(),!t)return;if(this.hasEditSvc&&n==="ui"){let a=this.editSvc;if(a.isEditing()){let l=a.getCellDataValue({rowNode:t,column:e},!0);if(l!==void 0)return l}}let o=e.getColDef().showRowGroup;if(typeof o=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(o)??-1)>t.level)return null;let s=this.resolveValue(e,t,i);if(this.cellExpressions&&g_(s)){let a=s.substring(1);s=this.executeValueGetter(a,t.data,e,t)}return s}getFormulaFromDataSource(e,t){let i=this.formulaDataSvc;if(!i?.hasDataSource()||!e.isAllowFormula())return;let n=i.getFormula({column:e,rowNode:t});return g_(n)?n:void 0}resolveValue(e,t,i){let n=e.getColDef(),r=e.getColId(),o=this.isTreeData,s=this.getFormulaFromDataSource(e,t);if(s!==void 0)return s;let a=!i&&t.aggData&&t.aggData[r]!==void 0;if(o&&a)return t.aggData[r];let l=t.data,c=n.field;if(o&&n.valueGetter)return this.executeValueGetter(n.valueGetter,l,e,t);if(o&&c&&l)return Au(l,c,e.isFieldContainsDots());let d=t.groupData;if(d&&r in d)return t.groupData[r];if(a)return t.aggData[r];let h=n.showRowGroup,p=typeof h!="string"||!t.group,f=this.isSsrm&&i&&!!n.aggFunc,g=this.isSsrm&&t.footer&&t.field&&(h===!0||h===t.field);if(n.valueGetter&&!f)return p?this.executeValueGetter(n.valueGetter,l,e,t):void 0;if(g)return Au(l,t.field,e.isFieldContainsDots());if(c&&l&&!f)return p?Au(l,c,e.isFieldContainsDots()):void 0}parseValue(e,t,i,n){let r=e.getColDef();if(r.allowFormula&&this.beans.formula?.isFormula(i))return i;let o=r.valueParser;if(pe(o)){let s=_e(this.gos,{node:t,data:t?.data,oldValue:n,newValue:i,colDef:r,column:e});return typeof o=="function"?o(s):this.expressionSvc?.evaluate(o,s)}return i}getDeleteValue(e,t){return pe(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay({column:e,node:t}).value)??null:null}formatValue(e,t,i,n,r=!0){let{expressionSvc:o}=this.beans,s=null,a,l=e.getColDef();if(n?a=n:r&&(a=l.valueFormatter),a){let c=t?t.data:null,d=_e(this.gos,{value:i,node:t,data:c,colDef:l,column:e});typeof a=="function"?s=a(d):s=o?o.evaluate(a,d):null}else if(l.refData)return l.refData[i]||"";return s==null&&Array.isArray(i)&&(s=i.join(", ")),s}setValue(e,t,i,n){let r=this.colModel.getColDefCol(t);if(!e||!r)return!1;this.ensureRowData(e);let o=r.getColDef();if(!this.isSetValueSupported({column:r,newValue:i,colDef:o}))return!1;let s=_e(this.gos,{node:e,data:e.data,oldValue:this.getValue(r,e,void 0,n),newValue:i,colDef:o,column:r});s.newValue=i;let a=this.handleExternalFormulaChange({column:r,eventSource:n,newValue:i,setterParams:s,rowNode:e});if(a!==null)return a;let l=this.computeValueChange({column:r,newValue:i,params:s,rowData:e.data,valueSetter:o.valueSetter,field:o.field});return l===void 0&&(l=!0),l?this.finishValueChange(e,r,s,n):!1}finishValueChange(e,t,i,n){e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();let r=this.getValue(t,e);return this.dispatchCellValueChangedEvent(e,i,r,n),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,i,r,n),!0}ensureRowData(e){mt(e.data)&&(e.data={})}isSetValueSupported(e){let{column:t,newValue:i,colDef:n}=e,{field:r,valueSetter:o}=n,s=this.beans.formula,a=t.isAllowFormula()&&s?.isFormula(i),l=!!this.formulaDataSvc?.hasDataSource();return mt(r)&&mt(o)&&!(l&&a)?(J(17),!1):this.dataTypeSvc&&!this.dataTypeSvc.checkType(t,i)?(J(135),!1):!0}handleExternalFormulaChange(e){let{column:t,rowNode:i,newValue:n,eventSource:r,setterParams:o}=e,s=this.beans.formula,a=this.formulaDataSvc;if(!a?.hasDataSource()||!t.isAllowFormula())return null;let l=s?.isFormula(n),c=a.getFormula({column:t,rowNode:i});if(l){if(!(c!==n))return!1;a.setFormula({column:t,rowNode:i,formula:n});let u=s?.resolveValue(t,i),h=t.getColDef();if(pe(h.valueSetter)||!mt(h.field)){let p=T(w({},o),{newValue:u});this.computeValueChange({column:t,newValue:u,params:p,rowData:i.data,valueSetter:h.valueSetter,field:h.field})}return this.finishValueChange(i,t,o,r)}return c!==void 0&&a.setFormula({column:t,rowNode:i,formula:void 0}),null}computeValueChange(e){let{valueSetter:t,params:i,rowData:n,field:r,column:o,newValue:s}=e;return pe(t)?typeof t=="function"?t(i):this.expressionSvc?.evaluate(t,i):this.setValueUsingField(n,r,s,o.isFieldContainsDots())}dispatchCellValueChangedEvent(e,t,i,n){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:i,value:i,source:n})}callColumnCellValueChangedHandler(e){let t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,i,n){if(!t)return!1;let r=!1;if(!n)r=e[t]===i,r||(e[t]=i);else{let o=t.split("."),s=e;for(;o.length>0&&s;){let a=o.shift();o.length===0?(r=s[a]===i,r||(s[a]=i)):s=s[a]}}return!r}executeValueGetterWithValueCache(e,t,i,n){let r=i.getColId(),o=this.valueCache.getValue(n,r);if(o!==void 0)return o;let s=this.executeValueGetterWithoutValueCache(e,t,i,n);return this.valueCache.setValue(n,r,s),s}executeValueGetterWithoutValueCache(e,t,i,n){let r=_e(this.gos,{data:t,node:n,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,n)}),o;return typeof e=="function"?o=e(r):o=this.expressionSvc?.evaluate(e,r),o}getValueCallback(e,t){let i=this.colModel.getColDefCol(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){let i=this.getValue(e,t),n=e.getColDef().keyCreator,r=i;if(n){let o=_e(this.gos,{value:i,colDef:e.getColDef(),column:e,node:t,data:t.data});r=n(o)}return typeof r=="string"||r==null||(r=String(r),r==="[object Object]"&&J(121)),r}},bee={moduleName:"CommunityCore",version:fe,beans:[gQ,mY,yJ,VU,JZ,IX,cQ,OQ,NU,DZ,_Z,ZZ,wee,pQ,lQ,fQ,xJ,lee,mJ,vJ,qQ],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:vY,destroy:CY,isDestroyed:wY,getGridOption:bY,setGridOption:yY,updateGridOptions:O8,isModuleRegistered:SY},dependsOn:[pJ,uX,CX,dM,GQ,OX,WQ,XZ,vee,jQ,kZ,IZ,LZ,KQ,bJ,fJ,mee,HX,HZ]},uM={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1,Formula:1},bb=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],yee={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:bb,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...bb,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...bb,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},See={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function xee(e,t){let i=[];for(let n of Array.isArray(e)?e:[e]){let r=yee[n];if(r)for(let o of r){let s=See[o];(!s||s===t)&&i.push(o)}else i.push(n)}return i}var hM=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,Eee=e=>{let t=e.map(n=>`import { ${Ou(n)} } from '${uM[n]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(n=>n==="IntegratedCharts"||n==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(n=>Ou(n,!0)).join(", ")} ]); 

For more info see: ${Wl}/modules/`};function Ou(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function Ree(e,t){let i=t.filter(o=>o==="IntegratedCharts"||o==="Sparklines"),n="";return!globalThis?.agCharts&&i.length>0?n=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(o=>uM[o])&&(n=n+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),n}function pM({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var yD=({reasonOrId:e,moduleName:t,gridScoped:i,gridId:n,rowModelType:r,additionalText:o,isUmd:s})=>{let a=xee(t,r),l=typeof e=="string"?e:Dee[e];if(s)return Ree(l,a);let c=a.filter(h=>h==="IntegratedCharts"||h==="Sparklines"),d=c.length>0?`${c.map(h=>Ou(h)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(h=>Ou(h)).join(", "):Ou(a[0])} is not registered${i?" for gridId: "+n:""}. ${d} Check if you have registered the module:
`}
${Eee(a)}`+(o?` 

${o}`:"")},SD=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,Pee=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,kee={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:i})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",i],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${Pee(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:i,pageSizeOptions:n})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${i?"":" the default"} paginationPageSizeSelector=[${n?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:i,jsComps:n})=>{let r=[],o=[...Object.keys(i??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(n??[]).filter(a=>!!n[a])],s=zb({inputValue:t,allSuggestions:o,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return r.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),s.length>0&&r.push(`         Did you mean: [${s.slice(0,3)}]?
`),r.push("If using a custom component check it has been registered correctly."),r},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${Wl}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{let i=zb({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,i.length>0?`         Did you mean: [${i.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:i})=>["duplicate group keys for row data, keys should be unique",e,t,...i??[]],187:({rowId:e,firstData:t,secondData:i})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",i],188:e=>`getRowId callback must be provided for Server Side Row Model ${e?.feature||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:yD,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${Wl}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>SD("IntegratedChartsModule"),258:()=>SD("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:i,gridId:n,rowModelType:r})=>yD({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:Jl[t],gridId:n,gridScoped:i,rowModelType:r}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${Wl}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>hM(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:pM,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:e})=>`The Multi Filter for column '${e}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`,293:()=>"The grid was initialised detached from the DOM and was then inserted into a Shadow Root. Theme styles are probably broken. Pass the themeStyleContainer grid option to let the grid know where in the document to insert theme CSS.",294:()=>"When using the `agRichSelectCellEditor` setting `filterListAsync = true` requires `allowTyping = true` and the `values()` callback must return a Promise of filtered values.",295:({blockedService:e})=>`colDef.allowFormula is not supported with ${e}. Formulas has been turned off.`,296:()=>"Since v35, `api.hideOverlay()` does not hide the overlay when `activeOverlay` is set. Set `activeOverlay=null` instead.",297:()=>'`api.hideOverlay()` does not hide the no matching rows overlay as it is only controlled by grid state. Set `suppressOverlays=["noMatchingRows"] to not show it.'};function _ee(e,t){let i=kee[e];if(!i)return[`Missing error text for error id ${e}!`];let n=i(t),o=`
See ${dF(e,t)}`;return Array.isArray(n)?n.concat(o):[n,o]}var Dee={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},xD=new WeakMap,ED=new WeakMap;function fM(e,t,i){if(!t)return Ze(11),{};let n=i,r;if(!n?.setThemeOnGridDiv){let s=Xt({tag:"div"});s.style.height="100%",e.appendChild(s),e=s,r=()=>e.remove()}return new Mee().create(e,t,s=>{let a=new fY(e);s.createBean(a)},void 0,i,r)}var Fee=1,Mee=class{create(e,t,i,n,r,o){let s=gy.applyGlobalGridOptions(t),a=s.gridId??String(Fee++),l=this.getRegisteredModules(r,a,s.rowModelType),c=this.createBeansList(s.rowModelType,l,a),d=this.createProvidedBeans(e,s,r);if(!c)return;let h={providedBeanInstances:d,beanClasses:c,id:a,beanInitComparator:JK,beanDestroyComparator:QK,derivedBeans:[YK],destroyCallback:()=>{ED.delete(f),xD.delete(e),zW(a),o?.()}},p=new Rq(h);this.registerModuleFeatures(p,l),i(p),p.getBean("syncSvc").start(),n?.(p);let f=p.getBean("gridApi");return xD.set(e,f),ED.set(f,e),f}getRegisteredModules(e,t,i){return Gu(bee,void 0,!0),e?.modules?.forEach(n=>Gu(n,t)),VW(t,RD(i))}registerModuleFeatures(e,t){let i=e.getBean("registry"),n=e.getBean("apiFunctionSvc");for(let r of t){i.registerModule(r);let o=r.apiFunctions;if(o){let s=Object.keys(o);for(let a of s)n?.addFunction(a,o[a])}}}createProvidedBeans(e,t,i){let n=i?i.frameworkOverrides:null;mt(n)&&(n=new Gy);let r={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:i?i.globalListener:null,globalSyncListener:i?i.globalSyncListener:null,frameworkOverrides:n};return i?.providedBeanInstances&&Object.assign(r,i.providedBeanInstances),r}createBeansList(e,t,i){let n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},r=RD(e),o=n[r];if(!o){Pu(201,{rowModelType:r},`Unknown rowModelType ${r}.`);return}if(!WW()){Pu(272,void 0,hM());return}if(!e){let a=Object.entries(n).filter(([l,c])=>Db(c,i,l));if(a.length==1){let[l,c]=a[0];if(l!==r){let d={moduleName:c,rowModelType:l};Pu(275,d,pM(d));return}}}if(!Db(o,i,r)){let a=vy(),l=`rowModelType = '${r}'`,c=a?`Unable to use ${l} as that requires the ag-grid-enterprise script to be included.
`:`Missing module ${o}Module for rowModelType ${r}.`;Pu(200,{reasonOrId:l,moduleName:o,gridScoped:my(),gridId:i,rowModelType:r,isUmd:a},c);return}let s=new Set;for(let a of t)for(let l of a.beans??[])s.add(l);return Array.from(s)}};function RD(e){return e??"clientSide"}function gs(e){let t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function km(e){let t=e.rowModel;return t.getType()==="infinite"?t:void 0}function Tee(e){let t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var Iee=class extends j{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){let e=this.gos,t=e.getCallback("getLocaleText");return t?PW(t):kW(e.get("localeText"))}};function Aee(e,t=!1){let i=[],n=[],r=[],o=[],s=[],a=[],l=[],c=[],d=[],u=0;for(let h=0;h<e.length;h++){let{colId:p,sort:f,sortType:g,sortIndex:m,rowGroup:v,rowGroupIndex:C,aggFunc:b,pivot:S,pivotIndex:E,pinned:x,hide:P,width:F,flex:N}=e[h];d.push(p),f&&(i[m??u++]={colId:p,sort:f,type:g}),v&&(n[C??0]=p),typeof b=="string"&&r.push({colId:p,aggFunc:b}),S&&(o[E??0]=p),x&&(x==="right"?a:s).push(p),P&&l.push(p),(N!=null||F)&&c.push({colId:p,flex:N??void 0,width:F===null?void 0:F})}return{sort:i.length?{sortModel:yb(i)}:void 0,rowGroup:n.length?{groupColIds:yb(n)}:void 0,aggregation:r.length?{aggregationModel:r}:void 0,pivot:o.length||t?{pivotMode:t,pivotColIds:yb(o)}:void 0,columnPinning:s.length||a.length?{leftColIds:s,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:c.length?{columnSizingModel:c}:void 0,columnOrder:d.length?{orderedColIds:d}:void 0}}function yb(e){return e.filter(t=>t!=null)}function Oee(e){let t=[];for(let{groupId:i,open:n}of e)n&&t.push(i);return t.length?{openColumnGroupIds:t}:void 0}var gM=class{wrap(e,t,i,n){let r=this.createWrapper(e,n);for(let o of t??[])this.createMethod(r,o,!0);for(let o of i??[])this.createMethod(r,o,!1);return r}createMethod(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))}createMethodProxy(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&J(49,{methodName:t}),null)}}};function Sb(e){return e.get("tooltipShowMode")==="whenTruncated"}function Lee(e,t){if(typeof e!="number")return"";let i=t(),n=i("thousandSeparator",","),r=i("decimalSeparator",".");return e.toString().replace(".",r).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${n}`)}var Nee=class extends j{getFileName(e){let t=this.getDefaultFileExtension();return e?.length||(e=this.getDefaultFileName()),e.includes(".")?e:`${e}.${t}`}getData(e){return this.beans.gridSerializer.serialize(this.createSerializingSession(e),e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},Bee=class{constructor(e){let{colModel:t,rowGroupColsSvc:i,colNames:n,valueSvc:r,gos:o,processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.colModel=t,this.rowGroupColsSvc=i,this.colNames=n,this.valueSvc=r,this.gos=o,this.processCellCallback=s,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e){let{column:t,node:i,currentColumnIndex:n,accumulatedRowIndex:r,type:o,useRawFormula:s}=e,a=n===0&&vF(this.gos,i,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||i.group)&&(t.isRowGroupDisplayed(i.rowGroupColumn?.getColId()??"")||a))return{value:this.processRowGroupCallback(_e(this.gos,{column:t,node:i}))??""};if(this.processCellCallback)return{value:this.processCellCallback(_e(this.gos,{accumulatedRowIndex:r,column:t,node:i,value:this.valueSvc.getValueForDisplay({column:t,node:i}).value,type:o,parseValue:f=>this.valueSvc.parseValue(t,i,f,this.valueSvc.getValue(t,i,void 0)),formatValue:f=>this.valueSvc.formatValue(t,i,f)??f}))??""};let l=this.gos.get("treeData"),c=this.valueSvc,d=i.level===-1&&i.footer,u=t.colDef.showRowGroup===!0&&(i.group||l);if(!d&&(a||u)){let f="",g=i;for(;g&&g.level!==-1;){let{value:m,valueFormatted:v}=c.getValueForDisplay({column:a?void 0:t,node:g,includeValueFormatted:!0,exporting:!0});f=` -> ${v??m??""}${f}`,g=g.parent}return{value:f,valueFormatted:f}}let{value:h,valueFormatted:p}=c.getValueForDisplay({column:t,node:i,includeValueFormatted:!0,exporting:!0,useRawFormula:s});return{value:h??"",valueFormatted:p}}getHeaderName(e,t){return e?e(_e(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function Hee(e,t){let i=document.defaultView||window;if(!i){J(52);return}let n=document.createElement("a"),r=i.URL.createObjectURL(t);n.setAttribute("href",r),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),n.remove(),i.setTimeout(()=>{i.URL.revokeObjectURL(r)},0)}var zee={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,overlayComponent:!0,suppressOverlays:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},Gi="clientSide",yi="serverSide",Ml="infinite",Vee={onGroupExpandedOrCollapsed:[Gi],refreshClientSideRowModel:[Gi],isRowDataEmpty:[Gi],forEachLeafNode:[Gi],forEachNodeAfterFilter:[Gi],forEachNodeAfterFilterAndSort:[Gi],resetRowHeights:[Gi,yi],applyTransaction:[Gi],applyTransactionAsync:[Gi],flushAsyncTransactions:[Gi],getBestCostNodeSelection:[Gi],getServerSideSelectionState:[yi],setServerSideSelectionState:[yi],applyServerSideTransaction:[yi],applyServerSideTransactionAsync:[yi],applyServerSideRowData:[yi],retryServerSideLoads:[yi],flushServerSideAsyncTransactions:[yi],refreshServerSide:[yi],getServerSideGroupLevelState:[yi],refreshInfiniteCache:[Ml],purgeInfiniteCache:[Ml],getInfiniteRowCount:[Ml],isLastRowIndexKnown:[Ml,yi],expandAll:[Gi,yi],collapseAll:[Gi,yi],onRowHeightChanged:[Gi,yi],setRowCount:[Ml,yi],getCacheBlockState:[Ml,yi]},Gee={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function Wee(e,t,i){let n=Gee[e];if(n){let{version:o,new:s,old:a,message:l}=n,c=a??e;return(...d)=>{let u=s?`Please use ${s} instead. `:"";return Mu(`Since ${o} api.${c} is deprecated. ${u}${l??""}`),t.apply(t,d)}}let r=Vee[e];return r?(...o)=>{let s=i.rowModel.getType();if(!r.includes(s)){Vl(`api.${e} can only be called when gridOptions.rowModelType is ${r.join(" or ")}`);return}return t.apply(t,o)}:t}var Uee={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},jee={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,aasc:1,adesc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},qee={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",overlayLoading:"Overlay",overlayExporting:"Overlay",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",richSelectLoading:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortAbsoluteAscending:["MenuCore","Sort"],sortAbsoluteDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},$ee=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),Kee=class extends j{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,UW(_ee)}warnOnInitialPropertyUpdate(e,t){e==="api"&&zee[t]&&J(22,{key:t})}processGridOptions(e){this.processOptions(e,TQ())}validateApiFunction(e,t){return Wee(e,t,this.beans)}missingUserComponent(e,t,i,n){let r=Jl[t];r?this.gos.assertModuleRegistered(r,`AG Grid '${e}' component: ${t}`):J(101,{propertyName:e,componentName:t,agGridDefaults:i,jsComps:n})}missingDynamicBean(e){let t=Uee[e];return t?Fr(200,T(w({},this.gos.getModuleErrorParams()),{moduleName:t,reasonOrId:e})):void 0}checkRowEvents(e){Xee.has(e)&&J(10,{eventType:e})}validateIcon(e){if($ee.has(e)&&J(43,{iconName:e}),jee[e])return;let t=qee[e];if(t){Ze(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:my(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}J(134,{iconName:e})}isProvidedUserComp(e){return!!Jl[e]}validateColDef(e){this.processOptions(e,SQ())}processOptions(e,t){let{validations:i,deprecations:n,allProperties:r,propertyExceptions:o,objectName:s,docsUrl:a}=t;r&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...o??[],...Object.keys(n)],r,s,a);let l=new Set;if(Object.keys(e).forEach(d=>{let u=n[d];if(u){let{message:C,version:b}=u;l.add(`As of v${b}, ${String(d)} is deprecated. ${C??""}`)}let h=e[d];if(h==null||h===!1)return;let p=i[d];if(!p)return;let{dependencies:f,validate:g,supportedRowModels:m,expectedType:v}=p;if(v){let C=typeof h;if(C!==v){l.add(`${String(d)} should be of type '${v}' but received '${C}' (${h}).`);return}}if(m){let C=this.gridOptions.rowModelType??"clientSide";if(!m.includes(C)){l.add(`${String(d)} is not supported with the '${C}' row model. It is only valid with: ${m.join(", ")}.`);return}}if(f){let C=this.checkForRequiredDependencies(d,f,e);if(C){l.add(C);return}}if(g){let C=g(e,this.gridOptions,this.beans);if(C){l.add(C);return}}}),l.size>0)for(let d of l)Mu(d)}checkForRequiredDependencies(e,t,i){let r=Object.entries(t).filter(([o,s])=>{let a=i[o];return!s.required.includes(a)});return r.length===0?null:r.map(([o,s])=>`'${String(e)}' requires '${o}' to be one of [${s.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${s.reason??""}`).join(`
           `)}checkProperties(e,t,i,n,r){let o=["__ob__","__v_skip","__metadata__"],s=Yee(Object.getOwnPropertyNames(e),[...o,...t,...i],i),a=Object.keys(s);for(let l of a){let c=s[l],d=`invalid ${n} property '${l}' did you mean any of these: ${c.slice(0,8).join(", ")}.`;i.includes("context")&&(d+=`
If you are trying to annotate ${n} with application data, use the '${n}.context' property instead.`),Mu(d)}if(a.length>0&&r){let l=this.beans.frameworkOverrides.getDocLink(r);Mu(`to see all the valid ${n} properties please check: ${l}`)}}};function Yee(e,t,i){let n={},r=e.filter(o=>!t.some(s=>s===o));if(r.length>0)for(let o of r)n[o]=zb({inputValue:o,allSuggestions:i}).values;return n}var Xee=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),Jee={moduleName:"Validation",version:fe,beans:[Kee]};function ty(e){let t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter)}var Qee=class extends j{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(e){this.filterManager=e.filterManager}execute(e){let t=!!this.filterManager?.isChildFilterPresent();this.beans.formula?.active?this.softFilter(t,e):this.filterNodes(t,e)}filterNodes(e,t){let i=(n,r)=>{n.hasChildren()&&e&&!r?n.childrenAfterFilter=n.childrenAfterGroup.filter(o=>{let s=o.childrenAfterFilter&&o.childrenAfterFilter.length>0,a=o.data&&this.filterManager.doesRowPassFilter({rowNode:o});return s||a}):n.childrenAfterFilter=n.childrenAfterGroup,ty(n)};if(this.doingTreeDataFiltering()){let n=(o,s)=>{if(o.childrenAfterGroup)for(let a=0;a<o.childrenAfterGroup.length;a++){let l=o.childrenAfterGroup[a],c=s||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?n(o.childrenAfterGroup[a],c):i(l,c)}i(o,s)},r=o=>n(o,!1);t.executeFromRootNode(r)}else{let n=r=>i(r,!1);t.forEachChangedNodeDepthFirst(n,!0)}}softFilter(e,t){let i=n=>{if(n.childrenAfterFilter=n.childrenAfterGroup,n.hasChildren())for(let r of n.childrenAfterGroup)r.softFiltered=e&&!(r.data&&this.filterManager.doesRowPassFilter({rowNode:r}));ty(n)};t.forEachChangedNodeDepthFirst(i,!0)}doingTreeDataFiltering(){let{gos:e}=this;return e.get("treeData")&&!e.get("excludeChildrenWhenTreeDataFiltering")}},Zee=class extends Vy{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,i,n,r){this.comp=e;let o=Qu(this,this.beans.context,r);this.eButtonShowMainFilter=i,this.eFloatingFilterBody=n,this.setGui(t,o),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(o),this.setupLeft(o),this.setupHover(o),this.setupFocus(o),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(o),this.setupUi(),o.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(o);let s=()=>this.onColDefChanged(o);o.addManagedListeners(this.column,{colDefChanged:s}),o.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&s()}}),o.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return _e(t.gos,{colDef:i,column:e,floatingFilter:!0})}setupActive(){let e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;let e=ji("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new Zu(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){let e=this.getLocaleTextFunc();ec(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){let{beans:t}=this;if(bt(t)===this.eGui)return;let r=xa(t,this.eGui,null,e.shiftKey);if(r){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),r.focus();return}let o=this.findNextColumnWithFloatingFilter(e.shiftKey);o&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:o},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){let t=this.beans.visibleCols,i=this.column;do if(i=e?t.getColBefore(i):t.getColAfter(i),!i)break;while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();switch(e.key){case B.UP:case B.DOWN:case B.LEFT:case B.RIGHT:if(t)return;wa(e);case B.ENTER:t&&Ca(this.eGui)&&e.preventDefault();break;case B.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;let i=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&da(e.relatedTarget,"ag-floating-filter");if(i&&n&&e.target===this.eGui){let r=this.lastFocusEvent,o=!!(r&&r.key===B.TAB);if(r&&o){let s=r.shiftKey;Ca(this.eGui,s)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){let t=new zy(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!sn(this.gos)}setupUserComp(){if(!this.active)return;let e=this.beans.colFilter?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){let e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;let{beans:{colFilter:t},column:i,gos:n}=this,r=o=>{if(o?.source==="filterDestroyed"&&(!this.isAlive()||!t?.isAlive()))return;let s=this.comp.getFloatingFilterComp();s&&s.then(a=>{if(a){if(n.get("enableFilterHandlers")){let d=o,u="filter";d?.afterFloatingFilter?u="ui":d?.afterDataChange?u="dataChanged":o?.source==="api"&&(u="api"),this.updateFloatingFilterParams(this.userCompDetails,u);return}let l=t?.getCurrentFloatingFilterParentModel(i),c=o?T(w({},o),{columns:o.columns??[],source:o.source==="api"?"api":"columnFilter"}):null;a.onParentModelChanged(l,c)}})};[this.destroySyncListener]=e.addManagedListeners(i,{filterChanged:r}),t?.isFilterActive(i)&&r(null)}setupWidth(e){let t=()=>{let i=`${this.column.getActualWidth()}px`;this.comp.setWidth(i)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){let e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){let t=this.active;this.setupActive();let i=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());let n=this.beans.colFilter,r=this.active?n?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,o=this.comp.getFloatingFilterComp();!o||!r?this.updateCompDetails(e,r,i):o.then(s=>{!s||n?.areFilterCompsDifferent(this.userCompDetails??null,r)?this.updateCompDetails(e,r,i):this.updateFloatingFilterParams(r,"colDef")})}updateCompDetails(e,t,i){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),i&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){if(!e)return;let i=e.params;this.comp.getFloatingFilterComp()?.then(n=>{typeof n?.refresh=="function"&&(this.gos.get("enableFilterHandlers")&&(i=T(w({},i),{model:$t(this.beans.colFilter?.model??{},this.column.getColId()),source:t})),n.refresh(i))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function ete(e,t){let i=e.colModel.getCol(t);if(!i){Ze(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:i,positionBy:"auto"})}function tte(e){e.menuSvc?.hidePopupMenu()}var ite={moduleName:"SharedMenu",version:fe,beans:[mK],apiFunctions:{showColumnMenu:ete,hidePopupMenu:tte}},nte=class extends Lq{getDefaultPopupParent(){return this.beans.ctrlsSvc.get("gridCtrl").getGui()}callPostProcessPopup(e,t,i,n,r){let o=this.gos.getCallback("postProcessPopup");if(o){let{column:s,rowNode:a}=e??{};o({column:s,rowNode:a,ePopup:i,type:t,eventSource:n,mouseEvent:r})}}getActivePopups(){return this.popupList.map(e=>e.element)}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return uo(e)}},_m={moduleName:"Popup",version:fe,beans:[nte]},rte=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function ote(e){let t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function ste(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function ate(e,t){let i=e.colModel.getColDefCol(t);if(i)return e.colFilter?.destroyFilter(i,"api")}function lte(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function cte(e){return e.filterManager?.getFilterModel()??{}}function dte(e,t,i){let{gos:n,colModel:r,colFilter:o}=e;i&&!n.get("enableFilterHandlers")&&(J(288),i=!1);let s=r.getColDefCol(t);return s?o?.getModelForColumn(s,i)??null:null}function ute(e,t,i){return e.filterManager?.setColumnFilterModel(t,i)??Promise.resolve()}function hte(e,t){let i=e.colModel.getCol(t);if(!i){Ze(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:i,containerType:"columnFilter",positionBy:"auto"})}function pte(e){e.menuSvc?.hideFilterMenu()}function fte(e,t){let i=e.colModel.getCol(t);if(!i){Ze(12,{colKey:t});return}return e.colFilter?.getHandler(i,!0)}function gte(e,t){let{colModel:i,colFilter:n,gos:r}=e;if(!r.get("enableFilterHandlers")){J(287);return}let{colId:o,action:s}=t;if(o){let a=i.getColById(o);a&&n?.updateModel(a,s)}else n?.updateAllModels(s)}var mte={filterHandler:()=>({doesFilterPass:()=>!0})},vte=class extends j{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap=w({},d8),this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});let e=this.gos,t=w({},e.get("initialState")?.filter?.filterModel??{});this.initialModel=t,this.model=w({},t),e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",i){let{colModel:n,dataTypeSvc:r,filterManager:o}=this.beans;if(r?.isPendingInference){this.modelUpdates.push({model:e,source:t});return}let s=[],a=this.getModel(!0);if(e){let l=new Set(Object.keys(e));this.allColumnFilters.forEach((c,d)=>{let u=e[d];s.push(this.setModelOnFilterWrapper(c,u)),l.delete(d)}),l.forEach(c=>{let d=n.getColDefCol(c)||n.getCol(c);if(!d){J(62,{colId:c});return}if(!d.isFilterAllowed()){J(63,{colId:c});return}let u=this.getOrCreateFilterWrapper(d,!0);if(!u){J(64,{colId:c});return}s.push(this.setModelOnFilterWrapper(u,e[c],!0))})}else this.model={},this.allColumnFilters.forEach(l=>{s.push(this.setModelOnFilterWrapper(l,null))});wt.all(s).then(()=>{let l=this.getModel(!0),c=[];this.allColumnFilters.forEach((d,u)=>{let h=a?a[u]:null,p=l?l[u]:null;Nu(h,p)||c.push(d.column)}),c.length>0?o?.onFilterChanged({columns:c,source:t}):i&&this.updateActive("filterChanged")})}getModel(e){let t={},{allColumnFilters:i,initialModel:n,beans:{colModel:r}}=this;if(i.forEach((o,s)=>{let a=this.getModelFromFilterWrapper(o);pe(a)&&(t[s]=a)}),!e)for(let o of Object.keys(n)){let s=n[o];pe(s)&&!i.has(o)&&r.getCol(o)?.isFilterAllowed()&&(t[o]=s)}return t}setState(e,t,i="api"){if(this.state.clear(),t)for(let n of Object.keys(t)){let r=t[n];this.state.set(n,{model:$t(this.model,n),state:r})}this.setModel(e,i,!0)}getState(){let e=this.state;if(!e.size)return;let t={},i=!1;return e.forEach((n,r)=>{let o=n.state;o!=null&&(i=!0,t[r]=o)}),i?t:void 0}getModelFromFilterWrapper(e){let i=e.column.getColId();if(e.isHandler)return $t(this.model,i);let n=e.filter;return n?typeof n.getModel!="function"?(J(66),null):n.getModel():$t(this.initialModel,i)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};let{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){let e=c=>c?c.isFilterActive?c.isFilterActive():(J(67),!1):!1,{colModel:t,gos:i}=this.beans,n=!!Tb(i),r=c=>{if(!c.isPrimary())return!0;let u=!t.isPivotActive();return!c.isValueActive()||!u?!1:t.isPivotMode()?!0:n},o=[],s=[],a=(c,d,u)=>{d&&(r(c)?o.push(u):s.push(u))},l=[];return this.allColumnFilters.forEach(c=>{let d=c.column,u=d.getColId();if(c.isHandler)l.push(wt.resolve().then(()=>{a(d,this.isHandlerActive(d),{colId:u,isHandler:!0,handler:c.handler,handlerParams:c.handlerParams})}));else{let h=Zo(c);h&&l.push(h.then(p=>{a(d,e(p),{colId:u,isHandler:!1,comp:p})}))}}),wt.all(l).then(()=>{this.activeAggregateFilters=o,this.activeColumnFilters=s})}updateFilterFlagInColumns(e,t){let i=[];return this.allColumnFilters.forEach(n=>{let r=n.column;if(n.isHandler)i.push(wt.resolve().then(()=>{this.setColFilterActive(r,this.isHandlerActive(r),e,t)}));else{let o=Zo(n);o&&i.push(o.then(s=>{this.setColFilterActive(r,s.isFilterActive(),e,t)}))}}),this.beans.groupFilter?.updateFilterFlags(e,t),wt.all(i)}doFiltersPass(e,t,i){let{data:n,aggData:r}=e,o=i?this.activeAggregateFilters:this.activeColumnFilters,s=i?r:n,a=this.model;for(let l=0;l<o.length;l++){let c=o[l],{colId:d,isHandler:u}=c;if(d!==t)if(u){let{handler:h,handlerParams:p}=c;if(!h.doesFilterPass({node:e,data:s,model:$t(a,d),handlerParams:p}))return!1}else{let h=c.comp;if(typeof h.doesFilterPass!="function"){Ze(91);continue}if(!h.doesFilterPass({node:e,data:s}))return!1}}return!0}getHandlerParams(e){let t=this.allColumnFilters.get(e.getColId());return t?.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){let{rowRenderer:t,filterManager:i}=this.beans,n=()=>{this.isAlive()&&i?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(n,0):n()}updateBeforeFilterChanged(e={}){let{column:t,additionalEventAttributes:i}=e,n=t?.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",i).then(()=>{this.allColumnFilters.forEach(r=>{let{column:o,isHandler:s}=r;n!==o.getColId()&&(s&&r.handler.onAnyFilterChanged?.(),Zo(r,s)?.then(a=>{typeof a?.onAnyFilterChanged=="function"&&a.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){let t=[];this.allColumnFilters.forEach(i=>{let n=i.isHandler;n&&i.handler.onNewRowsLoaded?.();let r=Zo(i,n);r&&t.push(r.then(o=>{o.onNewRowsLoaded?.()}))}),wt.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){let{filterValueSvc:i,colModel:n}=this.beans;return(r,o)=>{let s=o?n.getCol(o):e;return s?i.getValue(s,r,t):void 0}}isFilterActive(e){let t=this.cachedFilter(e);if(t?.isHandler)return this.isHandlerActive(e);let i=t?.filter;return i?i.isFilterActive():$t(this.initialModel,e.getColId())!=null}isHandlerActive(e){let t=pe($t(this.model,e.getColId()));if(t)return t;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterActive(e):!1}getOrCreateFilterUi(e){let t=this.getOrCreateFilterWrapper(e,!0);return t?Zo(t):null}getFilterUiForDisplay(e){let t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;let i=Zo(t);return i?i.then(n=>({comp:n,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){let i=this.getOrCreateFilterWrapper(e,t);return i?.isHandler?i.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let i=this.cachedFilter(e);return!i&&t&&(i=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,i)),i}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>this.beans.dataTypeSvc?.getBaseDataType(e),t)}getDefaultFilterFromDataType(e,t=!1){return aU(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":l$(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,i,n,r,o){let s=()=>{let c=this.createFilterCompParams(e,r,o),d=n(c,r);return hj(this.beans.userCompFactory,t,d,i)},a=s();return a?{compDetails:a,createFilterUi:c=>(c?s():a).newAgStackInstance()}:null}createFilterInstance(e,t,i,n){let r=this.beans.selectableFilter;r?.isSelectable(t)&&(t=r.getFilterDef(e,t));let{handler:o,handlerParams:s,handlerGenerator:a}=this.createHandler(e,t,i)??{},l=this.createFilterComp(e,t,i,n,!!o,"init");if(!l)return{compDetails:null,createFilterUi:null,handler:o,handlerGenerator:a,handlerParams:s};let{compDetails:c,createFilterUi:d}=l;return this.isGlobalButtons&&(c.params?.buttons?.length||J(281,{colId:e.getColId()})),{compDetails:c,handler:o,handlerGenerator:a,handlerParams:s,createFilterUi:d}}createBaseFilterParams(e,t){let{filterManager:i,rowModel:n}=this.beans;return _e(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:r=>i?.doesRowPassOtherFilters(e.getColId(),r)??!0,rowModel:n})}createFilterCompParams(e,t,i,n){let r=this.filterChangedCallbackFactory(e),o=this.createBaseFilterParams(e,n);if(o.filterChangedCallback=r,o.filterModifiedCallback=n?()=>{}:s=>this.filterModified(e,s),t){let s=o,a=e.getColId(),l=$t(this.model,a);s.model=l,s.state=this.state.get(a)??{model:l},s.onModelChange=(c,d)=>{this.updateStoredModel(a,c),this.refreshHandlerAndUi(e,c,"ui",!1,d).then(()=>{r(T(w({},d),{source:"columnFilter"}))})},s.onStateChange=c=>{this.updateState(e,c),this.updateOrRefreshFilterUi(e)},s.onAction=(c,d,u)=>{this.updateModel(e,c,d),this.dispatchLocalEvent({type:"filterAction",column:e,action:c,event:u})},s.getHandler=()=>this.getHandler(e,!0),s.onUiChange=c=>this.filterUiChanged(e,c),s.source=i}return o}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,i){let n=t(),r={created:!0,create:t,filterParams:e.params,compDetails:e,promise:n};return n.then(i),r}createFilterWrapper(e){let{compDetails:t,handler:i,handlerGenerator:n,handlerParams:r,createFilterUi:o}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),a=>a),s=e.getColId();if(i)return delete this.initialModel[s],i.init?.(T(w({},r),{source:"init",model:$t(this.model,s)})),{column:e,isHandler:!0,handler:i,handlerGenerator:n,handlerParams:r,filterUi:this.createFilterUiForHandler(t,o)};if(o){let a={column:e,filterUi:null,isHandler:!1};return a.filterUi=this.createFilterUiLegacy(t,o,l=>{a.filter=l??void 0}),a}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,i){let{gos:n,frameworkOverrides:r,registry:o}=this.beans,s,a=p=>{let f=p.filter;if(NF(f)){let g=f.handler;return g||(s=f.doesFilterPass,s?()=>({doesFilterPass:s}):void 0)}return typeof f=="string"?f:void 0},l=n.get("enableFilterHandlers"),c=l?a(t):void 0,d=p=>()=>this.createBean(o.createDynamicBean(p,!0)),u,h;if(typeof c=="string"){let p=n.get("filterHandlers")?.[c];p!=null?u=p:Xq.has(c)&&(u=d(c),h=c)}else u=c;if(!u){let p,{compName:f,jsComp:g,fwComp:m}=zF(r,t);f?p=f:g==null&&m==null&&t.filter===!0&&(p=i),h=this.handlerMap[p],h&&(u=d(h))}return u?{filterHandler:u,handlerNameOrCallback:s??h}:l?(_t(n)&&J(277,{colId:e.getColId()}),mte):void 0}createHandler(e,t,i){let n=this.createHandlerFunc(e,t,i);if(!n)return;let r=qw(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:o,filterHandler:s}=n,{handler:a,handlerParams:l}=this.createHandlerFromFunc(e,s,r);return{handler:a,handlerParams:l,handlerGenerator:o??s}}createHandlerFromFunc(e,t,i){let n=e.getColDef(),r=t(_e(this.gos,{column:e,colDef:n})),o=this.createHandlerParams(e,i);return{handler:r,handlerParams:o}}createHandlerParams(e,t){let i=e.getColDef(),n=e.getColId(),r=this.filterChangedCallbackFactory(e);return _e(this.gos,{colDef:i,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:o=>this.beans.filterManager?.doesRowPassOtherFilters(n,o)??!0,onModelChange:(o,s)=>{this.updateStoredModel(n,o),this.refreshHandlerAndUi(e,o,"handler",!1,s).then(()=>{r(T(w({},s),{source:"columnFilter"}))})},filterParams:t})}onColumnsChanged(){let e=[],{colModel:t,filterManager:i,groupFilter:n}=this.beans;this.allColumnFilters.forEach((o,s)=>{let a;o.column.isPrimary()?a=t.getColDefCol(s):a=t.getCol(s),!(a&&a===o.column)&&(e.push(o.column),this.disposeFilterWrapper(o,"columnChanged"),this.disposeColumnListener(s))});let r=n&&e.every(o=>n.isGroupFilter(o));e.length>0&&!r&&i?.onFilterChanged({columns:e,source:"api"})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){let{userCompFactory:i,frameworkOverrides:n,selectableFilter:r,gos:o}=this.beans,s=p=>{this.getOrCreateFilterUi(e)?.then(g=>{p(ju(g))})},a=e.getColDef(),l=r?.isSelectable(a)?r.getFilterDef(e,a):a,c=u$(n,l,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",d=o.get("enableFilterHandlers"),u=qw(i,l,this.createFilterCompParams(e,d,"init",!0)),h=_e(o,{column:e,filterParams:u,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:s,showParentFilter:t});if(d){let p=h,f=e.getColId(),g=this.filterChangedCallbackFactory(e);p.onUiChange=m=>this.floatingFilterUiChanged(e,m),p.model=$t(this.model,f),p.onModelChange=(m,v)=>{this.updateStoredModel(f,m),this.refreshHandlerAndUi(e,m,"floating",!0,v).then(()=>{g(T(w({},v),{source:"columnFilter"}))})},p.getHandler=()=>this.getHandler(e,!0),p.source="init"}return gj(i,a,h,c)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,i,n){let r="paramsUpdated";if(e.isHandler){let o=t.getColId();delete this.initialModel[o],this.state.delete(o);let s=e.filterUi,a=this.createFilterUiForHandler(i,n);e.filterUi=a;let l=this.eventSvc;s?.created?s.promise.then(c=>{this.destroyBean(c),l.dispatchEvent({type:"filterDestroyed",source:r,column:t})}):l.dispatchEvent({type:"filterHandlerDestroyed",source:r,column:t})}else this.destroyFilter(t,r)}destroyFilter(e,t="api"){let i=e.getColId(),n=this.allColumnFilters.get(i);this.disposeColumnListener(i),delete this.initialModel[i],n&&this.disposeFilterWrapper(n,t).then(r=>{r&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){let t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let i=!1,{column:n,isHandler:r,filterUi:o}=e,s=n.getColId();r&&(i=this.isHandlerActive(n),this.destroyBean(e.handler),delete this.model[s],this.state.delete(s));let a=()=>{this.setColFilterActive(n,!1,"filterDestroyed"),this.allColumnFilters.delete(s),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:n})};if(o){if(o.created)return o.promise.then(l=>(i=r?i:!!l?.isFilterActive(),this.destroyBean(l),a(),i));a()}return wt.resolve(i)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:t?.source??"columnFilter"})}}filterParamsChanged(e,t="api"){let i=this.allColumnFilters.get(e);if(!i)return;let n=this.beans,r=i.column,o=r.getColDef(),s=r.isFilterAllowed(),a=this.getDefaultFilter(r),l=n.selectableFilter,c=l?.isSelectable(o)?l.getFilterDef(r,o):o,d=s?this.createHandlerFunc(r,c,this.getDefaultFilter(r)):void 0,u=!!d,h=i.isHandler;if(h!=u){this.destroyFilter(r,"paramsUpdated");return}let{compDetails:p,createFilterUi:f}=(s?this.createFilterComp(r,c,a,m=>m,u,"colDef"):null)??{compDetails:null,createFilterUi:null},g=p?.params??qw(n.userCompFactory,c,this.createFilterCompParams(r,u,"colDef"));if(h){let m=d?.handlerNameOrCallback??d?.filterHandler,v=$t(this.model,e);if(i.handlerGenerator!=m){let C=i.handler,{handler:b,handlerParams:S}=this.createHandlerFromFunc(r,d.filterHandler,g);i.handler=b,i.handlerParams=S,i.handlerGenerator=m,delete this.model[e],b.init?.(T(w({},S),{source:"init",model:null})),this.destroyBean(C),v!=null&&this.beans.filterManager?.onFilterChanged({columns:[r],source:t})}else{let C=this.createHandlerParams(r,p?.params);i.handlerParams=C,i.handler.refresh?.(T(w({},C),{source:"colDef",model:v}))}}if(this.areFilterCompsDifferent(i.filterUi?.compDetails??null,p)||!i.filterUi||!p){this.destroyFilterUi(i,r,p,f);return}i.filterUi.filterParams=g,Zo(i,h)?.then(m=>{(m?.refresh?m.refresh(g):!0)===!1?this.destroyFilterUi(i,r,p,f):this.dispatchLocalEvent({type:"filterParamsChanged",column:r,params:g})})}refreshHandlerAndUi(e,t,i,n,r){let o=this.cachedFilter(e);if(!o)return n&&this.getOrCreateFilterWrapper(e,!0),wt.resolve();if(!o.isHandler)return wt.resolve();let{filterUi:s,handler:a,handlerParams:l}=o;return Jq(()=>{if(s){let{created:c,filterParams:d}=s;if(c)return s.promise.then(u=>u?{filter:u,filterParams:d}:void 0);s.refreshed=!0}return wt.resolve(void 0)},a,l,t,this.state.get(e.getColId())??{model:t},i,r)}setColumnFilterWrapper(e,t){let i=e.getColId();this.allColumnFilters.set(i,t),this.allColumnListeners.set(i,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(i)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;let{componentClass:i}=e,{componentClass:n}=t;return!(i===n||i?.render&&n?.render&&i.render===n.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){let t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);let i=this.getOrCreateFilterUi(t);return i?new Promise(n=>{i.then(r=>{n(ju(r))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:i})=>{this.setModelForColumn(e,t).then(()=>i())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){let{state:n,model:r}=this,o=e.getColId(),s=n.get(o);return s?s.model??null:$t(r,o)}let i=this.cachedFilter(e);return i?this.getModelFromFilterWrapper(i):null}setModelForColumn(e,t){if(this.beans.dataTypeSvc?.isPendingInference){let i=()=>{},n=new Promise(r=>{i=r});return this.columnModelUpdates.push({key:e,model:t,resolve:i}),n}return new Promise(i=>{this.setModelForColumnLegacy(e,t).then(n=>i(n))})}getStateForColumn(e){return this.state.get(e)??{model:$t(this.model,e)}}setModelForColumnLegacy(e,t){let i=this.beans.colModel.getColDefCol(e),n=i?this.getOrCreateFilterWrapper(i,!0):null;return n?this.setModelOnFilterWrapper(n,t):wt.resolve()}setColDefPropsForDataType(e,t,i){let n=e.filter,r=n===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):n;if(typeof r!="string")return;let o,s,a=this.beans,{filterParams:l,filterValueGetter:c}=e;r==="agMultiColumnFilter"?{filterParams:o,filterValueGetter:s}=a.multiFilter?.getParamsForDataType(l,c,t,i)??{}:{filterParams:o,filterValueGetter:s}=o$(r,l,c,t,i,a,this.getLocaleTextFunc()),e.filterParams=o,s&&(e.filterValueGetter=s)}setColFilterActive(e,t,i,n){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",i)),e.dispatchColEvent("filterChanged",i,n)}setModelOnFilterWrapper(e,t,i){return new wt(n=>{if(e.isHandler){let o=e.column,s=o.getColId(),a=this.model[s];if(this.updateStoredModel(s,t),i&&t===a){n();return}this.refreshHandlerAndUi(o,t,"api").then(()=>n());return}let r=Zo(e);if(r){r.then(o=>{if(typeof o?.setModel!="function"){J(65),n();return}(o.setModel(t)||wt.resolve()).then(()=>n())});return}n()})}updateStoredModel(e,t){pe(t)?this.model[e]=t:delete this.model[e];let i=this.state.get(e),n={model:t,state:i?.state};this.state.set(e,n)}filterModified(e,t){this.getOrCreateFilterUi(e)?.then(i=>{this.eventSvc.dispatchEvent(w({type:"filterModified",column:e,filterInstance:i},t))})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(w({type:"filterUiChanged",column:e},t))}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(w({type:"floatingFilterUiChanged",column:e},t))}updateModel(e,t,i){let n=e.getColId(),r=this.cachedFilter(e),o=()=>r?.filterUi;H_({action:t,filterParams:r?.filterUi?.filterParams,getFilterUi:o,getModel:()=>$t(this.model,n),getState:()=>this.state.get(n),updateState:s=>this.updateState(e,s),updateModel:s=>o()?.filterParams?.onModelChange(s,T(w({},i),{fromAction:t})),processModelToApply:r?.isHandler?r.handler.processModelToApply?.bind(r.handler):void 0})}updateAllModels(e,t){let i=[];this.allColumnFilters.forEach((n,r)=>{let o=this.beans.colModel.getColDefCol(r);o&&H_({action:e,filterParams:n.filterUi?.filterParams,getFilterUi:()=>n.filterUi,getModel:()=>$t(this.model,r),getState:()=>this.state.get(r),updateState:s=>this.updateState(o,s),updateModel:s=>{this.updateStoredModel(r,s),this.dispatchLocalEvent({type:"filterAction",column:o,action:e}),i.push(this.refreshHandlerAndUi(o,s,"ui"))},processModelToApply:n?.isHandler?n.handler.processModelToApply?.bind(n.handler):void 0})}),i.length&&wt.all(i).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){let t=e.getColId();h8(()=>this.cachedFilter(e)?.filterUi,()=>$t(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){let{state:e,model:t,activeFilterComps:i}=this;for(let r of i)if(r.source==="COLUMN_MENU")return!1;let n=!1;for(let r of e.keys()){let o=e.get(r);if(o.valid===!1)return!1;(o.model??null)!==$t(t,r)&&(n=!0)}return n}hasUnappliedModel(e){let{model:t,state:i}=this;return(i.get(e)?.model??null)!==$t(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;let i=this.beans.filterPanelSvc;return i?.isActive?!!i.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function Cte(e){return!!e.filterManager?.isAnyFilterPresent()}function wte(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var bte=class extends j{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){let e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:n})=>this.onAdvFilterEnabledChanged(n),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});let{gos:i}=this;this.alwaysPassFilter=i.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=i.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){let e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){let t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,i="api"){this.isAdvFilterEnabled()||this.colFilter?.setState(e,t,i)}setFilterModel(e,t="api",i){if(this.isAdvFilterEnabled()){i||this.warnAdvFilters();return}this.colFilter?.setModel(e,t)}getFilterModel(){return this.colFilter?.getModel()??{}}getFilterState(){return this.colFilter?.getState()}isColumnFilterPresent(){return!!this.colFilter?.isFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){Tb(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){let{source:t,additionalEventAttributes:i,columns:n=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):wt.resolve()).then(()=>{let r={source:t,type:"filterChanged",columns:n};i&&Ii(r,i),this.eventSvc.dispatchEvent(r),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!Tb(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){J(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(let e of this.advFilterModelUpdateQueue)this.setAdvFilterModel(e);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setModelForColumn(e,t)??Promise.resolve()}},yte=class extends j{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,i,n){e&&!e.isColumn||this.showPopup(e,r=>{this.popupSvc?.positionPopupUnderMouseEvent({additionalParams:{column:e},type:i,mouseEvent:t,ePopup:r})},i,t.target,sn(this.gos),n)}showMenuAfterButtonClick(e,t,i,n){if(e&&!e.isColumn)return;let r=-1,o="left",s=sn(this.gos);!s&&this.gos.get("enableRtl")&&(r=1,o="right");let a=s?void 0:4*r,l=s?void 0:4;this.showPopup(e,c=>{this.popupSvc?.positionPopupByComponent({type:i,eventSource:t,ePopup:c,nudgeX:a,nudgeY:l,alignSide:o,keepWithinBounds:!0,position:"under",additionalParams:{column:e}})},i,t,s,n)}showPopup(e,t,i,n,r,o){let s=e?this.createBean(new n$(e,"COLUMN_MENU")):void 0;if(this.activeMenu=s,!s?.hasFilter()||!e){Ze(57);return}let a=Xt({tag:"div",cls:`ag-menu${r?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:g=>this.trapFocusWithin(g,a)}),a.appendChild(s?.getGui());let l,c=()=>s?.afterGuiDetached(),d=lU(this.gos)?n??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,u=g=>{K_(e,!1,"contextMenu");let m=g instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),m&&n&&Ir(n)&&qF(n)?.focus({preventScroll:!0}),c(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,e),o?.()},h=this.getLocaleTextFunc(),p=r&&i!=="columnFilter"?h("ariaLabelColumnMenu","Column Menu"):h("ariaLabelColumnFilter","Column Filter"),f=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:u,positionCallback:()=>t(a),anchorToElement:d,ariaLabel:p});f&&(this.hidePopup=l=f.hideFunc),s.afterInit().then(()=>{t(a),s.afterGuiAttached({container:i,hidePopup:l})}),K_(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,e)}trapFocusWithin(e,t){e.key!==B.TAB||e.defaultPrevented||xa(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),Ca(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,i){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:i??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},Ste=class extends j{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,i){if(!t)return;let n=e.getColDef(),{selectableFilter:r,valueSvc:o,formula:s}=this.beans,a=i??r?.getFilterValueGetter(e.getColId())??n.filterValueGetter;if(a)return this.executeFilterValueGetter(a,t.data,e,t,n);let l=o.getValue(e,t);return e.isAllowFormula()&&s?.isFormula(l)?s.resolveValue(e,t):l}executeFilterValueGetter(e,t,i,n,r){let{expressionSvc:o,valueSvc:s}=this.beans,a=_e(this.gos,{data:t,node:n,column:i,colDef:r,getValue:s.getValueCallback.bind(s,n)});return typeof e=="function"?e(a):o?.evaluate(e,a)}},xte={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},Ete=class extends st{constructor(){super(xte,[bm]),this.eFloatingFilterText=ae}init(e){this.params=e;let t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){let i=e,n=i.getHandler();if(n.getModelAsString){let r=n.getModelAsString(i.model);this.eFloatingFilterText.setValue(r)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){let i=t.getModelAsString(e);this.eFloatingFilterText.setValue(i)}})}refresh(e){this.init(e)}},Jy=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){let i=e.filterOptions??t;this.filterOptions!==i&&(this.filterOptions=i,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){let{filterOptions:e}=this;if(e)for(let t of e){if(typeof t=="string")continue;let i=[["displayKey"],["displayName"],["predicate","test"]],n=r=>r.some(o=>t[o]!=null)?!0:(J(72,{keys:r}),!1);if(!i.every(n)){this.filterOptions=e.filter(r=>r===t)||[];continue}this.customFilterOptions[t.displayKey]=t}}getDefaultItem(e){let{filterOptions:t}=this;if(e)return e;if(t.length>=1){let i=t[0];if(typeof i=="string")return i;if(i.displayKey)return i.displayKey;J(73)}else J(74)}getCustomOption(e){return this.customFilterOptions[e]}};function Lu(e,t,i){return i==null?e.splice(t):e.splice(t,i)}function hm(e){return e==null||typeof e=="string"&&e.trim().length===0}function Rte(e){return e==="AND"||e==="OR"?e:"AND"}function Pte(e,t,i){if(e==null)return;let{predicate:n}=e;if(n!=null&&!t.some(r=>r==null))return n(t,i)}function kte(e,t){let i=e.length;return i>t&&(e.splice(t),J(78),i=t),i}function Yu(e,t){let i=t.getCustomOption(e);if(i){let{numberOfInputs:r}=i;return r??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var Qy=class extends d${constructor(e,t,i){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=i,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);let t=new Jy;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=Rte(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions(),Ui(this.getGui(),"tabindex",this.isReadOnly()?"-1":null)}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,i)=>{let n=i===0?e:this.optionsFactory.defaultOption;t.setValue(n,!0)})}getModelFromUi(){let e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){let{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){let i=!e.operator,n=!t.operator;if(!i&&n||i&&!n)return!1;let o;if(i){let s=e,a=t;o=this.areSimpleModelsEqual(s,a)}else{let s=e,a=t;o=s.operator===a.operator&&hs(s.conditions,a.conditions,(l,c)=>this.areSimpleModelsEqual(l,c))}return o}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),wt.resolve();if(e.operator){let n=e,r=n.conditions;r==null&&(r=[],J(77));let o=kte(r,this.maxNumConditions),s=this.getNumConditions();if(o<s)this.removeConditionsAndOperators(o);else if(o>s)for(let l=s;l<o;l++)this.createJoinOperatorPanel(),this.createOption();let a=n.operator==="OR";this.eJoinAnds.forEach(l=>l.setValue(!a,!0)),this.eJoinOrs.forEach(l=>l.setValue(a,!0)),r.forEach((l,c)=>{this.eTypes[c].setValue(l.type,!0),this.setConditionIntoUi(l,c)})}else{let n=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),wt.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(J(79),t=1),this.maxNumConditions=t;let i=e.numAlwaysVisibleConditions??1;i<1&&(J(80),i=1),i>t&&(J(81),i=t),this.numAlwaysVisibleConditions=i}createOption(){let e=this.getGui(),t=this.createManagedBean(new ky);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());let i=this.createEValue();this.eConditionBodies.push(i),e.appendChild(i),this.putOptionsIntoDropdown(t),this.resetType(t);let n=this.getNumConditions()-1;this.forEachPositionInput(n,r=>this.resetInput(r)),this.addChangedListeners(t,n)}createJoinOperatorPanel(){let e=Xt({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);let t=this.createJoinOperator(this.eJoinAnds,e,"and"),i=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);let n=this.eJoinPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,r),this.resetJoinOperatorOr(i,n,r),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){let n=this.createManagedBean(new zj);e.push(n);let r="ag-filter-condition-operator";return n.addCss(r),n.addCss(`${r}-${i}`),t.appendChild(n.getGui()),n}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){let{filterListOptions:t}=this;for(let i of t)e.addOption(i);e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){let{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){let e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let i=0;i<this.getNumConditions();i++)this.isConditionUiComplete(i)?e=i:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{let i=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<i){this.removeConditionsAndOperators(i+1);let n=e+1,r=i-n;r>0&&this.removeConditionsAndOperators(n,r),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((n,r)=>{let o=this.isConditionDisabled(r,e);n.setDisabled(o||this.filterListOptions.length<=1),r===1&&(Hu(this.eJoinPanels[0],o),this.eJoinAnds[0].setDisabled(o),this.eJoinOrs[0].setDisabled(o))}),this.eConditionBodies.forEach((n,r)=>{ot(n,this.isConditionBodyVisible(r))});let i=(t??this.getJoinOperator())==="OR";for(let n of this.eJoinAnds)n.setValue(!i,!0);for(let n of this.eJoinOrs)n.setValue(i,!0);this.forEachInput((n,r,o,s)=>{this.setElementDisplayed(n,r<s),this.setElementDisabled(n,this.isConditionDisabled(o,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;let{eTypes:i,eConditionBodies:n,eJoinPanels:r,eJoinAnds:o,eJoinOrs:s}=this;this.removeComponents(i,e,t),this.removeElements(n,e,t),this.removeEValues(e,t);let a=Math.max(e-1,0);this.removeElements(r,a,t),this.removeComponents(o,a,t),this.removeComponents(s,a,t)}removeElements(e,t,i){let n=Lu(e,t,i);for(let r of n)Wi(r)}removeComponents(e,t,i){let n=Lu(e,t,i);for(let r of n)Wi(r.getGui()),this.destroyBean(r)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){let t;if(!this.isReadOnly()){let i=this.getInputs(0)[0];i instanceof ca&&this.isConditionBodyVisible(0)?t=i.getInputElement():t=this.eTypes[0]?.getFocusableElement()}(t??this.getGui()).focus({preventScroll:!0})}}shouldKeepInvalidInputState(){return!1}afterGuiDetached(){super.afterGuiDetached();let e=this.params;if(this.beans.colFilter?.shouldKeepStateOnDetach(e.column)||this.shouldKeepInvalidInputState())return;e.onStateChange({model:e.model});let t=-1,i=-1,n=!1,r=this.getJoinOperator();for(let s=this.getNumConditions()-1;s>=0;s--)if(this.isConditionUiComplete(s))t===-1&&(t=s,i=s);else{let a=s>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(s-1),l=s<t;(a||l)&&(this.removeConditionsAndOperators(s,1),n=!0,l&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,r),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getModelAsString(e){return this.params.getHandler()?.getModelAsString?.(e)??""}resetPlaceholder(){let e=this.getLocaleTextFunc(),{filterPlaceholder:t,eTypes:i}=this;this.forEachInput((n,r,o,s)=>{if(!(n instanceof ca))return;let a=r===0&&s>1?"inRangeStart":r===0?"filterOoo":"inRangeEnd",l=r===0&&s>1?e("ariaFilterFromValue","Filter from value"):r===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value"),c=i[o].getValue(),d=p8(this,t,a,c);n.setInputPlaceholder(d),n.setInputAriaLabel(l)})}setElementValue(e,t,i){e instanceof ca&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){P_(e)&&ot(e.getGui(),t)}setElementDisabled(e,t){P_(e)&&Hu(e.getGui(),t)}attachElementOnChange(e,t){e instanceof ca&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,i)=>{this.forEachPositionTypeInput(i,t,e)})}forEachPositionInput(e,t){let i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(e,t,i){let n=Yu(t,this.optionsFactory),r=this.getInputs(e);for(let o=0;o<r.length;o++){let s=r[o];s!=null&&i(s,o,e,n)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){let t=this.getConditionType(e);return Yu(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(i=>i==null)||this.positionHasInvalidInputs(e))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){let e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,i)=>this.resetJoinOperatorAnd(t,i,this.joinOperatorId+i)),this.eJoinOrs.forEach((t,i)=>this.resetJoinOperatorOr(t,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){let i=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),i)}resetJoinOperator(e,t,i,n,r){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${r}`).setLabel(n),t)}updateJoinOperatorsDisabled(){let e=(t,i)=>this.updateJoinOperatorDisabled(t,i);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){let i=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((n,r,o)=>{o===t&&this.setElementValue(n,i[r]!=null?i[r]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,i,n)=>{this.setElementValue(t,i===0&&n===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,i=>{this.attachElementOnChange(i,this.listener)}))}hasInvalidInputs(){return!1}positionHasInvalidInputs(e){return!1}isReadOnly(){return!!this.params.readOnly}},PD=".ag-input-field-input",mM=class{constructor(e,t,i,n,r,o){this.context=e,this.eParent=r,this.alive=!0,this.debouncedReport=Yt({isAlive:()=>this.alive},kD,500),this.timeoutHandle=null,pj(t,i,n)?.newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;r.appendChild(a.getGui()),a?.afterGuiAttached?.();let{tempValue:l,disabled:c}=this;l&&a.setDate(l),c!=null&&a.setDisabled?.(c),o?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){let t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){let t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){ot(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}setCustomValidity(e,t=!1){let i=this.dateComp?.getGui().querySelector(PD);if(i&&"setCustomValidity"in i){let n=e.length>0;i.setCustomValidity(e),n?t?this.timeoutHandle=this.debouncedReport(i):kD(i):this.timeoutHandle&&window.clearTimeout(this.timeoutHandle),ay(i,n)}}getValidity(){return this.dateComp?.getGui().querySelector(PD)?.validity}};function kD(e){e.reportValidity()}var Zy=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function vM(e,t){let{dateFrom:i,dateTo:n,type:r}=e||{};return[i&&qi(i,void 0,!0)||null,n&&qi(n,void 0,!0)||null].slice(0,Yu(r,t))}var _D=1e3,DD=1/0,_te=class extends Qy{constructor(){super("dateFilter",vM,Zy),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=_D,this.maxValidYear=DD,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e),this.refreshInputValidation()}shouldKeepInvalidInputState(){return!qu()&&this.hasInvalidInputs()&&this.getConditionTypes().includes("inRange")}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);let t=(l,c)=>{let d=e[l];if(d!=null)if(isNaN(d))J(82,{param:l});else return d==null?c:Number(d);return c},i=t("minValidYear",_D),n=t("maxValidYear",DD);this.minValidYear=i,this.maxValidYear=n,i>n&&J(83);let{minValidDate:r,maxValidDate:o}=e,s=r instanceof Date?r:qi(r);this.minValidDate=s;let a=o instanceof Date?o:qi(o);this.maxValidDate=a,s&&a&&s>a&&J(84)}refreshInputValidation(){for(let e=0;e<this.dateConditionFromComps.length;e++)this.refreshInputPairValidation(e,!1,!0)}refreshInputPairValidation(e,t=!1,i=!1){let{dateConditionFromComps:n,dateConditionToComps:r,beans:o}=this,s=n[e],a=r[e],l=s.getDate(),c=a.getDate(),d=Dte(l,c,t),u=d?this.translate(d,[String(t?c:l)]):"",h=!qu()&&!i;(t?s:a).setCustomValidity(u,h),(t?a:s).setCustomValidity("",h),u.length>0&&o.ariaAnnounce.announceValue(u,"dateFilter")}createDateCompWrapper(e,t,i){let{beans:{userCompFactory:n,context:r,gos:o},params:s}=this,a=i==="from",l=new mM(r,n,s.colDef,_e(o,{onDateChanged:()=>{this.refreshInputPairValidation(t,a),this.onUiChanged()},onFocusIn:()=>this.refreshInputPairValidation(t,a),filterParams:s,location:"filter"}),e);return this.addDestroyFunc(()=>l.destroy()),l}getState(){return{isInvalid:this.hasInvalidInputs()}}areStatesEqual(e,t){return(e?.isInvalid??!1)===(t?.isInvalid??!1)}setElementValue(e,t){e.setDate(t),t||e.setCustomValidity("")}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){let e=Xt({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,n){let r=Xt({tag:"div",cls:`ag-filter-${n} ag-filter-date-${n}`});t.push(r),e.appendChild(r),i.push(this.createDateCompWrapper(r,t.length-1,n))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),Lu(this.eConditionPanelsFrom,e,t),Lu(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){let n=Lu(e,t,i);for(let r of n)r.destroy()}isValidDateValue(e){if(e===null)return!1;let{minValidDate:t,maxValidDate:i,minValidYear:n,maxValidYear:r}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<n)return!1;if(i){if(e>i)return!1}else if(e.getUTCFullYear()>r)return!1;return!0}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>e||(e=t.getDate()!=null&&!(t.getValidity()?.valid??!0))),e}positionHasInvalidInputs(e){let t=!1;return this.forEachPositionInput(e,i=>t||(t=!(i.getValidity()?.valid??!0))),t}canApply(e){return!this.hasInvalidInputs()}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachPositionInput(e,(i,n,r,o)=>{!t||n>=o||t&&(t=this.isValidDateValue(i.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){let t=this.getConditionType(e),i={},n=this.getValues(e),r=this.params.useIsoSeparator?"T":" ";return n.length>0&&(i.dateFrom=an(n[0],!0,r)),n.length>1&&(i.dateTo=an(n[1],!0,r)),w({dateFrom:null,dateTo:null,filterType:this.filterType,type:t},i)}removeConditionsAndOperators(e,t){if(!this.hasInvalidInputs())return super.removeConditionsAndOperators(e,t)}resetPlaceholder(){let e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(n=>{n.setInputPlaceholder(t),n.setInputAriaLabel(i)})}getInputs(e){let{dateConditionFromComps:t,dateConditionToComps:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,r,o)=>{n<o&&t.push(i.getDate())}),t}translate(e,t){let i=e;return e==="lessThan"?i="before":e==="greaterThan"&&(i="after"),super.translate(i,t)}};function Dte(e,t,i){return e!=null&&t!=null&&e>=t?`${i?"max":"min"}DateValidation`:null}var CM=class extends j{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){let t=e.filterParams,i=new Jy;this.optionsFactory=i,i.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(i,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){let t=e.filterParams,i=this.optionsFactory;i.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:i,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){let t=e.model;if(t==null)return!0;let{operator:i}=t,n=[];if(i){let s=t;n.push(...s.conditions??[])}else n.push(t);let r=i&&i==="OR"?"some":"every",o=this.params.getValue(e.node);return n[r](s=>this.individualConditionPasses(e,s,o))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){let{model:t,filterParams:{filterOptions:i,maxNumConditions:n}}=e;if(t==null)return;let o=m8(t)?t.conditions:[t],s=i?.map(d=>typeof d=="string"?d:d.displayKey)??this.defaultOptions;if(!(!o||o.every(d=>s.find(u=>u===d.type)!==void 0))){this.params=T(w({},e),{model:null}),e.onModelChange(null);return}let l=!1,c=this.filterType;if((o&&!o.every(d=>d.filterType===c)||t.filterType!==c)&&(o=o.map(d=>T(w({},d),{filterType:c})),l=!0),typeof n=="number"&&o&&o.length>n&&(o=o.slice(0,n),l=!0),l){let d=o.length>1?T(w({},t),{filterType:c,conditions:o}):T(w({},o[0]),{filterType:c});this.params=T(w({},e),{model:d}),e.onModelChange(d)}}individualConditionPasses(e,t,i){let n=this.optionsFactory,r=this.mapValuesFromModel(t,n),o=n.getCustomOption(t.type),s=Pte(o,r,i);return s??(i==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(r,i,t,e))}},wM=class extends CM{evaluateNullValue(e){let{includeBlanksInEquals:t,includeBlanksInNotEqual:i,includeBlanksInGreaterThan:n,includeBlanksInLessThan:r,includeBlanksInRange:o}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(i)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(n)return!0;break;case"lessThan":case"lessThanOrEqual":if(r)return!0;break;case"inRange":if(o)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,i){let n=i.type;if(!this.isValid(t))return n==="notEqual"||n==="notBlank";let r=this.comparator(),o=e[0]!=null?r(e[0],t):0;switch(n){case"equals":return o===0;case"notEqual":return o!==0;case"greaterThan":return o>0;case"greaterThanOrEqual":return o>=0;case"lessThan":return o<0;case"lessThanOrEqual":return o<=0;case"inRange":{let s=r(e[1],t);return this.params.filterParams.inRangeInclusive?o>=0&&s<=0:o>0&&s<0}case"blank":return hm(t);case"notBlank":return!hm(t);default:return J(76,{filterModelType:n}),!0}}},bM={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},Fte={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},eS=class extends j{constructor(e,t,i){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=i}getModelAsString(e,t){let i=this.getLocaleTextFunc(),n=t==="filterToolPanel";if(!e)return n?Pr(this,"filterSummaryInactive"):null;if(e.operator!=null){let o=e,a=(o.conditions??[]).map(c=>this.getModelAsString(c,t)),l=o.operator==="AND"?"andCondition":"orCondition";return a.join(` ${Pr(this,l)} `)}else{if(e.type==="blank"||e.type==="notBlank")return n?Pr(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):i(e.type,e.type);{let o=e,s=this.optionsFactory.getCustomOption(o.type),{displayKey:a,displayName:l,numberOfInputs:c}=s||{};return a&&l&&c===0?i(a,l):this.conditionToString(o,n,o.type==="inRange"||c===2,a,l)}}}updateParams(e){let{optionsFactory:t,filterParams:i}=e;this.optionsFactory=t,this.filterParams=i}conditionForToolPanel(e,t,i,n,r,o){let s,a=this.getTypeKey(e);return a&&(s=Pr(this,a)),r&&o&&(s=this.getLocaleTextFunc()(r,o)),s!=null?t?`${s} ${Pr(this,"filterSummaryInRangeValues",[i(),n()])}`:`${s} ${i()}`:null}getTypeKey(e){let t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){let t=this.valueFormatter;return t?t(e??null)??"":String(e)}},yM=class extends eS{constructor(e,t){super(e,t,i=>{let{dataTypeSvc:n,valueSvc:r}=this.beans,o=t.column,s=n?.getDateFormatterFunction(o),a=s?s(i??void 0):i;return r.formatValue(o,null,a)}),this.filterTypeKeys=bM}conditionToString(e,t,i,n,r){let{type:o}=e,s=qi(e.dateFrom),a=qi(e.dateTo),l=this.filterParams.inRangeFloatingFilterDateFormat,c=t?this.formatValue.bind(this):h=>Hb(h,l),d=()=>s!==null?c(s):"null",u=()=>a!==null?c(a):"null";if(t){let h=this.conditionForToolPanel(o,i,d,u,n,r);if(h!=null)return h}return i?`${d()}-${u()}`:s!=null?c(s):`${o}`}};function Mte(e,t){let i=t;return i<e?-1:i>e?1:0}var Tte=class extends wM{constructor(){super(vM,Zy),this.filterType="date",this.FilterModelFormatterClass=yM}comparator(){return this.params.filterParams.comparator??Mte}isValid(e){let t=this.params.filterParams.isValidDate;return!t||t(e)}},SM=class extends st{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}let t=e.operator,i;t?i=e.conditions[0]:i=e,this.lastType=i.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;let i=e;return this.isTypeEditable(i.type)}init(e){this.params=e;let t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){let i=e;this.onModelUpdated(i.model)}}setParams(e){let t=new Jy;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){let i=this.optionsFactory.defaultOption;t||(this.lastType=i),this.readOnly=!!e.filterParams.readOnly;let n=this.isTypeEditable(i);this.setEditable(n)}refresh(e){this.params=e;let t=e,i=this.reactive;if((!i||t.source==="colDef")&&this.updateParams(e),i){let{source:n,model:r}=t;if(n==="dataChanged"||n==="ui")return;this.onModelUpdated(r)}}updateParams(e){let t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){let t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){let t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},Ite={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},Ate=class extends SM{constructor(){super(Ite,[bm]),this.eReadOnlyText=ae,this.eDateWrapper=ae,this.FilterModelFormatterClass=yM,this.filterType="date",this.defaultOptions=Zy}setParams(e){super.setParams(e),this.createDateComponent();let t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){let t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){let i=e?qi(e.dateFrom):null;this.dateComp.setDate(i),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){ot(this.eDateWrapper,e),ot(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){let e=this.dateComp.getDate();if(this.reactive){let t=this.params;t.onUiChange();let i=t.model,n=an(e),r=n==null?null:T(w({},i??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption}),{dateFrom:n});t.onModelChange(r,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t?.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){let{filterParams:e}=this.params,t=Ty(e,this.defaultDebounceMs);return _e(this.gos,{onDateChanged:Yt(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){let{beans:{context:e,userCompFactory:t},eDateWrapper:i,params:{column:n}}=this;this.dateComp=new mM(e,t,n.getColDef(),this.getDateComponentParams(),i,r=>{r.setInputAriaLabel(this.getAriaLabel(n))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},Ote={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},Lte=class extends st{constructor(){super(Ote,[bm]),this.eDateInput=ae,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);let t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this),focusin:this.handleFocusIn.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}handleFocusIn(){this.params.onFocusIn?.()}setParams(e){let t=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=i&&fs();let{minValidYear:n,maxValidYear:r,minValidDate:o,maxValidDate:s,buttons:a,includeTime:l,colDef:c}=e.filterParams||{},d=this.beans.dataTypeSvc,u=l??d?.getDateIncludesTimeFlag?.(c.cellDataType)??!1;if(i?u?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",o&&n&&J(85),s&&r&&J(86),o&&s){let[h,p]=[o,s].map(f=>f instanceof Date?f:qi(f));h&&p&&h.getTime()>p.getTime()&&J(87)}o?o instanceof Date?t.min=Hb(o):t.min=o:n&&(t.min=`${n}-01-01`),s?s instanceof Date?t.max=Hb(s):t.max=s:r&&(t.max=`${r}-12-31`),this.isApply=e.location==="floatingFilter"&&!!a?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return qi(this.eDateInput.getValue())}setDate(e){let t=this.params.filterParams.colDef.cellDataType,i=this.beans.dataTypeSvc?.getDateIncludesTimeFlag(t)??!1;this.eDateInput.setValue(an(e,i))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e?.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},tS=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function iy(e){return e?.allowedCharPattern??null}function pm(e){return e==null||isNaN(e)?null:e}function xM(e,t){let{filter:i,filterTo:n,type:r}=e||{};return[pm(i),pm(n)].slice(0,Yu(r,t))}var Nte=class extends Qy{constructor(){super("numberFilter",xM,tS),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}afterGuiAttached(e){super.afterGuiAttached(e),this.refreshInputValidation()}shouldKeepInvalidInputState(){return!qu()&&this.hasInvalidInputs()&&this.getConditionTypes().includes("inRange")}refreshInputValidation(){for(let e=0;e<this.eValuesFrom.length;e++){let t=this.eValuesFrom[e],i=this.eValuesTo[e];this.refreshInputPairValidation(t,i)}}refreshInputPairValidation(e,t,i=!1){let n=this.params.numberParser,r=FD(n,e),o=FD(n,t),s=Bte(r,o,i),a=s?this.translate(s,[String(i?o:r)]):"";(i?e:t).setCustomValidity(a),(i?t:e).setCustomValidity(""),a.length>0&&this.beans.ariaAnnounce.announceValue(a,"dateFilter")}getState(){return{isInvalid:this.hasInvalidInputs()}}areStatesEqual(e,t){return(e?.isInvalid??!1)===(t?.isInvalid??!1)}refresh(e){let t=super.refresh(e),{state:i,additionalEventAttributes:n}=e,r=this.state,o=n?.fromAction;return(o&&o!="apply"||i.model!==r.model||!this.areStatesEqual(i.state,r.state))&&this.refreshInputValidation(),t}setElementValue(e,t,i){let{numberFormatter:n}=this.params,r=!i&&n?n(t??null):t;super.setElementValue(e,r),r===null&&e.setCustomValidity("")}createEValue(){let{params:e,eValuesFrom:t,eValuesTo:i}=this,n=iy(e),r=Xt({tag:"div",cls:"ag-filter-body",role:"presentation"}),o=this.createFromToElement(r,t,"from",n),s=this.createFromToElement(r,i,"to",n),a=(d,u,h)=>()=>this.refreshInputPairValidation(d,u,h),l=a(o,s,!0);o.onValueChange(l),o.addGuiEventListener("focusin",l);let c=a(o,s,!1);return s.onValueChange(c),s.addGuiEventListener("focusin",c),r}createFromToElement(e,t,i,n){let r=this.createManagedBean(n?new Ea({allowedCharPattern:n}):new Py);return r.addCss(`ag-filter-${i}`),r.addCss("ag-filter-filter"),t.push(r),e.appendChild(r.getGui()),r}removeEValues(e,t){let i=n=>this.removeComponents(n,e,t);i(this.eValuesFrom),i(this.eValuesTo)}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,r,o)=>{n<o&&t.push(pm(EM(this.params.numberParser,i.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}removeConditionsAndOperators(e,t){if(!this.hasInvalidInputs())return super.removeConditionsAndOperators(e,t)}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>e||(e=!t.getInputElement().validity.valid)),e}positionHasInvalidInputs(e){let t=!1;return this.forEachPositionInput(e,i=>t||(t=!i.getInputElement().validity.valid)),t}canApply(e){return!this.hasInvalidInputs()}};function EM(e,t){if(typeof t=="number")return t;let i=ao(t);return i!=null&&i.trim()===""&&(i=null),e?e(i):i==null||i.trim()==="-"?null:Number.parseFloat(i)}function FD(e,t){return pm(EM(e,t.getValue(!0)))}function Bte(e,t,i){return e!=null&&t!=null&&e>=t?`strict${i?"Max":"Min"}ValueValidation`:null}var RM=class extends eS{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=bM}conditionToString(e,t,i,n,r){let{filter:o,filterTo:s,type:a}=e,l=this.formatValue.bind(this);if(t){let c=this.conditionForToolPanel(a,i,()=>l(o),()=>l(s),n,r);if(c!=null)return c}return i?`${l(o)}-${l(s)}`:o!=null?l(o):`${a}`}},Hte=class extends wM{constructor(){super(xM,tS),this.filterType="number",this.FilterModelFormatterClass=RM}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},PM=class extends j{constructor(e){super(),this.params=e,this.eInput=ae,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new Ea(this.params?.config));let t=this.eInput.getGui();e.appendChild(t);let i=n=>this.onValueChanged(n);this.addManagedListeners(t,{input:i,keydown:i})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t,placeholder:i}){let{eInput:n}=this;n.setInputAriaLabel(e),t!==void 0&&n.setAutoComplete(t),n.toggleCss("ag-floating-filter-search-icon",!!i),n.setInputPlaceholder(i)}};function ny(e){let t=e?.trim();return t===""?e:t}function kM(e,t){let{filter:i,filterTo:n,type:r}=e||{};return[i||null,n||null].slice(0,Yu(r,t))}var zte={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},_M=class extends SM{constructor(){super(...arguments),this.eFloatingFilterInputContainer=ae,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(zte)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){let{inputSvc:t,defaultDebounceMs:i,readOnly:n}=this,{filterPlaceholder:r,column:o,browserAutoComplete:s,filterParams:a}=e,l=this.lastType??this.optionsFactory.defaultOption,c=e.filterParams.filterPlaceholder,d=r===!0?p8(this,c,"filterOoo",l):r||void 0;if(t.setParams({ariaLabel:this.getAriaLabel(o),autoComplete:s??!1,placeholder:d}),this.applyActive=Sm(a),!n){let u=Ty(a,i);t.setValueChangedListener(Yt(this,this.syncUpWithParentFilter.bind(this),u))}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){let{inputSvc:t}=this,i=t.getValue();ii(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(i,!0)}syncUpWithParentFilter(e){let t=e.key===B.ENTER,i=this.reactive;if(i&&this.params.onUiChange(),this.applyActive&&!t)return;let{inputSvc:n,params:r,lastType:o}=this,s=n.getValue();if(r.filterParams.trimInput&&(s=ny(s),n.setValue(s,!0)),i){let a=r,l=a.model,c=this.convertValue(s),d=c==null?null:T(w({},l??{filterType:this.filterType,type:o??this.optionsFactory.defaultOption}),{filter:c});a.onModelChange(d,{afterFloatingFilter:!0})}else r.parentFilterInstance(a=>{a?.onFloatingFilterChanged(o||null,s||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},Vte=class extends j{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new Py),this.eTextInput=this.createManagedBean(new Ea),this.eTextInput.setDisabled(!0);let t=this.eNumberInput.getGui(),i=this.eTextInput.getGui();e.appendChild(t),e.appendChild(i),this.setupListeners(t,n=>this.onValueChanged(n)),this.setupListeners(i,n=>this.onValueChanged(n))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams({ariaLabel:e,autoComplete:t,placeholder:i}){this.setAriaLabel(e),t!==void 0&&this.setAutoComplete(t),this.setPlaceholder(this.eNumberInput,i),this.setPlaceholder(this.eTextInput,i)}setPlaceholder(e,t){e.toggleCss("ag-floating-filter-search-icon",!!t),e.setInputPlaceholder(t)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},Gte=class extends _M{constructor(){super(...arguments),this.FilterModelFormatterClass=RM,this.filterType="number",this.defaultOptions=tS}updateParams(e){iy(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=iy(e.filterParams),this.allowedCharPattern?this.createManagedBean(new PM({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Vte)}convertValue(e){return e?Number(e):null}},iS=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],Wte=class extends Qy{constructor(){super("textFilter",kM,iS),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,n,r,o)=>{n<o&&t.push(ao(i.getValue()))}),t}createEValue(){let e=Xt({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:i}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,i,"to"),e}createFromToElement(e,t,i){let n=this.createManagedBean(new Ea);n.addCss(`ag-filter-${i}`),n.addCss("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeEValues(e,t){let i=o=>this.removeComponents(o,e,t),{eValuesFrom:n,eValuesTo:r}=this;i(n),i(r)}},DM=class extends eS{constructor(){super(...arguments),this.filterTypeKeys=Fte}conditionToString(e,t,i,n,r){let{filter:o,filterTo:s,type:a}=e;if(t){let l=d=>()=>Pr(this,"filterSummaryTextQuote",[d]),c=this.conditionForToolPanel(a,i,l(o),l(s),n,r);if(c!=null)return c}return i?`${o}-${s}`:o!=null?`${o}`:`${a}`}},Ute=({filterOption:e,value:t,filterText:i})=>{if(i==null)return!1;switch(e){case"contains":return t.includes(i);case"notContains":return!t.includes(i);case"equals":return t===i;case"notEqual":return t!=i;case"startsWith":return t.indexOf(i)===0;case"endsWith":{let n=t.lastIndexOf(i);return n>=0&&n===t.length-i.length}default:return!1}},jte=e=>e,qte=e=>e==null?null:e.toString().toLowerCase(),$te=class extends CM{constructor(){super(kM,iS),this.filterType="text",this.FilterModelFormatterClass=DM}updateParams(e){super.updateParams(e);let t=e.filterParams;this.matcher=t.textMatcher??Ute,this.formatter=t.textFormatter??(t.caseSensitive?jte:qte)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,i,n){let r=e.map(h=>this.formatter(h))||[],o=this.formatter(t),{api:s,colDef:a,column:l,context:c,filterParams:{textFormatter:d}}=this.params;if(i.type==="blank")return hm(t);if(i.type==="notBlank")return!hm(t);let u={api:s,colDef:a,column:l,context:c,node:n.node,data:n.data,filterOption:i.type,value:o,textFormatter:d};return r.some(h=>this.matcher(T(w({},u),{filterText:h})))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){let t=i=>{let n=w({},i),{filter:r,filterTo:o}=i;return r&&(n.filter=ny(r)??null),o&&(n.filterTo=ny(o)??null),n};return m8(e)?T(w({},e),{conditions:e.conditions.map(t)}):t(e)}return e}},Kte=class extends _M{constructor(){super(...arguments),this.FilterModelFormatterClass=DM,this.filterType="text",this.defaultOptions=iS}createFloatingFilterInputService(){return this.createManagedBean(new PM)}};function Yte(e){return!!e.quickFilter?.isFilterPresent()}function Xte(e){return e.quickFilter?.getText()}function Jte(e){e.quickFilter?.resetCache()}var Qte=class extends j{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){let e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",i=>this.setFilter(i.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){let{autoColSvc:e,colModel:t,gos:i,pivotResultCols:n}=this.beans,r=t.isPivotMode(),o=e?.getColumns(),s=t.getColDefCols(),a=(r&&!i.get("applyQuickFilterBeforePivotOrAgg")?n?.getPivotResultCols()?.list:s)??[];o&&(a=a.concat(o)),this.colsToUse=i.get("includeHiddenColumnsInQuickFilter")?a:a.filter(l=>l.isVisible()||l.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){let t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(i=>t?this.doesRowPassCache(e,i):this.doesRowPassNoCache(e,i))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){let{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return pe(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){J(70,{newFilter:e});return}let t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){let e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),i=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,i&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(i=>{let n=this.getTextForColumn(i,e);return pe(n)&&n.includes(t)})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.includes(t)}doesRowPassMatcher(e,t){let i;e?(this.checkGenerateAggText(t),i=t.quickFilterAggregateText):i=this.getAggText(t);let{quickFilterParts:n,matcher:r}=this;return r(n,i)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let i=this.beans.filterValueSvc.getValue(e,t),n=e.getColDef();if(n.getQuickFilterText){let r=_e(this.gos,{value:i,node:t,data:t.data,column:e,colDef:n});i=n.getQuickFilterText(r)}return pe(i)?i.toString().toUpperCase():null}getAggText(e){let t=[];for(let i of this.colsToUse){let n=this.getTextForColumn(i,e);pe(n)&&t.push(n)}return t.join(`
`)}},Zte={moduleName:"ClientSideRowModelFilter",version:fe,rowModels:["clientSide"],beans:[Qee]},nS={moduleName:"FilterCore",version:fe,beans:[bte],apiFunctions:{isAnyFilterPresent:Cte,onFilterChanged:wte},css:[rte],dependsOn:[Zte]},FM={moduleName:"FilterValue",version:fe,beans:[Ste]},Dm={moduleName:"ColumnFilter",version:fe,beans:[vte,yte],dynamicBeans:{headerFilterCellCtrl:Zee},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:ote,getColumnFilterInstance:ste,destroyFilter:ate,setFilterModel:lte,getFilterModel:cte,getColumnFilterModel:dte,setColumnFilterModel:ute,showColumnFilter:hte,hideColumnFilter:pte,getColumnFilterHandler:fte,doFilterAction:gte},dependsOn:[nS,_m,FM,ite]},eie={moduleName:"CustomFilter",version:fe,userComponents:{agReadOnlyFloatingFilter:Ete},dependsOn:[Dm]},tie={moduleName:"TextFilter",version:fe,dependsOn:[Dm],userComponents:{agTextColumnFilter:{classImp:Wte,params:{useForm:!0}},agTextColumnFloatingFilter:Kte},dynamicBeans:{agTextColumnFilterHandler:$te}},iie={moduleName:"NumberFilter",version:fe,dependsOn:[Dm],userComponents:{agNumberColumnFilter:{classImp:Nte,params:{useForm:!0}},agNumberColumnFloatingFilter:Gte},dynamicBeans:{agNumberColumnFilterHandler:Hte}},nie={moduleName:"DateFilter",version:fe,dependsOn:[Dm],userComponents:{agDateColumnFilter:{classImp:_te,params:{useForm:!0}},agDateInput:Lte,agDateColumnFloatingFilter:Ate},dynamicBeans:{agDateColumnFilterHandler:Tte}},rie={moduleName:"QuickFilterCore",version:fe,rowModels:["clientSide"],beans:[Qte],dependsOn:[nS,FM]},oie={moduleName:"QuickFilter",version:fe,apiFunctions:{isQuickFilterPresent:Yte,getQuickFilter:Xte,resetQuickFilter:Jte},dependsOn:[rie]},sie={moduleName:"ExternalFilter",version:fe,dependsOn:[nS]},aie=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip),&:where(.ag-cell-formula-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",xb=(e,t,i)=>{let{editModelSvc:n}=e,r=n?.getCellValidationModel()?.getCellValidation(t)?.errorMessages,o=n?.getRowValidationModel().getRowValidation(t)?.errorMessages,s=r||o;return s?.length?s.join(i("tooltipValidationErrorSeparator",". ")):void 0},lie=class extends j{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,i,n){e&&t.destroyBean(e);let r=this.gos,o=Sb(r),{column:s,eGui:a}=t,l=s.getColDef();!n&&o&&!l.headerComponent&&(n=Dg(()=>a.querySelector(".ag-header-cell-text")));let c="header",u=this.beans.colNames.getDisplayNameForColumn(s,"header",!0),h=i??u,p={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(_e(r,{location:c,colDef:l,column:s,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>({column:s,colDef:s.getColDef()})},f=this.createTooltipFeature(p);return f&&(f=t.createBean(f),t.setRefreshFunction("tooltip",()=>f.refreshTooltip())),f}setupHeaderGroupTooltip(e,t,i,n){e&&t.destroyBean(e);let r=this.gos,o=Sb(r),{column:s,eGui:a}=t,l=s.getColGroupDef();!n&&o&&!l?.headerGroupComponent&&(n=Dg(()=>a.querySelector(".ag-header-group-text")));let c="headerGroup",u=this.beans.colNames.getDisplayNameForColumnGroup(s,"header"),h=i??u,p={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>i??l?.headerTooltipValueGetter?.(_e(r,{location:c,colDef:l,column:s,value:h,valueFormatted:u}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>{let g={column:s};return l&&(g.colDef=l),g}},f=this.createTooltipFeature(p);return f&&t.createBean(f)}enableCellTooltipFeature(e,t,i){let{beans:n}=this,{gos:r,editSvc:o}=n,{column:s,rowNode:a}=e,l="cell",c=()=>{let p=!!!o?.isEditing(e)&&xb(n,e,this.getLocaleTextFunc());if(p)return l="cellEditor",p;l="cell";let f=s.getColDef(),g=a.data;if(f.tooltipField&&pe(g))return Au(g,f.tooltipField,s.isTooltipFieldContainsDots());let m=f.tooltipValueGetter;return m?m(_e(r,{location:"cell",colDef:s.getColDef(),column:s,rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,value:e.value,valueFormatted:e.valueFormatted})):null},d=Sb(r);i||(d&&!e.isCellRenderer()?i=()=>{let h=!!o?.isEditing(e);if(!h&&xb(n,e,this.getLocaleTextFunc()))return!0;if(!s.isTooltipEnabled())return!1;let g=Dg(()=>{let m=e.eGui;return m.children.length===0?m:m.querySelector(".ag-cell-value")});return!h&&g()}:i=()=>!o?.isEditing(e));let u={getGui:()=>e.eGui,getLocation:()=>l,getTooltipValue:t!=null?()=>t:c,shouldDisplayTooltip:i,getAdditionalParams:()=>({column:s,colDef:s.getColDef(),rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(u,n)}setupFullWidthRowTooltip(e,t,i,n){let r={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>i,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:n},o=this.beans,s=o.context;e&&t.destroyBean(e,s);let a=this.createTooltipFeature(r,o);if(a)return t.createBean(a,s)}setupFormulaTooltip(e){let{beans:t}=this,{context:i,formula:n}=t;if(!this.beans.formula?.active||!e.column.isAllowFormula())return;let r={getGui:()=>e.eGui,getTooltipValue:()=>{let s=n?.getFormulaError(e.column,e.rowNode);return s?s.message:void 0},getLocation:()=>"cellFormula",shouldDisplayTooltip:()=>!!n?.getFormulaError(e.column,e.rowNode)},o=this.createTooltipFeature(r,t);if(o)return e.createBean(o,i)}setupCellEditorTooltip(e,t){let{beans:i}=this,{context:n}=i,r=t.getValidationElement?.(!0)||!t.isPopup?.()&&e.eGui;if(!r)return;let o={getGui:()=>r,getTooltipValue:()=>xb(i,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{let{editModelSvc:a}=i,l=a?.getRowValidationModel()?.getRowValidationMap(),c=a?.getCellValidationModel()?.getCellValidationMap(),d=!!l&&l.size>0,u=!!c&&c.size>0;return d||u}},s=this.createTooltipFeature(o,i);if(s)return e.createBean(s,n)}initCol(e){let{colDef:t}=e;e.tooltipEnabled=pe(t.tooltipField)||pe(t.tooltipValueGetter)||pe(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},cie=class extends Iq{createTooltipComp(e,t){fj(this.beans.userCompFactory,e)?.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){this.onColumnMovedEventCallback?.(),this.onColumnMovedEventCallback=void 0}},MM={moduleName:"Tooltip",version:fe,beans:[lie],dynamicBeans:{tooltipFeature:s8,highlightTooltipFeature:Aq,tooltipStateManager:cie},userComponents:{agTooltipComponent:Nq},dependsOn:[_m],css:[aie]},Il=class{constructor(e){this.cellValueChanges=e}},Eb=class extends Il{constructor(e,t,i,n){super(e),this.initialRange=t,this.finalRange=i,this.ranges=n}},die=10,MD=class{constructor(e){this.actionStack=[],this.maxStackSize=e||die,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},uie=class extends j{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{let t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=this.activeCellEdit!==null&&Ly(this.activeCellEdit,t),n=this.activeRowEdit!==null&&q$(this.activeRowEdit,t);if(!(i||n||this.isPasting||this.isRangeInAction))return;let{rowPinned:o,rowIndex:s,column:a,oldValue:l,value:c}=e,d={rowPinned:o,rowIndex:s,columnId:a.getColId(),newValue:c,oldValue:l};this.cellValueChanges.push(d)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){let{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;let i=e.get("undoRedoCellEditingLimit");if(i<=0)return;this.undoStack=new MD(i),this.redoStack=new MD(i),this.addListeners();let n=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:r=>{r.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:n,newColumnsLoaded:n,columnGroupOpened:n,columnRowGroupChanged:n,columnMoved:n,columnPinned:n,columnVisible:n,rowDragEnd:n}),t.whenReady(this,r=>{this.gridBodyCtrl=r.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){let{eventSvc:t,undoStack:i,redoStack:n}=this;t.dispatchEvent({type:"undoStarted",source:e});let r=this.undoRedo(i,n,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:r})}redo(e){let{eventSvc:t,undoStack:i,redoStack:n}=this;t.dispatchEvent({type:"redoStarted",source:e});let r=this.undoRedo(n,i,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:r})}undoRedo(e,t,i,n,r){if(!e)return!1;let o=e.pop();return o?.cellValueChanges?(this.processAction(o,s=>s[n],r),o instanceof Eb?this.processRange(o.ranges||[o[i]]):this.processCell(o.cellValueChanges),t.push(o),!0):!1}processAction(e,t,i){for(let n of e.cellValueChanges){let{rowIndex:r,rowPinned:o,columnId:s}=n,a={rowIndex:r,rowPinned:o},l=fo(this.beans,a);l.displayed&&l.setDataValue(s,t(n),i)}}processRange(e){let t,i=this.beans.rangeSvc;i.removeAllCellRanges(!0),e.forEach((n,r)=>{if(!n)return;let o=n.startRow,s=n.endRow;r===e.length-1&&(t={rowPinned:o.rowPinned,rowIndex:o.rowIndex,columnId:n.startColumn.getColId()},this.setLastFocusedCell(t));let a={rowStartIndex:o.rowIndex,rowStartPinned:o.rowPinned,rowEndIndex:s.rowIndex,rowEndPinned:s.rowPinned,columnStart:n.startColumn,columns:n.columns};i.addCellRange(a)})}processCell(e){let t=e[0],{rowIndex:i,rowPinned:n}=t,r={rowIndex:i,rowPinned:n},o=fo(this.beans,r),s={rowPinned:t.rowPinned,rowIndex:o.rowIndex,columnId:t.columnId};this.setLastFocusedCell(s)}setLastFocusedCell(e){let{rowIndex:t,columnId:i,rowPinned:n}=e,{colModel:r,focusSvc:o,rangeSvc:s}=this.beans,a=r.getCol(i);if(!a)return;let{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);let c={rowIndex:t,column:a,rowPinned:n};o.setFocusedCell(T(w({},c),{forceBrowserFocus:!0})),s?.setRangeToCell(c)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{let e=new Il(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){let i=new Il(this.cellValueChanges);this.pushActionsToUndoStack(i)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{let e=new Il(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{let t=new Eb(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e,{rangeSvc:t,gos:i}=this.beans;t&&ho(i)?e=new Eb(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new Il(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this.updateBigChange(e,!0)}updateBigChange(e,t){e==="bulkEditing"?this.bulkEditing=t:this.batchEditing=t}stopBigChange(e,t){if(e==="bulkEditing"&&!this.bulkEditing||e==="batchEditing"&&!this.batchEditing||(this.updateBigChange(e,!1),t?.length===0))return;let i=new Il(t??[]);this.pushActionsToUndoStack(i),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},hie=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",pie={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},fie=class extends Em{constructor(){super(pie,[Ry]),this.eEditor=ae}initialiseEditor(e){let t=e.value??void 0,i=this.eEditor;i.setValue(t),i.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(i,{fieldValueChanged:r=>this.setAriaLabel(r.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){let t=this.getLocaleTextFunc(),i=gm(t,e),n=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${n} (${i})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{getValidationErrors:t}=e,i=this.getValue();return t?t({value:i,internalErrors:null,cellEditorParams:e}):null}},Fm=class extends Em{constructor(e){super(),this.cellEditorInput=e,this.eEditor=ae}initialiseEditor(e){let{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());let{eEditor:i}=this,{cellStartedEdit:n,eventKey:r,suppressPreventDefault:o}=e;i.getInputElement().setAttribute("title",""),t.init(i,e);let s,a=!0;n?(this.focusAfterAttached=!0,r===B.BACKSPACE||r===B.DELETE?s="":r&&r.length===1?o?a=!1:s=r:(s=t.getStartValue(),r!==B.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,s=t.getStartValue()),a&&s!=null&&i.setStartValue(s),this.addGuiEventListener("keydown",l=>{let{key:c}=l;(c===B.PAGE_UP||c===B.PAGE_DOWN)&&l.preventDefault()})}afterGuiAttached(){let e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;fs()||t.getFocusableElement().focus();let i=t.getInputElement();this.highlightAllOnFocus?i.select():this.cellEditorInput.setCaret?.()}focusIn(){let{eEditor:e}=this,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},gie={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},mie=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return gie}getAgComponents(){return[JF]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:n,step:r,colDef:o}=t;i!=null&&e.setMin(i),n!=null&&e.setMax(n),r!=null&&e.setStep(r),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(o.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let t=this.eEditor.getInputElement().valueAsDate,{params:i}=this,{min:n,max:r,getValidationErrors:o}=i,s=[],a=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(n){let l=n instanceof Date?n:new Date(n);if(t<l){let c=l.toLocaleDateString();s.push(a("minDateValidation",`Date must be after ${c}`,[c]))}}if(r){let l=r instanceof Date?r:new Date(r);if(t>l){let c=l.toLocaleDateString();s.push(a("maxDateValidation",`Date must be before ${c}`,[c]))}}}return s.length||(s=null),o?o({value:t,cellEditorParams:i,internalErrors:s}):s}getValue(){let{eEditor:e,params:t}=this,i=e.getDate();return!pe(i)&&!pe(t.value)?t.value:i??null}getStartValue(){let{value:e}=this.params;if(e instanceof Date)return an(e,this.includeTime??!1)}},vie=class extends Fm{constructor(){super(new mie(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},Cie={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},wie=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return Cie}getAgComponents(){return[JF]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:n,step:r,colDef:o}=t;i!=null&&e.setMin(i),n!=null&&e.setMax(n),r!=null&&e.setStep(r),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(o.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let{eEditor:e,params:t}=this,i=e.getInputElement().value,n=this.formatDate(this.parseDate(i??void 0)),{min:r,max:o,getValidationErrors:s}=t,a=[];if(n){let l=new Date(n),c=this.getLocaleTextFunc();if(r){let d=new Date(r);if(l<d){let u=d.toLocaleDateString();a.push(c("minDateValidation",`Date must be after ${u}`,[u]))}}if(o){let d=new Date(o);if(l>d){let u=d.toLocaleDateString();a.push(c("maxDateValidation",`Date must be before ${u}`,[u]))}}}return a.length||(a=null),s?s({value:this.getValue(),cellEditorParams:t,internalErrors:a}):a}getValue(){let{params:e,eEditor:t}=this,i=this.formatDate(t.getDate());return!pe(i)&&!pe(e.value)?e.value:e.parseValue(i??"")}getStartValue(){return an(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){let t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):qi(e)??void 0}formatDate(e){let t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):an(e??null,this.includeTime??!1)??void 0}},bie=class extends Fm{constructor(){super(new wie(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},yie={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},Sie=class extends Em{constructor(){super(yie,[Gj]),this.eEditor=ae}initialiseEditor(e){let{eEditor:t}=this,{cellStartedEdit:i,eventKey:n,maxLength:r,cols:o,rows:s}=e;this.focusAfterAttached=i,t.getInputElement().setAttribute("title",""),t.setMaxLength(r||200).setCols(o||60).setRows(s||10);let a;i?(this.focusAfterAttached=!0,n===B.BACKSPACE||n===B.DELETE?a="":n&&n.length===1?a=n:(a=this.getStartValue(e),n!==B.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(e)),a!=null&&t.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){let{value:t}=e;return t?.toString()??t}onKeyDown(e){let t=e.key;(t===B.LEFT||t===B.UP||t===B.RIGHT||t===B.DOWN||e.shiftKey&&t===B.ENTER)&&e.stopPropagation()}afterGuiAttached(){let{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:i}=this,n=this.getLocaleTextFunc();e.setInputAriaLabel(n("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),i&&e.getInputElement().select())}getValue(){let{eEditor:e,params:t}=this,{value:i}=t,n=e.getValue();return!pe(n)&&!pe(i)?i:t.parseValue(n)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,n=this.getLocaleTextFunc(),r=this.getValue(),o=[];return typeof r=="string"&&t!=null&&r.length>t&&o.push(n("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),o.length||(o=null),i?i({value:r,internalErrors:o,cellEditorParams:e}):o}},xie={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},Eie=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return xie}getAgComponents(){return[Wj]}init(e,t){this.eEditor=e,this.params=t;let{max:i,min:n,precision:r,step:o}=t;i!=null&&e.setMax(i),n!=null&&e.setMin(n),r!=null&&e.setPrecision(r),o!=null&&e.setStep(o);let s=e.getInputElement();t.preventStepping?e.addManagedElementListeners(s,{keydown:this.preventStepping}):t.showStepperButtons&&s.classList.add("ag-number-field-input-stepper")}getValidationErrors(){let{params:e}=this,{min:t,max:i,getValidationErrors:n}=e,o=this.eEditor.getInputElement().valueAsNumber,s=this.getLocaleTextFunc(),a=[];return typeof o=="number"&&(t!=null&&o<t&&a.push(s("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),i!=null&&o>i&&a.push(s("maxValueValidation",`Must be less than or equal to ${i}.`,[String(i)]))),a.length||(a=null),n?n({value:o,cellEditorParams:e,internalErrors:a}):a}preventStepping(e){(e.key===B.UP||e.key===B.DOWN)&&e.preventDefault()}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();if(!pe(i)&&!pe(t.value))return t.value;let n=t.parseValue(i);if(n==null)return n;if(typeof n=="string"){if(n==="")return null;n=Number(n)}return isNaN(n)?null:n}getStartValue(){return this.params.value}setCaret(){fs()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},Rie=class extends Fm{constructor(){super(new Eie(()=>this.getLocaleTextFunc()))}},Pie={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},kie=class extends Em{constructor(){super(Pie,[eq]),this.eEditor=ae,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;let{eEditor:t,valueSvc:i,gos:n}=this,{values:r,value:o,eventKey:s}=e;if(mt(r)){J(58);return}this.startedByEnter=s!=null?s===B.ENTER:!1;let a=!1;r.forEach(u=>{let h={value:u},p=i.formatValue(e.column,null,u),f=p!=null;h.text=f?p:u,t.addOption(h),a=a||o===u}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);let{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:d}=e;l!=null&&t.setPickerGap(l),d!=null&&t.setPickerMaxHeight(d),c!=null&&t.setPickerMaxWidth(c),n.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){let{params:e}=this,{values:t,getValidationErrors:i}=e,n=this.getValue(),r=[];if(t&&!t.includes(n)){let o=this.getLocaleTextFunc();r.push(o("invalidSelectionValidation","Invalid selection."))}else r=null;return i?i({value:n,internalErrors:r,cellEditorParams:e}):r}},_ie={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},Die=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return _ie}getAgComponents(){return[bm]}init(e,t){this.eEditor=e,this.params=t;let i=t.maxLength;i!=null&&e.setMaxLength(i)}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,n=this.getValue(),r=this.getLocaleTextFunc(),o=[];return t!=null&&typeof n=="string"&&n.length>t&&o.push(r("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),o.length||(o=null),i?i({value:n,cellEditorParams:e,internalErrors:o}):o}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();return!pe(i)&&!pe(t.value)?t.value:t.parseValue(i)}getStartValue(){let e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){fs()&&this.eEditor.getInputElement().focus({preventScroll:!0});let e=this.eEditor,t=e.getValue(),i=pe(t)&&t.length||0;i&&e.getInputElement().setSelectionRange(i,i)}},TD=class extends Fm{constructor(){super(new Die(()=>this.getLocaleTextFunc()))}};function Fie(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function Mie(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function TM(e,t,i="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,i),"ensureVisible")}function IM(e,t,i){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,i),"ensureVisible")}function Tie(e,t,i=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,i),"ensureVisible")}function Iie(e){e.undoRedo?.undo("api")}function Aie(e){e.undoRedo?.redo("api")}function Oie(e,t){return e.editModelSvc?.getEditRowDataValue(t,{checkSiblings:!0})}function Lie(e){let t=e.editModelSvc?.getEditMap(),i=[];return t?.forEach((n,r)=>{let{rowIndex:o,rowPinned:s}=r;n.forEach((a,l)=>{let{editorValue:c,pendingValue:d,sourceValue:u,state:h}=a,p=_r(a),f=c??d;f===Fn&&(f=void 0);let g={newValue:f,oldValue:u,state:h,column:l,colId:l.getColId(),colKey:l.getColId(),rowIndex:o,rowPinned:s};(h==="editing"||h==="changed"&&p)&&i.push(g)})}),i}function Nie(e,t=!1){let{editSvc:i}=e;if(i?.isBatchEditing()){if(t)for(let n of e.editModelSvc?.getEditPositions()??[])n.state==="editing"&&i.revertSingleCellEdit(n);else is(e,{persist:!0});Ql(e,void 0,{cancel:t})}else i?.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function Bie(e,t){let i=St(e,t);return e.editSvc?.isEditing(i)??!1}function Hie(e,t){let{key:i,colKey:n,rowIndex:r,rowPinned:o}=t,{editSvc:s,colModel:a}=e,l=a.getCol(n);if(!l){J(12,{colKey:n});return}let d=fo(e,{rowIndex:r,rowPinned:o||null,column:l});if(!d){J(290,{rowIndex:r,rowPinned:o});return}if(!s?.isCellEditable({rowNode:d,column:l},"api"))return;o==null&&IM(e,r),TM(e,n),s?.startEditing({rowNode:d,column:l},{event:i?new KeyboardEvent("keydown",{key:i}):void 0,source:"api"})}function zie(e){return e.editSvc?.validateEdit()||null}function Vie(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function Gie(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var Wie={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},Uie=class extends Sy{constructor(e){super(Wie),this.params=e}postConstruct(){va(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){let e=this.getGui(),t=this.params,i=n=>{qb(this.gos,n,t.node,t.column,!0)||t.onKeyDown(n)};this.addManagedElementListeners(e,{keydown:i})}};function jie(e,{column:t},i,n,r="ui"){if(i instanceof KeyboardEvent&&(i.key===B.TAB||i.key===B.ENTER||i.key===B.F2||i.key===B.BACKSPACE&&n))return!0;if(i?.shiftKey&&e.rangeSvc?.getCellRanges().length!=0)return!1;let s=t?.getColDef(),a=qie(e.gos,s),l=i?.type;return l==="click"&&i?.detail===1&&a===1||l==="dblclick"&&i?.detail===2&&a===2?!0:r==="api"?n??!1:!1}function qie(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t?.singleClickEdit?1:2}function ry(e,{rowNode:t,column:i},n="ui"){let r=i.getColDef().editable,o=e.editModelSvc;return i.isColumnFunc(t,r)||!!o&&o.hasEdits({rowNode:t,column:i},{withOpenEditor:!0})}function $ie(e,t,i="ui"){let n=ry(e,t,i);return n===!0||i==="ui"?n:e.colModel.getCols().some(o=>ry(e,{rowNode:t.rowNode,column:o},i))}var fm=(e,t=!1)=>{if(e!==void 0)return _r(e)||t&&e.state==="editing"};function AM(e,t,i=!1){return fm(e.editModelSvc?.getEdit(t),i)}var OM=(e,t,i)=>{if(e)for(let n=0,r=e.length;n<r;++n){let o=e[n];if(o.data&&(fm(t?.getEdit({rowNode:o,column:i}))||fm(t?.getEdit({rowNode:o.pinnedSibling,column:i})))||OM(o.childrenAfterGroup,t,i))return!0}};function LM(e,t){let{column:i,rowNode:n}=t;return e.gos.get("groupTotalRow")&&!n?.footer?!1:OM(n?.childrenAfterGroup,e.editModelSvc,i)}function NM(e,{rowNode:t,column:i}){if(t=t.pinnedSibling,!!t)return fm(e.editModelSvc?.getEdit({rowNode:t,column:i}))}var Kie=class extends j{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){let{cellCtrl:e,editSvc:t,beans:i}=this;if(t?.isBatchEditing()&&t.isEditing()){let r=AM(i,e)||LM(i,e)||NM(i,e);this.applyBatchingStyle(r)}else this.applyBatchingStyle(!1);let n=!!this.editModelSvc?.getCellValidationModel().hasCellValidation(this.cellCtrl);this.cellComp.toggleCss("ag-cell-editing-error",n)}applyBatchingStyle(e){this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&this.editSvc?.isBatchEditing())??!1)}},Yie=class extends j{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){let{rowCtrl:e,editModelSvc:t,beans:i}=this,n=e.rowNode,r=t?.getEditRow(n),o=this.editModelSvc?.getRowValidationModel().hasRowValidation({rowNode:n});if(!r&&n.pinnedSibling&&(n=n.pinnedSibling,r=t?.getEditRow(n)),r){let s=Array.from(r.keys()).some(a=>{let l={rowNode:n,column:a};return AM(i,l,!0)||LM(i,l)||NM(i,l)});this.applyStyle(o,s);return}this.applyStyle(o)}applyStyle(e=!1,t=!1){let i=this.editSvc?.isBatchEditing()??!1,n=this.gos.get("editType")==="fullRow";this.rowCtrl?.forEachGui(void 0,({rowComp:r})=>{r.toggleCss("ag-row-editing",n&&t),r.toggleCss("ag-row-batch-edit",n&&t&&i),r.toggleCss("ag-row-inline-editing",t),r.toggleCss("ag-row-not-inline-editing",!t),r.toggleCss("ag-row-editing-invalid",n&&t&&e)})}},Xie=({rowModel:e,pinnedRowModel:t,editModelSvc:i},n)=>{let r=new Set;e.forEachNode(o=>n.has(o)&&r.add(o)),t?.forEachPinnedRow("top",o=>n.has(o)&&r.add(o)),t?.forEachPinnedRow("bottom",o=>n.has(o)&&r.add(o));for(let o of n)r.has(o)||i.removeEdits({rowNode:o});return r},Jie=({editModelSvc:e},t,i)=>{for(let n of t)e?.getEditRow(n)?.forEach((r,o)=>!i.has(o)&&e.removeEdits({rowNode:n,column:o}))},Qie=e=>()=>{let t=new Set(e.colModel.getCols()),i=e.editModelSvc.getEditMap(!0),n=new Set(i.keys());Jie(e,Xie(e,n),t)},Zie=new Set(["undo","redo","paste","bulk","rangeSvc"]),ene=new Set(["ui","api"]),BM={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},tne=new Set(Object.keys(BM)),ine=new Set(["paste","rangeSvc","cellClear","redo","undo"]),_g={cancel:!0,source:"api"},nne={cancel:!1,source:"api"},Su={checkSiblings:!0},xu={force:!0,suppressFlash:!0},rne=class extends j{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){let{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:n})=>{this.stopEditing(void 0,_g),this.createStrategy(n)});let t=Qie(e),i=()=>{let n=this.model.getCellValidationModel().getCellValidationMap().size>0,r=this.model.getRowValidationModel().getRowValidationMap().size>0;return n||r?this.stopEditing(void 0,_g):this.isEditing()&&(this.batch?Ql(e,this.model.getEditPositions()):this.stopEditing(void 0,nne)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:i,filterChanged:i,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,_g)):(this.stopEditing(void 0,_g),this.batch=!1)}createStrategy(e){let{beans:t,gos:i,strategy:n}=this,r=ID(i,e);if(n){if(n.beanName===r)return n;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(r,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,i,n="ui"){let r=jie(this.beans,e,t,i,n);return r&&(this.strategy??(this.strategy=this.createStrategy())),r}shouldStopEditing(e,t,i="ui"){return this.strategy?.shouldStop(e,t,i)??null}shouldCancelEditing(e,t,i="ui"){return this.strategy?.shouldCancel(e,t,i)??null}validateEdit(){return cZ(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??Su)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){let{startedEdit:i=!0,event:n=null,source:r="ui",ignoreEventKey:o=!1,silent:s}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;let a=St(this.beans,e);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}let l=this.shouldStartEditing(e,n,i,r);if(l===!1&&r!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,r)&&!t.continueEditing&&this.stopEditing(void 0,{source:r}),l&&this.batch&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:n,source:r,ignoreEventKey:o,startedEdit:i,silent:s})}stopEditing(e,t){let i=this.prepareStopContext(e,t);if(!i)return!1;this.stopping=!0;let n=!1,{edits:r}=i;try{let o=this.processStopRequest(i);return n||(n=o.res),r=o.edits,this.finishStopEditing(T(w({},i),{edits:r,params:t,position:e,res:n})),n}finally{this.stopping=!1}}prepareStopContext(e,t){let{event:i,cancel:n,source:r="ui",forceCancel:o,forceStop:s}=t||{};if(tne.has(r)&&this.batch)return this.bulkRefresh(e),null;let a=this.committing?BM[r]:r;if(!(this.committing||this.isEditing(e)||this.batch&&this.model.hasEdits(e,Su))||!this.strategy||this.stopping)return null;let c=St(this.beans,e);c&&(c.onEditorAttachedFuncs=[]);let d=!n&&(!!this.shouldStopEditing(e,i,a)||(this.committing||r==="paste")&&!this.batch)||(s??!1),u=n&&!!this.shouldCancelEditing(e,i,a)||(o??!1);return{cancel:n,cellCtrl:c??void 0,edits:this.model.getEditMap(!0),event:i,forceCancel:o,forceStop:s,position:e,source:r,treatAsSource:a,willCancel:u,willStop:d}}processStopRequest(e){let{event:t,position:i,willCancel:n,willStop:r}=e;return r||n?this.handleStopOrCancel(e):this.shouldHandleMidBatchKey(t,i)?{res:!1,edits:this.handleMidBatchKey(t,i,e)}:(is(this.beans,{persist:!0}),this.batch&&this.strategy?.cleanupEditors(i),{res:!1,edits:this.model.getEditMap()})}handleStopOrCancel(e){let{beans:t,model:i}=this,{cancel:n,edits:r,event:o,source:s,willCancel:a,willStop:l}=e;is(t,{persist:!0,isCancelling:a||n,isStopping:l});let c=i.getEditMap(),d=this.processEdits(c,n,s);this.strategy?.stop(n,o),this.clearValidationIfNoOpenEditors();for(let u of d)i.clearEditValue(u);this.bulkRefresh(void 0,r);for(let u of i.getEditPositions(c)){let h=St(t,u),p=_r(u);h?.refreshCell({force:!0,suppressFlash:!p})}return{res:l,edits:c}}shouldHandleMidBatchKey(e,t){return e instanceof KeyboardEvent&&this.batch&&!!this.strategy?.midBatchInputsAllowed(t)&&this.isEditing(t,{withOpenEditor:!0})}handleMidBatchKey(e,t,i){let{beans:n,model:r}=this,{cellCtrl:o,edits:s}=i,{key:a}=e,l=a===B.ENTER,c=a===B.ESCAPE,d=a===B.TAB;return l||d||c?(l||d?is(n,{persist:!0}):c&&this.revertSingleCellEdit(o),this.batch?this.strategy?.cleanupEditors():Ql(n,r.getEditPositions(),{event:e,cancel:c}),e.preventDefault(),this.bulkRefresh(t,s,{suppressFlash:!0}),r.getEditMap()):s}finishStopEditing({cellCtrl:e,edits:t,params:i,position:n,res:r,willCancel:o,willStop:s}){let a=this.beans;r&&n&&this.model.removeEdits(n),this.navigateAfterEdit(i,e?.cellPosition),Vg(a),this.clearValidationIfNoOpenEditors(),this.bulkRefresh();let{rowRenderer:l,formula:c}=a;o&&l.refreshRows({rowNodes:Array.from(t.keys())}),this.batch&&(c?c.refreshFormulas(!0):l.refreshRows({suppressFlash:!0,force:!0}),r&&s&&this.dispatchBatchEvent("batchEditingStopped",t))}clearValidationIfNoOpenEditors(){this.model.hasEdits(void 0,{withOpenEditor:!0})||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap())}navigateAfterEdit(e,t){if(!e||!t)return;let{event:i,suppressNavigateAfterEdit:n}=e;if(!(i instanceof KeyboardEvent)||n)return;let{key:o,shiftKey:s}=i,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(o!==B.ENTER||!a)return;let l=s?B.UP:B.DOWN;this.beans.navigation?.navigateToNextCell(null,l,t,!1)}processEdits(e,t=!1,i){let n=Array.from(e.keys()),r=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,o=[];for(let s of n){let a=e.get(s);for(let l of a.keys()){let c=a.get(l),d={rowNode:s,column:l},u=_r(c);!t&&u&&!r&&(this.setNodeDataValue(s,l,c.pendingValue,void 0,i)||o.push(d))}}return o}setNodeDataValue(e,t,i,n,r="edit"){let{beans:o}=this,s=St(o,{rowNode:e,column:t}),a=ene.has(r)?"edit":r;s&&(s.suppressRefreshCell=!0),this.committing=!0;let l=e.setDataValue(t,i,a);return this.committing=!1,s&&(s.suppressRefreshCell=!1),n&&s?.refreshCell(xu),l}setEditMap(e,t){this.strategy??(this.strategy=this.createStrategy()),this.strategy?.setEditMap(e,t),this.bulkRefresh();let i=xu;t?.forceRefreshOfEditCellsOnly&&(i=w(w({},one(e)),xu)),this.beans.rowRenderer.refreshCells(i)}dispatchEditValuesChanged({rowNode:e,column:t},i={}){if(!e||!t||!i)return;let{pendingValue:n,sourceValue:r}=i,{rowIndex:o,rowPinned:s,data:a}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:o,rowPinned:s,column:t,source:"api",data:a,newValue:n,oldValue:r,value:n,colDef:t.getColDef()})}bulkRefresh(e={},t,i={}){let{beans:n,gos:r}=this,{editModelSvc:o,rowModel:s}=n;_t(r,s)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),i):t&&o?.getEditMap(!1)?.forEach((a,l)=>{for(let c of a.keys())this.refCell({rowNode:l,column:c},a.get(c),i)}))}refCell({rowNode:e,column:t},i,n={}){let{beans:r,gos:o}=this,s=new Set([e]),a=new Set,l=e.pinnedSibling;l&&s.add(l);let c=e.sibling;c&&a.add(c);let d=e.parent;for(;d;)d.sibling?.footer&&o.get("groupTotalRow")||!d.parent&&d.sibling&&o.get("grandTotalRow")?a.add(d.sibling):a.add(d),d=d.parent;for(let u of s)this.dispatchEditValuesChanged({rowNode:u,column:t},i);for(let u of s)St(r,{rowNode:u,column:t})?.refreshCell(n);for(let u of a)St(r,{rowNode:u,column:t})?.refreshCell(n)}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){let{rowNode:i}=e,{gos:n,beans:r}=this;if(i.group){if(n.get("treeData")){if(!i.data&&!n.get("enableGroupEdit"))return!1}else if(!n.get("enableGroupEdit"))return!1}let o=ID(n)==="fullRow"?$ie(r,e,t):ry(r,e,t);return o&&(this.strategy??(this.strategy=this.createStrategy())),o}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,i=!0){if(this.hasValidationErrors(e)){let n=St(this.beans,e);return this.cellEditingInvalidCommitBlocks()?(t?.preventDefault?.(),i&&(!n?.hasBrowserFocus()&&n?.focusCell(),n?.comp?.getCellEditor()?.focusIn?.()),"block-stop"):(n&&this.revertSingleCellEdit(n),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){let i=St(this.beans,e);i?.comp?.getCellEditor()&&(Ql(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),oc(this.beans,e,{silent:!0}),ba(this.beans),i?.refreshCell(xu),t&&(i?.focusCell(),i?.comp?.getCellEditor()?.focusIn?.()))}hasValidationErrors(e){ba(this.beans);let t=St(this.beans,e);t&&(t.refreshCell(xu),t.rowCtrl.rowEditStyleFeature?.applyRowStyles());let i=!1;return e?.rowNode?(i||(i=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(i||(i=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(i||(i=this.model.getCellValidationModel().getCellValidationMap().size>0),i||(i=this.model.getRowValidationModel().getRowValidationMap().size>0)),i}moveToNextCell(e,t,i,n="ui"){let r,o=this.isEditing(),s=o&&this.checkNavWithValidation(void 0,i)==="block-stop";return e instanceof Zl&&o&&(r=this.strategy?.moveToNextEditingCell(e,t,i,n,s)),r===null||(r=r||!!this.beans.focusSvc.focusedHeader,r===!1&&!s&&this.stopEditing()),r}getCellDataValue({rowNode:e,column:t},i=!0){if(!e||!t)return;let n=this.model.getEdit({rowNode:e,column:t}),r=e.pinnedSibling;if(r){let s=this.model.getEdit({rowNode:r,column:t});s&&(n=s)}let o=i?n?.editorValue??n?.pendingValue:n?.pendingValue;return o===Fn||!n?n?.sourceValue??this.valueSvc.getValue(t,e,!1,"api"):o}addStopEditingWhenGridLosesFocus(e){nZ(this,this.beans,e)}createPopupEditorWrapper(e){return new Uie(e)}setDataValue(e,t,i){try{if((!this.isEditing()||this.committing)&&!ine.has(i))return;let{beans:n}=this;this.strategy??(this.strategy=this.createStrategy());let r=this.batch?"ui":this.committing?i??"api":"api";if(!i||Zie.has(i))return Gg(n,e,t,i,void 0,{persist:!0}),this.batch?(this.cleanupEditors(),Vg(n),this.bulkRefresh(),!0):this.setNodeDataValue(e.rowNode,e.column,t,!0,i);let o=this.model.getEdit(e);if(o){if(o.pendingValue===t)return!1;if(o.sourceValue!==t)return Gg(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:r,suppressNavigateAfterEdit:!0}),!0;if(o.sourceValue===t)return n.editModelSvc?.removeEdits(e),this.dispatchEditValuesChanged(e,T(w({},o),{pendingValue:t})),!0}return Gg(n,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:r,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){sZ(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){let{model:i}=this;if(!this.batch||!i.hasRowEdits(e.rowNode,Su))return;let{rowNode:r}=e,{compDetails:o,valueToDisplay:s}=t;if(o){let{params:a}=o;return a.data=i.getEditRowDataValue(r,Su),{compDetails:o}}return{valueToDisplay:s}}cleanupEditors(){this.strategy?.cleanupEditors()}dispatchCellEvent(e,t,i,n){this.strategy?.dispatchCellEvent(e,t,i,n)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return _e(this.gos,w({type:e},e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}))}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},i){if(!i||i.length===0)return;let{beans:n,rangeSvc:r,valueSvc:o}=this,{formula:s}=n;is(n,{persist:!0});let a=this.model.getEditMap(!0),l=a.get(e)?.get(t)?.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"});let c=s?.isFormula(l)??!1;i.forEach(u=>{let h=u.columns.some(p=>p?.isAllowFormula());if(r?.forEachRowInRange(u,p=>{let f=fo(n,p);if(f===void 0)return;let g=a.get(f)??new Map,m=l;for(let v of u.columns){if(!v)continue;let C=!!c&&v.isAllowFormula();if(this.isCellEditable({rowNode:f,column:v},"api")){let b=o.getValue(v,f,!0,"api"),S=o.parseValue(v,f??null,m,b);Number.isNaN(S)&&(S=null),g.set(v,{editorValue:void 0,pendingValue:S,sourceValue:b,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}C&&(m=s?.updateFormulaByOffset({value:m,columnDelta:1}))}g.size>0&&a.set(f,g),c&&h&&(l=s?.updateFormulaByOffset({value:l,rowDelta:1}))}),this.setEditMap(a),this.batch){this.cleanupEditors(),Vg(n),this.bulkRefresh();return}this.committing=!0,this.stopEditing(void 0,{source:"bulk"}),this.committing=!1,this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(a)})}),this.bulkRefresh();let d=St(n,{rowNode:e,column:t});d&&d.focusCell(!0)}createCellStyleFeature(e){return new Kie(e,this.beans)}createRowStyleFeature(e){return new Yie(e,this.beans)}setEditingCells(e,t){let{beans:i}=this,{colModel:n,valueSvc:r}=i,o=new Map;for(let{colId:s,column:a,colKey:l,rowIndex:c,rowPinned:d,newValue:u,state:h}of e){let p=s?n.getCol(s):l?n.getCol(l):a;if(!p)continue;let f=fo(i,{rowIndex:c,rowPinned:d});if(!f)continue;let g=r.getValue(p,f,!0,"api");if(!t?.forceRefreshOfEditCellsOnly&&!_r({pendingValue:u,sourceValue:g})&&h!=="editing")continue;let m=o.get(f);m||(m=new Map,o.set(f,m)),u===void 0&&(u=Fn),m.set(p,{editorValue:void 0,pendingValue:u,sourceValue:g,state:h??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(o,t)}onCellFocused(e){let t=St(this.beans,e);if(!t||!this.isEditing(t,Su))return;let i=this.model.getEdit(t);if(!i||!_r(i))return;let r=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");this.beans.ariaAnnounce?.announceValue(r,"pendingChange")}allowedFocusTargetOnValidation(e){return St(this.beans,e)}};function one(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function ID(e,t){return t??e.get("editType")??"singleCell"}var HM=class extends j{postConstruct(){this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:this.onCellFocusChanged?.bind(this),cellFocusCleared:this.onCellFocusChanged?.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t,i=e.previousParams,{editSvc:n,beans:r}=this,o=e.type==="cellFocused"?e.sourceEvent:null;i&&(t=St(r,i));let{gos:s,editModelSvc:a}=r,l=e.type==="cellFocusCleared";if(n.isEditing(void 0,{withOpenEditor:!0})){let{column:c,rowIndex:d,rowPinned:u}=e,h={column:c,rowNode:fo(r,{rowIndex:d,rowPinned:u})},p=s.get("invalidEditValueMode")==="block";if(p)return;let f=!p,g=!!a?.getCellValidationModel().hasCellValidation(h),m=f&&g;(i||l?n.stopEditing(void 0,{cancel:m,source:l&&f?"api":void 0,event:o}):!0)||(n.isBatchEditing()?n.cleanupEditors():n.stopEditing(void 0,{source:"api"}))}t?.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){let i=this.model.getEditPositions(),n={all:[],pass:[],fail:[]};for(let r of i){if(n.all.push(r),(this.model.getCellValidationModel().getCellValidation(r)?.errorMessages?.length??0)>0){n.fail.push(r);continue}n.pass.push(r)}if(e)for(let r of i)cm(this.beans,r,{cancel:e}),this.model.stop(r);else{let r=this.processValidationResults(n);if(r.destroy.length>0)for(let o of r.destroy)cm(this.beans,o,{event:t,cancel:e}),this.model.stop(o);if(r.keep.length>0)for(let o of r.keep){let s=St(this.beans,o);this.editSvc?.cellEditingInvalidCommitBlocks()||s&&this.editSvc.revertSingleCellEdit(s)}}return!0}cleanupEditors({rowNode:e}={},t){is(this.beans,{persist:!1});let i=this.model.getEditPositions(),n=[];if(e)for(let r of i)r.rowNode!==e&&n.push(r);else for(let r of i)n.push(r);Ql(this.beans,n),Vg(this.beans,t)}setFocusOutOnEditor(e){e.comp?.getCellEditor()?.focusOut?.()}setFocusInOnEditor(e){let t=e.comp,i=t?.getCellEditor();if(i?.focusIn)i.focusIn();else{let n=this.beans.gos.get("editType")==="fullRow";e.focusCell(n),e.onEditorAttachedFuncs.push(()=>t?.getCellEditor()?.focusIn?.())}}setupEditors(e){let{event:t,ignoreEventKey:i=!1,startedEdit:n,position:r,cells:o=this.model.getEditPositions()}=e,s=t instanceof KeyboardEvent&&!i&&t.key||void 0;oZ(this.beans,o,r,s,t,n)}dispatchCellEvent(e,t,i,n){let r=St(this.beans,e);r&&this.eventSvc.dispatchEvent(w(w({},r.createEvent(t??null,i)),n))}dispatchRowEvent(e,t,i){if(i)return;let n=qy(this.beans,e);n&&this.eventSvc.dispatchEvent(n.createRowEvent(t))}shouldStop(e,t,i="ui"){let n=this.editSvc.isBatchEditing();return n&&i==="api"?!0:n&&(i==="ui"||i==="edit")?!1:i==="api"?!0:t instanceof KeyboardEvent&&!n?t.key===B.ENTER:null}shouldCancel(e,t,i="ui"){let n=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!n&&t.key===B.ESCAPE||n&&i==="api"||i==="api")}setEditMap(e,t){t?.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});let i=[];if(e.forEach((n,r)=>{n.forEach((o,s)=>{o.state==="editing"&&i.push(T(w({},o),{rowNode:r,column:s}))})}),t?.update&&(e=new Map([...this.model.getEditMap(),...e])),this.model?.setEditMap(e),i.length>0){let n=i.at(-1),r=n.pendingValue===Fn?void 0:n.pendingValue;this.start({position:n,event:new KeyboardEvent("keydown",{key:r}),source:"api"});let o=St(this.beans,n);o&&this.setFocusInOnEditor(o)}}destroy(){this.cleanupEditors(),super.destroy()}},sne=class extends HM{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,i="ui"){let{rowNode:n}=e||{};if(!qy(this.beans,{rowNode:this.rowNode}))return!0;let o=super.shouldStop({rowNode:this.rowNode},t,i);return o!==null?o:this.rowNode?n!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){let{position:t,silent:i,startedEdit:n,event:r,ignoreEventKey:o}=e,{rowNode:s}=t;this.rowNode!==s&&super.cleanupEditors(t);let a=this.beans.visibleCols.allCols,l=[],c=[];for(let d of a)d.isCellEditable(s)&&c.push(d);if(c.length!=0){this.dispatchRowEvent({rowNode:s},"rowEditingStarted",i),this.startedRows.push(s);for(let d of c){let u={rowNode:s,column:d};l.push(u),this.model.hasEdits(u)||this.model.start(u)}this.rowNode=s,this.setupEditors({cells:l,position:t,startedEdit:n,event:r,ignoreEventKey:o})}}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){let{rowNode:i}=this;if(i&&!this.model.hasRowEdits(i))return!1;let n=[];if(e||this.model.getEditMap().forEach((r,o)=>{if(!(!r||r.size===0)){for(let s of r.values())if(_r(s)){n.push(o);break}}}),ba(this.beans),!e&&this.editSvc?.checkNavWithValidation({rowNode:i})==="block-stop")return!1;super.stop(e,t);for(let r of n)this.dispatchRowEvent({rowNode:r},"rowValueChanged");return this.cleanupEditors({rowNode:i},!0),this.rowNode=void 0,!0}onCellFocusChanged(e){let{rowIndex:t}=e,i=e.previousParams;if(i?.rowIndex===t||e.sourceEvent instanceof KeyboardEvent)return;let n=St(this.beans,i);this.gos.get("invalidEditValueMode")==="block"&&n&&(this.model.getCellValidationModel().getCellValidation(n)||this.model.getRowValidationModel().getRowValidation(n))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t);for(let i of this.startedRows)this.dispatchRowEvent({rowNode:i},"rowEditingStopped");this.startedRows.length=0}moveToNextEditingCell(e,t,i,n="ui",r=!1){let o=e.cellPosition,s;this.model.suspend(!0);try{s=this.beans.navigation?.findNextCellToFocusOn(o,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(s===!1)return null;if(s==null)return!1;let a=s.cellPosition,l=e.isCellEditable(),c=s.isCellEditable(),d=a&&o.rowIndex===a.rowIndex&&o.rowPinned===a.rowPinned;l&&this.setFocusOutOnEditor(e),this.restoreEditors();let u=this.gos.get("suppressStartEditOnTab");return c&&!r?u?s.focusCell(!0,i):(s.comp?.getCellEditor()||oc(this.beans,s,{event:i,cellStartedEdit:!0}),this.setFocusInOnEditor(s),s.focusCell(!1,i)):(c&&r&&this.setFocusInOnEditor(s),s.focusCell(!0,i)),!d&&!r&&(this.editSvc?.stopEditing({rowNode:e.rowNode},{event:i}),this.cleanupEditors(s,!0),u?s.focusCell(!0,i):this.editSvc.startEditing(s,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:i},n)=>{if(i!=="editing")return;let r=St(this.beans,{rowNode:t,column:n});r&&!r.comp?.getCellEditor()&&oc(this.beans,r,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},ane=class extends HM{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,i="ui"){let n=super.shouldStop(e,t,i);if(n!==null)return n;let{rowNode:r,column:o}=e||{};return(!this.rowNode||!this.column)&&r&&o?null:this.rowNode!==r||this.column!==o}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){let{position:t,startedEdit:i,event:n,ignoreEventKey:r}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:i,event:n,ignoreEventKey:r})}dispatchRowEvent(e,t,i){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){let{colModel:t,editSvc:i}=this.beans,{rowIndex:n,column:r,rowPinned:o}=e,s=fo(this.beans,{rowIndex:n,rowPinned:o}),a=Qb(r),l=t.getCol(a),c=e.previousParams;if(c){let d=Qb(c.column);if(c?.rowIndex===n&&d===a&&c?.rowPinned===o)return}i?.isEditing({rowNode:s,column:l},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,i,n="ui",r=!1){let o=this.beans.focusSvc.getFocusedCell();o&&(e=Bl(this.beans,o)??e);let s=e.cellPosition,a,l=this.beans.gos.get("editType")==="fullRow";l&&this.model.suspend(!0),r||(e.eGui.focus(),this.editSvc?.stopEditing(e,{source:this.editSvc?.isBatchEditing()?"ui":"api",event:i}));try{a=this.beans.navigation?.findNextCellToFocusOn(s,{backwards:t,startEditing:!0})}finally{l&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;let c=a.cellPosition,d=e.isCellEditable(),u=a.isCellEditable(),h=c&&s.rowIndex===c.rowIndex&&s.rowPinned===c.rowPinned;d&&!r&&this.setFocusOutOnEditor(e);let p=this.gos.get("suppressStartEditOnTab");if(!h&&!r&&(super.cleanupEditors(a,!0),p?a.focusCell(!0,i):this.editSvc.startEditing(a,{startedEdit:!0,event:i,source:n,ignoreEventKey:!0})),u&&!r){if(a.focusCell(!1,i),p)a.focusCell(!0,i);else if(!a.comp?.getCellEditor()){let f=this.editSvc?.isEditing(a,{withOpenEditor:!0});oc(this.beans,a,{event:i,cellStartedEdit:!0,silent:f}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else u&&r&&this.setFocusInOnEditor(a),a.focusCell(!0,i);return e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},ms={moduleName:"EditCore",version:fe,beans:[iZ,rne],apiFunctions:{getEditingCells:Lie,getEditRowValues:Oie,getCellEditorInstances:rZ,startEditingCell:Hie,stopEditing:Nie,isEditing:Bie,validateEdit:zie},dynamicBeans:{singleCell:ane,fullRow:sne},dependsOn:[_m,MM],css:[hie]},lne={moduleName:"UndoRedoEdit",version:fe,beans:[uie],apiFunctions:{undoCellEditing:Iie,redoCellEditing:Aie,getCurrentUndoSize:Vie,getCurrentRedoSize:Gie},dependsOn:[ms]},cne={moduleName:"TextEditor",version:fe,userComponents:{agCellEditor:TD,agTextCellEditor:TD},dependsOn:[ms]},dne={moduleName:"NumberEditor",version:fe,userComponents:{agNumberCellEditor:{classImp:Rie}},dependsOn:[ms]},une={moduleName:"DateEditor",version:fe,userComponents:{agDateCellEditor:vie,agDateStringCellEditor:bie},dependsOn:[ms]},hne={moduleName:"CheckboxEditor",version:fe,userComponents:{agCheckboxCellEditor:fie},dependsOn:[ms]},pne={moduleName:"SelectEditor",version:fe,userComponents:{agSelectCellEditor:kie},dependsOn:[ms]},fne={moduleName:"LargeTextEditor",version:fe,userComponents:{agLargeTextCellEditor:Sie},dependsOn:[ms]},gne={moduleName:"CustomEditor",version:fe,dependsOn:[ms]},mne=class extends j{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,Kl(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){let t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),wU(e))}createColumns(e,t){let i=()=>{Zg(this.beans,this.columns?.tree),this.columns=null},n=e.treeDepth,o=(this.columns?.treeDepth??-1)==n,s=this.generateSelectionCols();if(CU(s,this.columns?.list??[])&&o)return;i();let{colGroupSvc:l}=this.beans,c=l?.findDepth(e.tree)??0,d=l?.balanceTreeForAutoCols(s,c)??[];this.columns={list:s,tree:d,treeDepth:c,map:{}},t(h=>{if(!h)return null;let p=h.filter(f=>!ps(f));return[...s,...p]})}updateColumns(e){let t=Kl(e.source),{beans:i}=this;for(let n of this.columns?.list??[]){let r=this.createSelectionColDef(e.currentValue);n.setColDef(r,null,t),qn(i,{state:[yU(r,n.colId)]},t)}}getColumn(e){return this.columns?.list.find(t=>Tu(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){let{gos:e,beans:t}=this,i=e.get("rowSelection");if(typeof i!="object"||!ua(e))return!1;let n=(t.autoColSvc?.getColumns()?.length??0)>0;if(i.checkboxLocation==="autoGroupColumn"&&n)return!1;let r=!!jl(i),o=Ig(i);return r||o}createSelectionColDef(e){let{gos:t}=this,i=e??t.get("selectionColumnDef"),n=t.get("enableRtl"),a=i??{},{rowSpan:r,spanRows:o}=a,s=xt(a,["rowSpan","spanRows"]);return T(w({width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:n?"right":"left",comparator(l,c,d,u){let h=d.isSelected(),p=u.isSelected();return h===p?0:h?1:-1},editable:!1,suppressFillHandle:!0,suppressAutoSize:!0,pinned:null},s),{colId:xF,chartDataType:"excluded"})}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];let e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);let i=new Sa(e,null,t,!1);return this.createBean(i),[i]}onSelectionOptionsChanged(e,t,i){let n=t&&typeof t!="string"?jl(t):void 0,r=e&&typeof e!="string"?jl(e):void 0,o=n!==r,s=t&&typeof t!="string"?Ig(t):void 0,a=e&&typeof e!="string"?Ig(e):void 0,l=s!==a,c=Xg(e),d=Xg(t);(o||l||c!==d)&&this.beans.colModel.refreshAll(i)}destroy(){Zg(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e,t,i){if(!this.columns?.list.length)return;let n=e.length+t.length+i.length;if(n===0)return;let r=this.columns.list[0];if(!r.isVisible())return;let o=()=>{let l;switch(r.pinned){case"left":case!0:l=e;break;case"right":l=i;break;default:l=t}l&&Mr(l,r)};(this.beans.rowNumbersSvc?.getColumn(EF)?2:1)===n&&o()}},vne=':where(.ag-selection-checkbox) .ag-checkbox-input-wrapper{&:before{content:"";cursor:pointer;inset:-8px;position:absolute}}';function Cne(e,t){if(!t.nodes.every(s=>s.rowPinned&&!ih(s)?(J(59),!1):s.id===void 0?(J(60),!1):!0))return;let{nodes:n,source:r,newValue:o}=t;e.selectionSvc?.setNodesSelected({nodes:n,source:r??"api",newValue:o})}function wne(e,t,i="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:i,selectAll:t})}function bne(e,t,i="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:i,selectAll:t})}function yne(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function Sne(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function xne(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function Ene(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function Rne(e){return e.selectionSvc?.getSelectedNodes()??[]}function Pne(e){return e.selectionSvc?.getSelectedRows()??[]}var kne=class extends jK{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();let{gos:e}=this;this.mode=Jg(e),this.groupSelectsDescendants=Uu(e),this.groupSelectsFiltered=Qg(e)==="filteredDescendants",this.masterSelectsDetail=S_(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{let t=Uu(e),i=Jg(e),n=Qg(e)==="filteredDescendants";this.masterSelectsDetail=S_(e)==="detail",(t!==this.groupSelectsDescendants||n!==this.groupSelectsFiltered||i!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=n,this.mode=i)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,i){if(this.isRowSelectionBlocked(t))return 0;let n=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,i);if(n==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in n)return n.reset?this.resetNodes():this.selectRange(n.deselect,!1,i),this.selectRange(n.select,!0,i);{let r=n.checkFilteredNodes?VM(n.node):n.newValue;return this.setNodesSelected({nodes:[n.node],newValue:r,clearSelection:n.clearSelection,keepDescendants:n.keepDescendants,event:e,source:i})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:i,nodes:n,event:r,source:o,keepDescendants:s=!1}){if(n.length===0)return 0;let{gos:a}=this;if(!ua(a)&&e)return J(132),0;if(n.length>1&&!this.isMultiSelect())return J(130),0;let l=0;for(let c=0;c<n.length;c++){let d=n[c],u=Tl(d);if(u.rowPinned&&!ih(u)){J(59);continue}if(u.id===void 0){J(60);continue}if(e&&d.destroyed)continue;this.groupSelectsFiltered&&u.group&&!a.get("treeData")||this.selectRowNode(u,e,r,o)&&(this.detailSelection.delete(u.id),l++),this.groupSelectsDescendants&&u.childrenAfterGroup?.length&&(l+=this.selectChildren(u,e,o))}return i||(n.length===1&&o==="api"&&this.selectionCtx.setRoot(Tl(n[0])),e&&(t||!this.isMultiSelect())&&(l+=this.clearOtherNodes(Tl(n[0]),s,o)),l>0&&(this.updateGroupsFromChildrenSelections(o),this.dispatchSelectionChanged(o))),l}selectRange(e,t,i){let n=0;return e.forEach(r=>{let o=Tl(r);if(o.group&&this.groupSelectsDescendants)return;this.selectRowNode(o,t,void 0,i)&&n++}),n>0&&(this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)),n}selectChildren(e,t,i){let n=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return n?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:i,nodes:n}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){let e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){let t=new Map;this.selectedNodes.forEach((i,n)=>{e(i)&&t.set(n,i)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;let{gos:i,rowModel:n}=this.beans;if(!_t(i,n))return!1;let r=n.rootNode;if(!r)return!1;t||(t=new Ku(!0,r),t.active=!1);let o=!1;return t.forEachChangedNodeDepthFirst(s=>{if(s!==r){let a=this.calculateSelectedFromChildren(s);o=this.selectRowNode(s,a===null?!1:a,void 0,e)||o}}),o}clearOtherNodes(e,t,i){let n=new Map,r=0;return this.selectedNodes.forEach(o=>{let s=o.id==e.id;if((t?!Dne(e,o):!0)&&!s){let l=this.selectedNodes.get(o.id);r+=this.setNodesSelected({nodes:[l],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:i}),this.groupSelectsDescendants&&o.parent&&n.set(o.parent.id,o.parent)}}),n.forEach(o=>{let s=this.calculateSelectedFromChildren(o);this.selectRowNode(o,s===null?!1:s,void 0,i)}),r}onRowSelected(e){let t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;let t=new ds(this.beans);return t.id=e.id,t.data=e.data,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){let t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){let{gos:e,rowModel:t}=this.beans;if(!_t(e,t))return;let i=t.getTopLevelNodes();if(i===null)return;let n=[];function r(o){for(let s=0,a=o.length;s<a;s++){let l=o[s];l.isSelected()?n.push(l):l.group&&l.childrenAfterGroup&&r(l.childrenAfterGroup)}}return r(i),n}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){let i=_t(this.gos),n=!1,r=o=>{let s=this.selectRowNode(Tl(o),!1,void 0,e);n||(n=s)};if(t==="currentPage"||t==="filtered"){if(!i){Ze(102);return}this.getNodesToSelect(t).forEach(r)}else this.selectedNodes.forEach(r),this.reset(e);if(this.selectionCtx.selectAll=!1,i&&this.groupSelectsDescendants){let o=this.updateGroupsFromChildrenSelections(e);n||(n=o)}n&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,i=0;return this.getNodesToSelect(e).forEach(n=>{this.groupSelectsDescendants&&n.group||(n.isSelected()?t++:n.selectable&&i++)}),{selectedCount:t,notSelectedCount:i}}getSelectAllState(e){let{selectedCount:t,notSelectedCount:i}=this.getSelectedCounts(e);return zM(t,i)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];let t=[],i=r=>t.push(r);if(e==="currentPage")return this.forEachNodeOnPage(r=>{if(!r.group){i(r);return}if(!r.expanded&&!r.footer){let o=s=>{i(s),s.childrenAfterFilter?.forEach(o)};o(r);return}this.groupSelectsDescendants||i(r)}),t;let n=this.beans.rowModel;return e==="filtered"?(n.forEachNodeAfterFilter(i),t):(n.forEachNode(i),t)}forEachNodeOnPage(e){let{pageBounds:t,rowModel:i}=this.beans,n=t.getFirstRow(),r=t.getLastRow();for(let o=n;o<=r;o++){let s=i.getRow(o);s&&e(s)}}selectAllRowNodes(e){let{gos:t,selectionCtx:i}=this;if(!ua(t)){J(132);return}if(iU(t)&&!Wu(t)){J(130);return}if(!this.canSelectAll())return;let{source:n,selectAll:r}=e,o=!1;if(this.getNodesToSelect(r).forEach(s=>{let a=this.selectRowNode(Tl(s),!0,void 0,n);o||(o=a)}),i.selectAll=!0,_t(t)&&this.groupSelectsDescendants){let s=this.updateGroupsFromChildrenSelections(n);o||(o=s)}o&&this.dispatchSelectionChanged(n)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,i){if(e||(e=[]),!Array.isArray(e)){Ze(103);return}let n=new Set(e),r=[];this.beans.rowModel.forEachNode(o=>{n.has(o.id)&&r.push(o)}),i&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:r,source:t})}canSelectAll(){return _t(this.beans.gos)}updateSelectable(e){let{gos:t,rowModel:i}=this.beans;if(!ua(t))return;let n="selectableChanged",r=e!==void 0,o=_t(t)&&this.groupSelectsDescendants,s=[],a=l=>{if(r&&!l.group)return;if(o&&l.group){let d=l.childrenAfterGroup?.some(u=>u.selectable)??!1;this.setRowSelectable(l,d,!0);return}!this.updateRowSelectable(l,!0)&&l.isSelected()&&s.push(l)};if(o){if(e===void 0){let l=i.rootNode;e=l?new Ku(!1,l):void 0}e?.forEachChangedNodeDepthFirst(a,!r,!r)}else i.forEachNode(a);s.length&&this.setNodesSelected({nodes:s,newValue:!1,source:n}),!r&&o&&this.updateGroupsFromChildrenSelections?.(n)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;let i=e.detailNode?.detailGridInfo?.api;if(!i)return;let n=_ne(i);if(e.isSelected()!==n&&this.selectRowNode(e,n,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!n){let o=this.detailSelection.get(e.id)??new Set;for(let s of i.getSelectedNodes())o.add(s.id);this.detailSelection.set(e.id,o)}}setDetailSelectionState(e,t,i){if(this.masterSelectsDetail){if(!Wu(t)){J(269);return}switch(e.isSelected()){case!0:{i.selectAll();break}case!1:{i.deselectAll();break}case void 0:{let n=this.detailSelection.get(e.id);if(n){let r=[];for(let o of n){let s=i.getRowNode(o);s&&r.push(s)}i.setNodesSelected({nodes:r,newValue:!0,source:"masterDetail"})}break}default:break}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function Tl(e){return ih(e)?e.pinnedSibling:e.footer?e.sibling:e}function _ne(e){let t=0,i=0;return e.forEachNode(n=>{n.isSelected()?t++:n.selectable&&i++}),zM(t,i)}function zM(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function Dne(e,t){let i=t.parent;for(;i;){if(i===e)return!0;i=i.parent}return!1}function VM(e){let t=e.isSelected()===!1,i=e.childrenAfterFilter?.some(VM)??!1;return t||i}var Fne={moduleName:"SharedRowSelection",version:fe,beans:[mne],css:[vne],apiFunctions:{setNodesSelected:Cne,selectAll:wne,deselectAll:bne,selectAllFiltered:yne,deselectAllFiltered:Sne,selectAllOnCurrentPage:xne,deselectAllOnCurrentPage:Ene,getSelectedNodes:Rne,getSelectedRows:Pne}},Mne={moduleName:"RowSelection",version:fe,rowModels:["clientSide","infinite","viewport"],beans:[kne],dependsOn:[Fne]};function Tne(e){e.expansionSvc?.expandAll(!0)}function Ine(e){e.expansionSvc?.expandAll(!1)}function GM(e){e.rowModel?.onRowHeightChanged()}function WM(e){if(e.rowAutoHeight?.active){J(3);return}e.rowModel?.resetRowHeights()}function Ane(e,t,i){let n=Tee(e);if(n){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){Ze(238);return}n.setRowCount(t,i);return}Ze(28);return}km(e)?.setRowCount(t,i)}function One(e){return Ju(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function Lne(e){return e.rowModel.isLastRowIndexKnown()}var Nne={moduleName:"CsrmSsrmSharedApi",version:fe,apiFunctions:{expandAll:Tne,collapseAll:Ine}},Bne={moduleName:"RowModelSharedApi",version:fe,apiFunctions:{onRowHeightChanged:GM,resetRowHeights:WM}},Hne={moduleName:"SsrmInfiniteSharedApi",version:fe,apiFunctions:{setRowCount:Ane,getCacheBlockState:One,isLastRowIndexKnown:Lne}},zne=class extends j{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[],t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(n=>{if(!n){Ze(18),t||Ze(20);return}if(this.isGridApi(n))return n;let r=n;return"current"in r?r.current?.api:(r.api||Ze(19),r.api)}).filter(n=>!!n&&!n.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){let e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){if(!this.consuming)for(let t of this.getAlignedGridApis())t.isDestroyed()||t.dispatchEvent(e)}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){let i=[];return e.columns?e.columns.forEach(n=>{i.push(t(n))}):e.column&&i.push(t(e.column)),i}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":J(21);break}})}processGroupOpenedEvent(e){let{colGroupSvc:t}=this.beans;if(t)for(let i of e.columnGroups){let n=null;i&&(n=t.getProvidedColGroup(i.getGroupId())),!(i&&!n)&&t.setColumnGroupOpened(n,i.isExpanded(),"alignedGridChanged")}}processColumnEvent(e){let t=e.column,i=null,n=this.beans,{colResize:r,ctrlsSvc:o,colModel:s}=n;if(t&&(i=s.getColDefCol(t.getColId())),t&&!i)return;let a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{let u=e.api.getColumnState().map(h=>({colId:h.colId}));qn(n,{state:u,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{let u=e.api.getColumnState().map(h=>({colId:h.colId,hide:h.hide}));qn(n,{state:u},"alignedGridChanged")}break;case"columnPinned":{let u=e.api.getColumnState().map(h=>({colId:h.colId,pinned:h.pinned}));qn(n,{state:u},"alignedGridChanged")}break;case"columnResized":{let d=e,u={};for(let h of a)u[h.getId()]={key:h.getColId(),newWidth:h.getActualWidth()};for(let h of d.flexColumns??[])u[h.getId()]&&delete u[h.getId()];r?.setColumnWidths(Object.values(u),!1,d.finished,"alignedGridChanged");break}}let c=o.getGridBodyCtrl().isVerticalScrollShowing();for(let d of this.getAlignedGridApis())d.setGridOption("alwaysShowVerticalScroll",c)}},Vne={moduleName:"AlignedGrids",version:fe,beans:[zne],dependsOn:[V8]},Gne=class extends j{constructor(e){super(),this.rootNode=e,this.nextId=0,this.allNodesMap={},AD(e)}getRowNode(e){return this.allNodesMap[e]}setNewRowData(e){this.dispatchRowDataUpdateStarted(e),this.destroyAllNodes();let t=AD(this.rootNode),i=new Array(e.length);t._leafs=i;let n=0,r=this.beans.groupStage?.getNestedDataGetter(),o=r?new Set:null,s=(a,l)=>{let c=a.level+1;for(let d=0,u=l.length;d<u;++d){let h=l[d];if(!h)continue;let p=this.createRowNode(h,c);if(p.sourceRowIndex=n,i[n++]=p,o&&!o.has(h)){o.add(h),p.treeParent=a;let f=r(h);f&&s(p,f)}}};s(t,e),i.length=n}destroyAllNodes(){let{selectionSvc:e,pinnedRowModel:t,groupStage:i}=this.beans;e?.reset("rowDataChanged"),t?.isManual()&&t.reset(),i?.clearNonLeafs();let n=this.rootNode._leafs;if(n)for(let r=0,o=n.length;r<o;++r)n[r]._destroy(!1);this.allNodesMap=Object.create(null),this.nextId=0}setImmutableRowData(e,t){let{rootNode:i,gos:n}=this;this.dispatchRowDataUpdateStarted(t);let r=tc(n),o=e.changedRowNodes,{adds:s,updates:a}=o,l=new Set,c=[],d=this.beans.groupStage?.getNestedDataGetter(),u=n.get("suppressMaintainUnsortedOrder")?void 0:!1,h=-1,p=!1,f=(v,C)=>{if(!u&&u!==void 0){let b=v.sourceRowIndex;u=b<=h,h=b}v.data!==C&&(v.updateData(C),s.has(v)||a.add(v),!v.selectable&&v.isSelected()&&c.push(v))},g=(v,C,b)=>{for(let S=0,E=C.length;S<E;++S){let x=C[S];if(!x)continue;let P=this.getRowNode(r({data:x,level:b}));if(P?(f(P,x),p||(p=!!d&&P.treeParent!==v)):(P=this.createRowNode(x,b),s.add(P)),!d||l.has(P)){l.add(P);continue}l.add(P),P.treeParent=v;let F=d(x);F&&g(P,F,b+1)}};g(i,t,0);let m=this.deleteUnusedNodes(l,o,c,!!e.animate)||u||s.size>0;if(m){let v=i._leafs??(i._leafs=[]);u===void 0?$ne(v,l,o):qne(v,l)&&(o.reordered=!0)}(m||p||a.size)&&(e.rowDataUpdated=!0,this.deselect(c))}deleteUnusedNodes(e,{removals:t},i,n){let r=this.rootNode._leafs;for(let o=0,s=r.length;o<s;o++){let a=r[o];e.has(a)||this.destroyNode(a,n)&&(t.push(a),a.isSelected()&&i.push(a))}return t.length>0}updateRowData(e,t,i){if(this.dispatchRowDataUpdateStarted(e.add),this.beans.groupStage?.getNestedDataGetter())return J(268),{remove:[],update:[],add:[]};let n=[],r=tc(this.gos),o=this.executeRemove(r,e,t,n,i),s=this.executeUpdate(r,e,t,n),a=this.executeAdd(e,t);return this.deselect(n),{remove:o,update:s,add:a}}executeRemove(e,{remove:t},{adds:i,updates:n,removals:r},o,s){let a=this.rootNode._leafs,l=a?.length,c=t?.length;if(!c||!l)return[];let d=0,u=l,h=0,p=new Array(c);for(let f=0;f<c;++f){let g=this.lookupNode(e,t[f]);if(!g)continue;let m=g.sourceRowIndex;m<u&&(u=m),m>h&&(h=m),p[d++]=g,this.destroyNode(g,s)&&(g.isSelected()&&o.push(g),i.delete(g)||(n.delete(g),r.push(g)))}return p.length=d,d&&jne(a,u,h),p}executeUpdate(e,{update:t},{adds:i,updates:n},r){let o=t?.length;if(!o)return[];let s=new Array(o),a=0;for(let l=0;l<o;l++){let c=t[l],d=this.lookupNode(e,c);d&&(d.updateData(c),!d.selectable&&d.isSelected()&&r.push(d),s[a++]=d,i.has(d)||n.add(d))}return s.length=a,s}executeAdd(e,t){var i;let n=(i=this.rootNode)._leafs??(i._leafs=[]),r=n.length,o=e.add,s=o?.length;if(!s)return[];let a=r+s,l=this.sanitizeAddIndex(n,e.addIndex);if(l<r){for(let u=r-1,h=a-1;u>=l;--u){let p=n[u];p.sourceRowIndex=h,n[h--]=p}t.reordered=!0}n.length=a;let c=new Array(s),d=t.adds;for(let u=0;u<s;u++){let h=this.createRowNode(o[u],0);d.add(h),h.sourceRowIndex=l,n[l]=h,c[u]=h,l++}return c}dispatchRowDataUpdateStarted(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselect(e){let t="rowDataChanged",i=this.beans.selectionSvc;e.length&&i?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),i?.updateGroupsFromChildrenSelections?.(t),e.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:i?.getSelectedNodes()??null,serverSideState:null})}createRowNode(e,t){let i=new ds(this.beans);i.parent=this.rootNode,i.level=t,i.group=!1,i.expanded=!1,i.setDataAndId(e,String(this.nextId++));let n=i.id,r=this.allNodesMap;return r[n]&&J(2,{nodeId:n}),r[n]=i,i}destroyNode(e,t){if(!e._destroy(t))return!1;let i=e.id,n=this.allNodesMap;n[i]===e&&delete n[i];let r=e.pinnedSibling;return r&&this.beans.pinnedRowModel?.pinRow(r,null),!0}lookupNode(e,t){if(!e)return Une(this.rootNode._leafs,t);let i=e({data:t,level:0}),n=this.allNodesMap[i];return n||(Ze(4,{id:i}),null)}sanitizeAddIndex(e,t){let i=e.length;if(typeof t!="number"||t<0||t>=i||Number.isNaN(t))return i;t=Math.ceil(t);let n=this.gos;return t>0&&n.get("treeData")&&n.get("getDataPath")&&(t=Wne(e,t)),t}},Wne=(e,t)=>{for(let i=0,n=e.length;i<n;i++)if(e[i]?.rowIndex==t-1)return i+1;return t},AD=e=>{e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",e._leafs?.length!==0&&(e._leafs=[]);let t=[],i=[],n=[],r=[];e.childrenAfterGroup=t,e.childrenAfterSort=i,e.childrenAfterAggFilter=n,e.childrenAfterFilter=r;let o=e.sibling;return o&&(o.childrenAfterGroup=t,o.childrenAfterSort=i,o.childrenAfterAggFilter=n,o.childrenAfterFilter=r,o.childrenMapped=e.childrenMapped),e.updateHasChildren(),e},Une=(e,t)=>{if(e)for(let i=0,n=e.length;i<n;i++){let r=e[i];if(r.data===t)return r}return Ze(5,{data:t}),null},jne=(e,t,i)=>{t=Math.max(0,t);for(let n=t,r=e.length;n<r;++n){let o=e[n];n<=i&&o.destroyed||(o.sourceRowIndex=t,e[t++]=o)}e.length=t},qne=(e,t)=>{let i=t.size;e.length=i;let n=0,r=!1,o=!1;for(let s of t){let a=s.sourceRowIndex;a===n?o||(o=r):(a>=0?o=!0:r=!0,s.sourceRowIndex=n,e[n]=s),++n}return o},$ne=(e,t,{adds:i})=>{let n=e.length,r=t.size;r>n&&(e.length=r);let o=0;for(let s=0;s<n;++s){let a=e[s];a.destroyed||(o!==s&&(a.sourceRowIndex=o,e[o]=a),++o)}for(let s of i)s.sourceRowIndex<0&&(s.sourceRowIndex=o,e[o++]=s);e.length=o},UM=e=>{let t=e.childrenAfterSort,i=e.sibling;if(i&&(i.childrenAfterSort=t),!!t)for(let n=0,r=t.length-1;n<=r;n++){let o=t[n],s=n===0,a=n===r;o.firstChild!==s&&(o.firstChild=s,o.dispatchRowEvent("firstChildChanged")),o.lastChild!==a&&(o.lastChild=a,o.dispatchRowEvent("lastChildChanged")),o.childIndex!==n&&(o.childIndex=n,o.dispatchRowEvent("childIndexChanged"))}},Kne=class extends j{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(e,t){let i=this.beans.sortSvc.getSortOptions(),n=i.length>0&&!!t&&this.gos.get("deltaSort"),{gos:r,colModel:o,rowGroupColsSvc:s,rowNodeSorter:a,rowRenderer:l,showRowGroupCols:c}=this.beans,d=r.get("groupMaintainOrder"),u=o.getCols().some(C=>C.isRowGroupActive()),h=s?.columns,p=o.isPivotMode(),f=r.getCallback("postSortRows"),g=!1,m,v=C=>{let b=p&&C.leafGroup,S=d&&u&&!C.leafGroup;S&&(m??(m=this.shouldSortContainsGroupCols(i)),S&&(S=!m));let E=null;if(S){let x=!1;if(h){let P=C.level+1;P<h.length&&(x=h[P].wasSortExplicitlyRemoved)}x||(E=Jne(C))}else!i.length||b||(n&&t?E=Yne(a,C,t,e,i):E=a.doFullSort(C.childrenAfterAggFilter,i));if(E||(E=C.childrenAfterAggFilter?.slice(0)??[]),g||(g=C.childrenAfterSort?.[0]!==E[0]),C.childrenAfterSort=E,UM(C),f){let x={nodes:C.childrenAfterSort};f(x)}};if(e?.forEachChangedNodeDepthFirst(v),g&&r.get("groupHideOpenParents")){let C=c?.columns;C?.length&&l.refreshCells({columns:C,force:!0})}}shouldSortContainsGroupCols(e){let t=e.length;if(!t)return!1;if(Er(this.gos)){for(let i=0;i<t;++i){let n=e[i].column;if(n.isPrimary()&&n.isRowGroupActive())return!0}return!1}for(let i=0;i<t;++i)if(e[i].column.getColDef().showRowGroup)return!0;return!1}},Yne=(e,t,i,n,r)=>{let o=t.childrenAfterAggFilter,s=t.childrenAfterSort;if(!s)return e.doFullSort(o,r);let a=new Set,l=[],{updates:c,adds:d}=i;for(let h=0,p=o.length;h<p;++h){let f=o[h];c.has(f)||d.has(f)||n&&!n.canSkip(f)?l.push({currentPos:l.length,rowNode:f}):a.add(f)}let u=s.filter(h=>a.has(h)).map((h,p)=>({currentPos:p,rowNode:h}));return l.sort((h,p)=>e.compareRowNodes(r,h,p)),Xne(e,r,l,u)},Xne=(e,t,i,n)=>{let r=0,o=0,s=i.length,a=n.length,l=new Array(s+a),c=0;for(;r<s&&o<a;){let d=i[r],u=n[o];e.compareRowNodes(t,d,u)<0?(l[c++]=d.rowNode,++r):(l[c++]=u.rowNode,++o)}for(;r<s;)l[c++]=i[r++].rowNode;for(;o<a;)l[c++]=n[o++].rowNode;return l},Jne=e=>{let t=e.childrenAfterSort,i=e.childrenAfterAggFilter,n=t?.length,r=i?.length;if(!n||!r)return null;let o=new Array(r),s=new Set;for(let l=0;l<r;++l)s.add(i[l]);let a=0;for(let l=0;l<n;++l){let c=t[l];s.delete(c)&&(o[a++]=c)}if(s.size===0&&a===n)return t;for(let l of s)o[a++]=l;return o.length=a,o},Qne=class extends j{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.formulaRows=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=null,this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=Yt(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){let e=this.beans,t=new ds(e);this.rootNode=t,this.nodeManager=this.createBean(new Gne(t));let i=()=>{this.beans.groupStage?.invalidateGroupCols(),this.refreshModel({step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")})};this.addManagedEventListeners({newColumnsLoaded:i,columnRowGroupChanged:i,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:()=>this.refreshModel({step:"pivot"}),columnPivotModeChanged:()=>this.refreshModel({step:"group"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),stylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){let{beans:e,stagesRefreshProps:t}=this,i=[e.groupStage,e.filterStage,e.pivotStage,e.aggStage,e.sortStage,e.filterAggStage,e.flattenStage].filter(n=>!!n);this.stages=i;for(let n=i.length-1;n>=0;--n){let r=i[n];for(let o of r.refreshProps)t.set(o,n)}this.addManagedPropertyListeners([...t.keys(),"rowData"],n=>{let r=n.changeSet?.properties;r&&this.onPropChange(r)}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,i,n){let r,o=!1;do{r=!1;let s=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(s,i),c=Math.min(a,n);for(let d=l;d<=c;d++){let u=this.getRow(d);if(u.rowHeightEstimated){let h=ls(this.beans,u);u.setRowHeight(h.height),r=!0,o=!0}}r&&this.setRowTopAndRowIndex()}while(r);return o}onPropChange(e){let{nodeManager:t,gos:i,beans:n}=this,r=n.groupStage;if(!t)return;let o=new Set(e),s=r?.onPropChange(o),a;o.has("rowData")?a=i.get("rowData"):s&&(a=r?.extractData()),a&&!Array.isArray(a)&&(a=null,J(1));let l={step:"nothing",changedProps:o};a&&(!s&&!this.isEmpty()&&a.length>0&&i.exists("getRowId")&&!i.get("resetRowDataOnUpdate")?(l.keepRenderedRows=!0,l.animate=!i.get("suppressAnimationFrame"),l.changedRowNodes=new Hg,t.setImmutableRowData(l,a)):(l.rowDataUpdated=!0,l.newData=!0,t.setNewRowData(a),this.rowNodesCountReady=!0));let c=l.rowDataUpdated?"group":this.getRefreshedStage(e);c&&(l.step=c,this.refreshModel(l))}getRefreshedStage(e){let{stages:t,stagesRefreshProps:i}=this;if(!t)return null;let n=t.length,r=n;for(let o=0,s=e.length;o<s&&r;++o)r=Math.min(r,i.get(e[o])??r);return r<n?t[r].step:null}setRowTopAndRowIndex(e){let{beans:t,rowsToDisplay:i}=this,n=t.environment.getDefaultRowHeight(),r=0,o=ni(this.gos,"normal");for(let s=0,a=i.length;s<a;++s){let l=i[s],c=l.id;if(c!=null&&e?.add(c),l.rowHeight==null){let d=ls(t,l,o,n);l.setRowHeight(d.height,d.estimated)}l.setRowTop(r),l.setRowIndex(s),r+=l.rowHeight}if(this.beans.formula?.active){let s=this.formulaRows;for(let a=0,l=s.length;a<l;++a){let c=s[a];c.formulaRowIndex=a}}}clearRowTopAndRowIndex(e,t){let i=e.active,n=s=>{s?.id!=null&&!t.has(s.id)&&s.clearRowTopAndRowIndex()},r=s=>{n(s),n(s.detailNode),n(s.sibling);let a=s.childrenAfterGroup;if(!s.hasChildren()||!a)return;let l=s.level==-1;if(!(i&&!l&&!s.expanded))for(let d=0,u=a.length;d<u;++d)r(a[d])},o=this.rootNode;o&&r(o)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){let{rootNode:e,rowsToDisplay:t}=this;if(!e||!t.length)return 0;if(t[0]===e)return 1;let n=e.sibling?.displayed?1:0;return(e.childrenAfterSort?.length??0)+n}getTopLevelRowDisplayedIndex(e){let{beans:t,rootNode:i,rowsToDisplay:n}=this;if(!i||!n.length||n[0]===i)return e;let o=i.childrenAfterSort,s=l=>{let c=o[l];if(this.gos.get("groupHideOpenParents"))for(;c.expanded&&c.childrenAfterSort&&c.childrenAfterSort.length>0;)c=c.childrenAfterSort[0];return c.rowIndex},a=t.footerSvc;return a?a?.getTopDisplayIndex(n,e,o,s):s(e)}getTopLevelIndexFromDisplayedIndex(e){let{rootNode:t,rowsToDisplay:i}=this;if(!t||!i.length||i[0]===t)return e;let r=this.getRow(e);r.footer&&(r=r.sibling);let o=r.parent;for(;o&&o!==t;)r=o,o=r.parent;let s=t.childrenAfterSort?.indexOf(r)??-1;return s>=0?s:e}getRowBounds(e){let t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:Ul(this.gos)})}onFilterChanged({afterDataChange:e,columns:t}){if(!e){let n=t.length===0||t.some(r=>r.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:Ul(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:Ul(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){let t=new Ku(!1,this.rootNode);return t.active=e,t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;let{changedRowNodes:t,newData:i,rowDataUpdated:n}=e;return!(!t||i||!n||t.removals.length||t.adds.size)}refreshModel(e){let{nodeManager:t,beans:i,eventSvc:n,started:r,refreshingModel:o}=this;if(!t)return;let s=!!e.rowDataUpdated,a=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&s));if(r&&s&&n.dispatchEvent({type:"rowDataUpdated"}),!r||o||i.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=s);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.step="group"),this.refreshingModel=!0,i.masterDetailSvc?.refreshModel(e),s&&e.step!=="group"&&i.colFilter?.refreshModel(),e.step){case"group":this.doGrouping(e);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(a,e.changedRowNodes);case"map":this.doRowsToDisplay()}let l=new Set;this.setRowTopAndRowIndex(l),this.clearRowTopAndRowIndex(a,l),this.refreshingModel=!1,n.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?._leafs?.length||!this.beans.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getOverlayType(){return this.isEmpty()?"noRows":this.beans.filterManager?.isAnyFilterPresent()&&this.getRowCount()===0?"noMatchingRows":null}getNodesInRangeForSelection(e,t){let i=!1,n=!1,r=[],o=Uu(this.gos);return this.forEachNodeAfterFilterAndSort(s=>{if(n)return;if(i&&(s===t||s===e)&&(n=!0,o&&s.group)){jM(r,s);return}if(!i){if(s!==t&&s!==e)return;i=!0,t===e&&(n=!0)}(!s.group||!o)&&r.push(s)}),r}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}getFormulaRow(e){return this.formulaRows[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){let t=this.rowsToDisplay,i=t.length;if(this.isEmpty()||i===0)return-1;let n=0,r=i-1;if(e<=0)return 0;if(t[r].rowTop<=e)return r;let s=-1,a=-1;for(;;){let l=Math.floor((n+r)/2),c=t[l];if(this.isRowInPixel(c,e)||(c.rowTop<e?n=l+1:c.rowTop>e&&(r=l-1),s===n&&a===r))return l;s=n,a=r}}isRowInPixel(e,t){let i=e.rowTop,n=i+e.rowHeight;return i<=t&&n>t}forEachLeafNode(e){let t=this.rootNode?._leafs;if(t)for(let i=0,n=t.length;i<n;++i)e(t[i],i)}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){let t=this.rowsToDisplay;for(let i=0,n=t.length;i<n;++i)e(t[i],i)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterSort)}forEachPivotNode(e,t,i){let{colModel:n,rowGroupColsSvc:r}=this.beans;if(!n.isPivotMode())return;if(!r?.columns.length){e(this.rootNode,0);return}let o=i?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,s=>s.leafGroup?null:s[o])}depthFirstSearchRowNodes(e,t=!1,i=o=>o.childrenAfterGroup,n=this.rootNode,r=0){let o=r;if(!n)return o;let s=n===this.rootNode;if(s||e(n,o++),n.hasChildren()&&!n.footer){let a=i(n);if(a){let l=this.beans.footerSvc;o=l?.addTotalRows(o,n,e,t,s,"top")??o;for(let c of a)o=this.depthFirstSearchRowNodes(e,t,i,c,o);return l?.addTotalRows(o,n,e,t,s,"bottom")??o}}return o}doAggregate(e){this.rootNode&&this.beans.aggStage?.execute(e)}doFilterAggregates(e){let t=this.rootNode,i=this.beans.filterAggStage;if(i){i.execute(e);return}t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){let i=this.beans.sortStage;if(i){i.execute(e,t);return}e.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),UM(n)})}doGrouping(e){let t=this.rootNode;if(!t)return;let n=this.beans.groupStage?.execute(e);if(n===void 0){let r=t._leafs;t.childrenAfterGroup=r,t.updateHasChildren();let o=t.sibling;o&&(o.childrenAfterGroup=r)}(n||e.rowDataUpdated)&&this.beans.colFilter?.refreshModel(),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){let t=this.beans.filterStage;if(t){t.execute(e);return}e.forEachChangedNodeDepthFirst(i=>{i.childrenAfterFilter=i.childrenAfterGroup,ty(i)},!0)}doPivot(e){this.beans.pivotStage?.execute(e)}getRowNode(e){let t=this.nodeManager?.getRowNode(e);return typeof t=="object"?t:this.beans.groupStage?.getNonLeaf(e)}batchUpdateRowData(e,t){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];let i=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),i)}this.asyncTransactions.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){let e=this.asyncTransactionsTimer;e&&(clearTimeout(e),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){let{nodeManager:e,beans:t,eventSvc:i,asyncTransactions:n}=this;if(!e)return;t.valueCache?.onDataChanged();let r=[],o=[],s=new Hg,a=!this.gos.get("suppressAnimationFrame");for(let{rowDataTransaction:l,callback:c}of n??[]){this.rowNodesCountReady=!0;let d=e.updateRowData(l,s,a);r.push(d),c&&o.push(c.bind(null,d))}this.commitTransactions(s,a),o.length>0&&setTimeout(()=>{for(let l=0,c=o.length;l<c;l++)o[l]()},0),r.length>0&&i.dispatchEvent({type:"asyncTransactionsFlushed",results:r}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(e){let t=this.nodeManager;if(!t)return null;this.beans.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;let i=new Hg,n=!this.gos.get("suppressAnimationFrame"),r=t.updateRowData(e,i,n);return this.commitTransactions(i,n),r}commitTransactions(e,t){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:t,changedRowNodes:e,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){let{rootNode:e,beans:t}=this;if(t.formula?.active){let r=e?.childrenAfterSort??[];this.formulaRows=r,this.rowsToDisplay=r.filter(o=>!o.softFiltered);for(let o of this.rowsToDisplay)o.setUiLevel(0);return}let i=t.flattenStage;if(i){this.rowsToDisplay=i.execute();return}let n=this.rootNode.childrenAfterSort??[];for(let r of n)r.setUiLevel(0);this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){let e=this.rootNode;if(!e)return;let t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0);let i=e.sibling;i?.setRowHeight(i.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);let i=t.detailNode;i?.setRowHeight(i.rowHeight,!0);let n=t.sibling;n?.setRowHeight(n.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){e.rowHeightChanged&&!this.beans.rowAutoHeight?.active&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,this.stages=null,this.stagesRefreshProps.clear(),clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},jM=(e,t)=>{let i=t.childrenAfterGroup;if(i)for(let n=0,r=i.length;n<r;++n){let o=i[n];o.data&&e.push(o),o.group&&jM(e,o)}};function Zne(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function ere(e,t){let i=gs(e);i&&((!t||t==="everything")&&(t="group"),i.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function tre(e){return gs(e)?.isEmpty()??!0}function ire(e,t){gs(e)?.forEachLeafNode(t)}function nre(e,t){gs(e)?.forEachNodeAfterFilter(t)}function rre(e,t){gs(e)?.forEachNodeAfterFilterAndSort(t)}function ore(e,t){return e.frameworkOverrides.wrapIncoming(()=>gs(e)?.updateRowData(t))}function sre(e,t,i){e.frameworkOverrides.wrapIncoming(()=>gs(e)?.batchUpdateRowData(t,i))}function are(e){e.frameworkOverrides.wrapIncoming(()=>gs(e)?.flushAsyncTransactions())}function lre(e){return e.selectionSvc?.getBestCostNodeSelection()}var cre={moduleName:"ClientSideRowModel",version:fe,rowModels:["clientSide"],beans:[Qne,Kne],dependsOn:[dM]},dre={moduleName:"ClientSideRowModelApi",version:fe,apiFunctions:{onGroupExpandedOrCollapsed:Zne,refreshClientSideRowModel:ere,isRowDataEmpty:tre,forEachLeafNode:ire,forEachNodeAfterFilter:nre,forEachNodeAfterFilterAndSort:rre,applyTransaction:ore,applyTransactionAsync:sre,flushAsyncTransactions:are,getBestCostNodeSelection:lre,resetRowHeights:WM,onRowHeightChanged:GM},dependsOn:[Nne,Bne]},ure=class extends j{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){let{allColumns:i,columnKeys:n,skipRowGroups:r,exportRowNumbers:o}=t,s=this.getColumnsToExport({allColumns:i,skipRowGroups:r,columnKeys:n,exportRowNumbers:o});return[this.prepareSession(s),this.prependContent(t),this.exportColumnGroups(t,s),this.exportHeaders(t,s),this.processPinnedTopRows(t,s),this.processRows(t,s),this.processPinnedBottomRows(t,s),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,i,n){let r=t.shouldRowBeSkipped||(()=>!1),s=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!s,l=this.colModel.isPivotMode()?n.leafGroup:!n.group,c=!!n.footer,d=n.allChildrenCount===1&&n.childrenAfterGroup?.length===1&&eU(this.gos,n);if(!l&&!c&&(t.skipRowGroups||d||a)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&n.rowPinned==="top"||t.skipPinnedBottom&&n.rowPinned==="bottom"||n.stub||n.level===-1&&!l&&!c||r(_e(this.gos,{node:n})))return;let p=e.onNewBodyRow(n);if(i.forEach((f,g)=>{p.onColumn(f,g,n)}),t.getCustomContentBelowRow){let f=t.getCustomContentBelowRow(_e(this.gos,{node:n}));f&&e.addCustomContent(f)}}appendContent(e){return t=>{let i=e.appendContent;return i&&t.addCustomContent(i),t}}prependContent(e){return t=>{let i=e.prependContent;return i&&t.addCustomContent(i),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return i=>{if(!e.skipColumnGroupHeaders){let n=new OF,{colGroupSvc:r}=this.beans,o=r?r.createColumnGroups({columns:t,idCreator:n,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(o,i,e.processGroupHeaderCallback)}return i}}exportHeaders(e,t){return i=>{if(!e.skipColumnHeaders){let n=i.onNewHeaderRow();t.forEach((r,o)=>{n.onColumn(r,o,void 0)})}return i}}processPinnedTopRows(e,t){return i=>{let n=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="top").sort((r,o)=>r.rowIndex-o.rowIndex).map(r=>this.pinnedRowModel?.getPinnedTopRow(r.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("top",n),i}}processRows(e,t){return i=>{let n=this.rowModel,r=_t(this.gos,n),o=Ju(this.gos,n),s=!r&&e.onlySelected,a=this.processRow.bind(this,i,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(c=>c.rowPinned==null).sort((c,d)=>c.rowIndex-d.rowIndex).map(c=>n.getRow(c.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())r?n.forEachPivotNode(a,!0,l==="filteredAndSorted"):o?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);else if(e.onlySelectedAllPages||s){let c=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(c),c.forEach(a)}else l==="all"?n.forEachNode(a):r||o?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);return i}}replicateSortedOrder(e){let{sortSvc:t,rowNodeSorter:i}=this.beans;if(!t||!i)return;let n=t.getSortOptions(),r=(o,s)=>o.rowIndex!=null&&s.rowIndex!=null?o.rowIndex-s.rowIndex:o.level===s.level?o.parent?.id===s.parent?.id?i.compareRowNodes(n,{rowNode:o,currentPos:o.rowIndex??-1},{rowNode:s,currentPos:s.rowIndex??-1}):r(o.parent,s.parent):o.level>s.level?r(o.parent,s):r(o,s.parent);e.sort(r)}processPinnedBottomRows(e,t){return i=>{let n=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="bottom").sort((r,o)=>r.rowIndex-o.rowIndex).map(r=>this.pinnedRowModel?.getPinnedBottomRow(r.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("bottom",n),i}}getColumnsToExport(e){let{allColumns:t=!1,skipRowGroups:i=!1,exportRowNumbers:n=!1,columnKeys:r}=e,{colModel:o,gos:s,visibleCols:a}=this,l=o.isPivotMode(),c=h=>ps(h)?!1:!lo(h)||n;if(r?.length)return o.getColsForKeys(r).filter(c);let d=s.get("treeData"),u=[];return t&&!l?u=o.getCols():u=a.allCols,u=u.filter(h=>c(h)&&(i&&!d?!by(h):!0)),u}recursivelyAddHeaderGroups(e,t,i){let n=[];for(let r of e){let o=r;if(o.getChildren)for(let s of o.getChildren()??[])n.push(s)}e.length>0&&It(e[0])&&this.doAddHeaderHeader(t,e,i),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,i)}doAddHeaderHeader(e,t,i){let n=e.onNewHeaderGroupingRow(),r=0;for(let o of t){let s=o,a;i?a=i(_e(this.gos,{columnGroup:s})):a=this.beans.colNames.getDisplayNameForColumnGroup(s,"header");let c=(s.isExpandable()?s.getLeafColumns():[]).reduce((d,u,h,p)=>{let f=dt(d);return u.getColumnGroupShow()==="open"?(!f||f[1]!=null)&&(f=[h],d.push(f)):f&&f[1]==null&&(f[1]=h-1),h===p.length-1&&f&&f[1]==null&&(f[1]=h),d},[]);n.onColumn(s,a||"",r++,s.getLeafColumns().length-1,c)}}},hre={moduleName:"SharedExport",version:fe,beans:[ure]},OD=`\r
`,pre=class extends Bee{constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";let{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,OD),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((i,n)=>{n!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(i.data.value||""),i.mergeAcross&&this.appendEmptyCells(i.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,n){i!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){t!=0&&(this.result+=this.columnSeparator);let n=this.extractRowCellValue({column:e,node:i,currentColumnIndex:t,accumulatedRowIndex:t,type:"csv",useRawFormula:!1});this.result+=this.putInQuotes(n.valueFormatted??n.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(J(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=OD),this.isFirstLine=!1}},fre=class extends Nee{constructor(){super(...arguments),this.beanName="csvCreator"}getMergedParams(e){let t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){J(51);return}let t=()=>{let n=this.getMergedParams(e),r=this.getData(n),o=new Blob(["\uFEFF",r],{type:"text/plain"}),s=n.fileName,a=typeof s=="function"?s(_e(this.gos,{})):s;Hee(this.getFileName(a),o)},{overlays:i}=this.beans;i?i.showExportOverlay(t):t()}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){let i=t?Object.assign({},e):this.getMergedParams(e);return this.getData(i)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){let{colModel:t,colNames:i,rowGroupColsSvc:n,valueSvc:r,gos:o}=this.beans,{processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:d,columnSeparator:u}=e;return new pre({colModel:t,colNames:i,valueSvc:r,gos:o,processCellCallback:s||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:d||!1,columnSeparator:u||",",rowGroupColsSvc:n})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function gre(e,t){return e.csvCreator?.getDataAsCsv(t)}function mre(e,t){e.csvCreator?.exportDataAsCsv(t)}var vre={moduleName:"CsvExport",version:fe,beans:[fre],apiFunctions:{getDataAsCsv:gre,exportDataAsCsv:mre},dependsOn:[hre]},Cre=class extends j{constructor(e,t,i){super(),this.id=e,this.parentCache=t,this.params=i,this.state="needsLoading",this.version=0,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){let t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];let{params:{blockSize:e,rowHeight:t},startRow:i,beans:n,rowNodes:r}=this;for(let o=0;o<e;o++){let s=i+o,a=new ds(n);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(s),a.setRowTop(t*s),r.push(a)}}getBlockStateJson(){let{id:e,startRow:t,endRow:i,state:n}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:i,pageStatus:n}}}setDataAndId(e,t,i){pe(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){let e=this.createLoadParams();if(mt(this.params.datasource.getRows)){J(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){let{startRow:e,endRow:t,version:i,params:{sortModel:n,filterModel:r},gos:o}=this;return _e(o,{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,i),failCallback:this.pageLoadFailed.bind(this,i),sortModel:n,filterModel:r})}forEachNode(e,t,i){this.rowNodes.forEach((n,r)=>{this.startRow+r<i&&e(n,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);let i=e-this.startRow;return this.rowNodes[i]}processServerResult(e){let{rowNodes:t,beans:i}=this;t.forEach((r,o)=>{let s=e.rowData?e.rowData[o]:void 0;!r.id&&r.alreadyRendered&&s&&(t[o]=new ds(i),t[o].setRowIndex(r.rowIndex),t[o].setRowTop(r.rowTop),t[o].setRowHeight(r.rowHeight),r._destroy(!0)),this.setDataAndId(t[o],s,this.startRow+o)});let n=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,n)}destroy(){let e=this.rowNodes;for(let t=0,i=e.length;t<i;t++)e[t]._destroy(!1);e.length=0,super.destroy()}},wre=2,bre=class extends j{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){let i=Math.floor(e/this.params.blockSize),n=this.blocks[i];if(!n){if(t)return;n=this.createBlock(i)}return n.getRow(e)}createBlock(e){let t=this.params,i=this.createBean(new Cre(e,this,t));return this.blocks[i.id]=i,this.blockCount++,this.purgeBlocksIfNeeded(i),t.rowNodeBlockLoader.addBlock(i),i}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(let t of this.getBlocksInOrder())t.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(let e of this.getBlocksInOrder())this.destroyBlock(e);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(as(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){let t=this.getBlocksInOrder().filter(s=>s!=e),i=(s,a)=>a.lastAccessed-s.lastAccessed;t.sort(i);let n=this.params.maxBlocksInCache>0,r=n?this.params.maxBlocksInCache-1:null,o=wre-1;t.forEach((s,a)=>{let l=s.state==="needsLoading"&&a>=o,c=n?a>=r:!1;if(l||c){if(this.isBlockCurrentlyDisplayed(s)||this.isBlockFocused(s))return;this.removeBlockFromCache(s)}})}isBlockFocused(e){let t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;let{startRow:i,endRow:n}=e;return t.rowIndex>=i&&t.rowIndex<n}isBlockCurrentlyDisplayed(e){let{startRow:t,endRow:i}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,i-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){let{blockSize:i,overflowSize:n}=this.params,o=(e.id+1)*i+n;this.rowCount<o&&(this.rowCount=o)}}setRowCount(e,t){this.rowCount=e,pe(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){let t={value:0};for(let i of this.getBlocksInOrder())i.forEachNode(e,t,this.rowCount)}getBlocksInOrder(){let e=(i,n)=>i.id-n.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){let e=[];for(let t of this.getBlocksInOrder())t.id*this.params.blockSize>=this.rowCount&&e.push(t);if(e.length>0)for(let t of e)this.destroyBlock(t)}purgeCache(){for(let e of this.getBlocksInOrder())this.removeBlockFromCache(e);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){let i=[],n=-1,r=!1,o={value:0},s=!1;for(let l of this.getBlocksInOrder())if(!s){if(r&&n+1!==l.id){s=!0;continue}n=l.id,l.forEachNode(c=>{let d=c===e||c===t;(r||d)&&i.push(c),d&&(r=!r)},o,this.rowCount)}return s||r?[]:i}},yre=class extends j{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;let e=this.beans,t=new ds(e);this.rootNode=t,t.level=-1,this.rowHeight=ha(e),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=ha(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!Nu(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getOverlayType(){return this.infiniteCache?.getRowCount()===0?this.beans.filterManager?.isAnyFilterPresent()?"noMatchingRows":"noRows":null}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;tc(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();let e=this.beans,{filterManager:t,sortSvc:i,rowNodeBlockLoader:n,eventSvc:r,gos:o}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:i?.getSortModel()??[],rowNodeBlockLoader:n,initialRowCount:o.get("infiniteInitialRowCount"),maxBlocksInCache:o.get("maxBlocksInCache"),rowHeight:ha(e),overflowSize:o.get("cacheOverflowSize"),blockSize:o.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new bre(this.cacheParams)),r.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){let t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(i=>{i.id===e&&(t=i)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){let t=Math.floor(e/this.rowHeight),i=this.getRowCount()-1;return t>i?i:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function Sre(e){km(e)?.refreshCache()}function xre(e){km(e)?.purgeCache()}function Ere(e){return km(e)?.getRowCount()}var Rre=class extends j{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=tU(this.gos);let e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Yt(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Mr(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){as(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}let e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(i=>i.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length;for(let i of t)i.load();this.printCacheStatus()}getBlockState(){let e={};return this.blocks.forEach(t=>{let{id:i,state:n}=t.getBlockStateJson();e[i]=n}),e}printCacheStatus(){as(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},Pre={moduleName:"InfiniteRowModelCore",version:fe,rowModels:["infinite"],beans:[yre,Rre]},kre={moduleName:"InfiniteRowModel",version:fe,apiFunctions:{refreshInfiniteCache:Sre,purgeInfiniteCache:xre,getInfiniteRowCount:Ere},dependsOn:[Pre,Hne]},_re="\u2191",Dre="\u2193",Fre={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},Mre=class extends st{constructor(){super(Fre),this.eValue=ae,this.eDelta=ae,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){let i=Math.abs(t),n=e.formatValue(i),r=pe(n)?n:i,o=t>=0,s=this.eDelta;o?s.textContent=_re+r:s.textContent=Dre+r,s.classList.toggle("ag-value-change-delta-up",o),s.classList.toggle("ag-value-change-delta-down",!o)}setTimerToRemoveDelta(){this.refreshCount++;let e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),ii(this.eDelta)}refresh(e,t=!1){let{value:i,valueFormatted:n}=e,{eValue:r,lastValue:o,beans:s}=this;if(i===o||(pe(n)?r.textContent=n:pe(i)?r.textContent=i:ii(r),s.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;let a=i&&typeof i=="object"&&"toNumber"in i?i.toNumber():i,l=o&&typeof o=="object"&&"toNumber"in o?o.toNumber():o;if(a===l)return!1;if(typeof a=="number"&&typeof l=="number"){let c=a-l;this.showDelta(e,c)}return o&&r.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=i,!0}},Tre=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",Ire={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},Are=class extends st{constructor(){super(Ire),this.eCurrent=ae,this.refreshCount=0,this.registerCSS(Tre)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;let e=this.refreshCount;this.ePrevious?.remove();let{beans:t,eCurrent:i}=this,n=Xt({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=n,n.textContent=i.textContent,this.getGui().insertBefore(n,i),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.ePrevious?.remove(),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let i=e.value;if(mt(i)&&(i=""),i===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=i;let n=this.eCurrent;return pe(e.valueFormatted)?n.textContent=e.valueFormatted:pe(e.value)?n.textContent=i:ii(n),!0}},Ore=class extends j{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,i=this.beans.gos.get("cellFlashDuration"),n=this.beans.gos.get("cellFadeDuration")){let r=this.animations[t];r.delete(e);let o=Date.now(),s=o+i,a=o+i+n,l={phase:"flash",flashEndTime:s,fadeEndTime:a};r.set(e,l);let c=`ag-cell-${t}`,d=`${c}-animation`,{comp:u,eGui:{style:h}}=e;u.toggleCss(c,!0),u.toggleCss(d,!1),h.removeProperty("transition"),h.removeProperty("transition-delay"),this.nextAnimationTime&&s+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),i)}),this.nextAnimationTime=s)}advanceAnimations(){let e=Date.now(),t=null;for(let i of Object.keys(this.animations)){let n=this.animations[i],r=`ag-cell-${i}`,o=`${r}-animation`;for(let[s,a]of n){if(!s.isAlive()||!s.comp){n.delete(s);continue}let{phase:l,flashEndTime:c,fadeEndTime:d}=a,u=l==="flash"?c:d;if(!(e+15>=u)){t=Math.min(u,t??1/0);continue}let{comp:p,eGui:{style:f}}=s;switch(l){case"flash":p.toggleCss(r,!1),p.toggleCss(o,!0),f.transition=`background-color ${d-c}ms`,f.transitionDelay=`${c-e}ms`,t=Math.min(d,t??1/0),a.phase="fade";break;case"fade":p.toggleCss(r,!1),p.toggleCss(o,!1),f.removeProperty("transition"),f.removeProperty("transition-delay"),n.delete(s);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;let i=U$(e.cellPosition);t.cells[i]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}destroy(){for(let e of Object.keys(this.animations))this.animations[e].clear()}};function Lre(e,t={}){let{cellFlashSvc:i}=e;i&&e.frameworkOverrides.wrapIncoming(()=>{for(let n of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns))i.flashCell(n,t)})}var Nre={moduleName:"HighlightChanges",version:fe,beans:[Ore],userComponents:{agAnimateShowChangeCellRenderer:Mre,agAnimateSlideCellRenderer:Are},apiFunctions:{flashCells:Lre}};function Bre(e){return e.stateSvc?.getState()??{}}function Hre(e,t,i){return e.stateSvc?.setState(t,i)}function LD(e){return e=w({},e),e.version||(e.version="32.1.0"),e.version==="32.1.0"&&(e=zre(e)),e.version=fe,e}function zre(e){return e.cellSelection=Vre(e,"rangeSelection"),e}function Vre(e,t){if(e&&typeof e=="object")return e[t]}var Gre=class extends j{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=Yt(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=Yt(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=Yt(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){let{gos:e,ctrlsSvc:t,colDelayRenderSvc:i}=this.beans;this.isClientSideRowModel=_t(e);let n=LD(e.get("initialState")??{}),r=n.partialColumnState;delete n.partialColumnState,this.cachedState=n;let o=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>o(()=>this.setupStateOnGridReady(n))),(n.columnOrder||n.columnVisibility||n.columnSizing||n.columnPinning||n.columnGroup)&&i?.hideColumns("columnState");let[s,a,l]=this.addManagedEventListeners({newColumnsLoaded:({source:c})=>{c==="gridInitializing"&&(s(),o(()=>{this.setupStateOnColumnsInitialised(n,!!r),i?.revealColumns("columnState")}))},rowCountReady:()=>{a?.(),o(()=>this.setupStateOnRowCountReady(n))},firstDataRendered:()=>{l?.(),o(()=>this.setupStateOnFirstDataRendered(n))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){let i=LD(e);delete i.partialColumnState,this.cachedState=i,this.startSuppressEvents();let n="api",r=t?new Set(t):void 0;this.setGridReadyState(i,n,r),this.setColumnsInitialisedState(i,n,!!r,r),this.setRowCountState(i,n,r),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(i,n,r),this.stopSuppressEvents(n)})}setGridReadyState(e,t,i){t==="api"&&!i?.has("sideBar")&&this.beans.sideBar?.comp?.setState(e.sideBar),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");let t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,i,n){this.setColumnState(e,t,i,n),this.setColumnGroupState(e,t,n),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);let i=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:i("aggregation"),columnMoved:i("columnOrder"),columnPinned:i("columnPinning"),columnResized:i("columnSizing"),columnVisible:i("columnVisibility"),columnPivotChanged:i("pivot"),columnPivotModeChanged:i("pivot"),columnRowGroupChanged:i("rowGroup"),sortChanged:i("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,i){let{filter:n,rowGroupExpansion:r,ssrmRowGroupExpansion:o,rowSelection:s,pagination:a,rowPinning:l}=e,c=(u,h)=>!i?.has(u)&&(h||t==="api");c("filter",n)&&this.setFilterState(n),c("rowGroupExpansion",r)&&this.setRowGroupExpansionState(o,r,t),c("rowSelection",s)&&this.setRowSelectionState(s,t),c("pagination",a)&&this.setPaginationState(a,t),c("rowPinning",l)&&this.setRowPinningState(l);let d=this.updateCachedState.bind(this);d("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(d("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),d("rowGroupExpansion",void 0)):(d("rowGroupExpansion",this.getRowGroupExpansionState()),d("ssrmRowGroupExpansion",void 0)),d("rowSelection",this.getRowSelectionState()),d("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},n=()=>t("filter",this.getFilterState()),{gos:r,colFilter:o,selectableFilter:s}=this.beans;this.addManagedEventListeners({filterChanged:n,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:i,columnRowGroupChanged:i,rowDataUpdated:()=>{(r.get("groupDefaultExpanded")!==0||r.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(i)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:a=>{(a.newPage||a.newPageSize)&&t("pagination",this.getPaginationState())},pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())}),o&&this.addManagedListeners(o,{filterStateChanged:n}),s&&this.addManagedListeners(s,{selectedFilterChanged:n})}setFirstDataRenderedState(e,t,i){let{scroll:n,cellSelection:r,focusedCell:o,columnOrder:s}=e,a=(d,u)=>!i?.has(d)&&(u||t==="api");a("focusedCell",o)&&this.setFocusedCellState(o),a("cellSelection",r)&&this.setCellSelectionState(r),a("scroll",n)&&this.setScrollState(n),this.setColumnPivotState(!!s?.orderedColIds,t);let l=this.updateCachedState.bind(this);l("sideBar",this.getSideBarState()),l("focusedCell",this.getFocusedCellState());let c=this.getRangeSelectionState();l("rangeSelection",c),l("cellSelection",c),l("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:i,cellFocusCleared:i,cellSelectionChanged:n=>{if(n.finished){let r=this.getRangeSelectionState();t("rangeSelection",r),t("cellSelection",r)}},bodyScrollEnd:()=>t("scroll",this.getScrollState())})}getColumnState(){let e=this.beans;return Aee(tm(e),e.colModel.isPivotMode())}setColumnState(e,t,i,n){let{sort:r,rowGroup:o,aggregation:s,pivot:a,columnPinning:l,columnVisibility:c,columnSizing:d,columnOrder:u}=e,h=!1,p=(X,Z)=>{let me=!n?.has(X)&&!!(Z||t==="api");return h||(h=me),me},f={},g=X=>{let Z=f[X];return Z||(Z={colId:X},f[X]=Z,Z)},m={},v=p("sort",r);v&&r?.sortModel.forEach(({colId:X,sort:Z},me)=>{let oe=g(X);oe.sort=Z,oe.sortIndex=me}),(v||!i)&&(m.sort=null,m.sortIndex=null);let C=p("rowGroup",o);C&&o?.groupColIds.forEach((X,Z)=>{let me=g(X);me.rowGroup=!0,me.rowGroupIndex=Z}),(C||!i)&&(m.rowGroup=null,m.rowGroupIndex=null);let b=p("aggregation",s);b&&s?.aggregationModel.forEach(({colId:X,aggFunc:Z})=>{g(X).aggFunc=Z}),(b||!i)&&(m.aggFunc=null);let S=p("pivot",a);S&&(a?.pivotColIds.forEach((X,Z)=>{let me=g(X);me.pivot=!0,me.pivotIndex=Z}),this.gos.updateGridOptions({options:{pivotMode:!!a?.pivotMode},source:t})),(S||!i)&&(m.pivot=null,m.pivotIndex=null);let E=p("columnPinning",l);if(E){for(let X of l?.leftColIds??[])g(X).pinned="left";for(let X of l?.rightColIds??[])g(X).pinned="right"}(E||!i)&&(m.pinned=null);let x=p("columnVisibility",c);if(x)for(let X of c?.hiddenColIds??[])g(X).hide=!0;(x||!i)&&(m.hide=null);let P=p("columnSizing",d);if(P)for(let{colId:X,flex:Z,width:me}of d?.columnSizingModel??[]){let oe=g(X);oe.flex=Z??null,oe.width=me}(P||!i)&&(m.flex=null);let F=u?.orderedColIds,N=!!F?.length&&!n?.has("columnOrder"),Y=N?F.map(X=>g(X)):Object.values(f);(Y.length||h)&&(this.columnStates=Y,qn(this.beans,{state:Y,applyOrder:N,defaultState:m},t))}setColumnPivotState(e,t){let i=this.columnStates;this.columnStates=void 0;let n=this.columnGroupStates;this.columnGroupStates=void 0;let r=this.beans,{pivotResultCols:o,colGroupSvc:s}=r;if(o?.isPivotResultColsPresent()){if(i){let a=[];for(let l of i)o.getPivotResultCol(l.colId)&&a.push(l);qn(r,{state:a,applyOrder:e},t)}n&&s?.setColumnGroupState(n,t)}}getColumnGroupState(){let e=this.beans.colGroupSvc;if(!e)return;let t=e.getColumnGroupState();return Oee(t)}setColumnGroupState(e,t,i){let n=this.beans.colGroupSvc;if(!n||i?.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;let r=new Set(e.columnGroup?.openColumnGroupIds),s=n.getColumnGroupState().map(({groupId:a})=>{let l=r.has(a);return l&&r.delete(a),{groupId:a,open:l}});for(let a of r)s.push({groupId:a,open:!0});s.length&&(this.columnGroupStates=s),n.setColumnGroupState(s,t)}getFilterState(){let{filterManager:e,selectableFilter:t}=this.beans,i=e?.getFilterModel();i&&Object.keys(i).length===0&&(i=void 0);let n=e?.getFilterState(),r=e?.getAdvFilterModel()??void 0,o=t?.getState();return i||r||n||o?{filterModel:i,columnFilterState:n,advancedFilterModel:r,selectableFilters:o}:void 0}setFilterState(e){let{filterManager:t,selectableFilter:i}=this.beans,{filterModel:n,columnFilterState:r,advancedFilterModel:o,selectableFilters:s}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};s!==void 0&&i?.setState(s??{}),(n!==void 0||r!==void 0)&&t?.setFilterState(n??null,r??null,"columnFilter"),o!==void 0&&t?.setAdvFilterModel(o??null,"advancedFilter")}getRangeSelectionState(){let e=this.beans.rangeSvc?.getCellRanges().map(t=>{let{id:i,type:n,startRow:r,endRow:o,columns:s,startColumn:a}=t;return{id:i,type:n,startRow:r,endRow:o,colIds:s.map(l=>l.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){let{gos:t,rangeSvc:i,colModel:n,visibleCols:r}=this.beans;if(!ho(t)||!i)return;let o=[];for(let s of e?.cellRanges??[]){let a=[];for(let c of s.colIds){let d=n.getCol(c);d&&a.push(d)}if(!a.length)continue;let l=n.getCol(s.startColId);if(!l){let c=r.allCols,d=new Set(a);l=c.find(u=>d.has(u))}o.push(T(w({},s),{columns:a,startColumn:l}))}i.setCellRanges(o)}getScrollState(){if(!this.isClientSideRowModel)return;let e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:i}=e?.getVScrollPosition()??{top:0};return i||t?{top:i,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;let{top:t,left:i}=e??{top:0,left:0},{frameworkOverrides:n,rowRenderer:r,animationFrameSvc:o,ctrlsSvc:s}=this.beans;n.wrapIncoming(()=>{s.get("center").setCenterViewportScrollLeft(i),s.getScrollFeature()?.setVerticalScrollPosition(t),r.redraw({afterScroll:!0}),o?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;let e=this.beans.focusSvc.getFocusedCell();if(e){let{column:t,rowIndex:i,rowPinned:n}=e;return{colId:t.getColId(),rowIndex:i,rowPinned:n}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;let{focusSvc:t,colModel:i}=this.beans;if(!e){t.clearFocusedCell();return}let{colId:n,rowIndex:r,rowPinned:o}=e;t.setFocusedCell({column:i.getCol(n),rowIndex:r,rowPinned:o,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){let{pagination:e,gos:t}=this.beans;if(!e)return;let i=e.getCurrentPage(),n=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!i&&!n))return{page:i,pageSize:n}}setPaginationState(e,t){let{pagination:i,gos:n}=this.beans;if(!i)return;let{pageSize:r,page:o}=e??{page:0,pageSize:n.get("paginationPageSize")},s=t==="gridInitializing";r&&!n.get("paginationAutoPageSize")&&i.setPageSize(r,s?"initialState":"pageSizeSelector"),typeof o=="number"&&(s?i.setPage(o):i.goToPage(o))}getRowSelectionState(){let e=this.beans.selectionSvc;if(!e)return;let t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e,t){this.beans.selectionSvc?.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){let{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){return this.beans.pinnedRowModel?.getPinnedState()}setRowPinningState(e){let t=this.beans.pinnedRowModel;e?t?.setPinnedState(e):t?.reset()}setRowGroupExpansionState(e,t,i){let n=this.beans.expansionSvc;if(!n)return;let r=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};n.setExpansionState(r,i)}updateColumnState(e){let t=this.getColumnState(),i=!1,n=this.cachedState;for(let r of Object.keys(t)){let o=t[r];Nu(o,n[r])||(i=!0)}this.cachedState=w(w({},n),t),i&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){let i=this.cachedState[e];this.setCachedStateValue(e,t),Nu(t,i)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState=T(w({},this.cachedState),{[e]:t})}refreshStaleState(){let e=this.staleStateKeys;for(let t of e)t==="rowSelection"&&this.setCachedStateValue(t,this.getRowSelectionState());e.clear()}dispatchStateUpdateEvent(e){if(!this.suppressEvents){for(let t of e)this.queuedUpdateSources.add(t);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){let e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){this.suppressEvents=!0,this.beans.colAnimation?.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.beans.colAnimation?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},Wre={moduleName:"GridState",version:fe,beans:[Gre],apiFunctions:{getState:Bre,setState:Hre}};function Ure(e){return e.rowModel.isLastRowIndexKnown()}function jre(e){return e.pagination?.getPageSize()??100}function qre(e){return e.pagination?.getCurrentPage()??0}function $re(e){return e.pagination?.getTotalPages()??1}function Kre(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function Yre(e){e.pagination?.goToNextPage()}function Xre(e){e.pagination?.goToPreviousPage()}function Jre(e){e.pagination?.goToFirstPage()}function Qre(e){e.pagination?.goToLastPage()}function Zre(e,t){e.pagination?.goToPage(t)}var eoe=class extends j{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;let t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;let e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){let t=this.beans,i=()=>{let n=Math.max(ha(t),1),r=Math.floor(e/n);t.pagination.setPageSize(r,"autoCalculated")};this.isBodyRendered?Yt(this,i,50)():(i(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},Eu="paginationPageSizeSelector",toe={tag:"span",cls:"ag-paging-page-size"},ioe=class extends st{constructor(){super(toe),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;let e=this.selectPageSizeComp.getValue();if(!e)return;let t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(Eu,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;let t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){ii(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(Eu)!==!1}reloadPageSizesSelector(){let e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),i=!t||!e.includes(t);if(i){let r=this.gos.exists("paginationPageSize"),o=this.gos.get(Eu)!==!0;J(94,{pageSizeSet:r,pageSizesSet:o,pageSizeOptions:e,paginationPageSizeOption:t}),o||J(95,{paginationPageSizeOption:t,paginationPageSizeSelector:Eu}),e.unshift("")}let n=String(i?"":t);this.selectPageSizeComp?(hs(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(n,!0)):this.createPageSizeSelectorComp(e,n),this.hasEmptyOption=i}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){let i=this.getLocaleTextFunc(),n=i("pageSizeSelectorLabel","Page Size:"),r=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new ky).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(r).setLabel(n).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){let e=[20,50,100],t=this.gos.get(Eu);return!Array.isArray(t)||!t?.length?e:[...t].sort((i,n)=>i-n)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},noe={selector:"AG-PAGE-SIZE-SELECTOR",component:ioe},roe=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",ooe=class extends I8{constructor(){super(),this.btFirst=ae,this.btPrevious=ae,this.btNext=ae,this.btLast=ae,this.lbRecordCount=ae,this.lbFirstRowOnPage=ae,this.lbLastRowOnPage=ae,this.lbCurrent=ae,this.lbTotal=ae,this.pageSizeComp=ae,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(roe)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){let e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[noe]);let{btFirst:t,btPrevious:i,btNext:n,btLast:r}=this;this.activateTabIndex([t,i,n,r]),t.insertAdjacentElement("afterbegin",ji(e?"last":"first",this.beans)),i.insertAdjacentElement("afterbegin",ji(e?"next":"previous",this.beans)),n.insertAdjacentElement("afterbegin",ji(e?"previous":"next",this.beans)),r.insertAdjacentElement("afterbegin",ji(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(o):Q$(this.beans,o),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){let t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(let e of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){let{el:t,fn:i}=e;this.addManagedListeners(t,{click:i,keydown:n=>{(n.key===B.ENTER||n.key===B.SPACE)&&(n.preventDefault(),i())}})}J$(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){let t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):Lee(e,this.getLocaleTextFunc.bind(this))}getTemplate(){let e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){let e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),i=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);let n=this.isZeroPagesToDisplay(),r=e===i-1;this.nextButtonDisabled=r||n,this.lastButtonDisabled=!t||n||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){tW(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),i=this.pagination.getMasterRowCount(),n=e?i:null,r=this.pagination.getCurrentPage(),o=this.pagination.getPageSize(),s,a;this.isZeroPagesToDisplay()?s=a=0:(s=o*r+1,a=s+o-1,e&&a>n&&(a=n));let l=s+o-1,c=!e&&i<l,d=this.formatNumber(s);this.lbFirstRowOnPage.textContent=d;let u,h=this.getLocaleTextFunc();c?u=h("pageLastRowUnknown","?"):u=this.formatNumber(a),this.lbLastRowOnPage.textContent=u;let f=t>0?r+1:0,g=this.formatNumber(f);this.lbCurrent.textContent=g;let m,v;if(e)m=this.formatNumber(t),v=this.formatNumber(n);else{let C=h("more","more");m=C,v=C}this.lbTotal.textContent=m,this.lbRecordCount.textContent=v,this.announceAriaStatus(d,u,v,g,m)}announceAriaStatus(e,t,i,n,r){let o=this.getLocaleTextFunc(),s=o("page","Page"),a=o("to","to"),l=o("of","of"),c=`${e} ${a} ${t} ${l} ${i}`,d=`${s} ${n} ${l} ${r}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnounce?.announceValue(c,"paginationRow")),d!==this.ariaPageStatus&&(this.ariaPageStatus=d,this.ariaAnnounce?.announceValue(d,"paginationPage"))}},soe={selector:"AG-PAGINATION",component:ooe},aoe=class extends j{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){let e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return soe}isPaginateChildRows(){let e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){let t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;let{editSvc:i}=this.beans;i?.isEditing()&&(i.isBatchEditing()?i.cleanupEditors():i.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){let e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return pe(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:pe(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:pe(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:pe(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;let e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){let i=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}i!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){let e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);let t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){let e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}let i=this.pageSize,n=t-1;this.totalPages=Math.floor(n/i)+1,this.adjustCurrentPageIfInvalid();let r=this.currentPage,o=i*r,s=i*(r+1)-1;if(s>n&&(s=n),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(o),s===n)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{let a=e.getTopLevelRowDisplayedIndex(s+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){let e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}let{pageSize:t,currentPage:i}=this,n=e-1;this.totalPages=Math.floor(n/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*i,this.bottomDisplayedRowIndex=t*(i+1)-1,this.bottomDisplayedRowIndex>n&&(this.bottomDisplayedRowIndex=n)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){let{keepRenderedRows:t=!1,newPage:i=!1,newPageSize:n=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:i,newPageSize:n,keepRenderedRows:t})}},loe={moduleName:"Pagination",version:fe,beans:[aoe,eoe],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:Ure,paginationGetPageSize:jre,paginationGetCurrentPage:qre,paginationGetTotalPages:$re,paginationGetRowCount:Kre,paginationGoToNextPage:Yre,paginationGoToPreviousPage:Xre,paginationGoToFirstPage:Jre,paginationGoToLastPage:Qre,paginationGoToPage:Zre},dependsOn:[_m]};function coe(e,t={}){let i=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(i))}function qM(e,t,i,n,r){t&&(n&&t.parent&&t.parent.level!==-1&&qM(e,t.parent,i,n,r),t.setExpanded(i,void 0,r))}function doe(e,t){return e.rowModel.getRowNode(t)}function uoe(e,t,i,n){e.rowRenderer.addRenderedRowListener(t,i,n)}function hoe(e){return e.rowRenderer.getRenderedNodes()}function poe(e,t,i){e.rowModel.forEachNode(t,i)}function foe(e){return e.rowRenderer.firstRenderedRow}function goe(e){return e.rowRenderer.lastRenderedRow}function moe(e,t){return e.rowModel.getRow(t)}function voe(e){return e.rowModel.getRowCount()}var Coe={moduleName:"RowApi",version:fe,apiFunctions:{redrawRows:coe,setRowNodeExpanded:qM,getRowNode:doe,addRenderedRowListener:uoe,getRenderedNodes:hoe,forEachNode:poe,getFirstDisplayedRowIndex:foe,getLastDisplayedRowIndex:goe,getDisplayedRowAtIndex:moe,getDisplayedRowCount:voe}},woe={moduleName:"ScrollApi",version:fe,apiFunctions:{getVerticalPixelRange:Fie,getHorizontalPixelRange:Mie,ensureColumnVisible:TM,ensureIndexVisible:IM,ensureNodeVisible:Tie}};function boe(e,t,i){if(!t)return;let n=e.ctrlsSvc.getGridBodyCtrl().eGridBody,r=`aria-${t}`;i===null?n.removeAttribute(r):n.setAttribute(r,i)}function yoe(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function Soe(e){e.frameworkOverrides.wrapIncoming(()=>{for(let t of e.ctrlsSvc.getHeaderRowContainerCtrls())t.refresh()})}function xoe(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function Eoe(e){e.animationFrameSvc?.flushAllFrames()}function Roe(e){return{rowHeight:ha(e),headerHeight:th(e)}}function Poe(e,t={}){let i=[];for(let o of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns)){let s=o.getCellRenderer();s!=null&&i.push(ju(s))}if(t.columns?.length)return i;let n=[],r=Zb(t.rowNodes);for(let o of e.rowRenderer.getAllRowCtrls()){if(r&&!ey(o.rowNode,r)||!o.isFullWidth())continue;let s=o.getFullWidthCellRenderers();for(let a=0;a<s.length;a++){let l=s[a];l!=null&&n.push(ju(l))}}return[...n,...i]}var koe={moduleName:"RenderApi",version:fe,apiFunctions:{setGridAriaProperty:boe,refreshCells:yoe,refreshHeader:Soe,isAnimationFrameQueueEmpty:xoe,flushAllAnimationFrames:Eoe,getSizesForCurrentTheme:Roe,getCellRendererInstances:Poe}},_oe=":where(.ag-ltr) :where(.ag-animate-autosize){.ag-cell,.ag-header-cell,.ag-header-group-cell{transition:width .2s ease-in-out,left .2s ease-in-out}}:where(.ag-rtl) :where(.ag-animate-autosize){.ag-cell,.ag-header-cell,.ag-header-group-cell{transition:width .2s ease-in-out,right .2s ease-in-out}}";function Doe(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function $M({colAutosize:e,visibleCols:t},i,n){Array.isArray(i)?e?.autoSizeCols({colKeys:i,skipHeader:n,source:"api"}):e?.autoSizeCols(T(w({},i),{colKeys:i.colIds??t.allCols,source:"api"}))}function Foe(e,t){t&&typeof t=="object"?$M(e,t):e.colAutosize?.autoSizeAllColumns({source:"api",skipHeader:t})}var Moe=class extends j{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){let{gos:e}=this,t=e.get("autoSizeStrategy");if(t){let i=!1,n=t.type;if(n==="fitGridWidth"||n==="fitProvidedWidth")i=!0;else if(n==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(t)});let r=e.get("rowData");i=r!=null&&r.length>0&&_t(e)}i&&this.beans.colDelayRenderSvc?.hideColumns(n)}}autoSizeCols(e){let{eventSvc:t,visibleCols:i,colModel:n}=this.beans;Ru(this.beans,!0),this.innerAutoSizeCols(e).then(r=>{let o=d=>ic(t,Array.from(d),!0,"autosizeColumns");if(!e.scaleUpToFitGridWidth)return Ru(this.beans,!1),o(r);let s=ND(this.beans),a=d=>i.leftCols.some(u=>Tu(u,d)),l=d=>i.rightCols.some(u=>Tu(u,d)),c=e.colKeys.filter(d=>!n.getCol(d)?.getColDef().suppressAutoSize&&!lo(d)&&!a(d)&&!l(d));this.sizeColumnsToFit(s,e.source,!0,{defaultMaxWidth:e.defaultMaxWidth,defaultMinWidth:e.defaultMinWidth,columnLimits:e.columnLimits?.map(d=>T(w({},d),{key:d.colId})),colKeys:c,onlyScaleUp:!0,animate:!1}),Ru(this.beans,!1),o(r)})}innerAutoSizeCols(e){return new Promise((t,i)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(e).then(t,i));let{colKeys:n,skipHeader:r,skipHeaderGroups:o,stopAtGroup:s,defaultMaxWidth:a,defaultMinWidth:l,columnLimits:c=[],source:d="api"}=e,{animationFrameSvc:u,renderStatus:h,colModel:p,autoWidthCalc:f,visibleCols:g}=this.beans;if(u?.flushAllFrames(),this.timesDelayed<5&&h&&(!h.areHeaderCellsRendered()||!h.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(e).then(t,i)});return}this.timesDelayed=0;let m=new Set,v=-1,C=Object.fromEntries(c.map(P=>{var F=P,{colId:E}=F,x=xt(F,["colId"]);return[E,x]})),b=r??this.gos.get("skipHeaderOnAutoSize"),S=o??b;for(;v!==0;){v=0;let E=[];for(let x of n){if(!x||vU(x))continue;let P=p.getCol(x);if(!P||m.has(P)||P.getColDef().suppressAutoSize)continue;let F=f.getPreferredWidthForColumn(P,b);if(F>0){let N=C[P.colId]??{};N.minWidth??(N.minWidth=l),N.maxWidth??(N.maxWidth=a);let Y=Toe(P,F,N);P.setActualWidth(Y,d),m.add(P),v++}E.push(P)}E.length&&g.refresh(d)}S||this.autoSizeColumnGroupsByColumns(n,d,s),t(m)})}autoSizeColumn(e,t,i){this.autoSizeCols({colKeys:[e],skipHeader:i,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,i){let{colModel:n,ctrlsSvc:r}=this.beans,o=new Set,s=n.getColsForKeys(e);for(let l of s){let c=l.getParent();for(;c&&c!=i;)c.isPadding()||o.add(c),c=c.getParent()}let a;for(let l of o){for(let c of r.getHeaderRowContainerCtrls())if(a=c.getHeaderCtrlForColumn(l),a)break;a?.resizeLeafColumnsToFit(t)}}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}this.autoSizeCols(w({colKeys:this.beans.visibleCols.allCols},e))}addColumnAutosizeListeners(e,t){let i=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.autoSizeColumn(t,"uiColumnResized",i)};e.addEventListener("dblclick",n);let r=new aa(e);return r.addEventListener("doubleTap",n),()=>{e.removeEventListener("dblclick",n),r.destroy()}}addColumnGroupResize(e,t,i){let n=this.gos.get("skipHeaderOnAutoSize"),r=()=>{let o=[],s=t.getDisplayedLeafColumns();for(let a of s)a.getColDef().suppressAutoSize||o.push(a.getColId());o.length>0&&this.autoSizeCols({colKeys:o,skipHeader:n,stopAtGroup:t,source:"uiColumnResized"}),i()};return e.addEventListener("dblclick",r),()=>e.removeEventListener("dblclick",r)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;let i=ND(this.beans);if(i>0){this.sizeColumnsToFit(i,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):J(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",i,n){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,i,n));return}let{beans:r}=this,o=n?.animate??!0;o&&Ru(r,!0);let s={};for(let m of n?.columnLimits??[]){let v=m,{key:C}=v,b=xt(v,["key"]);s[typeof C=="string"?C:C.getColId()]=b}let a=r.visibleCols.allCols;if(e<=0||!a.length)return;let l=so(a);if(n?.onlyScaleUp&&l>e||e===l&&a.every(b=>{if(b.colDef.suppressSizeToFit)return!0;let S=s?.[b.getId()],E=S?.minWidth??n?.defaultMinWidth,x=S?.maxWidth??n?.defaultMaxWidth,P=b.getActualWidth();return(E==null||P>=E)&&(x==null||P<=x)}))return;let d=[],u=[];for(let C of a){let b=n?.colKeys?.some(S=>Tu(C,S))??!0;C.getColDef().suppressSizeToFit||!b?u.push(C):d.push(C)}let h=d.slice(0),p=!1,f=C=>{Mr(d,C),u.push(C)};for(let C of d){C.resetActualWidth(t);let b=s?.[C.getId()],S=b?.minWidth??n?.defaultMinWidth,E=b?.maxWidth??n?.defaultMaxWidth,x=C.getActualWidth();typeof S=="number"&&x<S?C.setActualWidth(S,t,!0):typeof E=="number"&&x>E&&C.setActualWidth(E,t,!0)}for(;!p;){p=!0;let C=e-so(u);if(C<=0)for(let b of d){let S=s?.[b.getId()]?.minWidth??n?.defaultMinWidth??b.minWidth;b.setActualWidth(S,t,!0)}else{let b=C/so(d),S=C;for(let E=d.length-1;E>=0;E--){let x=d[E],P=s?.[x.getId()],F=P?.minWidth??n?.defaultMinWidth,N=P?.maxWidth??n?.defaultMaxWidth,Y=x.getMinWidth(),X=x.getMaxWidth(),Z=typeof F=="number"&&F>Y?F:Y,me=typeof N=="number"&&N<X?N:X,oe=Math.round(x.getActualWidth()*b);oe<Z?(oe=Z,f(x),p=!1):oe>me?(oe=me,f(x),p=!1):E===0&&(oe=S),x.setActualWidth(oe,t,!0),S-=oe}}}for(let C of h)C.fireColumnWidthChangedEvent(t);let g=r.visibleCols;g.setLeftValues(t),g.updateBodyWidths(),!i&&(ic(this.eventSvc,h,!0,t),o&&Ru(r,!1))}applyAutosizeStrategy(){let{gos:e,colDelayRenderSvc:t}=this.beans,i=e.get("autoSizeStrategy");i?.type!=="fitGridWidth"&&i?.type!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;let n=i.type;if(n==="fitGridWidth"){let{columnLimits:r,defaultMinWidth:o,defaultMaxWidth:s}=i,a=r?.map(({colId:l,minWidth:c,maxWidth:d})=>({key:l,minWidth:c,maxWidth:d}));this.sizeColumnsToFitGridBody({defaultMinWidth:o,defaultMaxWidth:s,columnLimits:a})}else n==="fitProvidedWidth"&&this.sizeColumnsToFit(i.width,"sizeColumnsToFit");t?.revealColumns(n)})}onFirstDataRendered(i){var n=i,{colIds:e}=n,t=xt(n,["colIds"]);setTimeout(()=>{if(!this.isAlive())return;let r="autosizeColumns";e?this.autoSizeCols(T(w({},t),{source:r,colKeys:e})):this.autoSizeAllColumns(T(w({},t),{source:r})),this.beans.colDelayRenderSvc?.revealColumns(t.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(let e of this.resizeOperationQueue)e();this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function Toe(e,t,i={}){let n=i.minWidth??e.getMinWidth();t<n&&(t=n);let r=i.maxWidth??e.getMaxWidth();return t>r&&(t=r),t}function ND({ctrlsSvc:e,scrollVisibleSvc:t}){let i=e.getGridBodyCtrl(),r=i.isVerticalScrollShowing()?t.getScrollbarWidth():0;return zu(i.eGridBody)-r}var BD="ag-animate-autosize";function Ru({ctrlsSvc:e,gos:t},i){if(!t.get("animateColumnResizing")||t.get("enableRtl")||!e.isAlive())return;let n=e.getGridBodyCtrl().eGridBody.classList;i?n.add(BD):n.remove(BD)}var Ioe={moduleName:"ColumnAutoSize",version:fe,beans:[Moe],apiFunctions:{sizeColumnsToFit:Doe,autoSizeColumns:$M,autoSizeAllColumns:Foe},dependsOn:[z8],css:[_oe]},Aoe=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function Ooe(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function Loe(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function Noe(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function Boe(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}function Hoe(e,t,i){return e.pinnedRowModel?.forEachPinnedRow(t,i)}var zoe={moduleName:"PinnedRow",version:fe,beans:[HK],css:[Aoe],apiFunctions:{getPinnedTopRowCount:Ooe,getPinnedBottomRowCount:Loe,getPinnedTopRow:Noe,getPinnedBottomRow:Boe,forEachPinnedRow:Hoe},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},Voe=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){let e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;for(let i of this.spannedNodes)i!==this.lastNode&&(t+=i.rowHeight);return e-t}},Goe=class extends j{constructor(e){super(),this.column=e}buildCache(e){let{column:t,beans:{gos:i,pinnedRowModel:n,rowModel:r,valueSvc:o,pagination:s}}=this,{colDef:a}=t,l=this.getNodeMap(e),c=new Map,d=i.getCallback("isFullWidthRow"),u=a.equals,h=a.spanRows,p=typeof h=="function",f=null,g=null,m,v=(b,S)=>{f=b,g=null,m=S},C=b=>{let S=!b.isExpandable()&&!b.group&&!b.detail&&(d?!d({rowNode:b}):!0);if(b.rowIndex==null||!S){v(null,null);return}if(f==null||b.level!==f.level||b.footer||g&&b.rowIndex-1!==g?.getLastNode().rowIndex){v(b,o.getValue(t,b));return}let E=o.getValue(t,b);if(p){let x=_e(i,{valueA:m,nodeA:f,valueB:E,nodeB:b,column:t,colDef:a});if(!h(x)){v(b,E);return}}else if(u?!u(m,E):m!==E){v(b,E);return}if(!g){let x=l?.get(f);x?.firstNode===f?(x.reset(),g=x):g=new Voe(t,f),c.set(f,g)}g.addSpannedNode(b),c.set(b,g)};switch(e){case"center":r.forEachDisplayedNode?.(b=>{(!s||s.isRowInPage(b.rowIndex))&&C(b)}),this.centerValueNodeMap=c;break;case"top":n?.forEachPinnedRow("top",C),this.topValueNodeMap=c;break;case"bottom":n?.forEachPinnedRow("bottom",C),this.bottomValueNodeMap=c;break}}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this.getNodeMap(e.rowPinned).get(e)}getNodeMap(e){switch(e){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},Woe=class extends j{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=Yt(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=Yt(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){let e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){let{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;let i=this.createManagedBean(new Goe(e));this.spanningColumns.set(e,i),i.buildCache("top"),i.buildCache("bottom"),i.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){let{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){let i=this.spanningColumns.get(e);return i?i.isCellSpanning(t):!1}getCellSpanByPosition(e){let{pinnedRowModel:t,rowModel:i}=this.beans,n=e.column,r=e.rowIndex,o=this.spanningColumns.get(n);if(!o)return;let s;switch(e.rowPinned){case"top":s=t?.getPinnedTopRow(r);break;case"bottom":s=t?.getPinnedBottomRow(r);break;default:s=i.getRow(r)}if(s)return o.getCellSpan(s)}getCellStart(e){let t=this.getCellSpanByPosition(e);return t?T(w({},e),{rowIndex:t.firstNode.rowIndex}):e}getCellEnd(e){let t=this.getCellSpanByPosition(e);return t?T(w({},e),{rowIndex:t.getLastNode().rowIndex}):e}getCellSpan(e,t){let i=this.spanningColumns.get(e);if(i)return i.getCellSpan(t)}forEachSpannedColumn(e,t){for(let[i,n]of this.spanningColumns)if(n.isCellSpanning(e)){let r=n.getCellSpan(e);t(i,r)}}destroy(){super.destroy(),this.spanningColumns.clear()}},Uoe=class extends Zl{constructor(e,t,i){super(e.col,e.firstNode,i,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,i,n,r,o,s){this.eWrapper=i,super.setComp(e,t,i,n,r,o,s),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){let{eGui:e,rowNode:t}=this;!e||t.rowIndex==null||Ug(e,t.rowIndex)}setAriaRowSpan(){sW(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){let e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){let{beans:t}=this;if(xm(t)){this.focusedCellPosition=void 0;return}let i=this.isCellFocused();i||(this.focusedCellPosition=void 0),e&&i&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},joe=class extends dm{onRowIndexChanged(){super.onRowIndexChanged();for(let e of this.getAllCellCtrls())e.refreshAriaRowIndex()}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){let t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new Uoe(t,this,this.beans)}isCorrectCtrlForSpan(e){let t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},qoe=class extends j{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){let{rowSpanSvc:t}=this.beans,i=this.getCtrlsMap(e),n=i.size,r=this.getAllRelevantRowControls(e),o=new Map,s=!1;for(let l of r)l.isAlive()&&t?.forEachSpannedColumn(l.rowNode,(c,d)=>{if(o.has(d.firstNode))return;let u=i.get(d.firstNode);if(u){o.set(d.firstNode,u),i.delete(d.firstNode);return}s=!0;let h=new joe(d.firstNode,this.beans,!1,!1,!1);o.set(d.firstNode,h)});this.setCtrlsMap(e,o);let a=o.size===n;if(!(!s&&a)){for(let l of i.values())l.destroyFirstPass(!0),l.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){let{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){let{rowSpanSvc:t}=this.beans,i=t?.getCellSpanByPosition(e);if(!i)return;let n=this.getCtrlsMap(e.rowPinned).get(i.firstNode);if(n)return n.getAllCellCtrls().find(r=>r.column===e.column)}getCtrls(e){return[...this.getCtrlsMap(e).values()]}destroyRowCtrls(e){for(let t of this.getCtrlsMap(e).values())t.destroyFirstPass(!0),t.destroySecondPass();this.setCtrlsMap(e,new Map)}getCtrlsMap(e){switch(e){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(e,t){switch(e){case"top":this.topCtrls=t;break;case"bottom":this.bottomCtrls=t;break;default:this.centerCtrls=t;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},$oe={moduleName:"CellSpan",version:fe,beans:[Woe,qoe]},Koe=class extends j{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){let{column:e,cellComp:t}=this,i=e.colDef,n=i.cellClassRules,r=this.getCellClassParams(e,i);Ky(this.beans.expressionSvc,n===this.cellClassRules?void 0:this.cellClassRules,n,r,o=>t.toggleCss(o,!0),o=>t.toggleCss(o,!1)),this.cellClassRules=n}applyUserStyles(){let e=this.column,t=e.colDef,i=t.cellStyle;if(!i)return;let n;if(typeof i=="function"){let r=this.getCellClassParams(e,t);n=i(r)}else n=i;n&&this.cellComp.setUserStyles(n)}applyClassesFromColDef(){let{column:e,cellComp:t}=this,i=e.colDef,n=this.getCellClassParams(e,i);for(let o of this.staticClasses)t.toggleCss(o,!1);let r=this.beans.cellStyles.getStaticCellClasses(i,n);this.staticClasses=r;for(let o of r)t.toggleCss(o,!0)}getCellClassParams(e,t){let{value:i,rowNode:n}=this.cellCtrl;return _e(this.beans.gos,{value:i,data:n.data,node:n,colDef:t,column:e,rowIndex:n.rowIndex})}},Yoe=class extends j{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,i,n){Ky(this.beans.expressionSvc,void 0,e.cellClassRules,t,i,n),this.processStaticCellClasses(e,t,i)}getStaticCellClasses(e,t){let{cellClass:i}=e;if(!i)return[];let n;return typeof i=="function"?n=i(t):n=i,typeof n=="string"&&(n=[n]),n||[]}createCellCustomStyleFeature(e){return new Koe(e,this.beans)}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach(r=>{i(r)})}},Xoe={moduleName:"CellStyle",version:fe,beans:[Yoe]},Joe={moduleName:"RowStyle",version:fe,beans:[EZ]};function Qoe(e,t){return!!e.colHover?.isHovered(t)}var Zoe=class extends j{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=i=>{let{beans:n,gos:r,element:o,columns:s}=this,a=n.colHover;if(i??!!r.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(o,{mouseover:a.setMouseOver.bind(a,s),mouseout:a.clearMouseOver.bind(a)});else{for(let c of this.destroyManagedListeners)c();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},ese="ag-column-hover",tse=class extends j{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;let t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,i){let n=()=>{let r=this.isHovered(i);t.toggleCss("ag-column-hover",r)};e.addManagedEventListeners({columnHoverChanged:n}),n()}onCellColumnHover(e,t){if(!t)return;let i=this.isHovered(e);t.toggleCss(ese,i)}addHeaderFilterColumnHoverListener(e,t,i,n){this.createHoverFeature(e,[i],n);let r=()=>{let o=this.isHovered(i);t.toggleCss("ag-column-hover",o)};e.addManagedEventListeners({columnHoverChanged:r}),r()}createHoverFeature(e,t,i){e.createManagedBean(new Zoe(t,i))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},ise={moduleName:"ColumnHover",version:fe,beans:[tse],apiFunctions:{isColumnHovered:Qoe}},nse=class extends j{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addListener(e,t){let i=this.wrapSvc?.wrap(e,t)??t,n=!zg.has(e),r=n?this.asyncListeners:this.syncListeners;r.has(e)||r.set(e,new Set),r.get(e).add(i),this.eventSvc.addListener(e,i,n)}removeListener(e,t){let i=this.wrapSvc?.unwrap(e,t)??t,r=!!this.asyncListeners.get(e)?.delete(i);r||this.syncListeners.get(e)?.delete(i),this.eventSvc.removeListener(e,i,r)}addGlobalListener(e){let t=this.wrapSvc?.wrapGlobal(e)??e,i=(o,s)=>{zg.has(o)&&t(o,s)},n=(o,s)=>{zg.has(o)||t(o,s)};this.globalListenerPairs.set(e,{syncListener:i,asyncListener:n});let r=this.eventSvc;r.addGlobalListener(i,!1),r.addGlobalListener(n,!0)}removeGlobalListener(e){let{eventSvc:t,wrapSvc:i,globalListenerPairs:n}=this,r=i?.unwrapGlobal(e)??e;if(n.has(r)){let{syncListener:s,asyncListener:a}=n.get(r);t.removeGlobalListener(s,!1),t.removeGlobalListener(a,!0),n.delete(e)}else this.syncGlobalListeners.delete(r),t.removeGlobalListener(r,!1)}destroyEventListeners(e,t){e.forEach((i,n)=>{i.forEach(r=>this.eventSvc.removeListener(n,r,t)),i.clear()}),e.clear()}destroyGlobalListeners(e,t){for(let i of e)this.eventSvc.removeGlobalListener(i,t);e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);let{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:i,asyncListener:n})=>{t.removeGlobalListener(i,!1),t.removeGlobalListener(n,!0)}),e.clear()}};function rse(e,t,i){e.apiEventSvc?.addListener(t,i)}function ose(e,t,i){e.apiEventSvc?.removeListener(t,i)}function sse(e,t){e.apiEventSvc?.addGlobalListener(t)}function ase(e,t){e.apiEventSvc?.removeGlobalListener(t)}var lse={moduleName:"EventApi",version:fe,apiFunctions:{addEventListener:rse,addGlobalListener:sse,removeEventListener:ose,removeGlobalListener:ase},beans:[nse]},cse={moduleName:"Locale",version:fe,beans:[Iee]},dse=class extends j{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=Yt(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){let{visibleCols:e,rowModel:t,rowSpanSvc:i,pinnedRowModel:n}=this.beans,r=e.autoHeightCols,o=!1,s=a=>{let l=a.__autoHeights,c=ls(this.beans,a).height;for(let d of r){let u=l?.[d.getColId()],h=i?.getCellSpan(d,a);if(h){if(h.getLastNode()!==a)continue;if(u=i?.getCellSpan(d,a)?.getLastNodeAutoHeight(),!u)return}if(u==null){if(this.colSpanSkipCell(d,a))continue;return}c=Math.max(u,c)}c!==a.rowHeight&&(a.setRowHeight(c),o=!0)};n?.forEachPinnedRow?.("top",s),n?.forEachPinnedRow?.("bottom",s),t.forEachDisplayedNode?.(s),o&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,i){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[i.getId()];return}let n=e.__autoHeights[i.getId()];e.__autoHeights[i.getId()]=t,n!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){let{colModel:i,colViewport:n,visibleCols:r}=this.beans;if(!i.colSpanActive)return!1;let o=[];switch(e.getPinned()){case"left":o=r.getLeftColsForRow(t);break;case"right":o=r.getRightColsForRow(t);break;case null:o=n.getColsWithinViewport(t);break}return!o.includes(e)}setupCellAutoHeight(e,t,i){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;let n=t.parentElement,{rowNode:r,column:o}=e,s=this.beans,a=d=>{if(this.beans.editSvc?.isEditing(e)||!e.isAlive()||!i.isAlive())return;let{paddingTop:u,paddingBottom:h,borderBottomWidth:p,borderTopWidth:f}=ya(n),g=u+h+p+f,v=t.offsetHeight+g;if(d<5){let b=!Kt(s)?.contains(t),S=v==0;if(b||S){window.setTimeout(()=>a(d+1),0);return}}this.setRowAutoHeight(r,v,o)},l=()=>a(0);l();let c=us(s,t,l);return i.addDestroyFunc(()=>{c(),this.setRowAutoHeight(r,void 0,o)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;let e=this.beans.rowRenderer.getAllRowCtrls(),t=null;for(let{rowNode:i}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(i).filter(r=>r.isAutoHeight())),t.length!==0){if(!i.__autoHeights)return!1;for(let n of t){let r=i.__autoHeights[n.getColId()];if(!r||i.rowHeight<r)return!1}}return!0}},use={moduleName:"RowAutoHeight",version:fe,beans:[dse]},Mm={moduleName:"AllCommunity",version:fe,dependsOn:[cre,vre,kre,Jee,cne,dne,une,hne,pne,fne,gne,lne,tie,iie,nie,eie,oie,sie,Wre,Vne,loe,V8,Coe,woe,koe,Ioe,GY,zoe,Mne,gee,Xoe,ise,Joe,lse,Cee,Nre,MM,cse,use,VY,dre,$oe]};var hse=(()=>{class e{constructor(){this.vcr=ce(Oa)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=Ae({type:e,selectors:[["ag-component-container"]],standalone:!1,decls:0,vars:0,template:function(n,r){},encapsulation:2})}}return e})(),XM=16,rS=0;function pse(e){let t=new Map;for(let i=0;i<XM;i++){let n=e.createComponent(hse);t.set(i,n),Wi(n.location.nativeElement)}return t}var fse=new Set(["doesFilterPass","isFilterActive"]),KM=(()=>{class e extends gM{setViewContainerRef(i,n){this.viewContainerRef=i,this.angularFrameworkOverrides=n}createWrapper(i){let n=this.angularFrameworkOverrides,r=this;r.compShards??=pse(this.viewContainerRef);class o extends oS{init(l){n.runInsideAngular(()=>{super.init(l),this._componentRef.changeDetectorRef.detectChanges()})}createComponent(){return r.createComponent(i)}hasMethod(l){return s.getFrameworkComponentInstance()[l]!=null}callMethod(l,c){let d=this.getFrameworkComponentInstance(),u=d[l];return fse.has(l)?u.apply(d,c):n.runInsideAngular(()=>u.apply(d,c))}addMethod(l,c){s[l]=c}}let s=new o;return s}createComponent(i){return rS=(rS+1)%XM,this.compShards.get(rS).instance.vcr.createComponent(i)}static{this.\u0275fac=(()=>{let i;return function(r){return(i||(i=xo(e)))(r||e)}})()}static{this.\u0275prov=Jn({token:e,factory:e.\u0275fac})}}return e})(),oS=class{init(t){this._params=t,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,Wi(this._eGui),this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}getRootElement(){return this._eGui.firstChild}destroy(){this._frameworkComponentInstance&&typeof this._frameworkComponentInstance.destroy=="function"&&this._frameworkComponentInstance.destroy(),this._componentRef?.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}},Tm=class{constructor(t){this.frameworkOverrides=t,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(t,i){let{frameworkOverrides:n,wrappedListeners:r}=this,o=i;if(n.shouldWrapOutgoing){o=a=>{n.wrapOutgoing(()=>i(a))};let s=r.get(t);s||(s=new Map,r.set(t,s)),s.set(i,o)}return o}wrapGlobal(t){let{frameworkOverrides:i,wrappedGlobalListeners:n}=this,r=t;return i.shouldWrapOutgoing&&(r=(o,s)=>{i.wrapOutgoing(()=>t(o,s))},n.set(t,r)),r}unwrap(t,i){let{wrappedListeners:n}=this,r=n.get(t);if(r){let o=r.get(i);if(o)return r.delete(i),r.size===0&&n.delete(t),o}return i}unwrapGlobal(t){let{wrappedGlobalListeners:i}=this,n=i.get(t);return n?(i.delete(t),n):t}},YM=(()=>{class e extends Gy{constructor(i){super("angular"),this._ngZone=i,this.batchFrameworkComps=!0,this.isRunningWithinTestZone=!1,this.wrapIncoming=(n,r)=>this.runOutside(n,r),this.wrapOutgoing=n=>this.runInsideAngular(n),this.isRunningWithinTestZone=window?.AG_GRID_UNDER_TEST??!!window?.Zone?.AsyncTestZoneSpec,this._ngZone?this.isRunningWithinTestZone?this.runOutside=(n,r)=>r==="resize-observer"||r==="popupPositioning"?this._ngZone.runOutsideAngular(n):n():this.runOutside=n=>this._ngZone.runOutsideAngular(n):this.runOutside=n=>n()}get shouldWrapOutgoing(){return this._ngZone&&Ni.isInAngularZone()}createLocalEventListenerWrapper(i,n){if(this.shouldWrapOutgoing)return i??(n.setFrameworkOverrides(this),new Tm(this))}createGlobalEventListenerWrapper(){return new Tm(this)}isFrameworkComponent(i){if(!i)return!1;let n=i.prototype;return n&&"agInit"in n}runInsideAngular(i){return!this._ngZone||Ni.isInAngularZone()?i():this._ngZone.run(i)}runOutsideAngular(i,n){return this.runOutside(i,n)}static{this.\u0275fac=function(n){return new(n||e)(b2(Ni))}}static{this.\u0275prov=Jn({token:e,factory:e.\u0275fac})}}return e})(),cc=(()=>{class e{constructor(i,n,r,o){this._viewContainerRef=n,this._angularFrameworkOverrides=r,this._frameworkCompWrapper=o,this._initialised=!1,this._destroyed=!1,this._holdEvents=!0,this._fullyReady=new Promise(s=>{this._resolveFullyReady=s}),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.columnMenu=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipTrigger=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.tooltipShowMode=void 0,this.tooltipInteraction=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.dataTypeDefinitions=void 0,this.maintainColumnOrder=void 0,this.enableStrictPivotColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.hidePaddedHeaderRows=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressMoveWhenColumnDragging=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressGroupChangesColumnVisibility=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.autoSizeStrategy=void 0,this.animateColumnResizing=void 0,this.components=void 0,this.editType=void 0,this.suppressStartEditOnTab=void 0,this.getFullRowEditValidationErrors=void 0,this.invalidEditValueMode=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterNavigatesVertically=void 0,this.enterNavigatesVerticallyAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.findSearchValue=void 0,this.findOptions=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.includeHiddenColumnsInQuickFilter=void 0,this.quickFilterParser=void 0,this.quickFilterMatcher=void 0,this.applyQuickFilterBeforePivotOrAgg=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableAdvancedFilter=void 0,this.alwaysPassFilter=void 0,this.includeHiddenColumnsInAdvancedFilter=void 0,this.advancedFilterParent=void 0,this.advancedFilterBuilderParams=void 0,this.advancedFilterParams=void 0,this.suppressAdvancedFilterEval=void 0,this.suppressSetFilterByDefault=void 0,this.enableFilterHandlers=void 0,this.filterHandlers=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.chartToolPanelsDef=void 0,this.chartMenuItems=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.loading=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.suppressOverlays=void 0,this.overlayComponent=void 0,this.overlayComponentParams=void 0,this.overlayComponentSelector=void 0,this.activeOverlay=void 0,this.activeOverlayParams=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationPageSizeSelector=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotMaxGeneratedColumns=void 0,this.pivotDefaultExpanded=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.formulaDataSource=void 0,this.formulaFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.alwaysAggregateAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.cellFlashDuration=void 0,this.cellFadeDuration=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableCellSpan=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.refreshAfterGroupEdit=void 0,this.rowDragInsertDelay=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.dragAndDropImageComponent=void 0,this.dragAndDropImageComponentParams=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupLockGroupColumns=void 0,this.groupAggFiltering=void 0,this.groupTotalRow=void 0,this.grandTotalRow=void 0,this.suppressStickyTotalRow=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupHideParentOfSingleChild=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererParams=void 0,this.treeData=void 0,this.treeDataChildrenField=void 0,this.treeDataParentIdField=void 0,this.rowGroupPanelSuppressSort=void 0,this.suppressGroupRowsSticky=void 0,this.groupHierarchyConfig=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.enableRowPinning=void 0,this.isRowPinnable=void 0,this.isRowPinned=void 0,this.rowModelType=void 0,this.rowData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.suppressServerSideFullWidthLoadingRow=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideEnableClientSideSort=void 0,this.serverSideOnlyRefreshFilteredGroups=void 0,this.serverSidePivotResultFieldSeparator=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.cellSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellFocus=void 0,this.suppressHeaderFocus=void 0,this.selectionColumnDef=void 0,this.rowNumbers=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.gridId=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.enableGroupEdit=void 0,this.initialState=void 0,this.theme=void 0,this.loadThemeGoogleFonts=void 0,this.themeCssLayer=void 0,this.styleNonce=void 0,this.themeStyleContainer=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processUnpinnedColumns=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.focusGridInnerElement=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.ssrmExpandAllAffectsAllRows=void 0,this.initialGroupOrderComparator=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthRow=void 0,this.isRowValidDropPosition=void 0,this.toolPanelVisibleChanged=new $,this.toolPanelSizeChanged=new $,this.columnMenuVisibleChanged=new $,this.contextMenuVisibleChanged=new $,this.cutStart=new $,this.cutEnd=new $,this.pasteStart=new $,this.pasteEnd=new $,this.columnVisible=new $,this.columnPinned=new $,this.columnResized=new $,this.columnMoved=new $,this.columnValueChanged=new $,this.columnPivotModeChanged=new $,this.columnPivotChanged=new $,this.columnGroupOpened=new $,this.newColumnsLoaded=new $,this.gridColumnsChanged=new $,this.displayedColumnsChanged=new $,this.virtualColumnsChanged=new $,this.columnEverythingChanged=new $,this.columnsReset=new $,this.columnHeaderMouseOver=new $,this.columnHeaderMouseLeave=new $,this.columnHeaderClicked=new $,this.columnHeaderContextMenu=new $,this.componentStateChanged=new $,this.cellValueChanged=new $,this.cellEditRequest=new $,this.rowValueChanged=new $,this.cellEditingStarted=new $,this.cellEditingStopped=new $,this.rowEditingStarted=new $,this.rowEditingStopped=new $,this.bulkEditingStarted=new $,this.bulkEditingStopped=new $,this.batchEditingStarted=new $,this.batchEditingStopped=new $,this.undoStarted=new $,this.undoEnded=new $,this.redoStarted=new $,this.redoEnded=new $,this.cellSelectionDeleteStart=new $,this.cellSelectionDeleteEnd=new $,this.rangeDeleteStart=new $,this.rangeDeleteEnd=new $,this.fillStart=new $,this.fillEnd=new $,this.filterOpened=new $,this.filterChanged=new $,this.filterModified=new $,this.filterUiChanged=new $,this.floatingFilterUiChanged=new $,this.advancedFilterBuilderVisibleChanged=new $,this.findChanged=new $,this.chartCreated=new $,this.chartRangeSelectionChanged=new $,this.chartOptionsChanged=new $,this.chartDestroyed=new $,this.cellKeyDown=new $,this.gridReady=new $,this.firstDataRendered=new $,this.gridSizeChanged=new $,this.modelUpdated=new $,this.virtualRowRemoved=new $,this.viewportChanged=new $,this.bodyScroll=new $,this.bodyScrollEnd=new $,this.dragStarted=new $,this.dragStopped=new $,this.dragCancelled=new $,this.stateUpdated=new $,this.paginationChanged=new $,this.rowDragEnter=new $,this.rowDragMove=new $,this.rowDragLeave=new $,this.rowDragEnd=new $,this.rowDragCancel=new $,this.rowResizeStarted=new $,this.rowResizeEnded=new $,this.columnRowGroupChanged=new $,this.rowGroupOpened=new $,this.expandOrCollapseAll=new $,this.pivotMaxColumnsExceeded=new $,this.pinnedRowDataChanged=new $,this.pinnedRowsChanged=new $,this.rowDataUpdated=new $,this.asyncTransactionsFlushed=new $,this.storeRefreshed=new $,this.headerFocused=new $,this.cellClicked=new $,this.cellDoubleClicked=new $,this.cellFocused=new $,this.cellMouseOver=new $,this.cellMouseOut=new $,this.cellMouseDown=new $,this.rowClicked=new $,this.rowDoubleClicked=new $,this.rowSelected=new $,this.selectionChanged=new $,this.cellContextMenu=new $,this.rangeSelectionChanged=new $,this.cellSelectionChanged=new $,this.tooltipShow=new $,this.tooltipHide=new $,this.sortChanged=new $,this._nativeElement=i.nativeElement,this._fullyReady.then(()=>{this._holdEvents=!1})}ngAfterViewInit(){this._angularFrameworkOverrides.runOutsideAngular(()=>{this._frameworkCompWrapper.setViewContainerRef(this._viewContainerRef,this._angularFrameworkOverrides);let i=Object.keys(this).filter(a=>!(a.startsWith("_")||a=="gridOptions"||a=="modules"||this[a]instanceof $)),n={};for(let a of i){let l=mse(a,this[a]);n[a]=l}let r=bF(this.gridOptions,n,i),o={globalListener:this.globalListener.bind(this),frameworkOverrides:this._angularFrameworkOverrides,providedBeanInstances:{frameworkCompWrapper:this._frameworkCompWrapper},modules:this.modules||[],setThemeOnGridDiv:!0},s=fM(this._nativeElement,r,o);s&&(this.api=s),this._initialised=!0,this._resolveFullyReady()})}ngOnChanges(i){this._initialised&&this._angularFrameworkOverrides.runOutsideAngular(()=>{let n={};for(let r of Object.keys(i)){let o=i[r];n[r]=o.currentValue}yF(n,this.api)})}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api?.destroy())}isEmitterUsed(i){let r=this[i],o=r?.observed??r?.observers?.length>0,s=`on${i.charAt(0).toUpperCase()}${i.substring(1)}`,a=!!this.gridOptions&&!!this.gridOptions[s];return o||a}globalListener(i,n){if(this._destroyed)return;let r=this[i];if(r&&this.isEmitterUsed(i)){let o=()=>this._angularFrameworkOverrides.runInsideAngular(()=>r.emit(n));this._holdEvents?this._fullyReady.then(()=>o()):o()}}static{this.\u0275fac=function(n){return new(n||e)(Fc(ci),Fc(Oa),Fc(YM),Fc(KM))}}static{this.\u0275cmp=Ae({type:e,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:[2,"suppressContextMenu","suppressContextMenu",H],preventDefaultOnContextMenu:[2,"preventDefaultOnContextMenu","preventDefaultOnContextMenu",H],allowContextMenuWithControlKey:[2,"allowContextMenuWithControlKey","allowContextMenuWithControlKey",H],columnMenu:"columnMenu",suppressMenuHide:[2,"suppressMenuHide","suppressMenuHide",H],enableBrowserTooltips:[2,"enableBrowserTooltips","enableBrowserTooltips",H],tooltipTrigger:"tooltipTrigger",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:[2,"tooltipMouseTrack","tooltipMouseTrack",H],tooltipShowMode:"tooltipShowMode",tooltipInteraction:[2,"tooltipInteraction","tooltipInteraction",H],popupParent:"popupParent",copyHeadersToClipboard:[2,"copyHeadersToClipboard","copyHeadersToClipboard",H],copyGroupHeadersToClipboard:[2,"copyGroupHeadersToClipboard","copyGroupHeadersToClipboard",H],clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:[2,"suppressCopyRowsToClipboard","suppressCopyRowsToClipboard",H],suppressCopySingleCellRanges:[2,"suppressCopySingleCellRanges","suppressCopySingleCellRanges",H],suppressLastEmptyLineOnPaste:[2,"suppressLastEmptyLineOnPaste","suppressLastEmptyLineOnPaste",H],suppressClipboardPaste:[2,"suppressClipboardPaste","suppressClipboardPaste",H],suppressClipboardApi:[2,"suppressClipboardApi","suppressClipboardApi",H],suppressCutToClipboard:[2,"suppressCutToClipboard","suppressCutToClipboard",H],columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",dataTypeDefinitions:"dataTypeDefinitions",maintainColumnOrder:[2,"maintainColumnOrder","maintainColumnOrder",H],enableStrictPivotColumnOrder:[2,"enableStrictPivotColumnOrder","enableStrictPivotColumnOrder",H],suppressFieldDotNotation:[2,"suppressFieldDotNotation","suppressFieldDotNotation",H],headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",hidePaddedHeaderRows:[2,"hidePaddedHeaderRows","hidePaddedHeaderRows",H],allowDragFromColumnsToolPanel:[2,"allowDragFromColumnsToolPanel","allowDragFromColumnsToolPanel",H],suppressMovableColumns:[2,"suppressMovableColumns","suppressMovableColumns",H],suppressColumnMoveAnimation:[2,"suppressColumnMoveAnimation","suppressColumnMoveAnimation",H],suppressMoveWhenColumnDragging:[2,"suppressMoveWhenColumnDragging","suppressMoveWhenColumnDragging",H],suppressDragLeaveHidesColumns:[2,"suppressDragLeaveHidesColumns","suppressDragLeaveHidesColumns",H],suppressGroupChangesColumnVisibility:"suppressGroupChangesColumnVisibility",suppressMakeColumnVisibleAfterUnGroup:[2,"suppressMakeColumnVisibleAfterUnGroup","suppressMakeColumnVisibleAfterUnGroup",H],suppressRowGroupHidesColumns:[2,"suppressRowGroupHidesColumns","suppressRowGroupHidesColumns",H],colResizeDefault:"colResizeDefault",suppressAutoSize:[2,"suppressAutoSize","suppressAutoSize",H],autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:[2,"skipHeaderOnAutoSize","skipHeaderOnAutoSize",H],autoSizeStrategy:"autoSizeStrategy",animateColumnResizing:[2,"animateColumnResizing","animateColumnResizing",H],components:"components",editType:"editType",suppressStartEditOnTab:[2,"suppressStartEditOnTab","suppressStartEditOnTab",H],getFullRowEditValidationErrors:"getFullRowEditValidationErrors",invalidEditValueMode:"invalidEditValueMode",singleClickEdit:[2,"singleClickEdit","singleClickEdit",H],suppressClickEdit:[2,"suppressClickEdit","suppressClickEdit",H],readOnlyEdit:[2,"readOnlyEdit","readOnlyEdit",H],stopEditingWhenCellsLoseFocus:[2,"stopEditingWhenCellsLoseFocus","stopEditingWhenCellsLoseFocus",H],enterNavigatesVertically:[2,"enterNavigatesVertically","enterNavigatesVertically",H],enterNavigatesVerticallyAfterEdit:[2,"enterNavigatesVerticallyAfterEdit","enterNavigatesVerticallyAfterEdit",H],enableCellEditingOnBackspace:[2,"enableCellEditingOnBackspace","enableCellEditingOnBackspace",H],undoRedoCellEditing:[2,"undoRedoCellEditing","undoRedoCellEditing",H],undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:[2,"suppressCsvExport","suppressCsvExport",H],defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:[2,"suppressExcelExport","suppressExcelExport",H],excelStyles:"excelStyles",findSearchValue:"findSearchValue",findOptions:"findOptions",quickFilterText:"quickFilterText",cacheQuickFilter:[2,"cacheQuickFilter","cacheQuickFilter",H],includeHiddenColumnsInQuickFilter:[2,"includeHiddenColumnsInQuickFilter","includeHiddenColumnsInQuickFilter",H],quickFilterParser:"quickFilterParser",quickFilterMatcher:"quickFilterMatcher",applyQuickFilterBeforePivotOrAgg:[2,"applyQuickFilterBeforePivotOrAgg","applyQuickFilterBeforePivotOrAgg",H],excludeChildrenWhenTreeDataFiltering:[2,"excludeChildrenWhenTreeDataFiltering","excludeChildrenWhenTreeDataFiltering",H],enableAdvancedFilter:[2,"enableAdvancedFilter","enableAdvancedFilter",H],alwaysPassFilter:"alwaysPassFilter",includeHiddenColumnsInAdvancedFilter:[2,"includeHiddenColumnsInAdvancedFilter","includeHiddenColumnsInAdvancedFilter",H],advancedFilterParent:"advancedFilterParent",advancedFilterBuilderParams:"advancedFilterBuilderParams",advancedFilterParams:"advancedFilterParams",suppressAdvancedFilterEval:[2,"suppressAdvancedFilterEval","suppressAdvancedFilterEval",H],suppressSetFilterByDefault:[2,"suppressSetFilterByDefault","suppressSetFilterByDefault",H],enableFilterHandlers:[2,"enableFilterHandlers","enableFilterHandlers",H],filterHandlers:"filterHandlers",enableCharts:[2,"enableCharts","enableCharts",H],chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",chartToolPanelsDef:"chartToolPanelsDef",chartMenuItems:"chartMenuItems",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:[2,"masterDetail","masterDetail",H],keepDetailRows:[2,"keepDetailRows","keepDetailRows",H],keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:[2,"detailRowAutoHeight","detailRowAutoHeight",H],context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:[2,"valueCache","valueCache",H],valueCacheNeverExpires:[2,"valueCacheNeverExpires","valueCacheNeverExpires",H],enableCellExpressions:[2,"enableCellExpressions","enableCellExpressions",H],suppressTouch:[2,"suppressTouch","suppressTouch",H],suppressFocusAfterRefresh:[2,"suppressFocusAfterRefresh","suppressFocusAfterRefresh",H],suppressBrowserResizeObserver:[2,"suppressBrowserResizeObserver","suppressBrowserResizeObserver",H],suppressPropertyNamesCheck:[2,"suppressPropertyNamesCheck","suppressPropertyNamesCheck",H],suppressChangeDetection:[2,"suppressChangeDetection","suppressChangeDetection",H],debug:[2,"debug","debug",H],loading:[2,"loading","loading",H],overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:[2,"suppressLoadingOverlay","suppressLoadingOverlay",H],overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:[2,"suppressNoRowsOverlay","suppressNoRowsOverlay",H],suppressOverlays:"suppressOverlays",overlayComponent:"overlayComponent",overlayComponentParams:"overlayComponentParams",overlayComponentSelector:"overlayComponentSelector",activeOverlay:"activeOverlay",activeOverlayParams:"activeOverlayParams",pagination:[2,"pagination","pagination",H],paginationPageSize:"paginationPageSize",paginationPageSizeSelector:"paginationPageSizeSelector",paginationAutoPageSize:[2,"paginationAutoPageSize","paginationAutoPageSize",H],paginateChildRows:[2,"paginateChildRows","paginateChildRows",H],suppressPaginationPanel:[2,"suppressPaginationPanel","suppressPaginationPanel",H],pivotMode:[2,"pivotMode","pivotMode",H],pivotPanelShow:"pivotPanelShow",pivotMaxGeneratedColumns:"pivotMaxGeneratedColumns",pivotDefaultExpanded:"pivotDefaultExpanded",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:[2,"pivotSuppressAutoColumn","pivotSuppressAutoColumn",H],suppressExpandablePivotGroups:[2,"suppressExpandablePivotGroups","suppressExpandablePivotGroups",H],functionsReadOnly:[2,"functionsReadOnly","functionsReadOnly",H],aggFuncs:"aggFuncs",formulaDataSource:"formulaDataSource",formulaFuncs:"formulaFuncs",suppressAggFuncInHeader:[2,"suppressAggFuncInHeader","suppressAggFuncInHeader",H],alwaysAggregateAtRootLevel:[2,"alwaysAggregateAtRootLevel","alwaysAggregateAtRootLevel",H],aggregateOnlyChangedColumns:[2,"aggregateOnlyChangedColumns","aggregateOnlyChangedColumns",H],suppressAggFilteredOnly:[2,"suppressAggFilteredOnly","suppressAggFilteredOnly",H],removePivotHeaderRowWhenSingleValueColumn:[2,"removePivotHeaderRowWhenSingleValueColumn","removePivotHeaderRowWhenSingleValueColumn",H],animateRows:[2,"animateRows","animateRows",H],cellFlashDuration:"cellFlashDuration",cellFadeDuration:"cellFadeDuration",allowShowChangeAfterFilter:[2,"allowShowChangeAfterFilter","allowShowChangeAfterFilter",H],domLayout:"domLayout",ensureDomOrder:[2,"ensureDomOrder","ensureDomOrder",H],enableCellSpan:[2,"enableCellSpan","enableCellSpan",H],enableRtl:[2,"enableRtl","enableRtl",H],suppressColumnVirtualisation:[2,"suppressColumnVirtualisation","suppressColumnVirtualisation",H],suppressMaxRenderedRowRestriction:[2,"suppressMaxRenderedRowRestriction","suppressMaxRenderedRowRestriction",H],suppressRowVirtualisation:[2,"suppressRowVirtualisation","suppressRowVirtualisation",H],rowDragManaged:[2,"rowDragManaged","rowDragManaged",H],refreshAfterGroupEdit:[2,"refreshAfterGroupEdit","refreshAfterGroupEdit",H],rowDragInsertDelay:"rowDragInsertDelay",suppressRowDrag:[2,"suppressRowDrag","suppressRowDrag",H],suppressMoveWhenRowDragging:[2,"suppressMoveWhenRowDragging","suppressMoveWhenRowDragging",H],rowDragEntireRow:[2,"rowDragEntireRow","rowDragEntireRow",H],rowDragMultiRow:[2,"rowDragMultiRow","rowDragMultiRow",H],rowDragText:"rowDragText",dragAndDropImageComponent:"dragAndDropImageComponent",dragAndDropImageComponentParams:"dragAndDropImageComponentParams",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:[2,"embedFullWidthRows","embedFullWidthRows",H],groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:[2,"groupMaintainOrder","groupMaintainOrder",H],groupSelectsChildren:[2,"groupSelectsChildren","groupSelectsChildren",H],groupLockGroupColumns:"groupLockGroupColumns",groupAggFiltering:"groupAggFiltering",groupTotalRow:"groupTotalRow",grandTotalRow:"grandTotalRow",suppressStickyTotalRow:"suppressStickyTotalRow",groupSuppressBlankHeader:[2,"groupSuppressBlankHeader","groupSuppressBlankHeader",H],groupSelectsFiltered:[2,"groupSelectsFiltered","groupSelectsFiltered",H],showOpenedGroup:[2,"showOpenedGroup","showOpenedGroup",H],groupHideParentOfSingleChild:"groupHideParentOfSingleChild",groupRemoveSingleChildren:[2,"groupRemoveSingleChildren","groupRemoveSingleChildren",H],groupRemoveLowestSingleChildren:[2,"groupRemoveLowestSingleChildren","groupRemoveLowestSingleChildren",H],groupHideOpenParents:[2,"groupHideOpenParents","groupHideOpenParents",H],groupAllowUnbalanced:[2,"groupAllowUnbalanced","groupAllowUnbalanced",H],rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererParams:"groupRowRendererParams",treeData:[2,"treeData","treeData",H],treeDataChildrenField:"treeDataChildrenField",treeDataParentIdField:"treeDataParentIdField",rowGroupPanelSuppressSort:[2,"rowGroupPanelSuppressSort","rowGroupPanelSuppressSort",H],suppressGroupRowsSticky:[2,"suppressGroupRowsSticky","suppressGroupRowsSticky",H],groupHierarchyConfig:"groupHierarchyConfig",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",enableRowPinning:"enableRowPinning",isRowPinnable:"isRowPinnable",isRowPinned:"isRowPinned",rowModelType:"rowModelType",rowData:"rowData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:[2,"suppressModelUpdateAfterUpdateTransaction","suppressModelUpdateAfterUpdateTransaction",H],datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",suppressServerSideFullWidthLoadingRow:[2,"suppressServerSideFullWidthLoadingRow","suppressServerSideFullWidthLoadingRow",H],cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:[2,"purgeClosedRowNodes","purgeClosedRowNodes",H],serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:[2,"serverSideSortAllLevels","serverSideSortAllLevels",H],serverSideEnableClientSideSort:[2,"serverSideEnableClientSideSort","serverSideEnableClientSideSort",H],serverSideOnlyRefreshFilteredGroups:[2,"serverSideOnlyRefreshFilteredGroups","serverSideOnlyRefreshFilteredGroups",H],serverSidePivotResultFieldSeparator:"serverSidePivotResultFieldSeparator",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:[2,"alwaysShowHorizontalScroll","alwaysShowHorizontalScroll",H],alwaysShowVerticalScroll:[2,"alwaysShowVerticalScroll","alwaysShowVerticalScroll",H],debounceVerticalScrollbar:[2,"debounceVerticalScrollbar","debounceVerticalScrollbar",H],suppressHorizontalScroll:[2,"suppressHorizontalScroll","suppressHorizontalScroll",H],suppressScrollOnNewData:[2,"suppressScrollOnNewData","suppressScrollOnNewData",H],suppressScrollWhenPopupsAreOpen:[2,"suppressScrollWhenPopupsAreOpen","suppressScrollWhenPopupsAreOpen",H],suppressAnimationFrame:[2,"suppressAnimationFrame","suppressAnimationFrame",H],suppressMiddleClickScrolls:[2,"suppressMiddleClickScrolls","suppressMiddleClickScrolls",H],suppressPreventDefaultOnMouseWheel:[2,"suppressPreventDefaultOnMouseWheel","suppressPreventDefaultOnMouseWheel",H],scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",cellSelection:"cellSelection",rowMultiSelectWithClick:[2,"rowMultiSelectWithClick","rowMultiSelectWithClick",H],suppressRowDeselection:[2,"suppressRowDeselection","suppressRowDeselection",H],suppressRowClickSelection:[2,"suppressRowClickSelection","suppressRowClickSelection",H],suppressCellFocus:[2,"suppressCellFocus","suppressCellFocus",H],suppressHeaderFocus:[2,"suppressHeaderFocus","suppressHeaderFocus",H],selectionColumnDef:"selectionColumnDef",rowNumbers:"rowNumbers",suppressMultiRangeSelection:[2,"suppressMultiRangeSelection","suppressMultiRangeSelection",H],enableCellTextSelection:[2,"enableCellTextSelection","enableCellTextSelection",H],enableRangeSelection:[2,"enableRangeSelection","enableRangeSelection",H],enableRangeHandle:[2,"enableRangeHandle","enableRangeHandle",H],enableFillHandle:[2,"enableFillHandle","enableFillHandle",H],fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:[2,"suppressClearOnFillReduction","suppressClearOnFillReduction",H],sortingOrder:"sortingOrder",accentedSort:[2,"accentedSort","accentedSort",H],unSortIcon:[2,"unSortIcon","unSortIcon",H],suppressMultiSort:[2,"suppressMultiSort","suppressMultiSort",H],alwaysMultiSort:[2,"alwaysMultiSort","alwaysMultiSort",H],multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:[2,"suppressMaintainUnsortedOrder","suppressMaintainUnsortedOrder",H],icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:[2,"suppressRowHoverHighlight","suppressRowHoverHighlight",H],suppressRowTransform:[2,"suppressRowTransform","suppressRowTransform",H],columnHoverHighlight:[2,"columnHoverHighlight","columnHoverHighlight",H],gridId:"gridId",deltaSort:[2,"deltaSort","deltaSort",H],treeDataDisplayType:"treeDataDisplayType",enableGroupEdit:[2,"enableGroupEdit","enableGroupEdit",H],initialState:"initialState",theme:"theme",loadThemeGoogleFonts:[2,"loadThemeGoogleFonts","loadThemeGoogleFonts",H],themeCssLayer:"themeCssLayer",styleNonce:"styleNonce",themeStyleContainer:"themeStyleContainer",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processUnpinnedColumns:"processUnpinnedColumns",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",focusGridInnerElement:"focusGridInnerElement",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",ssrmExpandAllAffectsAllRows:[2,"ssrmExpandAllAffectsAllRows","ssrmExpandAllAffectsAllRows",H],initialGroupOrderComparator:"initialGroupOrderComparator",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowId:"getRowId",resetRowDataOnUpdate:[2,"resetRowDataOnUpdate","resetRowDataOnUpdate",H],processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthRow:"isFullWidthRow",isRowValidDropPosition:"isRowValidDropPosition"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",columnMenuVisibleChanged:"columnMenuVisibleChanged",contextMenuVisibleChanged:"contextMenuVisibleChanged",cutStart:"cutStart",cutEnd:"cutEnd",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",columnsReset:"columnsReset",columnHeaderMouseOver:"columnHeaderMouseOver",columnHeaderMouseLeave:"columnHeaderMouseLeave",columnHeaderClicked:"columnHeaderClicked",columnHeaderContextMenu:"columnHeaderContextMenu",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",bulkEditingStarted:"bulkEditingStarted",bulkEditingStopped:"bulkEditingStopped",batchEditingStarted:"batchEditingStarted",batchEditingStopped:"batchEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",cellSelectionDeleteStart:"cellSelectionDeleteStart",cellSelectionDeleteEnd:"cellSelectionDeleteEnd",rangeDeleteStart:"rangeDeleteStart",rangeDeleteEnd:"rangeDeleteEnd",fillStart:"fillStart",fillEnd:"fillEnd",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",filterUiChanged:"filterUiChanged",floatingFilterUiChanged:"floatingFilterUiChanged",advancedFilterBuilderVisibleChanged:"advancedFilterBuilderVisibleChanged",findChanged:"findChanged",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",dragCancelled:"dragCancelled",stateUpdated:"stateUpdated",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",rowDragCancel:"rowDragCancel",rowResizeStarted:"rowResizeStarted",rowResizeEnded:"rowResizeEnded",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pivotMaxColumnsExceeded:"pivotMaxColumnsExceeded",pinnedRowDataChanged:"pinnedRowDataChanged",pinnedRowsChanged:"pinnedRowsChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",headerFocused:"headerFocused",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",cellSelectionChanged:"cellSelectionChanged",tooltipShow:"tooltipShow",tooltipHide:"tooltipHide",sortChanged:"sortChanged"},features:[it([YM,KM]),Ah],decls:0,vars:0,template:function(n,r){},encapsulation:2})}}return e})(),gse=new Set(jy);function mse(e,t){return gse.has(e)?t===""?!0:t==="false"?!1:t:t}function vse(e,t){if(e&1){let i=Ue();A(0,"button",2),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.onActionClick(r))}),le(1,"ng-icon",3),I()}if(e&2){let i=t.$implicit;ve("variant",i.variant||"ghost"),L(),ve("name",i.icon)}}var Ra=(()=>{class e{actions=[];data;agInit(i){this.actions=i.actions||[],this.data=i.data}refresh(i){return this.actions=i.actions||[],this.data=i.data,!0}onActionClick(i){i.action(this.data)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-ag-grid-actions-cell"]],decls:3,vars:0,consts:[[1,"flex","gap-2","h-full","items-center"],["hlmBtn","","size","icon",3,"variant"],["hlmBtn","","size","icon",3,"click","variant"],["hlm","","size","sm",3,"name"]],template:function(n,r){n&1&&(A(0,"div",0),On(1,vse,2,2,"button",1,Lh),I()),n&2&&(L(),Ln(r.actions))},dependencies:[Rt,hi,ui],encapsulation:2,changeDetection:0})}return e})();var Ar=class{supabaseGlobal=ce(ja);supabase=this.supabaseGlobal.supabase;loadingCount=xe(0);loading=Ie(()=>this.loadingCount()>0);flexibleItems=Nn({loader:async()=>{let{data:t,error:i}=await this.supabase.from("flexible_items").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});createItem(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("flexible_items").insert({name:t.name,description:t.description||null,user_defined_properties:t.user_defined_properties||{}}).select().single()).pipe(tt(i=>Ye({error:i})),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}updateItem(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("flexible_items").update(i).eq("id",t).select().single()).pipe(tt(n=>Ye({error:n})),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.flexibleItems.reload()})}deleteItem(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("flexible_items").delete().eq("id",t)).pipe(tt(i=>Ye({error:i})),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}deleteItems(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("flexible_items").delete().in("id",t)).pipe(tt(i=>Ye({error:i})),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.flexibleItems.reload()})}addItemToHousePlan(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("house_plan_items").insert({house_plan_id:t.house_plan_id,flexible_item_id:t.flexible_item_id,position_x:t.position_x||0,position_y:t.position_y||0,rotation:t.rotation||0,scale:t.scale||1}).select().single()).pipe(tt(n=>Ye({error:n})),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;n?.data?i?.(n.data):i?.({id:"",house_plan_id:t.house_plan_id,flexible_item_id:t.flexible_item_id,position_x:t.position_x||0,position_y:t.position_y||0,rotation:t.rotation||0,scale:t.scale||1,created_at:""})})}updateHousePlanItem(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("house_plan_items").update(i).eq("id",t).select().single()).pipe(tt(n=>Ye({error:n})),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error})}removeItemFromHousePlan(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("house_plan_items").delete().eq("id",t)).pipe(tt(i=>Ye({error:i})),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error})}getHousePlanItemsResource(t){return Nn({params:()=>({planId:t}),loader:async({params:i})=>{let{data:n,error:r}=await this.supabase.from("house_plan_items").select(`
            *,
            item:flexible_item_id (*)
          `).eq("house_plan_id",i.planId);if(r)throw r;return n||[]}})}};var Cse=Math.PI/180;function wse(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}var vs=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},ne={_global:vs,version:"10.0.12",isBrowser:wse(),isUnminified:/param/.test(function(e){}.toString()),dblClickWindow:400,getAngle(e){return ne.angleDeg?e*Cse:e},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return ne.DD.isDragging},isTransforming(){var e,t;return(t=(e=ne.Transformer)===null||e===void 0?void 0:e.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!ne.DD.node},releaseCanvasOnDestroy:!0,document:vs.document,_injectGlobal(e){typeof vs.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),vs.Konva=e}},Oe=e=>{ne[e.prototype.getClassName()]=e};ne._injectGlobal(ne);var bse=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,JM=()=>{if(typeof document>"u")throw new Error(bse)},ri=class e{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new e(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){let i=this.m;return{x:i[0]*t.x+i[2]*t.y+i[4],y:i[1]*t.x+i[3]*t.y+i[5]}}translate(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this}scale(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this}rotate(t){let i=Math.cos(t),n=Math.sin(t),r=this.m[0]*i+this.m[2]*n,o=this.m[1]*i+this.m[3]*n,s=this.m[0]*-n+this.m[2]*i,a=this.m[1]*-n+this.m[3]*i;return this.m[0]=r,this.m[1]=o,this.m[2]=s,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,i){let n=this.m[0]+this.m[2]*i,r=this.m[1]+this.m[3]*i,o=this.m[2]+this.m[0]*t,s=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=r,this.m[2]=o,this.m[3]=s,this}multiply(t){let i=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],o=this.m[1]*t.m[2]+this.m[3]*t.m[3],s=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=i,this.m[1]=n,this.m[2]=r,this.m[3]=o,this.m[4]=s,this.m[5]=a,this}invert(){let t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=this.m[3]*t,n=-this.m[1]*t,r=-this.m[2]*t,o=this.m[0]*t,s=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=i,this.m[1]=n,this.m[2]=r,this.m[3]=o,this.m[4]=s,this.m[5]=a,this}getMatrix(){return this.m}decompose(){let t=this.m[0],i=this.m[1],n=this.m[2],r=this.m[3],o=this.m[4],s=this.m[5],a=t*r-i*n,l={x:o,y:s,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||i!=0){let c=Math.sqrt(t*t+i*i);l.rotation=i>0?Math.acos(t/c):-Math.acos(t/c),l.scaleX=c,l.scaleY=a/c,l.skewX=(t*n+i*r)/a,l.skewY=0}else if(n!=0||r!=0){let c=Math.sqrt(n*n+r*r);l.rotation=Math.PI/2-(r>0?Math.acos(-n/c):-Math.acos(n/c)),l.scaleX=a/c,l.scaleY=c,l.skewX=0,l.skewY=(t*n+i*r)/a}return l.rotation=M._getRotation(l.rotation),l}},yse="[object Array]",Sse="[object Number]",xse="[object String]",Ese="[object Boolean]",Rse=Math.PI/180,Pse=180/Math.PI,rh="#",kse="",_se="0",Dse="Konva warning: ",QM="Konva error: ",Fse="rgb(",sS={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},Mse=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,Im=[],oh=null,Tse=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(e){setTimeout(e,60)},M={_isElement(e){return!!(e&&e.nodeType==1)},_isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)},_isPlainObject(e){return!!e&&e.constructor===Object},_isArray(e){return Object.prototype.toString.call(e)===yse},_isNumber(e){return Object.prototype.toString.call(e)===Sse&&!isNaN(e)&&isFinite(e)},_isString(e){return Object.prototype.toString.call(e)===xse},_isBoolean(e){return Object.prototype.toString.call(e)===Ese},isObject(e){return e instanceof Object},isValidSelector(e){if(typeof e!="string")return!1;let t=e[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(e){return e===0||e>0?1:-1},requestAnimFrame(e){Im.push(e),Im.length===1&&Tse(function(){let t=Im;Im=[],t.forEach(function(i){i()})})},createCanvasElement(){JM();let e=document.createElement("canvas");try{e.style=e.style||{}}catch{}return e},createImageElement(){return JM(),document.createElement("img")},_isInDocument(e){for(;e=e.parentNode;)if(e==document)return!0;return!1},_urlToImage(e,t){let i=M.createImageElement();i.onload=function(){t(i)},i.src=e},_rgbToHex(e,t,i){return((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},_hexToRgb(e){e=e.replace(rh,kse);let t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let e=(Math.random()*16777215<<0).toString(16);for(;e.length<6;)e=_se+e;return rh+e},isCanvasFarblingActive(){if(oh!==null)return oh;if(typeof document>"u")return oh=!1,!1;let e=this.createCanvasElement();e.width=10,e.height=10;let t=e.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,10,10),t.fillStyle="#282828",t.fillRect(0,0,10,10);let i=t.getImageData(0,0,10,10).data,n=!1;for(let r=0;r<100;r++)if(i[r*4]!==40||i[r*4+1]!==40||i[r*4+2]!==40||i[r*4+3]!==255){n=!0;break}return oh=n,this.releaseCanvas(e),oh},getHitColor(){let e=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(e):e},getHitColorKey(e,t,i){return this.isCanvasFarblingActive()&&(e=Math.round(e/5)*5,t=Math.round(t/5)*5,i=Math.round(i/5)*5),rh+this._rgbToHex(e,t,i)},getSnappedHexColor(e){let t=this._hexToRgb(e);return rh+this._rgbToHex(Math.round(t.r/5)*5,Math.round(t.g/5)*5,Math.round(t.b/5)*5)},getRGB(e){let t;return e in sS?(t=sS[e],{r:t[0],g:t[1],b:t[2]}):e[0]===rh?this._hexToRgb(e.substring(1)):e.substr(0,4)===Fse?(t=Mse.exec(e.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(e){return e=e||"black",M._namedColorToRBA(e)||M._hex3ColorToRGBA(e)||M._hex4ColorToRGBA(e)||M._hex6ColorToRGBA(e)||M._hex8ColorToRGBA(e)||M._rgbColorToRGBA(e)||M._rgbaColorToRGBA(e)||M._hslColorToRGBA(e)},_namedColorToRBA(e){let t=sS[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(e){if(e.indexOf("rgb(")===0){e=e.match(/rgb\(([^)]+)\)/)[1];let t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(e){if(e.indexOf("rgba(")===0){e=e.match(/rgba\(([^)]+)\)/)[1];let t=e.split(/ *, */).map((i,n)=>i.slice(-1)==="%"?n===3?parseInt(i)/100:parseInt(i)/100*255:Number(i));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(e){if(e[0]==="#"&&e.length===9)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:parseInt(e.slice(7,9),16)/255}},_hex6ColorToRGBA(e){if(e[0]==="#"&&e.length===7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}},_hex4ColorToRGBA(e){if(e[0]==="#"&&e.length===5)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:parseInt(e[4]+e[4],16)/255}},_hex3ColorToRGBA(e){if(e[0]==="#"&&e.length===4)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}},_hslColorToRGBA(e){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(e)){let[t,...i]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e),n=Number(i[0])/360,r=Number(i[1])/100,o=Number(i[2])/100,s,a,l;if(r===0)return l=o*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};o<.5?s=o*(1+r):s=o+r-o*r;let c=2*o-s,d=[0,0,0];for(let u=0;u<3;u++)a=n+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=c+(s-c)*6*a:2*a<1?l=s:3*a<2?l=c+(s-c)*(2/3-a)*6:l=c,d[u]=l*255;return{r:Math.round(d[0]),g:Math.round(d[1]),b:Math.round(d[2]),a:1}}},haveIntersection(e,t){return!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y)},cloneObject(e){let t={};for(let i in e)this._isPlainObject(e[i])?t[i]=this.cloneObject(e[i]):this._isArray(e[i])?t[i]=this.cloneArray(e[i]):t[i]=e[i];return t},cloneArray(e){return e.slice(0)},degToRad(e){return e*Rse},radToDeg(e){return e*Pse},_degToRad(e){return M.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),M.degToRad(e)},_radToDeg(e){return M.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),M.radToDeg(e)},_getRotation(e){return ne.angleDeg?M.radToDeg(e):e},_capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)},throw(e){throw new Error(QM+e)},error(e){console.error(QM+e)},warn(e){ne.showWarnings&&console.warn(Dse+e)},each(e,t){for(let i in e)t(i,e[i])},_inRange(e,t,i){return t<=e&&e<i},_getProjectionToSegment(e,t,i,n,r,o){let s,a,l,c=(e-i)*(e-i)+(t-n)*(t-n);if(c==0)s=e,a=t,l=(r-i)*(r-i)+(o-n)*(o-n);else{let d=((r-e)*(i-e)+(o-t)*(n-t))/c;d<0?(s=e,a=t,l=(e-r)*(e-r)+(t-o)*(t-o)):d>1?(s=i,a=n,l=(i-r)*(i-r)+(n-o)*(n-o)):(s=e+d*(i-e),a=t+d*(n-t),l=(s-r)*(s-r)+(a-o)*(a-o))}return[s,a,l]},_getProjectionToLine(e,t,i){let n=M.cloneObject(e),r=Number.MAX_VALUE;return t.forEach(function(o,s){if(!i&&s===t.length-1)return;let a=t[(s+1)%t.length],l=M._getProjectionToSegment(o.x,o.y,a.x,a.y,e.x,e.y),c=l[0],d=l[1],u=l[2];u<r&&(n.x=c,n.y=d,r=u)}),n},_prepareArrayForTween(e,t,i){let n=[],r=[];if(e.length>t.length){let s=t;t=e,e=s}for(let s=0;s<e.length;s+=2)n.push({x:e[s],y:e[s+1]});for(let s=0;s<t.length;s+=2)r.push({x:t[s],y:t[s+1]});let o=[];return r.forEach(function(s){let a=M._getProjectionToLine(s,n,i);o.push(a.x),o.push(a.y)}),o},_prepareToStringify(e){let t;e.visitedByCircularReferenceRemoval=!0;for(let i in e)if(e.hasOwnProperty(i)&&e[i]&&typeof e[i]=="object"){if(t=Object.getOwnPropertyDescriptor(e,i),e[i].visitedByCircularReferenceRemoval||M._isElement(e[i]))if(t.configurable)delete e[i];else return null;else if(M._prepareToStringify(e[i])===null)if(t.configurable)delete e[i];else return null}return delete e.visitedByCircularReferenceRemoval,e},_assign(e,t){for(let i in t)e[i]=t[i];return e},_getFirstPointerId(e){return e.touches?e.changedTouches[0].identifier:e.pointerId||999},releaseCanvas(...e){ne.releaseCanvasOnDestroy&&e.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(e,t,i,n){let r=t<0?t:0,o=i<0?i:0;t=Math.abs(t),i=Math.abs(i);let s=0,a=0,l=0,c=0;typeof n=="number"?s=a=l=c=Math.min(n,t/2,i/2):(s=Math.min(n[0]||0,t/2,i/2),a=Math.min(n[1]||0,t/2,i/2),c=Math.min(n[2]||0,t/2,i/2),l=Math.min(n[3]||0,t/2,i/2)),e.moveTo(r+s,o),e.lineTo(r+t-a,o),e.arc(r+t-a,o+a,a,Math.PI*3/2,0,!1),e.lineTo(r+t,o+i-c),e.arc(r+t-c,o+i-c,c,0,Math.PI/2,!1),e.lineTo(r+l,o+i),e.arc(r+l,o+i-l,l,Math.PI/2,Math.PI,!1),e.lineTo(r,o+s),e.arc(r+s,o+s,s,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(e,t,i,n,r){n=Math.abs(n);for(let o=0;o<i;o++){let s=t[(o-1+i)%i],a=t[o],l=t[(o+1)%i],c={x:a.x-s.x,y:a.y-s.y},d={x:l.x-a.x,y:l.y-a.y},u=Math.hypot(c.x,c.y),h=Math.hypot(d.x,d.y),p;typeof r=="number"?p=r:p=o<r.length?r[o]:0,p=n*Math.cos(Math.PI/i)*Math.min(1,p/n*2);let g={x:c.x/u,y:c.y/u},m={x:d.x/h,y:d.y/h},v={x:a.x-g.x*p,y:a.y-g.y*p},C={x:a.x+m.x*p,y:a.y+m.y*p};o===0?e.moveTo(v.x,v.y):e.lineTo(v.x,v.y),e.arcTo(a.x,a.y,C.x,C.y,p)}}};function Ise(e){let t=[],i=e.length,n=M;for(let r=0;r<i;r++){let o=e[r];n._isNumber(o)?o=Math.round(o*1e3)/1e3:n._isString(o)||(o=o+""),t.push(o)}return t}var ZM=",",Ase="(",Ose=")",Lse="([",Nse="])",Bse=";",Hse="()",zse="=",eT=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],Vse=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],Gse=100,Am=null;function aS(){if(Am!==null)return Am;try{let t=M.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Am=!1,!1)}catch{return Am=!1,!1}}var Pa=class{constructor(t){this.canvas=t,ne.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,i){let n=this.traceArr,r=n.length,o="",s,a,l,c;for(s=0;s<r;s++)a=n[s],l=a.method,l?(c=a.args,o+=l,t?o+=Hse:M._isArray(c[0])?o+=Lse+c.join(ZM)+Nse:(i&&(c=c.map(d=>typeof d=="number"?Math.floor(d):d)),o+=Ase+c.join(ZM)+Ose)):(o+=a.property,t||(o+=zse+a.val)),o+=Bse;return o}clearTrace(){this.traceArr=[]}_trace(t){let i=this.traceArr,n;i.push(t),n=i.length,n>=Gse&&i.shift()}reset(){let t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){let i=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,i.getWidth()/i.pixelRatio,i.getHeight()/i.pixelRatio)}_applyLineCap(t){let i=t.attrs.lineCap;i&&this.setAttr("lineCap",i)}_applyOpacity(t){let i=t.getAbsoluteOpacity();i!==1&&this.setAttr("globalAlpha",i)}_applyLineJoin(t){let i=t.attrs.lineJoin;i&&this.setAttr("lineJoin",i)}_applyMiterLimit(t){let i=t.attrs.miterLimit;i!=null&&this.setAttr("miterLimit",i)}setAttr(t,i){this._context[t]=i}arc(t,i,n,r,o,s){this._context.arc(t,i,n,r,o,s)}arcTo(t,i,n,r,o){this._context.arcTo(t,i,n,r,o)}beginPath(){this._context.beginPath()}bezierCurveTo(t,i,n,r,o,s){this._context.bezierCurveTo(t,i,n,r,o,s)}clearRect(t,i,n,r){this._context.clearRect(t,i,n,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,i){let n=arguments;if(n.length===2)return this._context.createImageData(t,i);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,i,n,r){return this._context.createLinearGradient(t,i,n,r)}createPattern(t,i){return this._context.createPattern(t,i)}createRadialGradient(t,i,n,r,o,s){return this._context.createRadialGradient(t,i,n,r,o,s)}drawImage(t,i,n,r,o,s,a,l,c){let d=arguments,u=this._context;d.length===3?u.drawImage(t,i,n):d.length===5?u.drawImage(t,i,n,r,o):d.length===9&&u.drawImage(t,i,n,r,o,s,a,l,c)}ellipse(t,i,n,r,o,s,a,l){this._context.ellipse(t,i,n,r,o,s,a,l)}isPointInPath(t,i,n,r){return n?this._context.isPointInPath(n,t,i,r):this._context.isPointInPath(t,i,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,i,n,r){this._context.fillRect(t,i,n,r)}strokeRect(t,i,n,r){this._context.strokeRect(t,i,n,r)}fillText(t,i,n,r){r?this._context.fillText(t,i,n,r):this._context.fillText(t,i,n)}measureText(t){return this._context.measureText(t)}getImageData(t,i,n,r){return this._context.getImageData(t,i,n,r)}lineTo(t,i){this._context.lineTo(t,i)}moveTo(t,i){this._context.moveTo(t,i)}rect(t,i,n,r){this._context.rect(t,i,n,r)}roundRect(t,i,n,r,o){this._context.roundRect(t,i,n,r,o)}putImageData(t,i,n){this._context.putImageData(t,i,n)}quadraticCurveTo(t,i,n,r){this._context.quadraticCurveTo(t,i,n,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,i){this._context.scale(t,i)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,i,n,r,o,s){this._context.setTransform(t,i,n,r,o,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,i,n,r){this._context.strokeText(t,i,n,r)}transform(t,i,n,r,o,s){this._context.transform(t,i,n,r,o,s)}translate(t,i){this._context.translate(t,i)}_enableTrace(){let t=this,i=eT.length,n=this.setAttr,r,o,s=function(a){let l=t[a],c;t[a]=function(){return o=Ise(Array.prototype.slice.call(arguments,0)),c=l.apply(t,arguments),t._trace({method:a,args:o}),c}};for(r=0;r<i;r++)s(eT[r]);t.setAttr=function(){n.apply(t,arguments);let a=arguments[0],l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:a,val:l})}}_applyGlobalCompositeOperation(t){let i=t.attrs.globalCompositeOperation;!i||i==="source-over"||this.setAttr("globalCompositeOperation",i)}};Vse.forEach(function(e){Object.defineProperty(Pa.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});var Om=class extends Pa{constructor(t,{willReadFrequently:i=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:i})}_fillColor(t){let i=t.fill();this.setAttr("fillStyle",i),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){let i=t._getLinearGradient();i&&(this.setAttr("fillStyle",i),t._fillFunc(this))}_fillRadialGradient(t){let i=t._getRadialGradient();i&&(this.setAttr("fillStyle",i),t._fillFunc(this))}_fill(t){let i=t.fill(),n=t.getFillPriority();if(i&&n==="color"){this._fillColor(t);return}let r=t.getFillPatternImage();if(r&&n==="pattern"){this._fillPattern(t);return}let o=t.getFillLinearGradientColorStops();if(o&&n==="linear-gradient"){this._fillLinearGradient(t);return}let s=t.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(t);return}i?this._fillColor(t):r?this._fillPattern(t):o?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}_strokeLinearGradient(t){let i=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),o=this.createLinearGradient(i.x,i.y,n.x,n.y);if(r){for(let s=0;s<r.length;s+=2)o.addColorStop(r[s],r[s+1]);this.setAttr("strokeStyle",o)}}_stroke(t){let i=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();let o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(t),i&&t.dashEnabled()&&(this.setLineDash(i),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var i,n,r;let o=(i=t.getShadowRGBA())!==null&&i!==void 0?i:"black",s=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,a=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},l=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),d=l.x*c,u=l.y*c;this.setAttr("shadowColor",o),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(u))),this.setAttr("shadowOffsetX",a.x*d),this.setAttr("shadowOffsetY",a.y*u)}},Lm=class extends Pa{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){let i=t.getStrokeScaleEnabled();if(!i){this.save();let o=this.getCanvas().getPixelRatio();this.setTransform(o,0,0,o,0,0)}this._applyLineCap(t);let n=t.hitStrokeWidth(),r=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),i||this.restore()}}};var Nm;function Wse(){if(Nm)return Nm;let e=M.createCanvasElement(),t=e.getContext("2d");return Nm=(function(){let i=ne._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n})(),M.releaseCanvas(e),Nm}var dc=class{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let n=(t||{}).pixelRatio||ne.pixelRatio||Wse();this.pixelRatio=n,this._canvas=M.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){let i=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/i,this.getHeight()/i)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";let i=this.pixelRatio;this.getContext()._context.scale(i,i)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,i){this.setWidth(t||0),this.setHeight(i||0)}toDataURL(t,i){try{return this._canvas.toDataURL(t,i)}catch{try{return this._canvas.toDataURL()}catch(r){return M.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}},cn=class extends dc{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new Om(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}},Cs=class extends dc{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Lm(this),this.setSize(t.width,t.height)}};var Ke={get isDragging(){let e=!1;return Ke._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(e=!0)}),e},justDragged:!1,get node(){let e;return Ke._dragElements.forEach(t=>{e=t.node}),e},_dragElements:new Map,_drag(e){let t=[];Ke._dragElements.forEach((i,n)=>{let{node:r}=i,o=r.getStage();o.setPointersPositions(e),i.pointerId===void 0&&(i.pointerId=M._getFirstPointerId(e));let s=o._changedPointerPositions.find(a=>a.id===i.pointerId);if(s){if(i.dragStatus!=="dragging"){let a=r.dragDistance();if(Math.max(Math.abs(s.x-i.startPointerPos.x),Math.abs(s.y-i.startPointerPos.y))<a||(r.startDrag({evt:e}),!r.isDragging()))return}r._setDragPosition(e,i),t.push(r)}}),t.forEach(i=>{i.fire("dragmove",{type:"dragmove",target:i,evt:e},!0)})},_endDragBefore(e){let t=[];Ke._dragElements.forEach(i=>{let{node:n}=i,r=n.getStage();if(e&&r.setPointersPositions(e),!r._changedPointerPositions.find(a=>a.id===i.pointerId))return;(i.dragStatus==="dragging"||i.dragStatus==="stopped")&&(Ke.justDragged=!0,ne._mouseListenClick=!1,ne._touchListenClick=!1,ne._pointerListenClick=!1,i.dragStatus="stopped");let s=i.node.getLayer()||i.node instanceof ne.Stage&&i.node;s&&t.indexOf(s)===-1&&t.push(s)}),t.forEach(i=>{i.draw()})},_endDragAfter(e){Ke._dragElements.forEach((t,i)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:e},!0),t.dragStatus!=="dragging"&&Ke._dragElements.delete(i)})}};ne.isBrowser&&(window.addEventListener("mouseup",Ke._endDragBefore,!0),window.addEventListener("touchend",Ke._endDragBefore,!0),window.addEventListener("touchcancel",Ke._endDragBefore,!0),window.addEventListener("mousemove",Ke._drag),window.addEventListener("touchmove",Ke._drag),window.addEventListener("mouseup",Ke._endDragAfter,!1),window.addEventListener("touchend",Ke._endDragAfter,!1),window.addEventListener("touchcancel",Ke._endDragAfter,!1));function ws(e){return M._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||M._isBoolean(e)?e:Object.prototype.toString.call(e)}function Bm(e){return e>255?255:e<0?0:Math.round(e)}function K(){if(ne.isUnminified)return function(e,t){return M._isNumber(e)||M.warn(ws(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function bs(e){if(ne.isUnminified)return function(t,i){let n=M._isNumber(t),r=M._isArray(t)&&t.length==e;return!n&&!r&&M.warn(ws(t)+' is a not valid value for "'+i+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function sh(){if(ne.isUnminified)return function(e,t){return M._isNumber(e)||e==="auto"||M.warn(ws(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function Or(){if(ne.isUnminified)return function(e,t){return M._isString(e)||M.warn(ws(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function lS(){if(ne.isUnminified)return function(e,t){let i=M._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return i||n||M.warn(ws(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function tT(){if(ne.isUnminified)return function(e,t){let i=Int8Array?Object.getPrototypeOf(Int8Array):null;return i&&e instanceof i||(M._isArray(e)?e.forEach(function(n){M._isNumber(n)||M.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):M.warn(ws(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function oi(){if(ne.isUnminified)return function(e,t){return e===!0||e===!1||M.warn(ws(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function iT(e){if(ne.isUnminified)return function(t,i){return t==null||M.isObject(t)||M.warn(ws(t)+' is a not valid value for "'+i+'" attribute. The value should be an object with properties '+e),t}}var ah="get",lh="set",R={addGetterSetter(e,t,i,n,r){R.addGetter(e,t,i),R.addSetter(e,t,n,r),R.addOverloadedGetterSetter(e,t)},addGetter(e,t,i){let n=ah+M._capitalize(t);e.prototype[n]=e.prototype[n]||function(){let r=this.attrs[t];return r===void 0?i:r}},addSetter(e,t,i,n){let r=lh+M._capitalize(t);e.prototype[r]||R.overWriteSetter(e,t,i,n)},overWriteSetter(e,t,i,n){let r=lh+M._capitalize(t);e.prototype[r]=function(o){return i&&o!==void 0&&o!==null&&(o=i.call(this,o,t)),this._setAttr(t,o),n&&n.call(this),this}},addComponentsGetterSetter(e,t,i,n,r){let o=i.length,s=M._capitalize,a=ah+s(t),l=lh+s(t);e.prototype[a]=function(){let d={};for(let u=0;u<o;u++){let h=i[u];d[h]=this.getAttr(t+s(h))}return d};let c=iT(i);e.prototype[l]=function(d){let u=this.attrs[t];n&&(d=n.call(this,d,t)),c&&c.call(this,d,t);for(let h in d)d.hasOwnProperty(h)&&this._setAttr(t+s(h),d[h]);return d||i.forEach(h=>{this._setAttr(t+s(h),void 0)}),this._fireChangeEvent(t,u,d),r&&r.call(this),this},R.addOverloadedGetterSetter(e,t)},addOverloadedGetterSetter(e,t){let i=M._capitalize(t),n=lh+i,r=ah+i;e.prototype[t]=function(){return arguments.length?(this[n](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(e,t,i,n){M.error("Adding deprecated "+t);let r=ah+M._capitalize(t),o=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";e.prototype[r]=function(){M.error(o);let s=this.attrs[t];return s===void 0?i:s},R.addSetter(e,t,n,function(){M.error(o)}),R.addOverloadedGetterSetter(e,t)},backCompat(e,t){M.each(t,function(i,n){let r=e.prototype[n],o=ah+M._capitalize(i),s=lh+M._capitalize(i);function a(){r.apply(this,arguments),M.error('"'+i+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}e.prototype[i]=a,e.prototype[o]=a,e.prototype[s]=a})},afterSetFilter(){this._filterUpToDate=!1}};function Use(e){let t=/(\w+)\(([^)]+)\)/g,i;for(;(i=t.exec(e))!==null;){let[,n,r]=i;switch(n){case"blur":{let o=parseFloat(r.replace("px",""));return function(s){this.blurRadius(o*.5);let a=ne.Filters;a&&a.Blur&&a.Blur.call(this,s)}}case"brightness":{let o=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(s){this.brightness(o);let a=ne.Filters;a&&a.Brightness&&a.Brightness.call(this,s)}}case"contrast":{let o=parseFloat(r);return function(s){let a=100*(Math.sqrt(o)-1);this.contrast(a);let l=ne.Filters;l&&l.Contrast&&l.Contrast.call(this,s)}}case"grayscale":return function(o){let s=ne.Filters;s&&s.Grayscale&&s.Grayscale.call(this,o)};case"sepia":return function(o){let s=ne.Filters;s&&s.Sepia&&s.Sepia.call(this,o)};case"invert":return function(o){let s=ne.Filters;s&&s.Invert&&s.Invert.call(this,o)};default:M.warn(`CSS filter "${n}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}var zm="absoluteOpacity",Hm="allEventListeners",mo="absoluteTransform",nT="absoluteScale",ka="canvas",jse="Change",qse="children",$se="konva",cS="listening",Kse="mouseenter",Yse="mouseleave",Xse="pointerenter",Jse="pointerleave",Qse="touchenter",Zse="touchleave";var rT="set",oT="Shape",Vm=" ",sT="stage",ys="transform",eae="Stage",dS="visible",tae=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Vm),iae=1,Q=class e{constructor(t){this._id=iae++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===ys||t===mo)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,i){let n=this._cache.get(t);return(n===void 0||(t===ys||t===mo)&&n.dirty===!0)&&(n=i.call(this),this._cache.set(t,n)),n}_calculate(t,i,n){if(!this._attachedDepsListeners.get(t)){let r=i.map(o=>o+"Change.konva").join(Vm);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(ka)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===mo&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ka)){let{scene:t,filter:i,hit:n,buffer:r}=this._cache.get(ka);M.releaseCanvas(t,i,n,r),this._cache.delete(ka)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){let i=t||{},n={};(i.x===void 0||i.y===void 0||i.width===void 0||i.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(i.width||n.width),o=Math.ceil(i.height||n.height),s=i.pixelRatio,a=i.x===void 0?Math.floor(n.x):i.x,l=i.y===void 0?Math.floor(n.y):i.y,c=i.offset||0,d=i.drawBorder||!1,u=i.hitCanvasPixelRatio||1;if(!r||!o){M.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let h=Math.abs(Math.round(n.x)-a)>.5?1:0,p=Math.abs(Math.round(n.y)-l)>.5?1:0;r+=c*2+h,o+=c*2+p,a-=c,l-=c;let f=new cn({pixelRatio:s,width:r,height:o}),g=new cn({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),m=new Cs({pixelRatio:u,width:r,height:o}),v=f.getContext(),C=m.getContext(),b=new cn({width:f.width/f.pixelRatio+Math.abs(a),height:f.height/f.pixelRatio+Math.abs(l),pixelRatio:f.pixelRatio}),S=b.getContext();return m.isCache=!0,f.isCache=!0,this._cache.delete(ka),this._filterUpToDate=!1,i.imageSmoothingEnabled===!1&&(f.getContext()._context.imageSmoothingEnabled=!1,g.getContext()._context.imageSmoothingEnabled=!1),v.save(),C.save(),S.save(),v.translate(-a,-l),C.translate(-a,-l),S.translate(-a,-l),b.x=a,b.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(zm),this._clearSelfAndDescendantCache(nT),this.drawScene(f,this,b),this.drawHit(m,this),this._isUnderCache=!1,v.restore(),C.restore(),d&&(v.save(),v.beginPath(),v.rect(0,0,r,o),v.closePath(),v.setAttr("strokeStyle","red"),v.setAttr("lineWidth",5),v.stroke(),v.restore()),this._cache.set(ka,{scene:f,filter:g,hit:m,buffer:b,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(ka)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,i){let n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],r=1/0,o=1/0,s=-1/0,a=-1/0,l=this.getAbsoluteTransform(i);return n.forEach(function(c){let d=l.point(c);r===void 0&&(r=s=d.x,o=a=d.y),r=Math.min(r,d.x),o=Math.min(o,d.y),s=Math.max(s,d.x),a=Math.max(a,d.y)}),{x:r,y:o,width:s-r,height:a-o}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);let i=this._getCanvasCache();t.translate(i.x,i.y);let n=this._getCachedSceneCanvas(),r=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/r,n.height/r),t.restore()}_drawCachedHitCanvas(t){let i=this._getCanvasCache(),n=i.hit;t.save(),t.translate(i.x,i.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),i=this._getCanvasCache(),n=i.scene,r=i.filter,o=r.getContext(),s,a,l,c;if(!t||t.length===0)return n;if(this._filterUpToDate)return r;let d=!0;for(let h=0;h<t.length;h++){let p=typeof t[h]=="string"&&!aS();if(typeof t[h]!="string"||!aS()){d=!1;break}}let u=n.pixelRatio;if(r.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio),d){let h=t.join(" ");return o.save(),o.setAttr("filter",h),o.drawImage(n._canvas,0,0,n.getWidth()/u,n.getHeight()/u),o.restore(),this._filterUpToDate=!0,r}try{for(s=t.length,o.clear(),o.drawImage(n._canvas,0,0,n.getWidth()/u,n.getHeight()/u),a=o.getImageData(0,0,r.getWidth(),r.getHeight()),l=0;l<s;l++)c=t[l],typeof c=="string"&&(c=Use(c)),c.call(this,a),o.putImageData(a,0,0)}catch(h){M.error("Unable to apply filter. "+h.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,i){if(this._cache&&this._cache.delete(Hm),arguments.length===3)return this._delegate.apply(this,arguments);let n=t.split(Vm);for(let r=0;r<n.length;r++){let s=n[r].split("."),a=s[0],l=s[1]||"";this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:l,handler:i})}return this}off(t,i){let n=(t||"").split(Vm),r=n.length,o,s,a,l,c,d;if(this._cache&&this._cache.delete(Hm),!t)for(s in this.eventListeners)this._off(s);for(o=0;o<r;o++)if(a=n[o],l=a.split("."),c=l[0],d=l[1],c)this.eventListeners[c]&&this._off(c,d,i);else for(s in this.eventListeners)this._off(s,d,i);return this}dispatchEvent(t){let i={target:this,type:t.type,evt:t};return this.fire(t.type,i),this}addEventListener(t,i){return this.on(t,function(n){i.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,i,n){let r=this;this.on(t,function(o){let s=o.target.findAncestors(i,!0,r);for(let a=0;a<s.length;a++)o=M.cloneObject(o),o.currentTarget=s[a],n.call(s[a],o)})}remove(){return this.isDragging()&&this.stopDrag(),Ke._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(mo),this._clearSelfAndDescendantCache(zm),this._clearSelfAndDescendantCache(nT),this._clearSelfAndDescendantCache(sT),this._clearSelfAndDescendantCache(dS),this._clearSelfAndDescendantCache(cS)}_remove(){this._clearCaches();let t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){let i="get"+M._capitalize(t);return M._isFunction(this[i])?this[i]():this.attrs[t]}getAncestors(){let t=this.getParent(),i=[];for(;t;)i.push(t),t=t.getParent();return i}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let i,n;if(!t)return this;for(i in t)i!==qse&&(n=rT+M._capitalize(i),M._isFunction(this[n])?this[n](t[i]):this._setAttr(i,t[i]))}),this}isListening(){return this._getCache(cS,this._isListening)}_isListening(t){if(!this.listening())return!1;let n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(dS,this._isVisible)}_isVisible(t){if(!this.visible())return!1;let n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,i=!1){if(t)return this._isVisible(t)&&this._isListening(t);let n=this.getLayer(),r=!1;Ke._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(r=!0)});let o=!i&&!ne.hitOnDragEnabled&&(r||ne.isTransforming());return this.isListening()&&this.isVisible()&&!o}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),i=this,n=0,r,o,s,a;function l(d){for(r=[],o=d.length,s=0;s<o;s++)a=d[s],n++,a.nodeType!==oT&&(r=r.concat(a.getChildren().slice())),a._id===i._id&&(s=o);r.length>0&&r[0].getDepth()<=t&&l(r)}let c=this.getStage();return i.nodeType!==eae&&c&&l(c.getChildren()),n}getDepth(){let t=0,i=this.parent;for(;i;)t++,i=i.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ys),this._clearSelfAndDescendantCache(mo)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let t=this.getStage();if(!t)return null;let i=t.getPointerPosition();if(!i)return null;let n=this.getAbsoluteTransform().copy();return n.invert(),n.point(i)}getAbsolutePosition(t){let i=!1,n=this.parent;for(;n;){if(n.isCached()){i=!0;break}n=n.parent}i&&!t&&(t=!0);let r=this.getAbsoluteTransform(t).getMatrix(),o=new ri,s=this.offset();return o.m=r.slice(),o.translate(s.x,s.y),o.getTranslation()}setAbsolutePosition(t){let s=this._clearTransform(),{x:i,y:n}=s,r=xt(s,["x","y"]);this.attrs.x=i,this.attrs.y=n,this._clearCache(ys);let o=this._getAbsoluteTransform().copy();return o.invert(),o.translate(t.x,t.y),t={x:this.attrs.x+o.getTranslation().x,y:this.attrs.y+o.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(ys),this._clearSelfAndDescendantCache(mo),this}_setTransform(t){let i;for(i in t)this.attrs[i]=t[i]}_clearTransform(){let t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let i=t.x,n=t.y,r=this.x(),o=this.y();return i!==void 0&&(r+=i),n!==void 0&&(o+=n),this.setPosition({x:r,y:o}),this}_eachAncestorReverse(t,i){let n=[],r=this.getParent(),o,s;if(!(i&&i._id===this._id)){for(n.unshift(this);r&&(!i||r._id!==i._id);)n.unshift(r),r=r.parent;for(o=n.length,s=0;s<o;s++)t(n[s])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return M.warn("Node has no parent. moveToTop function is ignored."),!1;let t=this.index,i=this.parent.getChildren().length;return t<i-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return M.warn("Node has no parent. moveUp function is ignored."),!1;let t=this.index,i=this.parent.getChildren().length;return t<i-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return M.warn("Node has no parent. moveDown function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return M.warn("Node has no parent. moveToBottom function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return M.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&M.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let i=this.index;return this.parent.children.splice(i,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(zm,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity(),i=this.getParent();return i&&!i._isUnderCache&&(t*=i.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),i,n,r,o,s,a={attrs:{},className:this.getClassName()};for(i in t)n=t[i],s=M.isObject(n)&&!M._isPlainObject(n)&&!M._isArray(n),!s&&(r=typeof this[i]=="function"&&this[i],delete t[i],o=r?r.call(this):null,t[i]=n,o!==n&&(a.attrs[i]=n));return M._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,i,n){let r=[];i&&this._isMatch(t)&&r.push(this);let o=this.parent;for(;o;){if(o===n)return r;o._isMatch(t)&&r.push(o),o=o.parent}return r}isAncestorOf(t){return!1}findAncestor(t,i,n){return this.findAncestors(t,i,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let i=t.replace(/ /g,"").split(","),n=i.length,r,o;for(r=0;r<n;r++)if(o=i[r],M.isValidSelector(o)||(M.warn('Selector "'+o+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),M.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),M.warn("Konva is awesome, right?")),o.charAt(0)==="#"){if(this.id()===o.slice(1))return!0}else if(o.charAt(0)==="."){if(this.hasName(o.slice(1)))return!0}else if(this.className===o||this.nodeType===o)return!0;return!1}getLayer(){let t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(sT,this._getStage)}_getStage(){let t=this.getParent();return t?t.getStage():null}fire(t,i={},n){return i.target=i.target||this,n?this._fireAndBubble(t,i):this._fire(t,i),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(mo,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let i;if(t)return i=new ri,this._eachAncestorReverse(function(n){let r=n.transformsEnabled();r==="all"?i.multiply(n.getTransform()):r==="position"&&i.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),i;{i=this._cache.get(mo)||new ri,this.parent?this.parent.getAbsoluteTransform().copyInto(i):i.reset();let n=this.transformsEnabled();if(n==="all")i.multiply(this.getTransform());else if(n==="position"){let r=this.attrs.x||0,o=this.attrs.y||0,s=this.attrs.offsetX||0,a=this.attrs.offsetY||0;i.translate(r-s,o-a)}return i.dirty=!1,i}}getAbsoluteScale(t){let i=this;for(;i;)i._isUnderCache&&(t=i),i=i.getParent();let r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ys,this._getTransform)}_getTransform(){var t,i;let n=this._cache.get(ys)||new ri;n.reset();let r=this.x(),o=this.y(),s=ne.getAngle(this.rotation()),a=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(i=this.attrs.scaleY)!==null&&i!==void 0?i:1,c=this.attrs.skewX||0,d=this.attrs.skewY||0,u=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(r!==0||o!==0)&&n.translate(r,o),s!==0&&n.rotate(s),(c!==0||d!==0)&&n.skew(c,d),(a!==1||l!==1)&&n.scale(a,l),(u!==0||h!==0)&&n.translate(-1*u,-1*h),n.dirty=!1,n}clone(t){let i=M.cloneObject(this.attrs),n,r,o,s,a;for(n in t)i[n]=t[n];let l=new this.constructor(i);for(n in this.eventListeners)for(r=this.eventListeners[n],o=r.length,s=0;s<o;s++)a=r[s],a.name.indexOf($se)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(a));return l}_toKonvaCanvas(t){t=t||{};let i=this.getClientRect(),n=this.getStage(),r=t.x!==void 0?t.x:Math.floor(i.x),o=t.y!==void 0?t.y:Math.floor(i.y),s=t.pixelRatio||1,a=new cn({width:t.width||Math.ceil(i.width)||(n?n.width():0),height:t.height||Math.ceil(i.height)||(n?n.height():0),pixelRatio:s}),l=a.getContext(),c=new cn({width:a.width/a.pixelRatio+Math.abs(r),height:a.height/a.pixelRatio+Math.abs(o),pixelRatio:a.pixelRatio});return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(r||o)&&l.translate(-1*r,-1*o),this.drawScene(a,void 0,c),l.restore(),a}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};let i=t.mimeType||null,n=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(i,n);return t.callback&&t.callback(r),r}toImage(t){return new Promise((i,n)=>{try{let r=t?.callback;r&&delete t.callback,M._urlToImage(this.toDataURL(t),function(o){i(o),r?.(o)})}catch(r){n(r)}})}toBlob(t){return new Promise((i,n)=>{try{let r=t?.callback;r&&delete t.callback,this.toCanvas(t).toBlob(o=>{i(o),r?.(o)},t?.mimeType,t?.quality)}catch(r){n(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():ne.dragDistance}_off(t,i,n){let r=this.eventListeners[t],o,s,a;for(o=0;o<r.length;o++)if(s=r[o].name,a=r[o].handler,(s!=="konva"||i==="konva")&&(!i||s===i)&&(!n||n===a)){if(r.splice(o,1),r.length===0){delete this.eventListeners[t];break}o--}}_fireChangeEvent(t,i,n){this._fire(t+jse,{oldVal:i,newVal:n})}addName(t){if(!this.hasName(t)){let i=this.name(),n=i?i+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;let i=this.name();return i?(i||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){let i=(this.name()||"").split(/\s/g),n=i.indexOf(t);return n!==-1&&(i.splice(n,1),this.name(i.join(" "))),this}setAttr(t,i){let n=this[rT+M._capitalize(t)];return M._isFunction(n)?n.call(this,i):this._setAttr(t,i),this}_requestDraw(){if(ne.autoDrawEnabled){let t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,i){let n=this.attrs[t];n===i&&!M.isObject(i)||(i==null?delete this.attrs[t]:this.attrs[t]=i,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,i),this._requestDraw())}_setComponentAttr(t,i,n){let r;n!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][i]=n,this._fireChangeEvent(t,r,n))}_fireAndBubble(t,i,n){i&&this.nodeType===oT&&(i.target=this);let r=[Kse,Yse,Xse,Jse,Qse,Zse];if(!(r.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,i);let s=r.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(i&&!i.cancelBubble||!i)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,i,n):this._fireAndBubble.call(this.parent,t,i))}}_getProtoListeners(t){var i,n,r;let o=(i=this._cache.get(Hm))!==null&&i!==void 0?i:{},s=o?.[t];if(s===void 0){s=[];let a=Object.getPrototypeOf(this);for(;a;){let l=(r=(n=a.eventListeners)===null||n===void 0?void 0:n[t])!==null&&r!==void 0?r:[];s.push(...l),a=Object.getPrototypeOf(a)}o[t]=s,this._cache.set(Hm,o)}return s}_fire(t,i){i=i||{},i.currentTarget=this,i.type=t;let n=this._getProtoListeners(t);if(n)for(let o=0;o<n.length;o++)n[o].handler.call(this,i);let r=this.eventListeners[t];if(r)for(let o=0;o<r.length;o++)r[o].handler.call(this,i)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){let i=t?t.pointerId:void 0,n=this.getStage(),r=this.getAbsolutePosition();if(!n)return;let o=n._getPointerById(i)||n._changedPointerPositions[0]||r;Ke._dragElements.set(this._id,{node:this,startPointerPos:o,offset:{x:o.x-r.x,y:o.y-r.y},dragStatus:"ready",pointerId:i})}startDrag(t,i=!0){Ke._dragElements.has(this._id)||this._createDragElement(t);let n=Ke._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},i)}_setDragPosition(t,i){let n=this.getStage()._getPointerById(i.pointerId);if(!n)return;let r={x:n.x-i.offset.x,y:n.y-i.offset.y},o=this.dragBoundFunc();if(o!==void 0){let s=o.call(this,r,t);s?r=s:M.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){let i=Ke._dragElements.get(this._id);i&&(i.dragStatus="stopped"),Ke._endDragBefore(t),Ke._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){let t=Ke._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||ne.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;Ke._dragElements.forEach(o=>{this.isAncestorOf(o.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let i=Ke._dragElements.get(this._id),n=i&&i.dragStatus==="dragging",r=i&&i.dragStatus==="ready";n?this.stopDrag():r&&Ke._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){let i=this.getStage();if(!i)return!1;let n={x:-t.x,y:-t.y,width:i.width()+2*t.x,height:i.height()+2*t.y};return M.haveIntersection(n,this.getClientRect())}static create(t,i){return M._isString(t)&&(t=JSON.parse(t)),this._createNode(t,i)}static _createNode(t,i){let n=e.prototype.getClassName.call(t),r=t.children,o,s,a;i&&(t.attrs.container=i),ne[n]||(M.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");let l=ne[n];if(o=new l(t.attrs),r)for(s=r.length,a=0;a<s;a++)o.add(e._createNode(r[a]));return o}};Q.prototype.nodeType="Node";Q.prototype._attrsAffectingSize=[];Q.prototype.eventListeners={};Q.prototype.on.call(Q.prototype,tae,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ys),this._clearSelfAndDescendantCache(mo)});Q.prototype.on.call(Q.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(dS)});Q.prototype.on.call(Q.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(cS)});Q.prototype.on.call(Q.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(zm)});var pt=R.addGetterSetter;pt(Q,"zIndex");pt(Q,"absolutePosition");pt(Q,"position");pt(Q,"x",0,K());pt(Q,"y",0,K());pt(Q,"globalCompositeOperation","source-over",Or());pt(Q,"opacity",1,K());pt(Q,"name","",Or());pt(Q,"id","",Or());pt(Q,"rotation",0,K());R.addComponentsGetterSetter(Q,"scale",["x","y"]);pt(Q,"scaleX",1,K());pt(Q,"scaleY",1,K());R.addComponentsGetterSetter(Q,"skew",["x","y"]);pt(Q,"skewX",0,K());pt(Q,"skewY",0,K());R.addComponentsGetterSetter(Q,"offset",["x","y"]);pt(Q,"offsetX",0,K());pt(Q,"offsetY",0,K());pt(Q,"dragDistance",void 0,K());pt(Q,"width",0,K());pt(Q,"height",0,K());pt(Q,"listening",!0,oi());pt(Q,"preventDefault",!0,oi());pt(Q,"filters",void 0,function(e){return this._filterUpToDate=!1,e});pt(Q,"visible",!0,oi());pt(Q,"transformsEnabled","all",Or());pt(Q,"size");pt(Q,"dragBoundFunc");pt(Q,"draggable",!1,oi());R.backCompat(Q,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Gt=class extends Q{constructor(){super(...arguments),this.children=[]}getChildren(t){let i=this.children||[];return t?i.filter(t):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}let i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){let i=this._generalFind(t,!0);return i.length>0?i[0]:void 0}_generalFind(t,i){let n=[];return this._descendants(r=>{let o=r._isMatch(t);return o&&n.push(r),!!(o&&i)}),n}_descendants(t){let i=!1,n=this.getChildren();for(let r of n){if(i=t(r),i)return!0;if(r.hasChildren()&&(i=r._descendants(t),i))return!0}return!1}toObject(){let t=Q.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(i=>{t.children.push(i.toObject())}),t}isAncestorOf(t){let i=t.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(t){let i=Q.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){i.add(n.clone())}),i}getAllIntersections(t){let i=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&i.push(n)}),i}_clearSelfAndDescendantCache(t){var i;super._clearSelfAndDescendantCache(t),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(i,n){i.index=n}),this._requestDraw()}drawScene(t,i,n){let r=this.getLayer(),o=t||r&&r.getCanvas(),s=o&&o.getContext(),a=this._getCanvasCache(),l=a&&a.scene,c=o&&o.isCache;if(!this.isVisible()&&!c)return this;if(l){s.save();let d=this.getAbsoluteTransform(i).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",o,i,n);return this}drawHit(t,i){if(!this.shouldDrawHit(i))return this;let n=this.getLayer(),r=t||n&&n.hitCanvas,o=r&&r.getContext(),s=this._getCanvasCache();if(s&&s.hit){o.save();let l=this.getAbsoluteTransform(i).getMatrix();o.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(o),o.restore()}else this._drawChildren("drawHit",r,i);return this}_drawChildren(t,i,n,r){var o;let s=i&&i.getContext(),a=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),d=typeof a=="number"&&typeof l=="number"||c,u=n===this;if(d){s.save();let p=this.getAbsoluteTransform(n),f=p.getMatrix();s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),s.beginPath();let g;if(c)g=c.call(this,s,this);else{let m=this.clipX(),v=this.clipY();s.rect(m||0,v||0,a,l)}s.clip.apply(s,g),f=p.copy().invert().getMatrix(),s.transform(f[0],f[1],f[2],f[3],f[4],f[5])}let h=!u&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";h&&(s.save(),s._applyGlobalCompositeOperation(this)),(o=this.children)===null||o===void 0||o.forEach(function(p){p[t](i,n,r)}),h&&s.restore(),d&&s.restore()}getClientRect(t={}){var i;let n=t.skipTransform,r=t.relativeTo,o,s,a,l,c={x:1/0,y:1/0,width:0,height:0},d=this;(i=this.children)===null||i===void 0||i.forEach(function(p){if(!p.visible())return;let f=p.getClientRect({relativeTo:d,skipShadow:t.skipShadow,skipStroke:t.skipStroke});f.width===0&&f.height===0||(o===void 0?(o=f.x,s=f.y,a=f.x+f.width,l=f.y+f.height):(o=Math.min(o,f.x),s=Math.min(s,f.y),a=Math.max(a,f.x+f.width),l=Math.max(l,f.y+f.height)))});let u=this.find("Shape"),h=!1;for(let p=0;p<u.length;p++)if(u[p]._isVisible(this)){h=!0;break}return h&&o!==void 0?c={x:o,y:s,width:a-o,height:l-s}:c={x:0,y:0,width:0,height:0},n?c:this._transformedRect(c,r)}};R.addComponentsGetterSetter(Gt,"clip",["x","y","width","height"]);R.addGetterSetter(Gt,"clipX",void 0,K());R.addGetterSetter(Gt,"clipY",void 0,K());R.addGetterSetter(Gt,"clipWidth",void 0,K());R.addGetterSetter(Gt,"clipHeight",void 0,K());R.addGetterSetter(Gt,"clipFunc");var ch=new Map,aT=ne._global.PointerEvent!==void 0;function Gm(e){return ch.get(e)}function Wm(e){return{evt:e,pointerId:e.pointerId}}function Um(e,t){return ch.get(e)===t}function jm(e,t){_a(e),t.getStage()&&(ch.set(e,t),aT&&t._fire("gotpointercapture",Wm(new PointerEvent("gotpointercapture"))))}function _a(e,t){let i=ch.get(e);if(!i)return;let n=i.getStage();n&&n.content,ch.delete(e),aT&&i._fire("lostpointercapture",Wm(new PointerEvent("lostpointercapture")))}var nae="Stage",rae="string",cT="px",oae="mouseout",uT="mouseleave",hT="mouseover",pT="mouseenter",fT="mousemove",gT="mousedown",mT="mouseup",dh="pointermove",uh="pointerdown",hc="pointerup",hh="pointercancel",sae="lostpointercapture",qm="pointerout",ph="pointerleave",$m="pointerover",Km="pointerenter",hS="contextmenu",vT="touchstart",CT="touchend",wT="touchmove",bT="touchcancel",pS="wheel",aae=5,lae=[[pT,"_pointerenter"],[gT,"_pointerdown"],[fT,"_pointermove"],[mT,"_pointerup"],[uT,"_pointerleave"],[vT,"_pointerdown"],[wT,"_pointermove"],[CT,"_pointerup"],[bT,"_pointercancel"],[hT,"_pointerover"],[pS,"_wheel"],[hS,"_contextmenu"],[uh,"_pointerdown"],[dh,"_pointermove"],[hc,"_pointerup"],[hh,"_pointercancel"],[ph,"_pointerleave"],[sae,"_lostpointercapture"]],uS={mouse:{[qm]:oae,[ph]:uT,[$m]:hT,[Km]:pT,[dh]:fT,[uh]:gT,[hc]:mT,[hh]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[qm]:"touchout",[ph]:"touchleave",[$m]:"touchover",[Km]:"touchenter",[dh]:wT,[uh]:vT,[hc]:CT,[hh]:bT,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[qm]:qm,[ph]:ph,[$m]:$m,[Km]:Km,[dh]:dh,[uh]:uh,[hc]:hc,[hh]:hh,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},fh=e=>e.indexOf("pointer")>=0?"pointer":e.indexOf("touch")>=0?"touch":"mouse",uc=e=>{let t=fh(e);if(t==="pointer")return ne.pointerEventsEnabled&&uS.pointer;if(t==="touch")return uS.touch;if(t==="mouse")return uS.mouse};function dT(e={}){return(e.clipFunc||e.clipWidth||e.clipHeight)&&M.warn("Stage does not support clipping. Please use clip for Layers or Groups."),e}var cae="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",pc=[],vo=class extends Gt{constructor(t){super(dT(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),pc.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{dT(this.attrs)}),this._checkVisibility()}_validateAdd(t){let i=t.getType()==="Layer",n=t.getType()==="FastLayer";i||n||M.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===rae){let i;if(t.charAt(0)==="."){let n=t.slice(1);t=document.getElementsByClassName(n)[0]}else t.charAt(0)!=="#"?i=t:i=t.slice(1),t=document.getElementById(i);if(!t)throw"Can not find container in document with id "+i}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let t=this.children,i=t.length;for(let n=0;n<i;n++)t[n].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),Gt.prototype.clone.call(this,t)}destroy(){super.destroy();let t=this.content;t&&M._isInDocument(t)&&this.container().removeChild(t);let i=pc.indexOf(this);return i>-1&&pc.splice(i,1),M.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(M.warn(cae),null)}_getPointerById(t){return this._pointerPositions.find(i=>i.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t=w({},t),t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();let i=new cn({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),n=i.getContext()._context,r=this.children;return(t.x||t.y)&&n.translate(-1*t.x,-1*t.y),r.forEach(function(o){if(!o.isVisible())return;let s=o._toKonvaCanvas(t);n.drawImage(s._canvas,t.x,t.y,s.getWidth()/s.getPixelRatio(),s.getHeight()/s.getPixelRatio())}),i}getIntersection(t){if(!t)return null;let i=this.children,n=i.length,r=n-1;for(let o=r;o>=0;o--){let s=i[o].getIntersection(t);if(s)return s}return null}_resizeDOM(){let t=this.width(),i=this.height();this.content&&(this.content.style.width=t+cT,this.content.style.height=i+cT),this.bufferCanvas.setSize(t,i),this.bufferHitCanvas.setSize(t,i),this.children.forEach(n=>{n.setSize({width:t,height:i}),n.draw()})}add(t,...i){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);let n=this.children.length;return n>aae&&M.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),ne.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Um(t,this)}setPointerCapture(t){jm(t,this)}releaseCapture(t){_a(t,this)}getLayers(){return this.children}_bindContentEvents(){ne.isBrowser&&lae.forEach(([t,i])=>{this.content.addEventListener(t,n=>{this[i](n)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);let i=uc(t.type);i&&this._fire(i.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);let i=uc(t.type);i&&this._fire(i.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let i=this[t+"targetShape"];return i&&!i.getStage()&&(i=null),i}_pointerleave(t){let i=uc(t.type),n=fh(t.type);if(!i)return;this.setPointersPositions(t);let r=this._getTargetShape(n),o=!(ne.isDragging()||ne.isTransforming())||ne.hitOnDragEnabled;r&&o?(r._fireAndBubble(i.pointerout,{evt:t}),r._fireAndBubble(i.pointerleave,{evt:t}),this._fire(i.pointerleave,{evt:t,target:this,currentTarget:this}),this[n+"targetShape"]=null):o&&(this._fire(i.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(i.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){let i=uc(t.type),n=fh(t.type);if(!i)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(o=>{let s=this.getIntersection(o);if(Ke.justDragged=!1,ne["_"+n+"ListenClick"]=!0,!s||!s.isListening()){this[n+"ClickStartShape"]=void 0;return}ne.capturePointerEventsEnabled&&s.setPointerCapture(o.id),this[n+"ClickStartShape"]=s,s._fireAndBubble(i.pointerdown,{evt:t,pointerId:o.id}),r=!0;let a=t.type.indexOf("touch")>=0;s.preventDefault()&&t.cancelable&&a&&t.preventDefault()}),r||this._fire(i.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){let i=uc(t.type),n=fh(t.type);if(!i)return;let r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(ne.isDragging()&&Ke.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(ne.isDragging()||ne.isTransforming())||ne.hitOnDragEnabled))return;let s={},a=!1,l=this._getTargetShape(n);this._changedPointerPositions.forEach(c=>{let d=Gm(c.id)||this.getIntersection(c),u=c.id,h={evt:t,pointerId:u},p=l!==d;if(p&&l&&(l._fireAndBubble(i.pointerout,w({},h),d),l._fireAndBubble(i.pointerleave,w({},h),d)),d){if(s[d._id])return;s[d._id]=!0}d&&d.isListening()?(a=!0,p&&(d._fireAndBubble(i.pointerover,w({},h),l),d._fireAndBubble(i.pointerenter,w({},h),l),this[n+"targetShape"]=d),d._fireAndBubble(i.pointermove,w({},h))):l&&(this._fire(i.pointerover,{evt:t,target:this,currentTarget:this,pointerId:u}),this[n+"targetShape"]=null)}),a||this._fire(i.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){let i=uc(t.type),n=fh(t.type);if(!i)return;this.setPointersPositions(t);let r=this[n+"ClickStartShape"],o=this[n+"ClickEndShape"],s={},a=!1;this._changedPointerPositions.forEach(l=>{let c=Gm(l.id)||this.getIntersection(l);if(c){if(c.releaseCapture(l.id),s[c._id])return;s[c._id]=!0}let d=l.id,u={evt:t,pointerId:d},h=!1;ne["_"+n+"InDblClickWindow"]?(h=!0,clearTimeout(this[n+"DblTimeout"])):Ke.justDragged||(ne["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout(function(){ne["_"+n+"InDblClickWindow"]=!1},ne.dblClickWindow),c&&c.isListening()?(a=!0,this[n+"ClickEndShape"]=c,c._fireAndBubble(i.pointerup,w({},u)),ne["_"+n+"ListenClick"]&&r&&r===c&&(c._fireAndBubble(i.pointerclick,w({},u)),h&&o&&o===c&&c._fireAndBubble(i.pointerdblclick,w({},u)))):(this[n+"ClickEndShape"]=null,a||(this._fire(i.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a=!0),ne["_"+n+"ListenClick"]&&this._fire(i.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:d}),h&&this._fire(i.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:d}))}),a||this._fire(i.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),ne["_"+n+"ListenClick"]=!1,t.cancelable&&n!=="touch"&&n!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(hS,{evt:t}):this._fire(hS,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);let i=this.getIntersection(this.getPointerPosition());i&&i.isListening()?i._fireAndBubble(pS,{evt:t}):this._fire(pS,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);let i=Gm(t.pointerId)||this.getIntersection(this.getPointerPosition());i&&i._fireAndBubble(hc,Wm(t)),_a(t.pointerId)}_lostpointercapture(t){_a(t.pointerId)}setPointersPositions(t){let i=this._getContentPosition(),n=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,o=>{this._pointerPositions.push({id:o.identifier,x:(o.clientX-i.left)/i.scaleX,y:(o.clientY-i.top)/i.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,o=>{this._changedPointerPositions.push({id:o.identifier,x:(o.clientX-i.left)/i.scaleX,y:(o.clientY-i.top)/i.scaleY})})):(n=(t.clientX-i.left)/i.scaleX,r=(t.clientY-i.top)/i.scaleY,this.pointerPos={x:n,y:r},this._pointerPositions=[{x:n,y:r,id:M._getFirstPointerId(t)}],this._changedPointerPositions=[{x:n,y:r,id:M._getFirstPointerId(t)}])}_setPointerPosition(t){M.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new cn({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Cs({pixelRatio:1,width:this.width(),height:this.height()}),!ne.isBrowser)return;let t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return M.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};vo.prototype.nodeType=nae;Oe(vo);R.addGetterSetter(vo,"container");ne.isBrowser&&document.addEventListener("visibilitychange",()=>{pc.forEach(e=>{e.batchDraw()})});var yT="hasShadow",ST="shadowRGBA",xT="patternImage",ET="linearGradient",RT="radialGradient",Ym;function fS(){return Ym||(Ym=M.createCanvasElement().getContext("2d"),Ym)}var Da={};function dae(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function uae(e){e.stroke()}function hae(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function pae(e){e.stroke()}function fae(){this._clearCache(yT)}function gae(){this._clearCache(ST)}function mae(){this._clearCache(xT)}function vae(){this._clearCache(ET)}function Cae(){this._clearCache(RT)}var q=class extends Q{constructor(t){super(t);let i,n=0;for(;i=M.getHitColor(),!(i&&!(i in Da));)if(n++,n>=1e4){M.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),i=M.getRandomColor();break}this.colorKey=i,Da[i]=this}getContext(){return M.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return M.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(yT,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(xT,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let i=fS().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(i&&i.setTransform){let n=new ri;n.translate(this.fillPatternX(),this.fillPatternY()),n.rotate(ne.getAngle(this.fillPatternRotation())),n.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),n.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let r=n.getMatrix(),o=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);i.setTransform(o)}return i}}_getLinearGradient(){return this._getCache(ET,this.__getLinearGradient)}__getLinearGradient(){let t=this.fillLinearGradientColorStops();if(t){let i=fS(),n=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),o=i.createLinearGradient(n.x,n.y,r.x,r.y);for(let s=0;s<t.length;s+=2)o.addColorStop(t[s],t[s+1]);return o}}_getRadialGradient(){return this._getCache(RT,this.__getRadialGradient)}__getRadialGradient(){let t=this.fillRadialGradientColorStops();if(t){let i=fS(),n=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),o=i.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let s=0;s<t.length;s+=2)o.addColorStop(t[s],t[s+1]);return o}}getShadowRGBA(){return this._getCache(ST,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let t=M.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){let i=this.getStage();if(!i)return!1;let n=i.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,void 0,!0),n.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return Q.prototype.destroy.call(this),delete Da[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var i;if(!((i=this.attrs.perfectDrawEnabled)!==null&&i!==void 0?i:!0))return!1;let r=t||this.hasFill(),o=this.hasStroke(),s=this.getAbsoluteOpacity()!==1;if(r&&o&&s)return!0;let a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(r&&o&&a&&l)}setStrokeHitEnabled(t){M.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){let t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let i=!1,n=this.getParent();for(;n;){if(n.isCached()){i=!0;break}n=n.getParent()}let r=t.skipTransform,o=t.relativeTo||i&&this.getStage()||void 0,s=this.getSelfRect(),l=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,c=s.width+l,d=s.height+l,u=!t.skipShadow&&this.hasShadow(),h=u?this.shadowOffsetX():0,p=u?this.shadowOffsetY():0,f=c+Math.abs(h),g=d+Math.abs(p),m=u&&this.shadowBlur()||0,v=f+m*2,C=g+m*2,b={width:v,height:C,x:-(l/2+m)+Math.min(h,0)+s.x,y:-(l/2+m)+Math.min(p,0)+s.y};return r?b:this._transformedRect(b,o)}drawScene(t,i,n){let r=this.getLayer(),o=t||r.getCanvas(),s=o.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),c=this.hasShadow(),d,u=!1,h=i===this;if(!this.isVisible()&&!h)return this;if(a){s.save();let p=this.getAbsoluteTransform(i).getMatrix();return s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!l)return this;if(s.save(),this._useBufferCanvas()&&!u){d=this.getStage();let p=n||d.bufferCanvas,f=p.getContext();f.clear(),f.save(),f._applyLineJoin(this),f._applyMiterLimit(this);let g=this.getAbsoluteTransform(i).getMatrix();f.transform(g[0],g[1],g[2],g[3],g[4],g[5]),l.call(this,f,this),f.restore();let m=p.pixelRatio;c&&s._applyShadow(this),h||(s._applyOpacity(this),s._applyGlobalCompositeOperation(this)),s.drawImage(p._canvas,p.x||0,p.y||0,p.width/m,p.height/m)}else{if(s._applyLineJoin(this),s._applyMiterLimit(this),!h){let p=this.getAbsoluteTransform(i).getMatrix();s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)}c&&s._applyShadow(this),l.call(this,s,this)}return s.restore(),this}drawHit(t,i,n=!1){if(!this.shouldDrawHit(i,n))return this;let r=this.getLayer(),o=t||r.hitCanvas,s=o&&o.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||M.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){s.save();let u=this.getAbsoluteTransform(i).getMatrix();return s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(s),s.restore(),this}if(!a)return this;if(s.save(),s._applyLineJoin(this),s._applyMiterLimit(this),!(this===i)){let u=this.getAbsoluteTransform(i).getMatrix();s.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return a.call(this,s,this),s.restore(),this}drawHitFromCache(t=0){let i=this._getCanvasCache(),n=this._getCachedSceneCanvas(),r=i.hit,o=r.getContext(),s=r.getWidth(),a=r.getHeight();o.clear(),o.drawImage(n._canvas,0,0,s,a);try{let l=o.getImageData(0,0,s,a),c=l.data,d=c.length,u=M._hexToRgb(this.colorKey);for(let h=0;h<d;h+=4)c[h+3]>t?(c[h]=u.r,c[h+1]=u.g,c[h+2]=u.b,c[h+3]=255):c[h+3]=0;o.putImageData(l,0,0)}catch(l){M.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(t){return Um(t,this)}setPointerCapture(t){jm(t,this)}releaseCapture(t){_a(t,this)}};q.prototype._fillFunc=dae;q.prototype._strokeFunc=uae;q.prototype._fillFuncHit=hae;q.prototype._strokeFuncHit=pae;q.prototype._centroid=!1;q.prototype.nodeType="Shape";Oe(q);q.prototype.eventListeners={};q.prototype.on.call(q.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",fae);q.prototype.on.call(q.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",gae);q.prototype.on.call(q.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",mae);q.prototype.on.call(q.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",vae);q.prototype.on.call(q.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",Cae);R.addGetterSetter(q,"stroke",void 0,lS());R.addGetterSetter(q,"strokeWidth",2,K());R.addGetterSetter(q,"fillAfterStrokeEnabled",!1);R.addGetterSetter(q,"hitStrokeWidth","auto",sh());R.addGetterSetter(q,"strokeHitEnabled",!0,oi());R.addGetterSetter(q,"perfectDrawEnabled",!0,oi());R.addGetterSetter(q,"shadowForStrokeEnabled",!0,oi());R.addGetterSetter(q,"lineJoin");R.addGetterSetter(q,"lineCap");R.addGetterSetter(q,"miterLimit");R.addGetterSetter(q,"sceneFunc");R.addGetterSetter(q,"hitFunc");R.addGetterSetter(q,"dash");R.addGetterSetter(q,"dashOffset",0,K());R.addGetterSetter(q,"shadowColor",void 0,Or());R.addGetterSetter(q,"shadowBlur",0,K());R.addGetterSetter(q,"shadowOpacity",1,K());R.addComponentsGetterSetter(q,"shadowOffset",["x","y"]);R.addGetterSetter(q,"shadowOffsetX",0,K());R.addGetterSetter(q,"shadowOffsetY",0,K());R.addGetterSetter(q,"fillPatternImage");R.addGetterSetter(q,"fill",void 0,lS());R.addGetterSetter(q,"fillPatternX",0,K());R.addGetterSetter(q,"fillPatternY",0,K());R.addGetterSetter(q,"fillLinearGradientColorStops");R.addGetterSetter(q,"strokeLinearGradientColorStops");R.addGetterSetter(q,"fillRadialGradientStartRadius",0);R.addGetterSetter(q,"fillRadialGradientEndRadius",0);R.addGetterSetter(q,"fillRadialGradientColorStops");R.addGetterSetter(q,"fillPatternRepeat","repeat");R.addGetterSetter(q,"fillEnabled",!0);R.addGetterSetter(q,"strokeEnabled",!0);R.addGetterSetter(q,"shadowEnabled",!0);R.addGetterSetter(q,"dashEnabled",!0);R.addGetterSetter(q,"strokeScaleEnabled",!0);R.addGetterSetter(q,"fillPriority","color");R.addComponentsGetterSetter(q,"fillPatternOffset",["x","y"]);R.addGetterSetter(q,"fillPatternOffsetX",0,K());R.addGetterSetter(q,"fillPatternOffsetY",0,K());R.addComponentsGetterSetter(q,"fillPatternScale",["x","y"]);R.addGetterSetter(q,"fillPatternScaleX",1,K());R.addGetterSetter(q,"fillPatternScaleY",1,K());R.addComponentsGetterSetter(q,"fillLinearGradientStartPoint",["x","y"]);R.addComponentsGetterSetter(q,"strokeLinearGradientStartPoint",["x","y"]);R.addGetterSetter(q,"fillLinearGradientStartPointX",0);R.addGetterSetter(q,"strokeLinearGradientStartPointX",0);R.addGetterSetter(q,"fillLinearGradientStartPointY",0);R.addGetterSetter(q,"strokeLinearGradientStartPointY",0);R.addComponentsGetterSetter(q,"fillLinearGradientEndPoint",["x","y"]);R.addComponentsGetterSetter(q,"strokeLinearGradientEndPoint",["x","y"]);R.addGetterSetter(q,"fillLinearGradientEndPointX",0);R.addGetterSetter(q,"strokeLinearGradientEndPointX",0);R.addGetterSetter(q,"fillLinearGradientEndPointY",0);R.addGetterSetter(q,"strokeLinearGradientEndPointY",0);R.addComponentsGetterSetter(q,"fillRadialGradientStartPoint",["x","y"]);R.addGetterSetter(q,"fillRadialGradientStartPointX",0);R.addGetterSetter(q,"fillRadialGradientStartPointY",0);R.addComponentsGetterSetter(q,"fillRadialGradientEndPoint",["x","y"]);R.addGetterSetter(q,"fillRadialGradientEndPointX",0);R.addGetterSetter(q,"fillRadialGradientEndPointY",0);R.addGetterSetter(q,"fillPatternRotation",0);R.addGetterSetter(q,"fillRule",void 0,Or());R.backCompat(q,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var wae="beforeDraw",bae="draw",PT=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],yae=PT.length,$i=class extends Gt{constructor(t){super(t),this.canvas=new cn,this.hitCanvas=new Cs({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);let i=this.getStage();return i&&i.content&&(i.content.removeChild(this.getNativeCanvasElement()),t<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[t+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Q.prototype.moveToTop.call(this);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Q.prototype.moveUp.call(this))return!1;let i=this.getStage();return!i||!i.content?!1:(i.content.removeChild(this.getNativeCanvasElement()),this.index<i.children.length-1?i.content.insertBefore(this.getNativeCanvasElement(),i.children[this.index+1].getCanvas()._canvas):i.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Q.prototype.moveDown.call(this)){let t=this.getStage();if(t){let i=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),i[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Q.prototype.moveToBottom.call(this)){let t=this.getStage();if(t){let i=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),i[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let t=this.getNativeCanvasElement();return Q.prototype.remove.call(this),t&&t.parentNode&&M._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:i}){return this.canvas.setSize(t,i),this.hitCanvas.setSize(t,i),this._setSmoothEnabled(),this}_validateAdd(t){let i=t.getType();i!=="Group"&&i!=="Shape"&&M.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=w({},t),t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Q.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){M.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){M.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,M.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let i=1,n=!1;for(;;){for(let r=0;r<yae;r++){let o=PT[r],s=this._getIntersection({x:t.x+o.x*i,y:t.y+o.y*i}),a=s.shape;if(a)return a;if(n=!!s.antialiased,!s.antialiased)break}if(n)i+=1;else return null}}_getIntersection(t){let i=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*i),Math.round(t.y*i),1,1).data,r=n[3];if(r===255){let o=M.getHitColorKey(n[0],n[1],n[2]),s=Da[o];return s?{shape:s}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,i,n){let r=this.getLayer(),o=t||r&&r.getCanvas();return this._fire(wae,{node:this}),this.clearBeforeDraw()&&o.getContext().clear(),Gt.prototype.drawScene.call(this,o,i,n),this._fire(bae,{node:this}),this}drawHit(t,i){let n=this.getLayer(),r=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),Gt.prototype.drawHit.call(this,r,i),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){M.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return M.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return M.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};$i.prototype.nodeType="Layer";Oe($i);R.addGetterSetter($i,"imageSmoothingEnabled",!0);R.addGetterSetter($i,"clearBeforeDraw",!0);R.addGetterSetter($i,"hitGraphEnabled",!0,oi());var fc=class extends $i{constructor(t){super(t),this.listening(!1),M.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};fc.prototype.nodeType="FastLayer";Oe(fc);var dn=class extends Gt{_validateAdd(t){let i=t.getType();i!=="Group"&&i!=="Shape"&&M.throw("You may only add groups and shapes to groups.")}};dn.prototype.nodeType="Group";Oe(dn);var gS=(function(){return vs.performance&&vs.performance.now?function(){return vs.performance.now()}:function(){return new Date().getTime()}})(),gc=(()=>{class e{constructor(i,n){this.id=e.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:gS(),frameRate:0},this.func=i,this.setLayers(n)}setLayers(i){let n=[];return i&&(n=Array.isArray(i)?i:[i]),this.layers=n,this}getLayers(){return this.layers}addLayer(i){let n=this.layers,r=n.length;for(let o=0;o<r;o++)if(n[o]._id===i._id)return!1;return this.layers.push(i),!0}isRunning(){let n=e.animations,r=n.length;for(let o=0;o<r;o++)if(n[o].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=gS(),e._addAnimation(this),this}stop(){return e._removeAnimation(this),this}_updateFrameObject(i){this.frame.timeDiff=i-this.frame.lastTime,this.frame.lastTime=i,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(i){this.animations.push(i),this._handleAnimation()}static _removeAnimation(i){let n=i.id,r=this.animations,o=r.length;for(let s=0;s<o;s++)if(r[s].id===n){this.animations.splice(s,1);break}}static _runFrames(){let i={},n=this.animations;for(let r=0;r<n.length;r++){let o=n[r],s=o.layers,a=o.func;o._updateFrameObject(gS());let l=s.length,c;if(a?c=a.call(o,o.frame)!==!1:c=!0,!!c)for(let d=0;d<l;d++){let u=s[d];u._id!==void 0&&(i[u._id]=u)}}for(let r in i)i.hasOwnProperty(r)&&i[r].batchDraw()}static _animationLoop(){let i=e;i.animations.length?(i._runFrames(),M.requestAnimFrame(i._animationLoop)):i.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,M.requestAnimFrame(this._animationLoop))}}return e.animations=[],e.animIdCounter=0,e.animRunning=!1,e})();var Sae={node:1,duration:1,easing:1,onFinish:1,yoyo:1},xae=1,kT=2,_T=3,DT=["fill","stroke","shadowColor"],Eae=0,mS=class{constructor(t,i,n,r,o,s,a){this.prop=t,this.propFunc=i,this.begin=r,this._pos=r,this.duration=s,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=o-this.begin,this.pause()}fire(t){let i=this[t];i&&i()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=kT,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=_T,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let t=this.getTimer()-this._startTime;this.state===kT?this.setTime(t):this.state===_T&&this.setTime(this.duration-t)}pause(){this.state=xae,this.fire("onPause")}getTimer(){return new Date().getTime()}},vS=(()=>{class e{constructor(i){let n=this,r=i.node,o=r._id,s=i.easing||mc.Linear,a=!!i.yoyo,l,c;typeof i.duration>"u"?l=.3:i.duration===0?l=.001:l=i.duration,this.node=r,this._id=Eae++;let d=r.getLayer()||(r instanceof ne.Stage?r.getLayers():null);d||M.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new gc(function(){n.tween.onEnterFrame()},d),this.tween=new mS(c,function(u){n._tweenFunc(u)},s,0,1,l*1e3,a),this._addListeners(),e.attrs[o]||(e.attrs[o]={}),e.attrs[o][this._id]||(e.attrs[o][this._id]={}),e.tweens[o]||(e.tweens[o]={});for(c in i)Sae[c]===void 0&&this._addAttr(c,i[c]);this.reset(),this.onFinish=i.onFinish,this.onReset=i.onReset,this.onUpdate=i.onUpdate}_addAttr(i,n){let r=this.node,o=r._id,s,a,l,c,d,u=e.tweens[o][i];u&&delete e.attrs[o][u][i];let h=r.getAttr(i);if(M._isArray(n))if(s=[],a=Math.max(n.length,h.length),i==="points"&&n.length!==h.length&&(n.length>h.length?(c=h,h=M._prepareArrayForTween(h,n,r.closed())):(l=n,n=M._prepareArrayForTween(n,h,r.closed()))),i.indexOf("fill")===0)for(let p=0;p<a;p++)if(p%2===0)s.push(n[p]-h[p]);else{let f=M.colorToRGBA(h[p]);d=M.colorToRGBA(n[p]),h[p]=f,s.push({r:d.r-f.r,g:d.g-f.g,b:d.b-f.b,a:d.a-f.a})}else for(let p=0;p<a;p++)s.push(n[p]-h[p]);else DT.indexOf(i)!==-1?(h=M.colorToRGBA(h),d=M.colorToRGBA(n),s={r:d.r-h.r,g:d.g-h.g,b:d.b-h.b,a:d.a-h.a}):s=n-h;e.attrs[o][this._id][i]={start:h,diff:s,end:n,trueEnd:l,trueStart:c},e.tweens[o][i]=this._id}_tweenFunc(i){let n=this.node,r=e.attrs[n._id][this._id],o,s,a,l,c,d,u,h;for(o in r){if(s=r[o],a=s.start,l=s.diff,h=s.end,M._isArray(a))if(c=[],u=Math.max(a.length,h.length),o.indexOf("fill")===0)for(d=0;d<u;d++)d%2===0?c.push((a[d]||0)+l[d]*i):c.push("rgba("+Math.round(a[d].r+l[d].r*i)+","+Math.round(a[d].g+l[d].g*i)+","+Math.round(a[d].b+l[d].b*i)+","+(a[d].a+l[d].a*i)+")");else for(d=0;d<u;d++)c.push((a[d]||0)+l[d]*i);else DT.indexOf(o)!==-1?c="rgba("+Math.round(a.r+l.r*i)+","+Math.round(a.g+l.g*i)+","+Math.round(a.b+l.b*i)+","+(a.a+l.a*i)+")":c=a+l*i;n.setAttr(o,c)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let i=this.node,n=e.attrs[i._id][this._id];n.points&&n.points.trueEnd&&i.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let i=this.node,n=e.attrs[i._id][this._id];n.points&&n.points.trueStart&&i.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(i){return this.tween.seek(i*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let i=this.node._id,n=this._id,r=e.tweens[i];this.pause(),this.anim&&this.anim.stop();for(let o in r)delete e.tweens[i][o];delete e.attrs[i][n],e.tweens[i]&&(Object.keys(e.tweens[i]).length===0&&delete e.tweens[i],Object.keys(e.attrs[i]).length===0&&delete e.attrs[i])}}return e.attrs={},e.tweens={},e})();Q.prototype.to=function(e){let t=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),t&&t()},new vS(e).play()};var mc={BackEaseIn(e,t,i,n){return i*(e/=n)*e*((1.70158+1)*e-1.70158)+t},BackEaseOut(e,t,i,n){return i*((e=e/n-1)*e*((1.70158+1)*e+1.70158)+1)+t},BackEaseInOut(e,t,i,n){let r=1.70158;return(e/=n/2)<1?i/2*(e*e*(((r*=1.525)+1)*e-r))+t:i/2*((e-=2)*e*(((r*=1.525)+1)*e+r)+2)+t},ElasticEaseIn(e,t,i,n,r,o){let s=0;return e===0?t:(e/=n)===1?t+i:(o||(o=n*.3),!r||r<Math.abs(i)?(r=i,s=o/4):s=o/(2*Math.PI)*Math.asin(i/r),-(r*Math.pow(2,10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/o))+t)},ElasticEaseOut(e,t,i,n,r,o){let s=0;return e===0?t:(e/=n)===1?t+i:(o||(o=n*.3),!r||r<Math.abs(i)?(r=i,s=o/4):s=o/(2*Math.PI)*Math.asin(i/r),r*Math.pow(2,-10*e)*Math.sin((e*n-s)*(2*Math.PI)/o)+i+t)},ElasticEaseInOut(e,t,i,n,r,o){let s=0;return e===0?t:(e/=n/2)===2?t+i:(o||(o=n*(.3*1.5)),!r||r<Math.abs(i)?(r=i,s=o/4):s=o/(2*Math.PI)*Math.asin(i/r),e<1?-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/o))+t:r*Math.pow(2,-10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/o)*.5+i+t)},BounceEaseOut(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},BounceEaseIn(e,t,i,n){return i-mc.BounceEaseOut(n-e,0,i,n)+t},BounceEaseInOut(e,t,i,n){return e<n/2?mc.BounceEaseIn(e*2,0,i,n)*.5+t:mc.BounceEaseOut(e*2-n,0,i,n)*.5+i*.5+t},EaseIn(e,t,i,n){return i*(e/=n)*e+t},EaseOut(e,t,i,n){return-i*(e/=n)*(e-2)+t},EaseInOut(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},StrongEaseIn(e,t,i,n){return i*(e/=n)*e*e*e*e+t},StrongEaseOut(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},StrongEaseInOut(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},Linear(e,t,i,n){return i*e/n+t}};var CS=M._assign(ne,{Util:M,Transform:ri,Node:Q,Container:Gt,Stage:vo,stages:pc,Layer:$i,FastLayer:fc,Group:dn,DD:Ke,Shape:q,shapes:Da,Animation:gc,Tween:vS,Easings:mc,Context:Pa,Canvas:dc});var Tn=class extends q{_sceneFunc(t){let i=ne.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,i,n),t.arc(0,0,this.innerRadius(),i,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){let t=this.innerRadius(),i=this.outerRadius(),n=this.clockwise(),r=ne.getAngle(n?360-this.angle():this.angle()),o=Math.cos(Math.min(r,Math.PI)),s=1,a=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),l=Math.sin(Math.min(r,Math.PI/2)),c=o*(o>0?t:i),d=s*(s>0?i:t),u=a*(a>0?t:i),h=l*(l>0?i:t);return{x:c,y:n?-1*h:u,width:d-c,height:h-u}}};Tn.prototype._centroid=!0;Tn.prototype.className="Arc";Tn.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];Oe(Tn);R.addGetterSetter(Tn,"innerRadius",0,K());R.addGetterSetter(Tn,"outerRadius",0,K());R.addGetterSetter(Tn,"angle",0,K());R.addGetterSetter(Tn,"clockwise",!1,oi());function wS(e,t,i,n,r,o,s){let a=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2)),l=Math.sqrt(Math.pow(r-i,2)+Math.pow(o-n,2)),c=s*a/(a+l),d=s*l/(a+l),u=i-c*(r-e),h=n-c*(o-t),p=i+d*(r-e),f=n+d*(o-t);return[u,h,p,f]}function FT(e,t){let i=e.length,n=[];for(let r=2;r<i-2;r+=2){let o=wS(e[r-2],e[r-1],e[r],e[r+1],e[r+2],e[r+3],t);isNaN(o[0])||(n.push(o[0]),n.push(o[1]),n.push(e[r]),n.push(e[r+1]),n.push(o[2]),n.push(o[3]))}return n}var un=class extends q{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){let i=this.points(),n=i.length,r=this.tension(),o=this.closed(),s=this.bezier();if(!n)return;let a=0;if(t.beginPath(),t.moveTo(i[0],i[1]),r!==0&&n>4){let l=this.getTensionPoints(),c=l.length;for(a=o?0:4,o||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);a<c-2;)t.bezierCurveTo(l[a++],l[a++],l[a++],l[a++],l[a++],l[a++]);o||t.quadraticCurveTo(l[c-2],l[c-1],i[n-2],i[n-1])}else if(s)for(a=2;a<n;)t.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);else for(a=2;a<n;a+=2)t.lineTo(i[a],i[a+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():FT(this.points(),this.tension())}_getTensionPointsClosed(){let t=this.points(),i=t.length,n=this.tension(),r=wS(t[i-2],t[i-1],t[0],t[1],t[2],t[3],n),o=wS(t[i-4],t[i-3],t[i-2],t[i-1],t[0],t[1],n),s=FT(t,n);return[r[2],r[3]].concat(s).concat([o[0],o[1],t[i-2],t[i-1],o[2],o[3],r[0],r[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let i=t[0],n=t[0],r=t[1],o=t[1],s,a;for(let l=0;l<t.length/2;l++)s=t[l*2],a=t[l*2+1],i=Math.min(i,s),n=Math.max(n,s),r=Math.min(r,a),o=Math.max(o,a);return{x:i,y:r,width:n-i,height:o-r}}};un.prototype.className="Line";un.prototype._attrsAffectingSize=["points","bezier","tension"];Oe(un);R.addGetterSetter(un,"closed",!1);R.addGetterSetter(un,"bezier",!1);R.addGetterSetter(un,"tension",0,K());R.addGetterSetter(un,"points",[],tT());var Rae=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],Pae=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],kae=[[1],[1,1],[1,2,1],[1,3,3,1]],yS=(e,t,i)=>{let n,r,s=i/2;n=0;for(let a=0;a<20;a++)r=s*Rae[20][a]+s,n+=Pae[20][a]*_ae(e,t,r);return s*n},SS=(e,t,i)=>{i===void 0&&(i=1);let n=e[0]-2*e[1]+e[2],r=t[0]-2*t[1]+t[2],o=2*e[1]-2*e[0],s=2*t[1]-2*t[0],a=4*(n*n+r*r),l=4*(n*o+r*s),c=o*o+s*s;if(a===0)return i*Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(t[2]-t[0],2));let d=l/(2*a),u=c/a,h=i+d,p=u-d*d,f=h*h+p>0?Math.sqrt(h*h+p):0,g=d*d+p>0?Math.sqrt(d*d+p):0,m=d+Math.sqrt(d*d+p)!==0?p*Math.log(Math.abs((h+f)/(d+g))):0;return Math.sqrt(a)/2*(h*f-d*g+m)};function _ae(e,t,i){let n=bS(1,i,e),r=bS(1,i,t),o=n*n+r*r;return Math.sqrt(o)}var bS=(e,t,i)=>{let n=i.length-1,r,o;if(n===0)return 0;if(e===0){o=0;for(let s=0;s<=n;s++)o+=kae[n][s]*Math.pow(1-t,n-s)*Math.pow(t,s)*i[s];return o}else{r=new Array(n);for(let s=0;s<n;s++)r[s]=n*(i[s+1]-i[s]);return bS(e-1,t,r)}},xS=(e,t,i)=>{let n=1,r=e/t,o=(e-i(r))/t,s=0;for(;n>.001;){let a=i(r+o),l=Math.abs(e-a)/t;if(l<n)n=l,r+=o;else{let c=i(r-o),d=Math.abs(e-c)/t;d<n?(n=d,r-=o):o/=2}if(s++,s>500)break}return r};var si=class e extends q{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=e.parsePathData(this.data()),this.pathLength=e.getPathLength(this.dataArray)}_sceneFunc(t){let i=this.dataArray;t.beginPath();let n=!1;for(let r=0;r<i.length;r++){let o=i[r].command,s=i[r].points;switch(o){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":let a=s[0],l=s[1],c=s[2],d=s[3],u=s[4],h=s[5],p=s[6],f=s[7],g=c>d?c:d,m=c>d?1:c/d,v=c>d?d/c:1;t.translate(a,l),t.rotate(p),t.scale(m,v),t.arc(0,0,g,u,u+h,1-f),t.scale(1/m,1/v),t.rotate(-p),t.translate(-a,-l);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(l){if(l.command==="A"){let c=l.points[4],d=l.points[5],u=l.points[4]+d,h=Math.PI/180;if(Math.abs(c-u)<h&&(h=Math.abs(c-u)),d<0)for(let p=c-h;p>u;p-=h){let f=e.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);t.push(f.x,f.y)}else for(let p=c+h;p<u;p+=h){let f=e.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);t.push(f.x,f.y)}}else if(l.command==="C")for(let c=0;c<=1;c+=.01){let d=e.getPointOnCubicBezier(c,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);t.push(d.x,d.y)}else t=t.concat(l.points)});let i=t[0],n=t[0],r=t[1],o=t[1],s,a;for(let l=0;l<t.length/2;l++)s=t[l*2],a=t[l*2+1],isNaN(s)||(i=Math.min(i,s),n=Math.max(n,s)),isNaN(a)||(r=Math.min(r,a),o=Math.max(o,a));return{x:i,y:r,width:n-i,height:o-r}}getLength(){return this.pathLength}getPointAtLength(t){return e.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,i,n,r){return Math.sqrt((n-t)*(n-t)+(r-i)*(r-i))}static getPathLength(t){let i=0;for(let n=0;n<t.length;++n)i+=t[n].pathLength;return i}static getPointAtLengthOfDataArray(t,i){let n,r=0,o=i.length;if(!o)return null;for(;r<o&&t>i[r].pathLength;)t-=i[r].pathLength,++r;if(r===o)return n=i[r-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return i[r].command==="M"?(n=i[r].points.slice(0,2),{x:n[0],y:n[1]}):{x:i[r].start.x,y:i[r].start.y};let s=i[r],a=s.points;switch(s.command){case"L":return e.getPointOnLine(t,s.start.x,s.start.y,a[0],a[1]);case"C":return e.getPointOnCubicBezier(xS(t,e.getPathLength(i),g=>yS([s.start.x,a[0],a[2],a[4]],[s.start.y,a[1],a[3],a[5]],g)),s.start.x,s.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return e.getPointOnQuadraticBezier(xS(t,e.getPathLength(i),g=>SS([s.start.x,a[0],a[2]],[s.start.y,a[1],a[3]],g)),s.start.x,s.start.y,a[0],a[1],a[2],a[3]);case"A":let l=a[0],c=a[1],d=a[2],u=a[3],h=a[5],p=a[6],f=a[4];return f+=h*t/s.pathLength,e.getPointOnEllipticalArc(l,c,d,u,f,p)}return null}static getPointOnLine(t,i,n,r,o,s,a){s=s??i,a=a??n;let l=this.getLineLength(i,n,r,o);if(l<1e-10)return{x:i,y:n};if(r===i)return{x:s,y:a+(o>n?t:-t)};let c=(o-n)/(r-i),d=Math.sqrt(t*t/(1+c*c))*(r<i?-1:1),u=c*d;if(Math.abs(a-n-c*(s-i))<1e-10)return{x:s+d,y:a+u};let h=((s-i)*(r-i)+(a-n)*(o-n))/(l*l),p=i+h*(r-i),f=n+h*(o-n),g=this.getLineLength(s,a,p,f),m=Math.sqrt(t*t-g*g),v=Math.sqrt(m*m/(1+c*c))*(r<i?-1:1),C=c*v;return{x:p+v,y:f+C}}static getPointOnCubicBezier(t,i,n,r,o,s,a,l,c){function d(m){return m*m*m}function u(m){return 3*m*m*(1-m)}function h(m){return 3*m*(1-m)*(1-m)}function p(m){return(1-m)*(1-m)*(1-m)}let f=l*d(t)+s*u(t)+r*h(t)+i*p(t),g=c*d(t)+a*u(t)+o*h(t)+n*p(t);return{x:f,y:g}}static getPointOnQuadraticBezier(t,i,n,r,o,s,a){function l(p){return p*p}function c(p){return 2*p*(1-p)}function d(p){return(1-p)*(1-p)}let u=s*l(t)+r*c(t)+i*d(t),h=a*l(t)+o*c(t)+n*d(t);return{x:u,y:h}}static getPointOnEllipticalArc(t,i,n,r,o,s){let a=Math.cos(s),l=Math.sin(s),c={x:n*Math.cos(o),y:r*Math.sin(o)};return{x:t+(c.x*a-c.y*l),y:i+(c.x*l+c.y*a)}}static parsePathData(t){if(!t)return[];let i=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];i=i.replace(new RegExp(" ","g"),",");for(let u=0;u<n.length;u++)i=i.replace(new RegExp(n[u],"g"),"|"+n[u]);let r=i.split("|"),o=[],s=[],a=0,l=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,d;for(let u=1;u<r.length;u++){let h=r[u],p=h.charAt(0);for(h=h.slice(1),s.length=0;d=c.exec(h);)s.push(d[0]);let f=[],g=p==="A"||p==="a"?0:-1;for(let m=0,v=s.length;m<v;m++){let C=s[m];if(C==="00"){f.push(0,0),g>=0&&(g+=2,g>=7&&(g-=7));continue}if(g>=0){if(g===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(C)){f.push(parseInt(C[0],10)),f.push(parseInt(C[1],10)),f.push(parseFloat(C.slice(2))),g+=3,g>=7&&(g-=7);continue}if(C==="11"||C==="10"||C==="01"){f.push(parseInt(C[0],10)),f.push(parseInt(C[1],10)),g+=2,g>=7&&(g-=7);continue}if(C==="0"||C==="1"){f.push(parseInt(C,10)),g+=1,g>=7&&(g-=7);continue}}else if(g===4){if(/^[01]\d+(?:\.\d+)?$/.test(C)){f.push(parseInt(C[0],10)),f.push(parseFloat(C.slice(1))),g+=2,g>=7&&(g-=7);continue}if(C==="0"||C==="1"){f.push(parseInt(C,10)),g+=1,g>=7&&(g-=7);continue}}let b=parseFloat(C);isNaN(b)?f.push(0):f.push(b),g+=1,g>=7&&(g-=7)}else{let b=parseFloat(C);isNaN(b)?f.push(0):f.push(b)}}for(;f.length>0&&!isNaN(f[0]);){let m="",v=[],C=a,b=l,S,E,x,P,F,N,Y,X,Z,me;switch(p){case"l":a+=f.shift(),l+=f.shift(),m="L",v.push(a,l);break;case"L":a=f.shift(),l=f.shift(),v.push(a,l);break;case"m":let oe=f.shift(),re=f.shift();if(a+=oe,l+=re,m="M",o.length>2&&o[o.length-1].command==="z"){for(let _=o.length-2;_>=0;_--)if(o[_].command==="M"){a=o[_].points[0]+oe,l=o[_].points[1]+re;break}}v.push(a,l),p="l";break;case"M":a=f.shift(),l=f.shift(),m="M",v.push(a,l),p="L";break;case"h":a+=f.shift(),m="L",v.push(a,l);break;case"H":a=f.shift(),m="L",v.push(a,l);break;case"v":l+=f.shift(),m="L",v.push(a,l);break;case"V":l=f.shift(),m="L",v.push(a,l);break;case"C":v.push(f.shift(),f.shift(),f.shift(),f.shift()),a=f.shift(),l=f.shift(),v.push(a,l);break;case"c":v.push(a+f.shift(),l+f.shift(),a+f.shift(),l+f.shift()),a+=f.shift(),l+=f.shift(),m="C",v.push(a,l);break;case"S":E=a,x=l,S=o[o.length-1],S.command==="C"&&(E=a+(a-S.points[2]),x=l+(l-S.points[3])),v.push(E,x,f.shift(),f.shift()),a=f.shift(),l=f.shift(),m="C",v.push(a,l);break;case"s":E=a,x=l,S=o[o.length-1],S.command==="C"&&(E=a+(a-S.points[2]),x=l+(l-S.points[3])),v.push(E,x,a+f.shift(),l+f.shift()),a+=f.shift(),l+=f.shift(),m="C",v.push(a,l);break;case"Q":v.push(f.shift(),f.shift()),a=f.shift(),l=f.shift(),v.push(a,l);break;case"q":v.push(a+f.shift(),l+f.shift()),a+=f.shift(),l+=f.shift(),m="Q",v.push(a,l);break;case"T":E=a,x=l,S=o[o.length-1],S.command==="Q"&&(E=a+(a-S.points[0]),x=l+(l-S.points[1])),a=f.shift(),l=f.shift(),m="Q",v.push(E,x,a,l);break;case"t":E=a,x=l,S=o[o.length-1],S.command==="Q"&&(E=a+(a-S.points[0]),x=l+(l-S.points[1])),a+=f.shift(),l+=f.shift(),m="Q",v.push(E,x,a,l);break;case"A":P=f.shift(),F=f.shift(),N=f.shift(),Y=f.shift(),X=f.shift(),Z=a,me=l,a=f.shift(),l=f.shift(),m="A",v=this.convertEndpointToCenterParameterization(Z,me,a,l,Y,X,P,F,N);break;case"a":P=f.shift(),F=f.shift(),N=f.shift(),Y=f.shift(),X=f.shift(),Z=a,me=l,a+=f.shift(),l+=f.shift(),m="A",v=this.convertEndpointToCenterParameterization(Z,me,a,l,Y,X,P,F,N);break}o.push({command:m||p,points:v,start:{x:C,y:b},pathLength:this.calcLength(C,b,m||p,v)})}(p==="z"||p==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,i,n,r){let o,s,a,l,c=e;switch(n){case"L":return c.getLineLength(t,i,r[0],r[1]);case"C":return yS([t,r[0],r[2],r[4]],[i,r[1],r[3],r[5]],1);case"Q":return SS([t,r[0],r[2]],[i,r[1],r[3]],1);case"A":o=0;let d=r[4],u=r[5],h=r[4]+u,p=Math.PI/180;if(Math.abs(d-h)<p&&(p=Math.abs(d-h)),s=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],d,0),u<0)for(l=d-p;l>h;l-=p)a=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),o+=c.getLineLength(s.x,s.y,a.x,a.y),s=a;else for(l=d+p;l<h;l+=p)a=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),o+=c.getLineLength(s.x,s.y,a.x,a.y),s=a;return a=c.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],h,0),o+=c.getLineLength(s.x,s.y,a.x,a.y),o}return 0}static convertEndpointToCenterParameterization(t,i,n,r,o,s,a,l,c){let d=c*(Math.PI/180),u=Math.cos(d)*(t-n)/2+Math.sin(d)*(i-r)/2,h=-1*Math.sin(d)*(t-n)/2+Math.cos(d)*(i-r)/2,p=u*u/(a*a)+h*h/(l*l);p>1&&(a*=Math.sqrt(p),l*=Math.sqrt(p));let f=Math.sqrt((a*a*(l*l)-a*a*(h*h)-l*l*(u*u))/(a*a*(h*h)+l*l*(u*u)));o===s&&(f*=-1),isNaN(f)&&(f=0);let g=f*a*h/l,m=f*-l*u/a,v=(t+n)/2+Math.cos(d)*g-Math.sin(d)*m,C=(i+r)/2+Math.sin(d)*g+Math.cos(d)*m,b=function(Y){return Math.sqrt(Y[0]*Y[0]+Y[1]*Y[1])},S=function(Y,X){return(Y[0]*X[0]+Y[1]*X[1])/(b(Y)*b(X))},E=function(Y,X){return(Y[0]*X[1]<Y[1]*X[0]?-1:1)*Math.acos(S(Y,X))},x=E([1,0],[(u-g)/a,(h-m)/l]),P=[(u-g)/a,(h-m)/l],F=[(-1*u-g)/a,(-1*h-m)/l],N=E(P,F);return S(P,F)<=-1&&(N=Math.PI),S(P,F)>=1&&(N=0),s===0&&N>0&&(N=N-2*Math.PI),s===1&&N<0&&(N=N+2*Math.PI),[v,C,a,l,x,N,d,s]}};si.prototype.className="Path";si.prototype._attrsAffectingSize=["data"];Oe(si);R.addGetterSetter(si,"data");var Lr=class extends un{_sceneFunc(t){super._sceneFunc(t);let i=Math.PI*2,n=this.points(),r=n,o=this.tension()!==0&&n.length>4;o&&(r=this.getTensionPoints());let s=this.pointerLength(),a=n.length,l,c;if(o){let h=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],n[a-2],n[a-1]],p=si.calcLength(r[r.length-4],r[r.length-3],"C",h),f=si.getPointOnQuadraticBezier(Math.min(1,1-s/p),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[a-2]-f.x,c=n[a-1]-f.y}else l=n[a-2]-n[a-4],c=n[a-1]-n[a-3];let d=(Math.atan2(c,l)+i)%i,u=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[a-2],n[a-1]),t.rotate(d),t.moveTo(0,0),t.lineTo(-s,u/2),t.lineTo(-s,-u/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),o?(l=(r[0]+r[2])/2-n[0],c=(r[1]+r[3])/2-n[1]):(l=n[2]-n[0],c=n[3]-n[1]),t.rotate((Math.atan2(-c,-l)+i)%i),t.moveTo(0,0),t.lineTo(-s,u/2),t.lineTo(-s,-u/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){let i=this.dashEnabled();i&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),i&&(this.attrs.dashEnabled=!0)}getSelfRect(){let t=super.getSelfRect(),i=this.pointerWidth()/2;return{x:t.x,y:t.y-i,width:t.width,height:t.height+i*2}}};Lr.prototype.className="Arrow";Oe(Lr);R.addGetterSetter(Lr,"pointerLength",10,K());R.addGetterSetter(Lr,"pointerWidth",10,K());R.addGetterSetter(Lr,"pointerAtBeginning",!1);R.addGetterSetter(Lr,"pointerAtEnding",!0);var Co=class extends q{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Co.prototype._centroid=!0;Co.prototype.className="Circle";Co.prototype._attrsAffectingSize=["radius"];Oe(Co);R.addGetterSetter(Co,"radius",0,K());var Kn=class extends q{_sceneFunc(t){let i=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),i!==n&&t.scale(1,n/i),t.arc(0,0,i,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}};Kn.prototype.className="Ellipse";Kn.prototype._centroid=!0;Kn.prototype._attrsAffectingSize=["radiusX","radiusY"];Oe(Kn);R.addComponentsGetterSetter(Kn,"radius",["x","y"]);R.addGetterSetter(Kn,"radiusX",0,K());R.addGetterSetter(Kn,"radiusY",0,K());var Ki=class e extends q{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",i=>{this._removeImageLoad(i.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){let t=!!this.cornerRadius(),i=this.hasShadow();return t&&i?!0:super._useBufferCanvas(!0)}_sceneFunc(t){let i=this.getWidth(),n=this.getHeight(),r=this.cornerRadius(),o=this.attrs.image,s;if(o){let a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?s=[o,this.cropX(),this.cropY(),a,l,0,0,i,n]:s=[o,0,0,i,n]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?M.drawRoundedRectPath(t,i,n,r):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)),o&&(r&&t.clip(),t.drawImage.apply(t,s))}_hitFunc(t){let i=this.width(),n=this.height(),r=this.cornerRadius();t.beginPath(),r?M.drawRoundedRectPath(t,i,n,r):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,i,n;return(n=(t=this.attrs.width)!==null&&t!==void 0?t:(i=this.image())===null||i===void 0?void 0:i.width)!==null&&n!==void 0?n:0}getHeight(){var t,i,n;return(n=(t=this.attrs.height)!==null&&t!==void 0?t:(i=this.image())===null||i===void 0?void 0:i.height)!==null&&n!==void 0?n:0}static fromURL(t,i,n=null){let r=M.createImageElement();r.onload=function(){let o=new e({image:r});i(o)},r.onerror=n,r.crossOrigin="Anonymous",r.src=t}};Ki.prototype.className="Image";Ki.prototype._attrsAffectingSize=["image"];Oe(Ki);R.addGetterSetter(Ki,"cornerRadius",0,bs(4));R.addGetterSetter(Ki,"image");R.addComponentsGetterSetter(Ki,"crop",["x","y","width","height"]);R.addGetterSetter(Ki,"cropX",0,K());R.addGetterSetter(Ki,"cropY",0,K());R.addGetterSetter(Ki,"cropWidth",0,K());R.addGetterSetter(Ki,"cropHeight",0,K());var MT=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],Dae="Change.konva",Fae="none",ES="up",RS="right",PS="down",kS="left",Mae=MT.length,vc=class extends dn{constructor(t){super(t),this.on("add.konva",function(i){this._addListeners(i.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let i=this,n,r=function(){i._sync()};for(n=0;n<Mae;n++)t.on(MT[n]+Dae,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),i=this.getTag(),n,r,o,s,a,l,c;if(t&&i){switch(n=t.width(),r=t.height(),o=i.pointerDirection(),s=i.pointerWidth(),c=i.pointerHeight(),a=0,l=0,o){case ES:a=n/2,l=-1*c;break;case RS:a=n+s,l=r/2;break;case PS:a=n/2,l=r+c;break;case kS:a=-1*s,l=r/2;break}i.setAttrs({x:-1*a,y:-1*l,width:n,height:r}),t.setAttrs({x:-1*a,y:-1*l})}}};vc.prototype.className="Label";Oe(vc);var Nr=class extends q{_sceneFunc(t){let i=this.width(),n=this.height(),r=this.pointerDirection(),o=this.pointerWidth(),s=this.pointerHeight(),a=this.cornerRadius(),l=0,c=0,d=0,u=0;typeof a=="number"?l=c=d=u=Math.min(a,i/2,n/2):(l=Math.min(a[0]||0,i/2,n/2),c=Math.min(a[1]||0,i/2,n/2),u=Math.min(a[2]||0,i/2,n/2),d=Math.min(a[3]||0,i/2,n/2)),t.beginPath(),t.moveTo(l,0),r===ES&&(t.lineTo((i-o)/2,0),t.lineTo(i/2,-1*s),t.lineTo((i+o)/2,0)),t.lineTo(i-c,0),t.arc(i-c,c,c,Math.PI*3/2,0,!1),r===RS&&(t.lineTo(i,(n-s)/2),t.lineTo(i+o,n/2),t.lineTo(i,(n+s)/2)),t.lineTo(i,n-u),t.arc(i-u,n-u,u,0,Math.PI/2,!1),r===PS&&(t.lineTo((i+o)/2,n),t.lineTo(i/2,n+s),t.lineTo((i-o)/2,n)),t.lineTo(d,n),t.arc(d,n-d,d,Math.PI/2,Math.PI,!1),r===kS&&(t.lineTo(0,(n+s)/2),t.lineTo(-1*o,n/2),t.lineTo(0,(n-s)/2)),t.lineTo(0,l),t.arc(l,l,l,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,i=0,n=this.pointerWidth(),r=this.pointerHeight(),o=this.pointerDirection(),s=this.width(),a=this.height();return o===ES?(i-=r,a+=r):o===PS?a+=r:o===kS?(t-=n*1.5,s+=n):o===RS&&(s+=n*1.5),{x:t,y:i,width:s,height:a}}};Nr.prototype.className="Tag";Oe(Nr);R.addGetterSetter(Nr,"pointerDirection",Fae);R.addGetterSetter(Nr,"pointerWidth",0,K());R.addGetterSetter(Nr,"pointerHeight",0,K());R.addGetterSetter(Nr,"cornerRadius",0,bs(4));var wo=class extends q{_sceneFunc(t){let i=this.cornerRadius(),n=this.width(),r=this.height();t.beginPath(),i?M.drawRoundedRectPath(t,n,r,i):t.rect(0,0,n,r),t.closePath(),t.fillStrokeShape(this)}};wo.prototype.className="Rect";Oe(wo);R.addGetterSetter(wo,"cornerRadius",0,bs(4));var Yn=class extends q{_sceneFunc(t){let i=this._getPoints(),n=this.radius(),r=this.sides(),o=this.cornerRadius();if(t.beginPath(),o)M.drawRoundedPolygonPath(t,i,r,n,o);else{t.moveTo(i[0].x,i[0].y);for(let s=1;s<i.length;s++)t.lineTo(i[s].x,i[s].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){let t=this.attrs.sides,i=this.attrs.radius||0,n=[];for(let r=0;r<t;r++)n.push({x:i*Math.sin(r*2*Math.PI/t),y:-1*i*Math.cos(r*2*Math.PI/t)});return n}getSelfRect(){let t=this._getPoints(),i=t[0].x,n=t[0].x,r=t[0].y,o=t[0].y;return t.forEach(s=>{i=Math.min(i,s.x),n=Math.max(n,s.x),r=Math.min(r,s.y),o=Math.max(o,s.y)}),{x:i,y:r,width:n-i,height:o-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};Yn.prototype.className="RegularPolygon";Yn.prototype._centroid=!0;Yn.prototype._attrsAffectingSize=["radius"];Oe(Yn);R.addGetterSetter(Yn,"radius",0,K());R.addGetterSetter(Yn,"sides",0,K());R.addGetterSetter(Yn,"cornerRadius",0,bs(4));var TT=Math.PI*2,Br=class extends q{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,TT,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),TT,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};Br.prototype.className="Ring";Br.prototype._centroid=!0;Br.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Oe(Br);R.addGetterSetter(Br,"innerRadius",0,K());R.addGetterSetter(Br,"outerRadius",0,K());var Oi=class extends q{constructor(t){super(t),this._updated=!0,this.anim=new gc(()=>{let i=this._updated;return this._updated=!1,i}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){let i=this.animation(),n=this.frameIndex(),r=n*4,o=this.animations()[i],s=this.frameOffsets(),a=o[r+0],l=o[r+1],c=o[r+2],d=o[r+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,d),t.closePath(),t.fillStrokeShape(this)),u)if(s){let h=s[i],p=n*2;t.drawImage(u,a,l,c,d,h[p+0],h[p+1],c,d)}else t.drawImage(u,a,l,c,d,0,0,c,d)}_hitFunc(t){let i=this.animation(),n=this.frameIndex(),r=n*4,o=this.animations()[i],s=this.frameOffsets(),a=o[r+2],l=o[r+3];if(t.beginPath(),s){let c=s[i],d=n*2;t.rect(c[d+0],c[d+1],a,l)}else t.rect(0,0,a,l);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let t=this.frameIndex(),i=this.animation(),n=this.animations(),r=n[i],o=r.length/4;t<o-1?this.frameIndex(t+1):this.frameIndex(0)}};Oi.prototype.className="Sprite";Oe(Oi);R.addGetterSetter(Oi,"animation");R.addGetterSetter(Oi,"animations");R.addGetterSetter(Oi,"frameOffsets");R.addGetterSetter(Oi,"image");R.addGetterSetter(Oi,"frameIndex",0,K());R.addGetterSetter(Oi,"frameRate",17,K());R.backCompat(Oi,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Xn=class extends q{_sceneFunc(t){let i=this.innerRadius(),n=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let o=1;o<r*2;o++){let s=o%2===0?n:i,a=s*Math.sin(o*Math.PI/r),l=-1*s*Math.cos(o*Math.PI/r);t.lineTo(a,l)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};Xn.prototype.className="Star";Xn.prototype._centroid=!0;Xn.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Oe(Xn);R.addGetterSetter(Xn,"numPoints",5,K());R.addGetterSetter(Xn,"innerRadius",0,K());R.addGetterSetter(Xn,"outerRadius",0,K());function bo(e){return[...e].reduce((t,i,n,r)=>{if(new RegExp("\\p{Emoji}","u").test(i)){let o=r[n+1];o&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(o)?(t.push(i+o),r[n+1]=""):t.push(i)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(i+(r[n+1]||""))?t.push(i+r[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(i)?t[t.length-1]+=i:i&&t.push(i);return t},[])}var Cc="auto",Tae="center",NT="inherit",gh="justify",Iae="Change.konva",Aae="2d",IT="-",BT="left",Oae="text",Lae="Text",Nae="top",Bae="bottom",AT="middle",HT="normal",Hae="px ",Xm=" ",zae="right",OT="rtl",Vae="word",Gae="char",LT="none",_S="\u2026",zT=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Wae=zT.length;function Uae(e){return e.split(",").map(t=>{t=t.trim();let i=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return i&&!n&&(t=`"${t}"`),t}).join(", ")}var Jm;function DS(){return Jm||(Jm=M.createCanvasElement().getContext(Aae),Jm)}function jae(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function qae(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function $ae(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}var ct=class extends q{constructor(t){super($ae(t)),this._partialTextX=0,this._partialTextY=0;for(let i=0;i<Wae;i++)this.on(zT[i]+Iae,this._setTextData);this._setTextData()}_sceneFunc(t){var i,n;let r=this.textArr,o=r.length;if(!this.text())return;let s=this.padding(),a=this.fontSize(),l=this.lineHeight()*a,c=this.verticalAlign(),d=this.direction(),u=0,h=this.align(),p=this.getWidth(),f=this.letterSpacing(),g=this.charRenderFunc(),m=this.fill(),v=this.textDecoration(),C=v.indexOf("underline")!==-1,b=v.indexOf("line-through")!==-1,S;d=d===NT?t.direction:d;let E=l/2,x=AT;if(!ne.legacyTextRendering){let P=this.measureSize("M");x="alphabetic";let F=(i=P.fontBoundingBoxAscent)!==null&&i!==void 0?i:P.actualBoundingBoxAscent,N=(n=P.fontBoundingBoxDescent)!==null&&n!==void 0?n:P.actualBoundingBoxDescent;E=(F-N)/2+l/2}for(d===OT&&t.setAttr("direction",d),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",x),t.setAttr("textAlign",BT),c===AT?u=(this.getHeight()-o*l-s*2)/2:c===Bae&&(u=this.getHeight()-o*l-s*2),t.translate(s,u+s),S=0;S<o;S++){let P=0,F=0,N=r[S],Y=N.text,X=N.width,Z=N.lastInParagraph;if(t.save(),h===zae?P+=p-X-s*2:h===Tae&&(P+=(p-X-s*2)/2),C){t.save(),t.beginPath();let oe=ne.legacyTextRendering?Math.round(a/2):Math.round(a/4),re=P,_=E+F+oe;t.moveTo(re,_);let k=h===gh&&!Z?p-s*2:X;t.lineTo(re+Math.round(k),_),t.lineWidth=a/15;let D=this._getLinearGradient();t.strokeStyle=D||m,t.stroke(),t.restore()}let me=P;if(d!==OT&&(f!==0||h===gh||g)){let oe=Y.split(" ").length-1,re=bo(Y);for(let _=0;_<re.length;_++){let k=re[_];if(k===" "&&!Z&&h===gh&&(P+=(p-s*2-X)/oe),this._partialTextX=P,this._partialTextY=E+F,this._partialText=k,g){t.save();let V=r.slice(0,S).reduce((G,z)=>G+bo(z.text).length,0),U=_+V;g({char:k,index:U,x:P,y:E+F,lineIndex:S,column:_,isLastInLine:Z,width:this.measureSize(k).width,context:t})}t.fillStrokeShape(this),g&&t.restore(),P+=this.measureSize(k).width+f}}else f!==0&&t.setAttr("letterSpacing",`${f}px`),this._partialTextX=P,this._partialTextY=E+F,this._partialText=Y,t.fillStrokeShape(this);if(b){t.save(),t.beginPath();let oe=ne.legacyTextRendering?0:-Math.round(a/4),re=me;t.moveTo(re,E+F+oe);let _=h===gh&&!Z?p-s*2:X;t.lineTo(re+Math.round(_),E+F+oe),t.lineWidth=a/15;let k=this._getLinearGradient();t.strokeStyle=k||m,t.stroke(),t.restore()}t.restore(),o>1&&(E+=l)}}_hitFunc(t){let i=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}setText(t){let i=M._isString(t)?t:t==null?"":t+"";return this._setAttr(Oae,i),this}getWidth(){return this.attrs.width===Cc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Cc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return M.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var i,n,r,o,s,a,l,c,d,u,h;let p=DS(),f=this.fontSize(),g;p.save(),p.font=this._getContextFont(),g=p.measureText(t),p.restore();let m=f/100;return{actualBoundingBoxAscent:(i=g.actualBoundingBoxAscent)!==null&&i!==void 0?i:71.58203125*m,actualBoundingBoxDescent:(n=g.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(r=g.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*m,actualBoundingBoxRight:(o=g.actualBoundingBoxRight)!==null&&o!==void 0?o:75.732421875*m,alphabeticBaseline:(s=g.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(a=g.emHeightAscent)!==null&&a!==void 0?a:100*m,emHeightDescent:(l=g.emHeightDescent)!==null&&l!==void 0?l:-20*m,fontBoundingBoxAscent:(c=g.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*m,fontBoundingBoxDescent:(d=g.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*m,hangingBaseline:(u=g.hangingBaseline)!==null&&u!==void 0?u:72.80000305175781*m,ideographicBaseline:(h=g.ideographicBaseline)!==null&&h!==void 0?h:-21*m,width:g.width,height:f}}_getContextFont(){return this.fontStyle()+Xm+this.fontVariant()+Xm+(this.fontSize()+Hae)+Uae(this.fontFamily())}_addTextLine(t){this.align()===gh&&(t=t.trim());let n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){let i=this.letterSpacing(),n=t.length;return DS().measureText(t).width+i*n}_setTextData(){let t=this.text().split(`
`),i=+this.fontSize(),n=0,r=this.lineHeight()*i,o=this.attrs.width,s=this.attrs.height,a=o!==Cc&&o!==void 0,l=s!==Cc&&s!==void 0,c=this.padding(),d=o-c*2,u=s-c*2,h=0,p=this.wrap(),f=p!==LT,g=p!==Gae&&f,m=this.ellipsis();this.textArr=[],DS().font=this._getContextFont();let v=m?this._getTextWidth(_S):0;for(let C=0,b=t.length;C<b;++C){let S=t[C],E=this._getTextWidth(S);if(a&&E>d)for(;S.length>0;){let x=0,P=bo(S).length,F="",N=0;for(;x<P;){let Y=x+P>>>1,X=bo(S),Z=X.slice(0,Y+1).join(""),me=this._getTextWidth(Z);(m&&l&&h+r>u?me+v:me)<=d?(x=Y+1,F=Z,N=me):P=Y}if(F){if(g){let Z=bo(S),me=bo(F),oe=Z[me.length],re=oe===Xm||oe===IT,_;if(re&&N<=d)_=me.length;else{let k=me.lastIndexOf(Xm),D=me.lastIndexOf(IT);_=Math.max(k,D)+1}_>0&&(x=_,F=Z.slice(0,x).join(""),N=this._getTextWidth(F))}if(F=F.trimRight(),this._addTextLine(F),n=Math.max(n,N),h+=r,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(S=bo(S).slice(x).join("").trimLeft(),S.length>0&&(E=this._getTextWidth(S),E<=d)){this._addTextLine(S),h+=r,n=Math.max(n,E);break}}else break}else this._addTextLine(S),h+=r,n=Math.max(n,E),this._shouldHandleEllipsis(h)&&C<b-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+r>u)break}this.textHeight=i,this.textWidth=n}_shouldHandleEllipsis(t){let i=+this.fontSize(),n=this.lineHeight()*i,r=this.attrs.height,o=r!==Cc&&r!==void 0,s=this.padding(),a=r-s*2;return!(this.wrap()!==LT)||o&&t+n>a}_tryToAddEllipsisToLastLine(){let t=this.attrs.width,i=t!==Cc&&t!==void 0,n=this.padding(),r=t-n*2,o=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!o||(i&&(this._getTextWidth(s.text+_S)<r||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+_S))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,i=this.hasShadow();return t&&i?!0:super._useBufferCanvas()}};ct.prototype._fillFunc=jae;ct.prototype._strokeFunc=qae;ct.prototype.className=Lae;ct.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Oe(ct);R.overWriteSetter(ct,"width",sh());R.overWriteSetter(ct,"height",sh());R.addGetterSetter(ct,"direction",NT);R.addGetterSetter(ct,"fontFamily","Arial");R.addGetterSetter(ct,"fontSize",12,K());R.addGetterSetter(ct,"fontStyle",HT);R.addGetterSetter(ct,"fontVariant",HT);R.addGetterSetter(ct,"padding",0,K());R.addGetterSetter(ct,"align",BT);R.addGetterSetter(ct,"verticalAlign",Nae);R.addGetterSetter(ct,"lineHeight",1,K());R.addGetterSetter(ct,"wrap",Vae);R.addGetterSetter(ct,"ellipsis",!1,oi());R.addGetterSetter(ct,"letterSpacing",0,K());R.addGetterSetter(ct,"text","",Or());R.addGetterSetter(ct,"textDecoration","");R.addGetterSetter(ct,"charRenderFunc",void 0);var Kae="",VT="normal";function GT(e){e.fillText(this.partialText,0,0)}function WT(e){e.strokeText(this.partialText,0,0)}var Dt=class extends q{constructor(t){super(t),this.dummyCanvas=M.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return si.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;let i=this.pathLength;return t>i?null:si.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=si.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();let i=this.textDecoration(),n=this.fill(),r=this.fontSize(),o=this.glyphInfo,s=i.indexOf("underline")!==-1,a=i.indexOf("line-through")!==-1;s&&t.beginPath();for(let l=0;l<o.length;l++){t.save();let c=o[l].p0;t.translate(c.x,c.y),t.rotate(o[l].rotation),this.partialText=o[l].text,t.fillStrokeShape(this),s&&(l===0&&t.moveTo(0,r/2+1),t.lineTo(o[l].width,r/2+1)),t.restore()}if(s&&(t.strokeStyle=n,t.lineWidth=r/20,t.stroke()),a){t.beginPath();for(let l=0;l<o.length;l++){t.save();let c=o[l].p0;t.translate(c.x,c.y),t.rotate(o[l].rotation),l===0&&t.moveTo(0,0),t.lineTo(o[l].width,0),t.restore()}t.strokeStyle=n,t.lineWidth=r/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();let i=this.glyphInfo;if(i.length>=1){let n=i[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<i.length;n++){let r=i[n].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return M.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return ct.prototype.setText.call(this,t)}_getContextFont(){return ct.prototype._getContextFont.call(this)}_getTextSize(t){let n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();let r=n.measureText(t);return n.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let t=bo(this.text()),i=[],n=0;for(let u=0;u<t.length;u++)i.push({char:t[u],width:this._getTextSize(t[u]).width}),n+=i[u].width;let{height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=n,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;let o=this.letterSpacing(),s=this.align(),a=this.kerningFunc(),l=Math.max(this.textWidth+((this.attrs.text||"").length-1)*o,0),c=0;s==="center"&&(c=Math.max(0,this.pathLength/2-l/2)),s==="right"&&(c=Math.max(0,this.pathLength-l));let d=c;for(let u=0;u<i.length;u++){let h=this._getPointAtLength(d);if(!h)return;let p=i[u].char,f=i[u].width+o;if(p===" "&&s==="justify"){let S=this.text().split(" ").length-1;f+=(this.pathLength-l)/S}let g=this._getPointAtLength(d+f);if(!g)return;let m=si.getLineLength(h.x,h.y,g.x,g.y),v=0;if(a)try{v=a(i[u-1].char,p)*this.fontSize()}catch{v=0}h.x+=v,g.x+=v,this.textWidth+=v;let C=si.getPointOnLine(v+m/2,h.x,h.y,g.x,g.y),b=Math.atan2(g.y-h.y,g.x-h.x);this.glyphInfo.push({transposeX:C.x,transposeY:C.y,text:t[u],rotation:b,p0:h,p1:g,width:m}),d+=f}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let t=[];this.glyphInfo.forEach(function(c){t.push(c.p0.x),t.push(c.p0.y),t.push(c.p1.x),t.push(c.p1.y)});let i=t[0]||0,n=t[0]||0,r=t[1]||0,o=t[1]||0,s,a;for(let c=0;c<t.length/2;c++)s=t[c*2],a=t[c*2+1],i=Math.min(i,s),n=Math.max(n,s),r=Math.min(r,a),o=Math.max(o,a);let l=this.fontSize();return{x:i-l/2,y:r-l/2,width:n-i+l,height:o-r+l}}destroy(){return M.releaseCanvas(this.dummyCanvas),super.destroy()}};Dt.prototype._fillFunc=GT;Dt.prototype._strokeFunc=WT;Dt.prototype._fillFuncHit=GT;Dt.prototype._strokeFuncHit=WT;Dt.prototype.className="TextPath";Dt.prototype._attrsAffectingSize=["text","fontSize","data"];Oe(Dt);R.addGetterSetter(Dt,"data");R.addGetterSetter(Dt,"fontFamily","Arial");R.addGetterSetter(Dt,"fontSize",12,K());R.addGetterSetter(Dt,"fontStyle",VT);R.addGetterSetter(Dt,"align","left");R.addGetterSetter(Dt,"letterSpacing",0,K());R.addGetterSetter(Dt,"textBaseline","middle");R.addGetterSetter(Dt,"fontVariant",VT);R.addGetterSetter(Dt,"text",Kae);R.addGetterSetter(Dt,"textDecoration","");R.addGetterSetter(Dt,"kerningFunc",void 0);var qT="tr-konva",Yae=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${qT}`).join(" "),UT="nodesRect",Xae=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],Jae={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Qae="ontouchstart"in ne._global;function Zae(e,t,i){if(e==="rotater")return i;t+=M.degToRad(Jae[e]||0);let n=(M.radToDeg(t)%360+360)%360;return M._inRange(n,315+22.5,360)||M._inRange(n,0,22.5)?"ns-resize":M._inRange(n,45-22.5,45+22.5)?"nesw-resize":M._inRange(n,90-22.5,90+22.5)?"ew-resize":M._inRange(n,135-22.5,135+22.5)?"nwse-resize":M._inRange(n,180-22.5,180+22.5)?"ns-resize":M._inRange(n,225-22.5,225+22.5)?"nesw-resize":M._inRange(n,270-22.5,270+22.5)?"ew-resize":M._inRange(n,315-22.5,315+22.5)?"nwse-resize":(M.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var Qm=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],jT=1e8;function ele(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function $T(e,t,i){let n=i.x+(e.x-i.x)*Math.cos(t)-(e.y-i.y)*Math.sin(t),r=i.y+(e.x-i.x)*Math.sin(t)+(e.y-i.y)*Math.cos(t);return T(w({},e),{rotation:e.rotation+t,x:n,y:r})}function tle(e,t){let i=ele(e);return $T(e,t,i)}function ile(e,t,i){let n=t;for(let r=0;r<e.length;r++){let o=ne.getAngle(e[r]),s=Math.abs(o-t)%(Math.PI*2);Math.min(s,Math.PI*2-s)<i&&(n=o)}return n}var FS=0,$e=(()=>{class e extends dn{constructor(i){super(i),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Yae,this.update),this.getNode()&&this.update()}attachTo(i){return this.setNode(i),this}setNode(i){return M.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([i])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return qT+this._id}setNodes(i=[]){this._nodes&&this._nodes.length&&this.detach();let n=i.filter(o=>o.isAncestorOf(this)?(M.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=i=n,i.length===1&&this.useSingleNodeRotation()?this.rotation(i[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(o=>{let s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(o._attrsAffectingSize.length){let a=o._attrsAffectingSize.map(l=>l+"Change."+this._getEventNamespace()).join(" ");o.on(a,s)}o.on(Xae.map(a=>a+`.${this._getEventNamespace()}`).join(" "),s),o.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(o)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(i){let n;i.on(`dragstart.${this._getEventNamespace()}`,r=>{n=i.getAbsolutePosition(),!this.isDragging()&&i!==this.findOne(".back")&&this.startDrag(r,!1)}),i.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!n)return;let o=i.getAbsolutePosition(),s=o.x-n.x,a=o.y-n.y;this.nodes().forEach(l=>{if(l===i||l.isDragging())return;let c=l.getAbsolutePosition();l.setAbsolutePosition({x:c.x+s,y:c.y+a}),l.startDrag(r)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(i=>{i.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(UT),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(UT,this.__getNodeRect)}__getNodeShape(i,n=this.rotation(),r){let o=i.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=i.getAbsoluteScale(r),a=i.getAbsolutePosition(r),l=o.x*s.x-i.offsetX()*s.x,c=o.y*s.y-i.offsetY()*s.y,d=(ne.getAngle(i.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),u={x:a.x+l*Math.cos(d)+c*Math.sin(-d),y:a.y+c*Math.cos(d)+l*Math.sin(d),width:o.width*s.x,height:o.height*s.y,rotation:d};return $T(u,-ne.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-jT,y:-jT,width:0,height:0,rotation:0};let n=[];this.nodes().map(d=>{let u=d.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),h=[{x:u.x,y:u.y},{x:u.x+u.width,y:u.y},{x:u.x+u.width,y:u.y+u.height},{x:u.x,y:u.y+u.height}],p=d.getAbsoluteTransform();h.forEach(function(f){let g=p.point(f);n.push(g)})});let r=new ri;r.rotate(-ne.getAngle(this.rotation()));let o=1/0,s=1/0,a=-1/0,l=-1/0;n.forEach(function(d){let u=r.point(d);o===void 0&&(o=a=u.x,s=l=u.y),o=Math.min(o,u.x),s=Math.min(s,u.y),a=Math.max(a,u.x),l=Math.max(l,u.y)}),r.invert();let c=r.point({x:o,y:s});return{x:c.x,y:c.y,width:a-o,height:l-s,rotation:ne.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Qm.forEach(i=>{this._createAnchor(i)}),this._createAnchor("rotater")}_createAnchor(i){let n=new wo({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:i+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Qae?10:"auto"}),r=this;n.on("mousedown touchstart",function(o){r._handleMouseDown(o)}),n.on("dragstart",o=>{n.stopDrag(),o.cancelBubble=!0}),n.on("dragend",o=>{o.cancelBubble=!0}),n.on("mouseenter",()=>{let o=ne.getAngle(this.rotation()),s=this.rotateAnchorCursor(),a=Zae(i,o,s);n.getStage().content&&(n.getStage().content.style.cursor=a),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){let i=new q({name:"back",width:0,height:0,sceneFunc(n,r){let o=r.getParent(),s=o.padding();n.beginPath(),n.rect(-s,-s,r.width()+s*2,r.height()+s*2),n.moveTo(r.width()/2,-s),o.rotateEnabled()&&o.rotateLineVisible()&&n.lineTo(r.width()/2,-o.rotateAnchorOffset()*M._sign(r.height())-s),n.fillStrokeShape(r)},hitFunc:(n,r)=>{if(!this.shouldOverdrawWholeArea())return;let o=this.padding();n.beginPath(),n.rect(-o,-o,r.width()+o*2,r.height()+o*2),n.fillStrokeShape(r)}});this.add(i),this._proxyDrag(i),i.on("dragstart",n=>{n.cancelBubble=!0}),i.on("dragmove",n=>{n.cancelBubble=!0}),i.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(i){if(this._transforming)return;this._movingAnchorName=i.target.name().split(" ")[0];let n=this._getNodeRect(),r=n.width,o=n.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(o,2));this.sin=Math.abs(o/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let a=i.target.getAbsolutePosition(),l=i.target.getStage().getPointerPosition();this._anchorDragOffset={x:l.x-a.x,y:l.y-a.y},FS++,this._fire("transformstart",{evt:i.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:i.evt,target:c})})}_handleMouseMove(i){let n,r,o,s=this.findOne("."+this._movingAnchorName),a=s.getStage();a.setPointersPositions(i);let l=a.getPointerPosition(),c={x:l.x-this._anchorDragOffset.x,y:l.y-this._anchorDragOffset.y},d=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(d,c,i)),s.setAbsolutePosition(c);let u=s.getAbsolutePosition();if(d.x===u.x&&d.y===u.y)return;if(this._movingAnchorName==="rotater"){let b=this._getNodeRect();n=s.x()-b.width/2,r=-s.y()+b.height/2;let S=Math.atan2(-r,n)+Math.PI/2;b.height<0&&(S-=Math.PI);let x=ne.getAngle(this.rotation())+S,P=ne.getAngle(this.rotationSnapTolerance()),N=ile(this.rotationSnaps(),x,P)-b.rotation,Y=tle(b,N);this._fitNodesInto(Y,i);return}let h=this.shiftBehavior(),p;h==="inverted"?p=this.keepRatio()&&!i.shiftKey:h==="none"?p=this.keepRatio():p=this.keepRatio()||i.shiftKey;let f=this.centeredScaling()||i.altKey;if(this._movingAnchorName==="top-left"){if(p){let b=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};o=Math.sqrt(Math.pow(b.x-s.x(),2)+Math.pow(b.y-s.y(),2));let S=this.findOne(".top-left").x()>b.x?-1:1,E=this.findOne(".top-left").y()>b.y?-1:1;n=o*this.cos*S,r=o*this.sin*E,this.findOne(".top-left").x(b.x-n),this.findOne(".top-left").y(b.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(p){let b=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};o=Math.sqrt(Math.pow(s.x()-b.x,2)+Math.pow(b.y-s.y(),2));let S=this.findOne(".top-right").x()<b.x?-1:1,E=this.findOne(".top-right").y()>b.y?-1:1;n=o*this.cos*S,r=o*this.sin*E,this.findOne(".top-right").x(b.x+n),this.findOne(".top-right").y(b.y-r)}var g=s.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(p){let b=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};o=Math.sqrt(Math.pow(b.x-s.x(),2)+Math.pow(s.y()-b.y,2));let S=b.x<s.x()?-1:1,E=s.y()<b.y?-1:1;n=o*this.cos*S,r=o*this.sin*E,s.x(b.x-n),s.y(b.y+r)}g=s.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(p){let b=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};o=Math.sqrt(Math.pow(s.x()-b.x,2)+Math.pow(s.y()-b.y,2));let S=this.findOne(".bottom-right").x()<b.x?-1:1,E=this.findOne(".bottom-right").y()<b.y?-1:1;n=o*this.cos*S,r=o*this.sin*E,this.findOne(".bottom-right").x(b.x+n),this.findOne(".bottom-right").y(b.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(f=this.centeredScaling()||i.altKey,f){let b=this.findOne(".top-left"),S=this.findOne(".bottom-right"),E=b.x(),x=b.y(),P=this.getWidth()-S.x(),F=this.getHeight()-S.y();S.move({x:-E,y:-x}),b.move({x:P,y:F})}let m=this.findOne(".top-left").getAbsolutePosition();n=m.x,r=m.y;let v=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),C=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:r,width:v,height:C,rotation:ne.getAngle(this.rotation())},i)}_handleMouseUp(i){this._removeEvents(i)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(i){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let r=this.getNode();FS--,this._fire("transformend",{evt:i,target:r}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),r&&this._nodes.forEach(o=>{var s;o._fire("transformend",{evt:i,target:o}),(s=o.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(i,n){let r=this._getNodeRect(),o=1;if(M._inRange(i.width,-this.padding()*2-o,o)){this.update();return}if(M._inRange(i.height,-this.padding()*2-o,o)){this.update();return}let s=new ri;if(s.rotate(ne.getAngle(this.rotation())),this._movingAnchorName&&i.width<0&&this._movingAnchorName.indexOf("left")>=0){let p=s.point({x:-this.padding()*2,y:0});i.x+=p.x,i.y+=p.y,i.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=p.x,this._anchorDragOffset.y-=p.y}else if(this._movingAnchorName&&i.width<0&&this._movingAnchorName.indexOf("right")>=0){let p=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=p.x,this._anchorDragOffset.y-=p.y,i.width+=this.padding()*2}if(this._movingAnchorName&&i.height<0&&this._movingAnchorName.indexOf("top")>=0){let p=s.point({x:0,y:-this.padding()*2});i.x+=p.x,i.y+=p.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=p.x,this._anchorDragOffset.y-=p.y,i.height+=this.padding()*2}else if(this._movingAnchorName&&i.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let p=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=p.x,this._anchorDragOffset.y-=p.y,i.height+=this.padding()*2}if(this.boundBoxFunc()){let p=this.boundBoxFunc()(r,i);p?i=p:M.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let a=1e7,l=new ri;l.translate(r.x,r.y),l.rotate(r.rotation),l.scale(r.width/a,r.height/a);let c=new ri,d=i.width/a,u=i.height/a;this.flipEnabled()===!1?(c.translate(i.x,i.y),c.rotate(i.rotation),c.translate(i.width<0?i.width:0,i.height<0?i.height:0),c.scale(Math.abs(d),Math.abs(u))):(c.translate(i.x,i.y),c.rotate(i.rotation),c.scale(d,u));let h=c.multiply(l.invert());this._nodes.forEach(p=>{var f;if(!p.getStage())return;let g=p.getParent().getAbsoluteTransform(),m=p.getTransform().copy();m.translate(p.offsetX(),p.offsetY());let v=new ri;v.multiply(g.copy().invert()).multiply(h).multiply(g).multiply(m);let C=v.decompose();p.setAttrs(C),(f=p.getLayer())===null||f===void 0||f.batchDraw()}),this.rotation(M._getRotation(i.rotation)),this._nodes.forEach(p=>{this._fire("transform",{evt:n,target:p}),p._fire("transform",{evt:n,target:p})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(i,n){this.findOne(i).setAttrs(n)}update(){var i;let n=this._getNodeRect();this.rotation(M._getRotation(n.rotation));let r=n.width,o=n.height,s=this.enabledAnchors(),a=this.resizeEnabled(),l=this.padding(),c=this.anchorSize(),d=this.find("._anchor");d.forEach(h=>{h.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+l,offsetY:c/2+l,visible:a&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+l,visible:a&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-l,offsetY:c/2+l,visible:a&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:o/2,offsetX:c/2+l,visible:a&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:o/2,offsetX:c/2-l,visible:a&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:o,offsetX:c/2+l,offsetY:c/2-l,visible:a&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:o,offsetY:c/2-l,visible:a&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:o,offsetX:c/2-l,offsetY:c/2-l,visible:a&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*M._sign(o)-l,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:o,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(h=>h.draggable()),x:0,y:0});let u=this.anchorStyleFunc();u&&d.forEach(h=>{u(h)}),(i=this.getLayer())===null||i===void 0||i.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let i=this.findOne("."+this._movingAnchorName);i&&i.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),dn.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Q.prototype.toObject.call(this)}clone(i){return Q.prototype.clone.call(this,i)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}return e.isTransforming=()=>FS>0,e})();function nle(e){return e instanceof Array||M.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){Qm.indexOf(t)===-1&&M.warn("Unknown anchor name: "+t+". Available names are: "+Qm.join(", "))}),e||[]}$e.prototype.className="Transformer";Oe($e);R.addGetterSetter($e,"enabledAnchors",Qm,nle);R.addGetterSetter($e,"flipEnabled",!0,oi());R.addGetterSetter($e,"resizeEnabled",!0);R.addGetterSetter($e,"anchorSize",10,K());R.addGetterSetter($e,"rotateEnabled",!0);R.addGetterSetter($e,"rotateLineVisible",!0);R.addGetterSetter($e,"rotationSnaps",[]);R.addGetterSetter($e,"rotateAnchorOffset",50,K());R.addGetterSetter($e,"rotateAnchorCursor","crosshair");R.addGetterSetter($e,"rotationSnapTolerance",5,K());R.addGetterSetter($e,"borderEnabled",!0);R.addGetterSetter($e,"anchorStroke","rgb(0, 161, 255)");R.addGetterSetter($e,"anchorStrokeWidth",1,K());R.addGetterSetter($e,"anchorFill","white");R.addGetterSetter($e,"anchorCornerRadius",0,K());R.addGetterSetter($e,"borderStroke","rgb(0, 161, 255)");R.addGetterSetter($e,"borderStrokeWidth",1,K());R.addGetterSetter($e,"borderDash");R.addGetterSetter($e,"keepRatio",!0);R.addGetterSetter($e,"shiftBehavior","default");R.addGetterSetter($e,"centeredScaling",!1);R.addGetterSetter($e,"ignoreStroke",!1);R.addGetterSetter($e,"padding",0,K());R.addGetterSetter($e,"nodes");R.addGetterSetter($e,"node");R.addGetterSetter($e,"boundBoxFunc");R.addGetterSetter($e,"anchorDragBoundFunc");R.addGetterSetter($e,"anchorStyleFunc");R.addGetterSetter($e,"shouldOverdrawWholeArea",!1);R.addGetterSetter($e,"useSingleNodeRotation",!0);R.backCompat($e,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var In=class extends q{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,ne.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};In.prototype.className="Wedge";In.prototype._centroid=!0;In.prototype._attrsAffectingSize=["radius"];Oe(In);R.addGetterSetter(In,"radius",0,K());R.addGetterSetter(In,"angle",0,K());R.addGetterSetter(In,"clockwise",!1);R.backCompat(In,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function KT(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var rle=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],ole=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function sle(e,t){let i=e.data,n=e.width,r=e.height,o,s,a,l,c,d,u,h,p,f,g,m,v,C,b,S,E,x,P,F,N=t+t+1,Y=n-1,X=r-1,Z=t+1,me=Z*(Z+1)/2,oe=new KT,re=rle[t],_=ole[t],k=null,D=oe,V=null,U=null;for(let G=1;G<N;G++)D=D.next=new KT,G===Z&&(k=D);D.next=oe,a=s=0;for(let G=0;G<r;G++){m=v=C=b=l=c=d=u=0,h=Z*(S=i[s]),p=Z*(E=i[s+1]),f=Z*(x=i[s+2]),g=Z*(P=i[s+3]),l+=me*S,c+=me*E,d+=me*x,u+=me*P,D=oe;for(let z=0;z<Z;z++)D.r=S,D.g=E,D.b=x,D.a=P,D=D.next;for(let z=1;z<Z;z++)o=s+((Y<z?Y:z)<<2),l+=(D.r=S=i[o])*(F=Z-z),c+=(D.g=E=i[o+1])*F,d+=(D.b=x=i[o+2])*F,u+=(D.a=P=i[o+3])*F,m+=S,v+=E,C+=x,b+=P,D=D.next;V=oe,U=k;for(let z=0;z<n;z++)i[s+3]=P=u*re>>_,P!==0?(P=255/P,i[s]=(l*re>>_)*P,i[s+1]=(c*re>>_)*P,i[s+2]=(d*re>>_)*P):i[s]=i[s+1]=i[s+2]=0,l-=h,c-=p,d-=f,u-=g,h-=V.r,p-=V.g,f-=V.b,g-=V.a,o=a+((o=z+t+1)<Y?o:Y)<<2,m+=V.r=i[o],v+=V.g=i[o+1],C+=V.b=i[o+2],b+=V.a=i[o+3],l+=m,c+=v,d+=C,u+=b,V=V.next,h+=S=U.r,p+=E=U.g,f+=x=U.b,g+=P=U.a,m-=S,v-=E,C-=x,b-=P,U=U.next,s+=4;a+=n}for(let G=0;G<n;G++){v=C=b=m=c=d=u=l=0,s=G<<2,h=Z*(S=i[s]),p=Z*(E=i[s+1]),f=Z*(x=i[s+2]),g=Z*(P=i[s+3]),l+=me*S,c+=me*E,d+=me*x,u+=me*P,D=oe;for(let O=0;O<Z;O++)D.r=S,D.g=E,D.b=x,D.a=P,D=D.next;let z=n;for(let O=1;O<=t;O++)s=z+G<<2,l+=(D.r=S=i[s])*(F=Z-O),c+=(D.g=E=i[s+1])*F,d+=(D.b=x=i[s+2])*F,u+=(D.a=P=i[s+3])*F,m+=S,v+=E,C+=x,b+=P,D=D.next,O<X&&(z+=n);s=G,V=oe,U=k;for(let O=0;O<r;O++)o=s<<2,i[o+3]=P=u*re>>_,P>0?(P=255/P,i[o]=(l*re>>_)*P,i[o+1]=(c*re>>_)*P,i[o+2]=(d*re>>_)*P):i[o]=i[o+1]=i[o+2]=0,l-=h,c-=p,d-=f,u-=g,h-=V.r,p-=V.g,f-=V.b,g-=V.a,o=G+((o=O+Z)<X?o:X)*n<<2,l+=m+=V.r=i[o],c+=v+=V.g=i[o+1],d+=C+=V.b=i[o+2],u+=b+=V.a=i[o+3],V=V.next,h+=S=U.r,p+=E=U.g,f+=x=U.b,g+=P=U.a,m-=S,v-=E,C-=x,b-=P,U=U.next,s+=n}}var YT=function(t){let i=Math.round(this.blurRadius());i>0&&sle(t,i)};R.addGetterSetter(Q,"blurRadius",0,K(),R.afterSetFilter);var XT=function(e){let t=this.brightness()*255,i=e.data,n=i.length;for(let r=0;r<n;r+=4)i[r]+=t,i[r+1]+=t,i[r+2]+=t};R.addGetterSetter(Q,"brightness",0,K(),R.afterSetFilter);var JT=function(e){let t=this.brightness(),i=e.data,n=i.length;for(let r=0;r<n;r+=4)i[r]=Math.min(255,i[r]*t),i[r+1]=Math.min(255,i[r+1]*t),i[r+2]=Math.min(255,i[r+2]*t)};var QT=function(e){let t=Math.pow((this.contrast()+100)/100,2),i=e.data,n=i.length,r=150,o=150,s=150;for(let a=0;a<n;a+=4)r=i[a],o=i[a+1],s=i[a+2],r/=255,r-=.5,r*=t,r+=.5,r*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,s=s<0?0:s>255?255:s,i[a]=r,i[a+1]=o,i[a+2]=s};R.addGetterSetter(Q,"contrast",0,K(),R.afterSetFilter);var ZT=function(e){var t,i,n,r,o,s,a,l,c;let d=e.data,u=e.width,h=e.height,p=Math.min(1,Math.max(0,(i=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&i!==void 0?i:.5)),f=Math.min(1,Math.max(0,(r=(n=this.embossWhiteLevel)===null||n===void 0?void 0:n.call(this))!==null&&r!==void 0?r:.5)),m=(a={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(s=(o=this.embossDirection)===null||o===void 0?void 0:o.call(this))!==null&&s!==void 0?s:"top-left"])!==null&&a!==void 0?a:315,v=!!((c=(l=this.embossBlend)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0&&c),C=p*10,b=f*255,S=m*Math.PI/180,E=Math.cos(S),x=Math.sin(S),P=128/1020*C,F=new Uint8ClampedArray(d),N=new Float32Array(u*h);for(let oe=0,re=0;re<d.length;re+=4,oe++)N[oe]=.2126*F[re]+.7152*F[re+1]+.0722*F[re+2];let Y=[-1,0,1,-2,0,2,-1,0,1],X=[-1,-2,-1,0,0,0,1,2,1],Z=[-u-1,-u,-u+1,-1,0,1,u-1,u,u+1],me=oe=>oe<0?0:oe>255?255:oe;for(let oe=1;oe<h-1;oe++)for(let re=1;re<u-1;re++){let _=oe*u+re,k=0,D=0;k+=N[_+Z[0]]*Y[0],D+=N[_+Z[0]]*X[0],k+=N[_+Z[1]]*Y[1],D+=N[_+Z[1]]*X[1],k+=N[_+Z[2]]*Y[2],D+=N[_+Z[2]]*X[2],k+=N[_+Z[3]]*Y[3],D+=N[_+Z[3]]*X[3],k+=N[_+Z[5]]*Y[5],D+=N[_+Z[5]]*X[5],k+=N[_+Z[6]]*Y[6],D+=N[_+Z[6]]*X[6],k+=N[_+Z[7]]*Y[7],D+=N[_+Z[7]]*X[7],k+=N[_+Z[8]]*Y[8],D+=N[_+Z[8]]*X[8];let V=E*k+x*D,U=me(b+V*P),G=_*4;if(v){let z=U-b;d[G]=me(F[G]+z),d[G+1]=me(F[G+1]+z),d[G+2]=me(F[G+2]+z),d[G+3]=F[G+3]}else d[G]=d[G+1]=d[G+2]=U,d[G+3]=F[G+3]}for(let oe=0;oe<u;oe++){let re=oe*4,_=((h-1)*u+oe)*4;d[re]=F[re],d[re+1]=F[re+1],d[re+2]=F[re+2],d[re+3]=F[re+3],d[_]=F[_],d[_+1]=F[_+1],d[_+2]=F[_+2],d[_+3]=F[_+3]}for(let oe=1;oe<h-1;oe++){let re=oe*u*4,_=(oe*u+(u-1))*4;d[re]=F[re],d[re+1]=F[re+1],d[re+2]=F[re+2],d[re+3]=F[re+3],d[_]=F[_],d[_+1]=F[_+1],d[_+2]=F[_+2],d[_+3]=F[_+3]}return e};R.addGetterSetter(Q,"embossStrength",.5,K(),R.afterSetFilter);R.addGetterSetter(Q,"embossWhiteLevel",.5,K(),R.afterSetFilter);R.addGetterSetter(Q,"embossDirection","top-left",void 0,R.afterSetFilter);R.addGetterSetter(Q,"embossBlend",!1,void 0,R.afterSetFilter);function MS(e,t,i,n,r){let o=i-t,s=r-n;if(o===0)return n+s/2;if(s===0)return n;let a=(e-t)/o;return a=s*a+n,a}var e7=function(e){let t=e.data,i=t.length,n=t[0],r=n,o,s=t[1],a=s,l,c=t[2],d=c,u,h=this.enhance();if(h===0)return;for(let b=0;b<i;b+=4)o=t[b+0],o<n?n=o:o>r&&(r=o),l=t[b+1],l<s?s=l:l>a&&(a=l),u=t[b+2],u<c?c=u:u>d&&(d=u);r===n&&(r=255,n=0),a===s&&(a=255,s=0),d===c&&(d=255,c=0);let p,f,g,m,v,C;if(h>0)p=r+h*(255-r),f=n-h*(n-0),g=a+h*(255-a),m=s-h*(s-0),v=d+h*(255-d),C=c-h*(c-0);else{let b=(r+n)*.5;p=r+h*(r-b),f=n+h*(n-b);let S=(a+s)*.5;g=a+h*(a-S),m=s+h*(s-S);let E=(d+c)*.5;v=d+h*(d-E),C=c+h*(c-E)}for(let b=0;b<i;b+=4)t[b+0]=MS(t[b+0],n,r,f,p),t[b+1]=MS(t[b+1],s,a,m,g),t[b+2]=MS(t[b+2],c,d,C,v)};R.addGetterSetter(Q,"enhance",0,K(),R.afterSetFilter);var t7=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4){let r=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=r,t[n+1]=r,t[n+2]=r}};R.addGetterSetter(Q,"hue",0,K(),R.afterSetFilter);R.addGetterSetter(Q,"saturation",0,K(),R.afterSetFilter);R.addGetterSetter(Q,"luminance",0,K(),R.afterSetFilter);var i7=function(e){let t=e.data,i=t.length,n=1,r=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,s=this.luminance()*127,a=n*r*Math.cos(o*Math.PI/180),l=n*r*Math.sin(o*Math.PI/180),c=.299*n+.701*a+.167*l,d=.587*n-.587*a+.33*l,u=.114*n-.114*a-.497*l,h=.299*n-.299*a-.328*l,p=.587*n+.413*a+.035*l,f=.114*n-.114*a+.293*l,g=.299*n-.3*a+1.25*l,m=.587*n-.586*a-1.05*l,v=.114*n+.886*a-.2*l,C,b,S,E;for(let x=0;x<i;x+=4)C=t[x+0],b=t[x+1],S=t[x+2],E=t[x+3],t[x+0]=c*C+d*b+u*S+s,t[x+1]=h*C+p*b+f*S+s,t[x+2]=g*C+m*b+v*S+s,t[x+3]=E};var n7=function(e){let t=e.data,i=t.length,n=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),o=Math.abs(this.hue()+360)%360,s=n*r*Math.cos(o*Math.PI/180),a=n*r*Math.sin(o*Math.PI/180),l=.299*n+.701*s+.167*a,c=.587*n-.587*s+.33*a,d=.114*n-.114*s-.497*a,u=.299*n-.299*s-.328*a,h=.587*n+.413*s+.035*a,p=.114*n-.114*s+.293*a,f=.299*n-.3*s+1.25*a,g=.587*n-.586*s-1.05*a,m=.114*n+.886*s-.2*a;for(let v=0;v<i;v+=4){let C=t[v+0],b=t[v+1],S=t[v+2],E=t[v+3];t[v+0]=l*C+c*b+d*S,t[v+1]=u*C+h*b+p*S,t[v+2]=f*C+g*b+m*S,t[v+3]=E}};R.addGetterSetter(Q,"hue",0,K(),R.afterSetFilter);R.addGetterSetter(Q,"saturation",0,K(),R.afterSetFilter);R.addGetterSetter(Q,"value",0,K(),R.afterSetFilter);var r7=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};var ale=function(e,t,i){let n=e.data,r=t.data,o=e.width,s=e.height,a=i.polarCenterX||o/2,l=i.polarCenterY||s/2,c=Math.sqrt(a*a+l*l),d=o-a,u=s-l,h=Math.sqrt(d*d+u*u);c=h>c?h:c;let p=s,f=o,g=360/f*Math.PI/180;for(let m=0;m<f;m+=1){let v=Math.sin(m*g),C=Math.cos(m*g);for(let b=0;b<p;b+=1){d=Math.floor(a+c*b/p*C),u=Math.floor(l+c*b/p*v);let S=(u*o+d)*4,E=n[S+0],x=n[S+1],P=n[S+2],F=n[S+3];S=(m+b*o)*4,r[S+0]=E,r[S+1]=x,r[S+2]=P,r[S+3]=F}}},lle=function(e,t,i){let n=e.data,r=t.data,o=e.width,s=e.height,a=i.polarCenterX||o/2,l=i.polarCenterY||s/2,c=Math.sqrt(a*a+l*l),d=o-a,u=s-l,h=Math.sqrt(d*d+u*u);c=h>c?h:c;let p=s,f=o,g=i.polarRotation||0,m,v;for(d=0;d<o;d+=1)for(u=0;u<s;u+=1){let C=d-a,b=u-l,S=Math.sqrt(C*C+b*b)*p/c,E=(Math.atan2(b,C)*180/Math.PI+360+g)%360;E=E*f/360,m=Math.floor(E),v=Math.floor(S);let x=(v*o+m)*4,P=n[x+0],F=n[x+1],N=n[x+2],Y=n[x+3];x=(u*o+d)*4,r[x+0]=P,r[x+1]=F,r[x+2]=N,r[x+3]=Y}},o7=function(e){let t=e.width,i=e.height,n,r,o,s,a,l,c,d,u,h,p=Math.round(this.kaleidoscopePower()),f=Math.round(this.kaleidoscopeAngle()),g=Math.floor(t*(f%360)/360);if(p<1)return;let m=M.createCanvasElement();m.width=t,m.height=i;let v=m.getContext("2d").getImageData(0,0,t,i);M.releaseCanvas(m),ale(e,v,{polarCenterX:t/2,polarCenterY:i/2});let C=t/Math.pow(2,p);for(;C<=8;)C=C*2,p-=1;C=Math.ceil(C);let b=C,S=0,E=b,x=1;for(g+C>t&&(S=b,E=0,x=-1),r=0;r<i;r+=1)for(n=S;n!==E;n+=x)o=Math.round(n+g)%t,u=(t*r+o)*4,a=v.data[u+0],l=v.data[u+1],c=v.data[u+2],d=v.data[u+3],h=(t*r+n)*4,v.data[h+0]=a,v.data[h+1]=l,v.data[h+2]=c,v.data[h+3]=d;for(r=0;r<i;r+=1)for(b=Math.floor(C),s=0;s<p;s+=1){for(n=0;n<b+1;n+=1)u=(t*r+n)*4,a=v.data[u+0],l=v.data[u+1],c=v.data[u+2],d=v.data[u+3],h=(t*r+b*2-n-1)*4,v.data[h+0]=a,v.data[h+1]=l,v.data[h+2]=c,v.data[h+3]=d;b*=2}lle(v,e,{polarRotation:0})};R.addGetterSetter(Q,"kaleidoscopePower",2,K(),R.afterSetFilter);R.addGetterSetter(Q,"kaleidoscopeAngle",0,K(),R.afterSetFilter);function Zm(e,t,i){let n=(i*e.width+t)*4,r=[];return r.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),r}function mh(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function cle(e){let t=[0,0,0];for(let i=0;i<e.length;i++)t[0]+=e[i][0],t[1]+=e[i][1],t[2]+=e[i][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function dle(e,t){let i=Zm(e,0,0),n=Zm(e,e.width-1,0),r=Zm(e,0,e.height-1),o=Zm(e,e.width-1,e.height-1),s=t||10;if(mh(i,n)<s&&mh(n,o)<s&&mh(o,r)<s&&mh(r,i)<s){let a=cle([n,i,o,r]),l=[];for(let c=0;c<e.width*e.height;c++){let d=mh(a,[e.data[c*4],e.data[c*4+1],e.data[c*4+2]]);l[c]=d<s?0:255}return l}}function ule(e,t){for(let i=0;i<e.width*e.height;i++)e.data[4*i+3]=t[i]}function hle(e,t,i){let n=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(n.length)),o=Math.floor(r/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let c=a*t+l,d=0;for(let u=0;u<r;u++)for(let h=0;h<r;h++){let p=a+u-o,f=l+h-o;if(p>=0&&p<i&&f>=0&&f<t){let g=p*t+f,m=n[u*r+h];d+=e[g]*m}}s[c]=d===2040?255:0}return s}function ple(e,t,i){let n=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(n.length)),o=Math.floor(r/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let c=a*t+l,d=0;for(let u=0;u<r;u++)for(let h=0;h<r;h++){let p=a+u-o,f=l+h-o;if(p>=0&&p<i&&f>=0&&f<t){let g=p*t+f,m=n[u*r+h];d+=e[g]*m}}s[c]=d>=1020?255:0}return s}function fle(e,t,i){let n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(n.length)),o=Math.floor(r/2),s=[];for(let a=0;a<i;a++)for(let l=0;l<t;l++){let c=a*t+l,d=0;for(let u=0;u<r;u++)for(let h=0;h<r;h++){let p=a+u-o,f=l+h-o;if(p>=0&&p<i&&f>=0&&f<t){let g=p*t+f,m=n[u*r+h];d+=e[g]*m}}s[c]=d}return s}var s7=function(e){let t=this.threshold(),i=dle(e,t);return i&&(i=hle(i,e.width,e.height),i=ple(i,e.width,e.height),i=fle(i,e.width,e.height),ule(e,i)),e};R.addGetterSetter(Q,"threshold",0,K(),R.afterSetFilter);var a7=function(e){let t=this.noise()*255,i=e.data,n=i.length,r=t/2;for(let o=0;o<n;o+=4)i[o+0]+=r-2*r*Math.random(),i[o+1]+=r-2*r*Math.random(),i[o+2]+=r-2*r*Math.random()};R.addGetterSetter(Q,"noise",.2,K(),R.afterSetFilter);var l7=function(e){let t=Math.ceil(this.pixelSize()),i=e.width,n=e.height,r=Math.ceil(i/t),o=Math.ceil(n/t),s=e.data;if(t<=0){M.error("pixelSize value can not be <= 0");return}for(let a=0;a<r;a+=1)for(let l=0;l<o;l+=1){let c=0,d=0,u=0,h=0,p=a*t,f=p+t,g=l*t,m=g+t,v=0;for(let C=p;C<f;C+=1)if(!(C>=i))for(let b=g;b<m;b+=1){if(b>=n)continue;let S=(i*b+C)*4;c+=s[S+0],d+=s[S+1],u+=s[S+2],h+=s[S+3],v+=1}c=c/v,d=d/v,u=u/v,h=h/v;for(let C=p;C<f;C+=1)if(!(C>=i))for(let b=g;b<m;b+=1){if(b>=n)continue;let S=(i*b+C)*4;s[S+0]=c,s[S+1]=d,s[S+2]=u,s[S+3]=h}}};R.addGetterSetter(Q,"pixelSize",8,K(),R.afterSetFilter);var c7=function(e){let t=Math.round(this.levels()*254)+1,i=e.data,n=i.length,r=255/t;for(let o=0;o<n;o+=1)i[o]=Math.floor(i[o]/r)*r};R.addGetterSetter(Q,"levels",.5,K(),R.afterSetFilter);var d7=function(e){let t=e.data,i=t.length,n=this.red(),r=this.green(),o=this.blue();for(let s=0;s<i;s+=4){let a=(.34*t[s]+.5*t[s+1]+.16*t[s+2])/255;t[s]=a*n,t[s+1]=a*r,t[s+2]=a*o,t[s+3]=t[s+3]}};R.addGetterSetter(Q,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});R.addGetterSetter(Q,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});R.addGetterSetter(Q,"blue",0,Bm,R.afterSetFilter);var u7=function(e){let t=e.data,i=t.length,n=this.red(),r=this.green(),o=this.blue(),s=this.alpha();for(let a=0;a<i;a+=4){let l=1-s;t[a]=n*s+t[a]*l,t[a+1]=r*s+t[a+1]*l,t[a+2]=o*s+t[a+2]*l}};R.addGetterSetter(Q,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});R.addGetterSetter(Q,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});R.addGetterSetter(Q,"blue",0,Bm,R.afterSetFilter);R.addGetterSetter(Q,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e});var h7=function(e){let t=e.data,i=t.length;for(let n=0;n<i;n+=4){let r=t[n+0],o=t[n+1],s=t[n+2];t[n+0]=Math.min(255,r*.393+o*.769+s*.189),t[n+1]=Math.min(255,r*.349+o*.686+s*.168),t[n+2]=Math.min(255,r*.272+o*.534+s*.131)}};var p7=function(e){let i=e.data;for(let n=0;n<i.length;n+=4){let r=i[n],o=i[n+1],s=i[n+2];.2126*r+.7152*o+.0722*s>=128&&(i[n]=255-r,i[n+1]=255-o,i[n+2]=255-s)}return e};var f7=function(e){let t=this.threshold()*255,i=e.data,n=i.length;for(let r=0;r<n;r+=1)i[r]=i[r]<t?0:255};R.addGetterSetter(Q,"threshold",.5,K(),R.afterSetFilter);var g7=CS.Util._assign(CS,{Arc:Tn,Arrow:Lr,Circle:Co,Ellipse:Kn,Image:Ki,Label:vc,Tag:Nr,Line:un,Path:si,Rect:wo,RegularPolygon:Yn,Ring:Br,Sprite:Oi,Star:Xn,Text:ct,TextPath:Dt,Transformer:$e,Wedge:In,Filters:{Blur:YT,Brightness:JT,Brighten:XT,Contrast:QT,Emboss:ZT,Enhance:e7,Grayscale:t7,HSL:i7,HSV:n7,Invert:r7,Kaleidoscope:o7,Mask:s7,Noise:a7,Pixelate:l7,Posterize:c7,RGB:d7,RGBA:u7,Sepia:h7,Solarize:p7,Threshold:f7}});var m7=g7;var v7=["*"];function TS(e){let t=e.getLayer()||e.getStage();t&&t.batchDraw()}function C7(e,t={},i={}){"id"in t&&console.warn('ng2-konva: You are using "id" attribute for Konva node. In some very rare cases it may produce bugs. Currently we recommend not to use it and use "name" attribute instead.');let n=e.getStage(),r={},o=!1;if(Object.keys(i).forEach(s=>{let a=s.slice(0,2)==="on",l=i[s]!==t[s];if(a&&l){let d=s.slice(2).toLowerCase();d.slice(0,7)==="content"&&(d="content"+d.slice(7,8).toUpperCase()+d.slice(8)),n.off(d,i[s])}!Object.hasOwn(t,s)&&n.setAttr(s,void 0)}),Object.keys(t).forEach(s=>{let a=s.slice(0,2)==="on",l=i[s]!==t[s];if(a&&l){let c=s.slice(2).toLowerCase();c.slice(0,7)==="content"&&(c="content"+c.slice(7,8).toUpperCase()+c.slice(8)),t[s]&&(n.off(c),n.on(c,d=>{t[s]({angularComponent:e,event:d})}))}!a&&(t[s]!==i[s]||t[s]!==n.getAttr(s))&&(o=!0,r[s]=t[s])}),o){n.setAttrs(r),TS(n);let s;Object.keys(r).forEach(a=>{if(s=r[a],s instanceof Image&&!s.complete){let l=n;s.addEventListener("load",function(){let c=l.getLayer();c&&c.batchDraw()})}})}}function gle(e){return e.replace(/^\w|[A-Z]|\b\w/g,function(t,i){return i==0?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")}function mle(e){return e.charAt(0).toUpperCase()+e.slice(1)}function vle(e){return mle(gle(e.slice(3).replace("-"," ")))}function w7(e){let t={};return["mouseover","mousemove","mouseout","mouseenter","mouseleave","mousedown","mouseup","wheel","contextmenu","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","dragstart","dragmove","dragend","transformstart","transform","transformend"].forEach(i=>{let r=e[i];r.listeners?.length>0&&(t["on"+i]=r.emit.bind(r))}),t}var e0=(()=>{class e{shapes=E0(e);config=Lc();#e=ht(()=>{let i=this.config();i&&this.uploadKonva(i)});mouseover=Ce();mousemove=Ce();mouseout=Ce();mouseenter=Ce();mouseleave=Ce();mousedown=Ce();mouseup=Ce();wheel=Ce();contextmenu=Ce();click=Ce();dblclick=Ce();touchstart=Ce();touchmove=Ce();touchend=Ce();tap=Ce();dbltap=Ce();dragstart=Ce();dragmove=Ce();dragend=Ce();transformstart=Ce();transform=Ce();transformend=Ce();nameNode=vle(ce(ci).nativeElement.localName);cacheProps={};_stage;getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}constructor(){this.initKonva()}initKonva(){this._stage||(this._stage=new q),this.nameNode==="Shape"?this._stage=new q:this.nameNode==="Sprite"?this._stage=new Oi(this.config()):this._stage=new m7[this.nameNode](void 0);let i=this._stage.to.bind(this._stage);this._stage.to=r=>{i(r),setTimeout(()=>{Object.keys(this._stage.attrs).forEach(o=>{typeof this._stage.attrs[o]!="function"&&this.config()&&this.config.update(s=>T(w({},s),{[o]:this._stage.attrs[o]}))})},200)};let n=this.config();n&&this.uploadKonva(n)}uploadKonva(i){if(!this._stage)return;let n=w(w({},i),w7(this));C7(this,n,this.cacheProps),this.cacheProps=n}#t=ht(()=>{this.shapes().forEach((i,n)=>{this!==i&&((this._stage instanceof dn||this._stage instanceof $i)&&this._stage.add(i.getStage()),i.getStage().zIndex(n),TS(this._stage))})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["ko-shape"],["ko-layer"],["ko-circle"],["ko-fastlayer"],["ko-group"],["ko-label"],["ko-rect"],["ko-ellipse"],["ko-wedge"],["ko-line"],["ko-sprite"],["ko-image"],["ko-text"],["ko-text-path"],["ko-star"],["ko-ring"],["ko-arc"],["ko-tag"],["ko-path"],["ko-regular-polygon"],["ko-arrow"],["ko-transformer"]],contentQueries:function(n,r,o){n&1&&y0(o,r.shapes,e,4),n&2&&Ic()},inputs:{config:[1,"config"]},outputs:{config:"configChange",mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:v7,decls:2,vars:0,template:function(n,r){n&1&&(Eo(),La(0,"div"),Ro(1),Tc())},encapsulation:2})}return e})(),b7=(()=>{class e{nodeContainer=ce(ci).nativeElement;shapes=E0(e0);config=De();#e=ht(()=>{let i=this.config();i&&(this._stage?this.uploadKonva(i):(this._stage=new vo(T(w({},i),{container:this.nodeContainer})),this.uploadKonva(i)))});mouseover=Ce();mousemove=Ce();mouseout=Ce();mouseenter=Ce();mouseleave=Ce();mousedown=Ce();mouseup=Ce();wheel=Ce();contextmenu=Ce();click=Ce();dblclick=Ce();touchstart=Ce();touchmove=Ce();touchend=Ce();tap=Ce();dbltap=Ce();dragstart=Ce();dragmove=Ce();dragend=Ce();transformstart=Ce();transform=Ce();transformend=Ce();_stage;cacheProps={};getStage(){return this._stage}getNode(){return this._stage}getConfig(){return this.config()||{}}uploadKonva(i){let n=w(w({},i),w7(this));C7(this,n,this.cacheProps),this.cacheProps=n}#t=ht(()=>{this.shapes().forEach((i,n)=>{if(!(i.getStage()instanceof $i))throw"You can only add Layer Nodes to Stage Nodes!";this._stage.add(i.getStage()),i.getStage().zIndex(n),TS(this._stage)})});ngOnDestroy(){this._stage.destroy()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["ko-stage"]],contentQueries:function(n,r,o){n&1&&y0(o,r.shapes,e0,4),n&2&&Ic()},inputs:{config:[1,"config"]},outputs:{mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousedown:"mousedown",mouseup:"mouseup",wheel:"wheel",contextmenu:"contextmenu",click:"click",dblclick:"dblclick",touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",tap:"tap",dbltap:"dbltap",dragstart:"dragstart",dragmove:"dragmove",dragend:"dragend",transformstart:"transformstart",transform:"transform",transformend:"transformend"},ngContentSelectors:v7,decls:2,vars:0,template:function(n,r){n&1&&(Eo(),La(0,"div"),Ro(1),Tc())},encapsulation:2})}return e})();var Cle=()=>[10,5],wle=(e,t)=>({points:e,stroke:"#3b82f6",strokeWidth:4,lineCap:"round",lineJoin:"round",dash:t}),ble=(e,t,i)=>({x:e,y:t,listening:!0,name:i}),yle=(e,t,i,n)=>({width:36,height:36,offsetX:18,offsetY:18,cornerRadius:8,fill:e,stroke:t,strokeWidth:i,opacity:n}),Sle=(e,t)=>({text:e,fontSize:12,fill:"#111827",width:80,align:"center",offsetX:40,offsetY:t}),xle=e=>({image:e,width:20,height:20,offsetX:10,offsetY:10}),Ele=(e,t)=>t.name,Rle=(e,t)=>t.id;function Ple(e,t){if(e&1&&le(0,"ko-line",2),e&2){let i=t.$implicit;ve("config",i)}}function kle(e,t){if(e&1){let i=Ue();A(0,"ko-line",3),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.onWallClick(r.name))})("mouseenter",function(){let r=ue(i).$implicit,o=te();return he(o.onWallMouseEnter(r.name))})("mouseleave",function(){ue(i);let r=te();return he(r.onWallMouseLeave())}),I()}if(e&2){let i=t.$implicit;ve("config",i)}}function _le(e,t){if(e&1&&le(0,"ko-line",2),e&2){let i=te();ve("config",x0(2,wle,i.tempLine(),Bh(1,Cle)))}}function Dle(e,t){if(e&1&&le(0,"ko-image",2),e&2){let i=te().$implicit;ve("config",Oc(1,xle,i.iconImage))}}function Fle(e,t){if(e&1){let i=Ue();A(0,"ko-group",3),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.onItemClick(r.id))})("mouseenter",function(){let r=ue(i).$implicit,o=te();return he(o.onItemMouseEnter(r.id))})("mouseleave",function(){ue(i);let r=te();return he(r.onItemMouseLeave())}),le(1,"ko-rect",2),Ve(2,Dle,1,3,"ko-image",2),le(3,"ko-text",2),I()}if(e&2){let i=t.$implicit,n=te();ve("config",P2(4,ble,i.x,i.y,i.konvaName)),L(),ve("config",k2(8,yle,n.selectedItemId()===i.id?"#fb923c":"#fbbf24",n.selectedItemId()===i.id?"#c2410c":n.hoveredItemId()===i.id?"#f97316":"#92400e",n.selectedItemId()===i.id?3:2,n.selectedItemId()===i.id?1:.9)),L(),Ge(i.iconImage?2:-1),L(),ve("config",x0(13,Sle,i.name,-24))}}var t0=class e{static ITEM_SIZE=36;static ITEM_RADIUS=e.ITEM_SIZE/2;canvasWidth=De(1600);canvasHeight=De(1200);gridSize=De(20);drawingMode=De("select");zoom=De(1);stagePosition=De({x:0,y:0});items=Lc.required();activeFlexibleItemId=De(null);walls=Lc.required();wallClicked=Ce();wallMouseEnter=Ce();wallMouseLeave=Ce();zoomChanged=Ce();stagePositionChanged=Ce();wallCreated=Ce();wallMoved=Ce();wallDeleted=Ce();itemClicked=Ce();itemMoved=Ce();itemDeleted=Ce();itemPlaced=Ce();selectedWallId=xe(null);hoveredWallId=xe(null);selectedItemId=xe(null);hoveredItemId=xe(null);isDrawing=xe(!1);tempLine=xe(null);isDragging=xe(!1);draggedWallId=xe(null);dragStartPos=xe(null);draggedWallInitialCoords=xe(null);isItemDragging=xe(!1);draggedItemId=xe(null);itemDragStartPos=xe(null);draggedItemInitialPos=xe(null);isPanning=xe(!1);panStartPos=xe(null);panInitialStagePos=xe(null);iconCache=new Map;iconLoadingSignal=xe(0);gridLines=Ie(()=>{let t=[],i=this.canvasWidth(),n=this.canvasHeight(),r=this.gridSize();for(let o=0;o<=i;o+=r)t.push({points:[o,0,o,n],stroke:"#e5e7eb",strokeWidth:o%(r*5)===0?1.5:.5});for(let o=0;o<=n;o+=r)t.push({points:[0,o,i,o],stroke:"#e5e7eb",strokeWidth:o%(r*5)===0?1.5:.5});return t});wallLines=Ie(()=>{let t=this.hoveredWallId(),i=this.selectedWallId(),n=this.draggedWallId();return this.walls().map(r=>{let o=r.color,s=1;return r.id===n?(o="#10b981",s=.7):r.id===i?o="#3b82f6":r.id===t&&(o="#6366f1"),{name:r.id,points:[r.start_x,r.start_y,r.end_x,r.end_y],stroke:o,strokeWidth:4,opacity:s,hitStrokeWidth:20,lineCap:"round",lineJoin:"round",listening:!0}})});itemShapes=Ie(()=>(this.iconLoadingSignal(),(this.items()||[]).map(t=>({id:t.id,konvaName:t.id,name:t.item?.name||"Item",icon:t.item?.icon||null,iconImage:t.item?.icon?this.getIconImage(t.item.icon):null,x:t.position_x??0,y:t.position_y??0}))));constructor(){ht(()=>{this.items().forEach(i=>{i.item?.icon&&this.loadIconImage(i.item.icon)})})}stageConfig=Ie(()=>({width:this.canvasWidth(),height:this.canvasHeight(),scaleX:this.zoom(),scaleY:this.zoom(),x:this.stagePosition().x,y:this.stagePosition().y}));cursorStyle=Ie(()=>this.isPanning()?"grabbing":this.drawingMode()==="draw"?"crosshair":this.drawingMode()==="add-item"?this.activeFlexibleItemId()?"copy":"not-allowed":this.drawingMode()==="delete"?"not-allowed":this.drawingMode()==="move"?this.isItemDragging()||this.isDragging()?"grabbing":"grab":"default");onStageMouseDown(t){let i=t?.event?.target?.getStage();if(!i)return;let n=i.getPointerPosition();if(!n)return;let r=t.event.evt;if(r.button===1||r.button===0&&r.ctrlKey){this.isPanning.set(!0),this.panStartPos.set({x:r.clientX,y:r.clientY}),this.panInitialStagePos.set(w({},this.stagePosition()));return}let o=this.getCanvasPosition(n),s=this.getItemAtPosition(o),a=this.getWallAtPosition(o);switch(this.drawingMode()){case"draw":{if(this.isDrawing()){let l=this.tempLine();l&&this.wallCreated.emit({start_x:l[0],start_y:l[1],end_x:l[2],end_y:l[3]}),this.isDrawing.set(!1),this.tempLine.set(null)}else{this.isDrawing.set(!0);let l=this.snapToGrid(o);this.tempLine.set([l.x,l.y,l.x,l.y])}break}case"add-item":{if(!this.activeFlexibleItemId())return;let l=this.snapToGrid(o);this.itemPlaced.emit({x:l.x,y:l.y});break}case"move":{if(s){this.startItemDrag(s,o);break}a&&(this.isDragging.set(!0),this.draggedWallId.set(a.id),this.dragStartPos.set({x:o.x,y:o.y}),this.draggedWallInitialCoords.set(a));break}case"delete":{if(s){this.items.update(l=>l.filter(c=>c.id!==s.id)),this.selectedItemId.set(null),this.itemDeleted.emit(s.id);break}a&&(this.walls.update(l=>l.filter(c=>c.id!==a.id)),this.selectedWallId.set(null),this.wallDeleted.emit(a.id));break}case"select":break}}onStageMouseMove(t){let i=t?.event?.target?.getStage();if(!i)return;let n=i.getPointerPosition();if(!n)return;let r=t.event.evt;if(this.isPanning()){let o=this.panStartPos(),s=this.panInitialStagePos();if(o&&s){let a=r.clientX-o.x,l=r.clientY-o.y;this.stagePositionChanged.emit({x:s.x+a,y:s.y+l})}return}if(this.drawingMode()==="draw"&&this.isDrawing()){let o=this.getCanvasPosition(n),s=this.snapToGrid(o),a=this.tempLine();a&&this.tempLine.set([a[0],a[1],s.x,s.y])}else if(this.drawingMode()==="move"){if(this.isItemDragging()){this.applyItemDragMovement(n);return}this.isDragging()&&this.applyWallDragMovement(n)}}onStageMouseUp(t){if(this.isPanning()){this.isPanning.set(!1),this.panStartPos.set(null),this.panInitialStagePos.set(null);return}if(this.drawingMode()==="move"&&this.isItemDragging()){this.finishItemDrag();return}this.drawingMode()==="move"&&this.isDragging()&&this.finishWallDrag()}onWallClick(t){this.drawingMode()==="select"&&(this.selectedWallId.set(t),this.selectedItemId.set(null),this.wallClicked.emit(t))}onWallMouseEnter(t){this.hoveredWallId.set(t),this.wallMouseEnter.emit(t)}onWallMouseLeave(){this.hoveredWallId.set(null),this.wallMouseLeave.emit()}onItemClick(t){this.drawingMode()==="select"&&(this.selectedItemId.set(t),this.selectedWallId.set(null),this.itemClicked.emit(t))}onItemMouseEnter(t){this.hoveredItemId.set(t)}onItemMouseLeave(){this.hoveredItemId.set(null)}startItemDrag(t,i){this.isItemDragging.set(!0),this.draggedItemId.set(t.id),this.itemDragStartPos.set({x:i.x,y:i.y}),this.draggedItemInitialPos.set({x:t.position_x??0,y:t.position_y??0})}applyItemDragMovement(t){let i=this.draggedItemId(),n=this.itemDragStartPos(),r=this.draggedItemInitialPos();if(!(i&&n&&r))return;let o=this.getCanvasPosition(t),s=o.x-n.x,a=o.y-n.y,l=this.snapToGrid({x:r.x+s,y:r.y+a});this.items.update(c=>c.map(d=>d.id===i?T(w({},d),{position_x:l.x,position_y:l.y}):d))}finishItemDrag(){let t=this.draggedItemId();if(t){let i=this.items().find(n=>n.id===t);if(i){let n=this.snapToGrid({x:i.position_x??0,y:i.position_y??0});this.items.update(r=>r.map(o=>o.id===t?T(w({},o),{position_x:n.x,position_y:n.y}):o)),this.itemMoved.emit({id:t,position_x:n.x,position_y:n.y})}}this.isItemDragging.set(!1),this.draggedItemId.set(null),this.itemDragStartPos.set(null),this.draggedItemInitialPos.set(null)}applyWallDragMovement(t){let i=this.draggedWallId(),n=this.dragStartPos(),r=this.draggedWallInitialCoords();if(!(i&&n&&r))return;let o=this.getCanvasPosition(t),s=o.x-n.x,a=o.y-n.y;this.walls.update(l=>l.map(c=>c.id===i?T(w({},c),{start_x:r.start_x+s,start_y:r.start_y+a,end_x:r.end_x+s,end_y:r.end_y+a}):c))}finishWallDrag(){let t=this.draggedWallId();if(t){let i=this.walls().find(n=>n.id===t);if(i){let n=this.snapToGrid({x:i.start_x,y:i.start_y}),r=this.snapToGrid({x:i.end_x,y:i.end_y});this.walls.update(o=>o.map(s=>s.id===t?T(w({},s),{start_x:n.x,start_y:n.y,end_x:r.x,end_y:r.y}):s)),this.wallMoved.emit({id:t,start_x:n.x,start_y:n.y,end_x:r.x,end_y:r.y})}}this.isDragging.set(!1),this.draggedWallId.set(null),this.dragStartPos.set(null),this.draggedWallInitialCoords.set(null)}snapToGrid(t){let i=this.gridSize();return{x:Math.round(t.x/i)*i,y:Math.round(t.y/i)*i}}getCanvasPosition(t){let i=this.zoom(),n=this.stagePosition();return{x:(t.x-n.x)/i,y:(t.y-n.y)/i}}getWallAtPosition(t){for(let n of this.walls())if(this.distanceToLineSegment(t,{x:n.start_x,y:n.start_y},{x:n.end_x,y:n.end_y})<10)return n;return null}getItemAtPosition(t){for(let i of this.items()){let n=i.position_x??0,r=i.position_y??0;if(t.x>=n-e.ITEM_RADIUS&&t.x<=n+e.ITEM_RADIUS&&t.y>=r-e.ITEM_RADIUS&&t.y<=r+e.ITEM_RADIUS)return i}return null}distanceToLineSegment(t,i,n){let r=n.x-i.x,o=n.y-i.y,s=r*r+o*o;if(s===0)return Math.sqrt((t.x-i.x)**2+(t.y-i.y)**2);let a=((t.x-i.x)*r+(t.y-i.y)*o)/s;a=Math.max(0,Math.min(1,a));let l=i.x+a*r,c=i.y+a*o;return Math.sqrt((t.x-l)**2+(t.y-c)**2)}getIconImage(t){return this.iconCache.get(t)||null}loadIconImage(t){if(this.iconCache.has(t))return;let i=Rs[t];if(!i){console.warn(`Icon ${t} not found in @ng-icons/lucide`);return}let r=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        ${i.data||i}
      </svg>
    `,o=new Blob([r],{type:"image/svg+xml"}),s=URL.createObjectURL(o),a=new Image;a.onload=()=>{this.iconCache.set(t,a),URL.revokeObjectURL(s),this.iconLoadingSignal.update(l=>l+1)},a.onerror=()=>{console.error(`Failed to load icon: ${t}`),URL.revokeObjectURL(s)},a.src=s}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-house-plan-canvas"]],inputs:{canvasWidth:[1,"canvasWidth"],canvasHeight:[1,"canvasHeight"],gridSize:[1,"gridSize"],drawingMode:[1,"drawingMode"],zoom:[1,"zoom"],stagePosition:[1,"stagePosition"],items:[1,"items"],activeFlexibleItemId:[1,"activeFlexibleItemId"],walls:[1,"walls"]},outputs:{items:"itemsChange",walls:"wallsChange",wallClicked:"wallClicked",wallMouseEnter:"wallMouseEnter",wallMouseLeave:"wallMouseLeave",zoomChanged:"zoomChanged",stagePositionChanged:"stagePositionChanged",wallCreated:"wallCreated",wallMoved:"wallMoved",wallDeleted:"wallDeleted",itemClicked:"itemClicked",itemMoved:"itemMoved",itemDeleted:"itemDeleted",itemPlaced:"itemPlaced"},decls:12,vars:4,consts:[[1,"bg-white","inline-block"],[3,"mousedown","mousemove","mouseup","config"],[3,"config"],[3,"click","mouseenter","mouseleave","config"]],template:function(i,n){i&1&&(A(0,"div",0)(1,"ko-stage",1),de("mousedown",function(o){return n.onStageMouseDown(o)})("mousemove",function(o){return n.onStageMouseMove(o)})("mouseup",function(o){return n.onStageMouseUp(o)}),A(2,"ko-layer"),On(3,Ple,1,1,"ko-line",2,Lh),I(),A(5,"ko-layer"),On(6,kle,1,1,"ko-line",2,Ele),Ve(8,_le,1,5,"ko-line",2),I(),A(9,"ko-layer"),On(10,Fle,4,16,"ko-group",2,Rle),I()()()),i&2&&(zr("cursor",n.cursorStyle()),L(),ve("config",n.stageConfig()),L(2),Ln(n.gridLines()),L(3),Ln(n.wallLines()),L(2),Ge(n.tempLine()?8:-1),L(2),Ln(n.itemShapes()))},dependencies:[gn,b7,e0],encapsulation:2,changeDetection:0})};var IS=(()=>{class e{constructor(){M2(()=>"block")}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,selectors:[["ng-scrollbar","hlm",""],["ng-scrollbar","hlmScrollbar",""]],hostAttrs:["data-slot","scroll-area"],hostVars:10,hostBindings:function(n,r){n&2&&zr("--scrollbar-border-radius","100px")("--scrollbar-offset",3)("--scrollbar-thumb-color","var(--border)")("--scrollbar-thumb-hover-color","var(--border)")("--scrollbar-thickness",7)}})}return e})();var Tle=4,Ile=.001,Ale=1e-7,Ole=10,vh=11,i0=1/(vh-1),Lle=typeof Float32Array=="function";function y7(e,t){return 1-3*t+3*e}function S7(e,t){return 3*t-6*e}function x7(e){return 3*e}function n0(e,t,i){return((y7(t,i)*e+S7(t,i))*e+x7(t))*e}function E7(e,t,i){return 3*y7(t,i)*e*e+2*S7(t,i)*e+x7(t)}function Nle(e,t,i,n,r){let o,s,a=0;do s=t+(i-t)/2,o=n0(s,n,r)-e,o>0?i=s:t=s;while(Math.abs(o)>Ale&&++a<Ole);return s}function Ble(e,t,i,n){for(let r=0;r<Tle;++r){let o=E7(t,i,n);if(o===0)return t;let s=n0(t,i,n)-e;t-=s/o}return t}function Hle(e){return e}function zle(e,t,i,n){if(!(0<=e&&e<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&i===n)return Hle;let r=Lle?new Float32Array(vh):new Array(vh);for(let s=0;s<vh;++s)r[s]=n0(s*i0,e,i);function o(s){let a=0,l=1,c=vh-1;for(;l!==c&&r[l]<=s;++l)a+=i0;--l;let d=(s-r[l])/(r[l+1]-r[l]),u=a+d*i0,h=E7(u,e,i);return h>=Ile?Ble(s,u,e,i):h===0?u:Nle(s,a,a+i0,e,i)}return function(a){return a===0?0:a===1?1:n0(o(a),t,n)}}var Vle={duration:468,easing:{x1:.42,y1:0,x2:.58,y2:1}},Gle=new pn("SMOOTH_SCROLL_OPTIONS",{providedIn:"root",factory:()=>Vle});var R7=(()=>{class e{document=ce(So);zone=ce(Ni);_defaultOptions=ce(Gle);onGoingScrolls=new Map;get now(){return this.document.defaultView.performance?.now?.bind(this.document.defaultView.performance)||Date.now}scrollElement(i,n,r){i.scrollLeft=n,i.scrollTop=r}getElement(i,n){return typeof i=="string"?(n||this.document).querySelector(i):Hn(i)}getScrollDestroyerRef(i){return this.onGoingScrolls.has(i)&&this.onGoingScrolls.get(i).next(),this.onGoingScrolls.set(i,new yt).get(i)}step(i){return new Pc(n=>{let r=(this.now()-i.startTime)/i.duration;r=r>1?1:r;let o=i.easing(r);i.currentX=i.startX+(i.x-i.startX)*o,i.currentY=i.startY+(i.y-i.startY)*o,this.scrollElement(i.scrollable,i.currentX,i.currentY),requestAnimationFrame(()=>{n.next(),n.complete()})})}isReached(i,n){return i.currentX===i.x&&i.currentY===i.y?(n.next(),!0):!1}scrolling(i,n){return this.step(i).pipe(_c(()=>!this.isReached(i,n)),Ji(()=>this.scrolling(i,n)))}onScrollReached(i,n,r){r.complete(),this.onGoingScrolls.delete(i),this.zone.run(()=>n())}interrupted(i,n){return yo(Ri(i,"wheel",{passive:!0,capture:!0}),Ri(i,"touchmove",{passive:!0,capture:!0}),n).pipe(Th(1))}applyScrollToOptions(i,n){return n.duration?new Promise(r=>{this.zone.runOutsideAngular(()=>{let o=this.getScrollDestroyerRef(i),s={scrollable:i,startTime:this.now(),startX:i.scrollLeft,startY:i.scrollTop,x:n.left==null?i.scrollLeft:~~n.left,y:n.top==null?i.scrollTop:~~n.top,duration:n.duration,easing:zle(n.easing.x1,n.easing.y1,n.easing.x2,n.easing.y2)};this.scrolling(s,o).pipe(Qi(this.interrupted(i,o)),Je(()=>this.onScrollReached(i,r,o))).subscribe()})}):(this.scrollElement(i,n.left,n.top),Promise.resolve())}scrollTo(i,n){let r=this.getElement(i),o=getComputedStyle(r).direction==="rtl",s=T(w(w({},this._defaultOptions),n),{left:n.left==null?o?n.end:n.start:n.left,right:n.right==null?o?n.start:n.end:n.right});return s.bottom!=null&&(s.top=r.scrollHeight-r.clientHeight-s.bottom),o?(s.left!=null&&(s.right=r.scrollWidth-r.clientWidth-s.left),s.left=s.right?-s.right:s.right):s.right!=null&&(s.left=r.scrollWidth-r.clientWidth-s.right),this.applyScrollToOptions(r,s)}scrollToElement(i,n,r={}){let o=this.getElement(i),s=this.getElement(n,o),a=getComputedStyle(o).direction==="rtl";if(!s||!o)return Promise.resolve();let l=o.getBoundingClientRect(),c=s.getBoundingClientRect(),d=T(w(w({},this._defaultOptions),r),{top:c.top+o.scrollTop-l.top+(r.top||0),left:r.left==null?a?r.end:r.start:r.left,right:r.right==null?a?r.start:r.end:r.right});if(r.center){let h=l.left+l.width/2,p=l.top+l.height/2,f=c.left+c.width/2,g=c.top+c.height/2;return d.left=f-h+o.scrollLeft,d.top=g-p+o.scrollTop,this.applyScrollToOptions(o,d)}if(d.bottom!=null){let h=l.height-c.height;d.top=c.top+o.scrollTop-l.top-h+(r.bottom||0)}d.left=c.left-l.left+o.scrollLeft+(d.left||0),d.right!=null&&(d.left=c.right-l.left+o.scrollLeft-l.width+(d.right||0));let u={top:d.top,left:d.left,easing:d.easing,duration:d.duration};return this.applyScrollToOptions(o,u)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Jn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var o0=["*"],Wle="[_nghost-%COMP%]{position:relative;width:100%;height:100%;cursor:default;z-index:1;order:2}",Ule="[_nghost-%COMP%]{--_thumb-size-percent: var(--_fixed-thumb-size-percent, max(var(--_thumb-size-percent-raw), var(--_min-thumb-size-percent)));--_effective-thumb-ratio: calc(var(--_thumb-size-percent) / 100);--_scrollbar-thumb-transform-to-value: calc((100 / var(--_effective-thumb-ratio) - 100) * 1%);box-sizing:border-box;position:absolute;background:var(--_scrollbar-thumb-color);transition:var(--scrollbar-thumb-transition, none);border-radius:var(--scrollbar-thumb-shape, inherit);will-change:transform;animation-name:_ngcontent-%COMP%_scrollbarThumbAnimation;animation-duration:1ms;animation-timing-function:linear;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]:hover{background:var(--_scrollbar-thumb-hover-color)}[_nghost-%COMP%]:active{background:var(--_scrollbar-thumb-active-color)}@keyframes _ngcontent-%COMP%_scrollbarThumbAnimation{0%{translate:var(--_scrollbar-thumb-transform-from)}to{translate:var(--_scrollbar-thumb-transform-to)}}",jle=["scrollbarButton",""];function qle(e,t){if(e&1&&le(0,"button",2)(1,"button",3),e&2){let i=te();Vr(Wr("ng-scrollbar-button ",i.cmp.buttonClass())),ve("disabled",!i.cmp.isVerticallyScrollable()),L(),Vr(Wr("ng-scrollbar-button ",i.cmp.buttonClass())),ve("disabled",!i.cmp.isVerticallyScrollable())}}function $le(e,t){if(e&1&&le(0,"button",2)(1,"button",3),e&2){let i=te();Vr(Wr("ng-scrollbar-button ",i.cmp.buttonClass())),ve("disabled",!i.cmp.isHorizontallyScrollable()),L(),Vr(Wr("ng-scrollbar-button ",i.cmp.buttonClass())),ve("disabled",!i.cmp.isHorizontallyScrollable())}}var Kle="[_nghost-%COMP%]{display:block;height:var(--_scrollbar-wrapper-height);width:var(--_scrollbar-wrapper-width);position:sticky;z-index:100;opacity:var(--_scrollbar-hover-opacity);transition:var(--_scrollbar-opacity-transition);background:var(--scrollbar-container-color, transparent);border-radius:var(--scrollbar-container-shape, 0px)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{touch-action:none;-webkit-user-select:none;user-select:none;gap:var(--scrollbar-button-gap, 0px);inset-block-start:var(--_scrollbar-track-inset-block-start);inset-block-end:var(--_scrollbar-track-inset-block-end);inset-inline-start:var(--_scrollbar-track-inset-inline-start);inset-inline-end:var(--_scrollbar-track-inset-inline-end);transition:var(--scrollbar-track-wrapper-transition, width 60ms linear, height 60ms linear);position:absolute;overflow:hidden;display:flex;place-items:center}.track-inner[_ngcontent-%COMP%]{position:absolute;border-radius:var(--scrollbar-track-shape, 0);background:var(--scrollbar-track-color, rgba(128, 128, 128, .5))}";function Yle(e,t){e&1&&le(0,"scrollbar-y")}function Xle(e,t){e&1&&le(0,"scrollbar-x")}var Jle='[_nghost-%COMP%]{--_scrollbar-track-thickness-px: var(--scrollbar-track-thickness, 7px);--_scrollbar-container-offset-px: var(--scrollbar-container-offset, 0px);--_scrollbar-total-thickness-px: calc(var(--_scrollbar-track-thickness-px) + var(--_scrollbar-container-offset-px) * 2);--_scrollbar-thumb-min-size: var(--scrollbar-thumb-min-size, 20);position:relative!important;box-sizing:border-box!important;padding:0!important;-webkit-overflow-scrolling:touch;will-change:scroll-position}[_nghost-%COMP%]    >.ng-scroll-spacer{position:absolute;inset-block-start:0;inset-inline-start:0;width:calc(var(--_spacer-width) * 1px);height:calc(var(--_spacer-height) * 1px);min-width:100%;min-height:100%}[_nghost-%COMP%]{scrollbar-width:none!important}[_nghost-%COMP%]::-webkit-scrollbar{display:none!important}[_nghost-%COMP%]{--_viewport-overflow: auto;--_scrollbar-content-width: fit-content;overflow:var(--_viewport-overflow)}[orientation=vertical][_nghost-%COMP%]{--_viewport-overflow: hidden auto;--_scrollbar-content-width: unset}[orientation=horizontal][_nghost-%COMP%]{--_viewport-overflow: auto hidden}[_nghost-%COMP%]{--_vertical-inset-block-start: var(--_scrollbar-container-offset-px);--_vertical-inset-block-end: var(--_scrollbar-container-offset-px);--_horizontal-inline-start: var(--_scrollbar-container-offset-px);--_horizontal-inline-end: var(--_scrollbar-container-offset-px);--_scrollbar-grid-template: ". scrollbar-y" 1fr "scrollbar-x ." auto / 1fr auto;--_scrollbar-wrapper-y-start: initial;--_scrollbar-wrapper-y-end: 0;--_scrollbar-wrapper-x-top: initial;--_scrollbar-wrapper-x-bottom: 0}[position=invertY][_nghost-%COMP%]{--_scrollbar-grid-template: "scrollbar-y ." 1fr ". scrollbar-x" auto / auto 1fr}[position=invertX][_nghost-%COMP%]{--_scrollbar-grid-template: "scrollbar-x ." auto ". scrollbar-y" 1fr / 1fr auto}[position=invertAll][_nghost-%COMP%]{--_scrollbar-grid-template: ". scrollbar-x" auto "scrollbar-y ." 1fr / auto 1fr }[_nghost-%COMP%]{--_horizontal-block-start: initial;--_horizontal-block-end: var(--_scrollbar-container-offset-px)}[_nghost-%COMP%]:is([position=invertX],[position=invertAll]){--_horizontal-block-start: var(--_scrollbar-container-offset-px);--_horizontal-block-end: initial;--_scrollbar-wrapper-x-top: 0;--_scrollbar-wrapper-x-bottom: initial}[_nghost-%COMP%]{--_vertical-inset-inline-end: var(--_scrollbar-container-offset-px);--_vertical-inset-inline-start: initial}[_nghost-%COMP%]:is([position=invertY],[position=invertAll]){--_vertical-inset-inline-start: var(--_scrollbar-container-offset-px);--_vertical-inset-inline-end: initial;--_scrollbar-wrapper-y-start: 0;--_scrollbar-wrapper-y-end: initial}[verticalUsed=true][horizontalUsed=true][_nghost-%COMP%]{--_scrollbar-thickness-margin-px: calc(var(--_scrollbar-track-thickness-px) + var(--_scrollbar-container-offset-px) * 3)}[horizontalUsed=true][_nghost-%COMP%]{--_vertical-inset-block-start: var(--_scrollbar-container-offset-px);--_vertical-inset-block-end: var(--_scrollbar-thickness-margin-px)}[horizontalUsed=true][_nghost-%COMP%]:is([position=invertX],[position=invertAll]){--_vertical-inset-block-start: var(--_scrollbar-thickness-margin-px);--_vertical-inset-block-end: var(--_scrollbar-container-offset-px)}[verticalUsed=true][_nghost-%COMP%]{--_horizontal-inline-start: var(--_scrollbar-container-offset-px);--_horizontal-inline-end: var(--_scrollbar-thickness-margin-px)}[verticalUsed=true][_nghost-%COMP%]:is([position=invertY],[position=invertAll]){--_horizontal-inline-start: var(--_scrollbar-thickness-margin-px);--_horizontal-inline-end: var(--_scrollbar-container-offset-px)}[_nghost-%COMP%]{--_viewport-padding-block-start: 0;--_viewport-padding-block-end: 0;--_viewport-padding-inline-start: 0;--_viewport-padding-inline-end: 0}[appearance=native][verticalUsed=true][_nghost-%COMP%]{--_viewport-padding-inline-start: 0;--_viewport-padding-inline-end: var(--_scrollbar-total-thickness-px)}[appearance=native][verticalUsed=true][_nghost-%COMP%]:is([position=invertY],[position=invertAll]){--_viewport-padding-inline-start: var(--_scrollbar-total-thickness-px);--_viewport-padding-inline-end: 0}[appearance=native][horizontalUsed=true][_nghost-%COMP%]{--_viewport-padding-block-start: 0;--_viewport-padding-block-end: var(--_scrollbar-total-thickness-px)}[appearance=native][horizontalUsed=true][_nghost-%COMP%]:is([position=invertX],[position=invertAll]){--_viewport-padding-block-start: var(--_scrollbar-total-thickness-px);--_viewport-padding-block-end: 0}[_nghost-%COMP%]{--_horizontal-thumb-display: block;--_vertical-thumb-display: block}[isVerticallyScrollable=false][_nghost-%COMP%]{--_vertical-thumb-display: none}[isHorizontallyScrollable=false][_nghost-%COMP%]{--_horizontal-thumb-display: none}[visibility=hover][_nghost-%COMP%]{--_scrollbar-hover-opacity: 0;--_scrollbar-opacity-transition: opacity var(--scrollbar-hover-opacity-transition-leave-duration, .4s) var(--scrollbar-hover-opacity-transition-leave-delay, 1s)}[visibility=hover][scrolling=true][_nghost-%COMP%], [visibility=hover][_nghost-%COMP%]:hover, [visibility=hover][_nghost-%COMP%]:active, [visibility=hover][_nghost-%COMP%]:focus{--_scrollbar-hover-opacity: 1;--_scrollbar-opacity-transition: opacity var(--scrollbar-hover-opacity-transition-enter-duration, 0)}[_nghost-%COMP%]{--_viewport_scroll-timeline: unset;--_animation-timeline-y: unset;--_scrollbar-thumb-transform-from: unset;--_scrollbar-thumb-transform-to: unset}[verticalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerY;--_animation-timeline-y: --scrollerY;--_viewport_scroll-timeline: --scrollerY y}[horizontalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerX;--_animation-timeline-x: --scrollerX;--_viewport_scroll-timeline: --scrollerX x}[verticalUsed=true][horizontalUsed=true][_nghost-%COMP%]{--_timeline-scope: --scrollerX, --scrollerY;--_viewport_scroll-timeline: --scrollerX x, --scrollerY y}[_nghost-%COMP%]{scroll-timeline:var(--_viewport_scroll-timeline);--_scrollbar-hover-thickness-px: var(--scrollbar-track-hover-thickness, var(--_scrollbar-track-thickness-px));--_scrollbar-active-thickness-px: var(--scrollbar-track-active-thickness, var(--_scrollbar-hover-thickness-px));--_track-y-thickness-px: var(--_scrollbar-track-thickness-px);--_track-x-thickness-px: var(--_scrollbar-track-thickness-px);-webkit-user-select:var(--_viewport-user-select);user-select:var(--_viewport-user-select)}[dragging=x][_nghost-%COMP%], [dragging=y][_nghost-%COMP%]{--_viewport-user-select: none}[dragging=x][_nghost-%COMP%]{--_track-x-thickness-px: var(--_scrollbar-active-thickness-px)}[dragging=y][_nghost-%COMP%]{--_track-y-thickness-px: var(--_scrollbar-active-thickness-px)}[_nghost-%COMP%]{overscroll-behavior:var(--scrollbar-overscroll-behavior, initial)}[mobile=true][_nghost-%COMP%]{overscroll-behavior:var(--scrollbar-mobile-overscroll-behavior, none)}[_nghost-%COMP%]{--_viewport-pointer-events: auto;--_scrollbar-y-pointer-events: auto;--_scrollbar-x-pointer-events: auto;pointer-events:var(--_viewport-pointer-events)}[disableInteraction=true][_nghost-%COMP%]{--_viewport-pointer-events: none;--_scrollbar-y-pointer-events: none;--_scrollbar-x-pointer-events: none}[isVerticallyScrollable=false][_nghost-%COMP%]{--_scrollbar-y-pointer-events: none}[isHorizontallyScrollable=false][_nghost-%COMP%]{--_scrollbar-x-pointer-events: none}[_nghost-%COMP%]{--_scrollbar-thumb-color: var(--scrollbar-thumb-color, #1e90ff);--_scrollbar-thumb-hover-color: var(--scrollbar-thumb-hover-color, var(--_scrollbar-thumb-color));--_scrollbar-thumb-active-color: var(--scrollbar-thumb-active-color, var(--_scrollbar-thumb-hover-color));--_scrollbar-button-color: var(--scrollbar-button-color, transparent);--_scrollbar-button-hover-color: var(--scrollbar-button-hover-color, var(--_scrollbar-button-color));--_scrollbar-button-active-color: var(--scrollbar-button-active-color, var(--_scrollbar-button-hover-color));--_scrollbar-button-inactive-color: var(--scrollbar-button-inactive-color, color-mix(in srgb, var(--_scrollbar-button-color), #000 35%));--_scrollbar-button-fill: var(--scrollbar-button-fill, var(--_scrollbar-thumb-color));--_scrollbar-button-hover-fill: var(--scrollbar-button-hover-fill, var(--_scrollbar-thumb-hover-color));--_scrollbar-button-active-fill: var(--scrollbar-button-active-fill, var(--_scrollbar-thumb-active-color));--_scrollbar-button-inactive-fill: var(--scrollbar-button-inactive-fill, color-mix(in srgb, var(--_scrollbar-button-fill), #000 35%))}@layer default{[_nghost-%COMP%]{display:block;max-height:100%;max-width:100%}}';var Ch=[];function Qle(e){let t=e.getSelection();if(Ch=[],!!t?.rangeCount)for(let i=0;i<t.rangeCount;i++)Ch.push(t.getRangeAt(i).cloneRange())}function Zle(e){if(!Ch?.length)return;let t=e.getSelection();t.removeAllRanges(),Ch.forEach(i=>t.addRange(i)),Ch=[]}function LS(e){return hn(()=>{Qle(e),e.getSelection()?.removeAllRanges(),e.onselectstart=()=>!1})}function NS(e){return hn(()=>{Zle(e),e.onselectstart=null})}function wh(){return hn(e=>e.stopPropagation())}function ece(e,t){return t?e.pipe(w2(t,null,{leading:!1,trailing:!0})):e}var k7=(function(e){return e.Viewport="ng-scroll-viewport",e.Content="ng-scroll-content",e.Spacer="ng-scroll-spacer",e})(k7||{}),tce={trackClass:"",thumbClass:"",buttonClass:"",orientation:"auto",appearance:"native",visibility:"native",position:"native",trackScrollDuration:50,sensorThrottleTime:0,disableSensor:!1,disableInteraction:!1,withButtons:!1,hoverOffset:!1,scrollHideDelay:400,scrollThrottleTime:200},ice="https://cdn.jsdelivr.net/gh/MurhafSousli/ngx-scrollbar@19.1.0/projects/ngx-scrollbar/src/assets/scroll-timeline-polyfill.js",OS=(function(e){return e.AfterInit="AfterInit",e.Resized="ResizeObserver",e})(OS||{}),nce=new pn("NG_SCROLLBAR_OPTIONS",{providedIn:"root",factory:()=>tce}),rce=new pn("NG_SCROLLBAR_POLYFILL",{providedIn:"root",factory:()=>ice}),oce=(()=>{class e{options=ce(nce);orientation=De(this.options.orientation);visibility=De(this.options.visibility);withButtons=De(this.options.withButtons,{transform:H});disableInteraction=De(this.options.disableInteraction,{transform:H});disableSensor=De(this.options.disableSensor,{transform:H});sensorThrottleTime=De(this.options.sensorThrottleTime,{transform:Bc});hoverOffset=De(this.options.hoverOffset,{transform:H});trackScrollDuration=De(this.options.trackScrollDuration,{transform:Bc});appearance=De(this.options.appearance);position=De(this.options.position);trackClass=De(this.options.trackClass);thumbClass=De(this.options.thumbClass);buttonClass=De(this.options.thumbClass);afterInit=Ce();afterUpdate=Ce();static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,inputs:{orientation:[1,"orientation"],visibility:[1,"visibility"],withButtons:[1,"withButtons"],disableInteraction:[1,"disableInteraction"],disableSensor:[1,"disableSensor"],sensorThrottleTime:[1,"sensorThrottleTime"],hoverOffset:[1,"hoverOffset"],trackScrollDuration:[1,"trackScrollDuration"],appearance:[1,"appearance"],position:[1,"position"],trackClass:[1,"trackClass"],thumbClass:[1,"thumbClass"],buttonClass:[1,"buttonClass"]},outputs:{afterInit:"afterInit",afterUpdate:"afterUpdate"}})}return e})(),P7={width:0,height:0},Sh=(()=>{class e extends oce{smoothScroll=ce(R7);dir=ce(zc);direction=F2(this.dir.change,{initialValue:this.dir.value});dragging=xe("none");state=Ie(()=>{let i=!1,n=!1,r=!1,o=!1,s=this.orientation(),a=this.visibility(),l=this.viewportDimension(),c=this.contentDimension();return(s==="auto"||s==="vertical")&&(r=c.height>l.height,i=a==="visible"||r),(s==="auto"||s==="horizontal")&&(o=c.width>l.width,n=a==="visible"||o),{verticalUsed:i,horizontalUsed:n,isVerticallyScrollable:r,isHorizontallyScrollable:o}});isVerticallyScrollable=Ie(()=>this.state().isVerticallyScrollable);isHorizontallyScrollable=Ie(()=>this.state().isHorizontallyScrollable);verticalUsed=Ie(()=>this.state().verticalUsed);horizontalUsed=Ie(()=>this.state().horizontalUsed);viewportDimension=xe(P7);contentDimension=xe(P7);viewportElement;contentWrapperElement;initialized=xe(!1);get clientHeight(){return this.viewportElement.clientHeight}get clientWidth(){return this.viewportElement.clientWidth}get scrollTop(){return this.viewportElement.scrollTop}get scrollLeft(){return this.viewportElement.scrollLeft}get contentHeight(){return this.contentWrapperElement.clientHeight}get contentWidth(){return this.contentWrapperElement.clientWidth}get scrollMaxX(){return this.contentWidth-this.clientWidth}get scrollMaxY(){return this.contentHeight-this.clientHeight}init(i,n,r){this.viewportElement=i,r?(r.classList.add(k7.Spacer),this.contentWrapperElement=r):this.contentWrapperElement=n,this.initialized.set(!0)}reset(){this.viewportElement=null,this.contentWrapperElement=null,this.initialized.set(!1)}scrollYTo(i){this.viewportElement.scrollTop=i}scrollXTo(i){this.viewportElement.scrollLeft=i}scrollTo(i){return this.smoothScroll.scrollTo(this.viewportElement,i)}scrollToElement(i,n){return this.smoothScroll.scrollToElement(this.viewportElement,i,n)}static \u0275fac=(()=>{let i;return function(r){return(i||(i=xo(e)))(r||e)}})();static \u0275dir=Pi({type:e,features:[fn]})}return e})(),AS=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["ng-scroll-content"]],hostVars:2,hostBindings:function(n,r){n&2&&At("ng-scroll-content",!0)},ngContentSelectors:o0,decls:1,vars:0,template:function(n,r){n&1&&(Eo(),Ro(0))},styles:["[_nghost-%COMP%]{box-sizing:border-box;width:var(--_scrollbar-content-width);z-index:1;min-width:100%;min-height:100%;padding-block-start:var(--_viewport-padding-block-start, 0);padding-block-end:var(--_viewport-padding-block-end, 0);padding-inline-start:var(--_viewport-padding-inline-start, 0);padding-inline-end:var(--_viewport-padding-inline-end, 0)}@layer default{[_nghost-%COMP%]{position:relative}[_nghost-%COMP%]:not(table){display:flow-root}}"],changeDetection:0})}return e})(),BS=new pn("SCROLLBAR_CONTROL"),_7=(()=>{class e{cmp=ce(Sh);static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,hostVars:4,hostBindings:function(n,r){n&2&&At("ng-scrollbar-sticky",!0)("ng-scrollbar-hover",r.cmp.hoverOffset())}})}return e})(),D7=(()=>{class e{_polyfillUrl=ce(rce);document=ce(So);window=this.document.defaultView;scrollTimelinePolyfill=xe(null);constructor(){Oh({earlyRead:()=>{(!this.window.ScrollTimeline||!CSS.supports("animation-timeline","scroll()"))&&this.initPolyfill()}})}async initPolyfill(){try{let i=this.document.createElement("script");i.src=this._polyfillUrl,i.async=!0,await new Promise((n,r)=>{i.onload=n,i.onerror=r,this.document.head.appendChild(i)}),this.window.ScrollTimeline?this.scrollTimelinePolyfill.set(this.window.ScrollTimeline):console.error("[NgScrollbar]: Polyfill script loaded but ScrollTimeline not found.")}catch(i){console.error("[NgScrollbar]: Error loading ScrollTimeline script:",i)}}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Jn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),bh=class{adapter=ce(Sh);control=ce(BS);document=ce(So);zone=ce(Ni);nativeElement=ce(ci).nativeElement;_pointerEventsSub;constructor(){ht(t=>{let i=this.adapter.disableInteraction();Aa(()=>{i||this.zone.runOutsideAngular(()=>{this._pointerEventsSub=this.pointerEvents.subscribe()}),t(()=>this._pointerEventsSub?.unsubscribe())})})}},yh=(()=>{class e extends bh{pointerOut$=Ri(this.nativeElement,"pointerout",{passive:!0});currMousePosition;scrollDirection;scrollMax;get viewportSize(){return this.adapter[this.control.sizeProperty]}get clientRect(){return this.nativeElement.getBoundingClientRect()}get offset(){return this.clientRect[this.control.rectOffsetProperty]}get size(){return this.nativeElement[this.control.sizeProperty]}get pointerEvents(){let i=Ri(this.nativeElement,"pointerdown").pipe(wh(),LS(this.document)),n=Ri(this.document,"pointerup",{passive:!0}).pipe(NS(this.document)),r=Ri(this.nativeElement,"pointerover",{passive:!0}).pipe(hn(s=>this.currMousePosition=this.getPointerPosition(s)),kc({})),o=Ri(this.nativeElement,"pointermove",{passive:!0}).pipe(hn(s=>this.currMousePosition=this.getPointerPosition(s)));return i.pipe(Ji(s=>(o.pipe(Qi(n)).subscribe(),this.onTrackFirstClick(s).pipe(v0(200),Ji(()=>r.pipe(C2(()=>this.scrollDirection===this.getScrollDirection(this.currMousePosition)),Ji(()=>this.onTrackOngoingMousedown()))),Qi(n)))))}constructor(){super()}getPointerPosition(i){return i[this.control.clientProperty]-this.offset}onTrackFirstClick(i){return this.currMousePosition=this.getPointerPosition(i),this.scrollDirection=this.getScrollDirection(this.currMousePosition),this.scrollMax=this.control.viewportScrollMax,this.scrollTo(this.nextStep())}nextStep(){if(this.scrollDirection==="forward"){let n=this.getScrollForwardStep();return n>=this.scrollMax?this.scrollMax:n}let i=this.getScrollBackwardStep();return i<=0?0:i}onTrackOngoingMousedown(){let i=this.nextStep();return this.scrollTo(i).pipe(Qi(this.pointerOut$),_c(()=>!this.isReached(i)),Ji(()=>this.onTrackOngoingMousedown()))}isReached(i){return this.scrollDirection==="forward"?i>=this.scrollMax:i<=0}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,features:[fn]})}return e})(),sce=(()=>{class e extends yh{get contentSize(){return this.adapter.contentHeight}getThumbStartPosition(){return this.control.viewportScrollOffset*this.size/this.contentSize}getThumbEndPosition(){return(this.control.viewportScrollOffset+this.viewportSize)*this.size/this.contentSize}getScrollDirection(i){return i>this.getThumbEndPosition()?"forward":i<this.getThumbStartPosition()?"backward":null}scrollTo(i){return je(this.adapter.scrollTo({top:i,duration:this.adapter.trackScrollDuration()}))}getScrollForwardStep(){return this.control.viewportScrollOffset+this.viewportSize}getScrollBackwardStep(){return this.control.viewportScrollOffset-this.viewportSize}static \u0275fac=(()=>{let i;return function(r){return(i||(i=xo(e)))(r||e)}})();static \u0275cmp=Ae({type:e,selectors:[["scrollbar-track-y"]],features:[it([{provide:yh,useExisting:e}]),fn],ngContentSelectors:o0,decls:1,vars:0,template:function(n,r){n&1&&(Eo(),Ro(0))},styles:["[_nghost-%COMP%]{position:relative;width:100%;height:100%;cursor:default;z-index:1;order:2}"],changeDetection:0})}return e})(),ace=(()=>{class e extends yh{get contentSize(){return this.adapter.contentWidth}getThumbStartPosition;getThumbEndPosition;getScrollDirection;constructor(){ht(()=>{this.adapter.direction()==="rtl"?(this.getThumbStartPosition=()=>(this.contentSize-this.viewportSize-this.control.viewportScrollOffset)*this.size/this.contentSize,this.getThumbEndPosition=()=>(this.contentSize-this.control.viewportScrollOffset)*this.size/this.contentSize,this.getScrollDirection=i=>i<this.getThumbStartPosition()?"forward":i>this.getThumbEndPosition()?"backward":null):(this.getThumbStartPosition=()=>this.control.viewportScrollOffset*this.size/this.contentSize,this.getThumbEndPosition=()=>(this.control.viewportScrollOffset+this.viewportSize)*this.size/this.contentSize,this.getScrollDirection=i=>i>this.getThumbEndPosition()?"forward":i<this.getThumbStartPosition()?"backward":null)}),super()}scrollTo(i){return je(this.adapter.scrollTo({start:i,duration:this.adapter.trackScrollDuration()}))}getScrollForwardStep(){return this.control.viewportScrollOffset+this.viewportSize}getScrollBackwardStep(){return this.control.viewportScrollOffset-this.viewportSize}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["scrollbar-track-x"]],features:[it([{provide:yh,useExisting:e}]),fn],ngContentSelectors:o0,decls:1,vars:0,template:function(n,r){n&1&&(Eo(),Ro(0))},styles:[Wle],changeDetection:0})}return e})(),r0=(()=>{class e extends bh{manager=ce(D7);track=ce(yh);_animation;get size(){return this.nativeElement.getBoundingClientRect()[this.control.rectSizeProperty]}get trackMax(){return this.track.size-this.size}get pointerEvents(){return Ri(this.nativeElement,"pointerdown").pipe(wh(),LS(this.document),Ji(i=>{let n,r,o=Ye(i).pipe(hn(()=>{n=this.trackMax,r=this.control.viewportScrollMax,this.setDragging(this.control.axis)})),s=Ri(this.document,"pointermove").pipe(wh()),a=Ri(this.document,"pointerup",{capture:!0}).pipe(wh(),NS(this.document),hn(()=>this.setDragging("none")));return o.pipe(xs(l=>l[this.control.offsetProperty]),Ji(l=>s.pipe(xs(c=>c[this.control.clientProperty]),xs(c=>c-this.track.offset),xs(c=>r*(c-l)/n),hn(c=>this.control.instantScrollTo(c,r)),Qi(a))))}))}constructor(){R0({earlyRead:()=>{let i=this.manager.scrollTimelinePolyfill();Aa(()=>{i&&!this._animation&&(this._animation=lce(i,this.nativeElement,this.adapter.viewportElement,this.control.axis))})}}),super()}setDragging(i){this.zone.run(()=>this.adapter.dragging.set(i))}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,features:[fn]})}return e})();function lce(e,t,i,n){return t.animate({translate:["var(--_scrollbar-thumb-transform-from)","var(--_scrollbar-thumb-transform-to)"]},{fill:"both",easing:"linear",timeline:new e({source:i,axis:n})})}var cce=(()=>{class e extends r0{static \u0275fac=(()=>{let i;return function(r){return(i||(i=xo(e)))(r||e)}})();static \u0275cmp=Ae({type:e,selectors:[["scrollbar-thumb-y"]],features:[it([{provide:r0,useExisting:e}]),fn],decls:0,vars:0,template:function(n,r){},styles:["[_nghost-%COMP%]{--_thumb-size-percent: var(--_fixed-thumb-size-percent, max(var(--_thumb-size-percent-raw), var(--_min-thumb-size-percent)));--_effective-thumb-ratio: calc(var(--_thumb-size-percent) / 100);--_scrollbar-thumb-transform-to-value: calc((100 / var(--_effective-thumb-ratio) - 100) * 1%);box-sizing:border-box;position:absolute;background:var(--_scrollbar-thumb-color);transition:var(--scrollbar-thumb-transition, none);border-radius:var(--scrollbar-thumb-shape, inherit);will-change:transform;animation-name:_ngcontent-%COMP%_scrollbarThumbAnimation;animation-duration:1ms;animation-timing-function:linear;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]:hover{background:var(--_scrollbar-thumb-hover-color)}[_nghost-%COMP%]:active{background:var(--_scrollbar-thumb-active-color)}@keyframes _ngcontent-%COMP%_scrollbarThumbAnimation{0%{translate:var(--_scrollbar-thumb-transform-from)}to{translate:var(--_scrollbar-thumb-transform-to)}}","[_nghost-%COMP%]{animation-timeline:var(--_animation-timeline-y);display:var(--_vertical-thumb-display);height:calc(var(--_thumb-size-percent) * 1%);width:100%;--_thumb-size-percent-raw: calc(var(--viewport-height) / var(--content-height) * 100);--_min-thumb-size-percent: calc(var(--_scrollbar-thumb-min-size) / var(--viewport-height) * 100);--_fixed-thumb-size-percent: calc(var(--scrollbar-thumb-size) / var(--viewport-height) * 100);--_scrollbar-thumb-transform-from: 0 0;--_scrollbar-thumb-transform-to: 0 var(--_scrollbar-thumb-transform-to-value)}"],changeDetection:0})}return e})(),dce=(()=>{class e extends r0{static \u0275fac=(()=>{let i;return function(r){return(i||(i=xo(e)))(r||e)}})();static \u0275cmp=Ae({type:e,selectors:[["scrollbar-thumb-x"]],features:[it([{provide:r0,useExisting:e}]),fn],decls:0,vars:0,template:function(n,r){},styles:[Ule,"[_nghost-%COMP%]{animation-timeline:var(--_animation-timeline-x);display:var(--_horizontal-thumb-display);height:100%;width:calc(var(--_thumb-size-percent) * 1%);--_thumb-size-percent-raw: calc(var(--viewport-width) / var(--content-width) * 100);--_min-thumb-size-percent: calc(var(--_scrollbar-thumb-min-size) / var(--viewport-width) * 100);--_fixed-thumb-size-percent: calc(var(--scrollbar-thumb-size) / var(--viewport-width) * 100);--_scrollbar-thumb-transform-from: 0;--_scrollbar-thumb-transform-to: var(--_scrollbar-thumb-transform-to-value)}[dir=rtl][_nghost-%COMP%]{animation-name:_ngcontent-%COMP%_scrollbarThumbRTLAnimation;will-change:right;--_scrollbar-thumb-transform-to: calc(var(--_scrollbar-thumb-transform-to-value) * -1)}@keyframes _ngcontent-%COMP%_scrollbarThumbRTLAnimation{0%{right:var(--_scrollbar-thumb-transform-from)}to{right:calc((var(--_effective-thumb-ratio) - 100 + var(--_effective-thumb-ratio) * 100) * -1%)}}"],changeDetection:0})}return e})(),uce={forward:(e,t)=>e<t,backward:e=>e>0},F7={forward:(e,t)=>t+e,backward:(e,t)=>t-e},hce={rtl:{forward:(e,t,i)=>i-t-e,backward:(e,t,i)=>i-t+e},ltr:F7},M7=(()=>{class e extends bh{scrollbarButton=De.required();scrollDirection=De.required();afterFirstClickDelay=120;firstClickDuration=100;scrollBy=50;onGoingScrollBy=12;nextStep;canScroll;get pointerEvents(){let i=Ri(this.nativeElement,"pointerdown").pipe(wh(),LS(this.document)),n=Ri(this.document,"pointerup",{passive:!0}).pipe(NS(this.document)),r=Ri(this.nativeElement,"pointerleave",{passive:!0}),o=yo(n,r);return i.pipe(Ji(()=>this.firstScrollStep().pipe(v0(this.afterFirstClickDelay),Ji(()=>this.onOngoingPointerdown()),Qi(o))))}constructor(){ht(()=>{let i=this.scrollDirection(),n=this.adapter.direction();Aa(()=>{this.canScroll=uce[i],this.control.axis==="x"?this.nextStep=hce[n][i]:this.nextStep=F7[i]})}),super()}firstScrollStep(){let i=this.nextStep(this.scrollBy,this.control.viewportScrollOffset,this.control.viewportScrollMax);return this.control.scrollTo(i,this.firstClickDuration)}onGoingScrollStep(){let i=this.control.viewportScrollMax,n=this.nextStep(this.onGoingScrollBy,this.control.viewportScrollOffset,i);this.control.instantScrollTo(n,i)}onOngoingPointerdown(){return Mh(0,Fh).pipe(_c(()=>this.canScroll(this.control.viewportScrollOffset,this.control.viewportScrollMax)),hn(()=>this.onGoingScrollStep()))}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["button","scrollbarButton",""]],inputs:{scrollbarButton:[1,"scrollbarButton"],scrollDirection:[1,"scrollDirection"]},features:[fn],attrs:jle,decls:3,vars:0,consts:[[1,"ng-scrollbar-button-icon"],["viewBox","0 0 512 512","xmlns","http://www.w3.org/2000/svg"],["d","M413.1,327.3l-1.8-2.1l-136-156.5c-4.6-5.3-11.5-8.6-19.2-8.6c-7.7,0-14.6,3.4-19.2,8.6L101,324.9l-2.3,2.6  C97,330,96,333,96,336.2c0,8.7,7.4,15.8,16.6,15.8v0h286.8v0c9.2,0,16.6-7.1,16.6-15.8C416,332.9,414.9,329.8,413.1,327.3z"]],template:function(n,r){n&1&&(La(0,"div",0),y2(),La(1,"svg",1),Nh(2,"path",2),Tc()())},styles:["[_nghost-%COMP%]{position:relative;border:none;margin:0;padding:0;border-radius:var(--scrollbar-button-shape);appearance:none;background:var(--_scrollbar-button-color);flex:0 0 var(--scrollbar-button-size, var(--_scrollbar-track-thickness-px));block-size:100%}[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;fill:var(--_scrollbar-button-fill)}[_nghost-%COMP%]:hover{background:var(--_scrollbar-button-hover-color)}[_nghost-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:var(--_scrollbar-button-hover-fill)}[_nghost-%COMP%]:active{background:var(--_scrollbar-button-active-color)}[_nghost-%COMP%]:active   svg[_ngcontent-%COMP%]{fill:var(--_scrollbar-button-active-fill)}[_nghost-%COMP%]:disabled{background:var(--_scrollbar-button-inactive-color)}[_nghost-%COMP%]:disabled   svg[_ngcontent-%COMP%]{fill:var(--_scrollbar-button-inactive-fill)}[scrollbarButton=top][_nghost-%COMP%]{--_button-rotate: var(--_button-icon-rotate-top)}[scrollbarButton=bottom][_nghost-%COMP%]{--_button-rotate: var(--_button-icon-rotate-bottom)}[scrollbarButton=start][_nghost-%COMP%]{--_button-rotate: var(--_button-icon-rotate-start)}[scrollbarButton=end][_nghost-%COMP%]{--_button-rotate: var(--_button-icon-rotate-end)}[_nghost-%COMP%]:is([scrollbarButton=top],[scrollbarButton=start]){order:1}[_nghost-%COMP%]:is([scrollbarButton=bottom],[scrollbarButton=end]){order:3}.ng-scrollbar-button-icon[_ngcontent-%COMP%]{rotate:var(--_button-rotate);display:flex;place-content:center;place-items:center;width:100%;height:100%}"],changeDetection:0})}return e})(),pce=(()=>{class e extends _7{rectOffsetProperty="top";rectSizeProperty="height";sizeProperty="clientHeight";clientProperty="clientY";offsetProperty="offsetY";axis="y";get viewportScrollMax(){return this.cmp.scrollMaxY}get viewportScrollOffset(){return this.cmp.scrollTop}scrollTo(i,n){return je(this.cmp.scrollTo({top:i,duration:n}))}instantScrollTo(i){this.cmp.scrollYTo(i)}static \u0275fac=(()=>{let i;return function(r){return(i||(i=xo(e)))(r||e)}})();static \u0275cmp=Ae({type:e,selectors:[["scrollbar-y"]],features:[it([{provide:BS,useExisting:e}]),fn],decls:5,vars:9,consts:[[1,"ng-scrollbar-track-wrapper"],[1,"track-inner"],["scrollbarButton","top","scrollDirection","backward",3,"disabled"],["scrollbarButton","bottom","scrollDirection","forward",3,"disabled"]],template:function(n,r){n&1&&(A(0,"div",0)(1,"scrollbar-track-y")(2,"div",1),le(3,"scrollbar-thumb-y"),I()(),Ve(4,qle,2,8),I()),n&2&&(At("ng-scrollbar-hover",!r.cmp.hoverOffset()),L(),Vr(Wr("ng-scrollbar-track ",r.cmp.trackClass())),L(2),Vr(Wr("ng-scrollbar-thumb ",r.cmp.thumbClass())),L(),Ge(r.cmp.withButtons()?4:-1))},dependencies:[sce,cce,M7],styles:["[_nghost-%COMP%]{display:block;height:var(--_scrollbar-wrapper-height);width:var(--_scrollbar-wrapper-width);position:sticky;z-index:100;opacity:var(--_scrollbar-hover-opacity);transition:var(--_scrollbar-opacity-transition);background:var(--scrollbar-container-color, transparent);border-radius:var(--scrollbar-container-shape, 0px)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{touch-action:none;-webkit-user-select:none;user-select:none;gap:var(--scrollbar-button-gap, 0px);inset-block-start:var(--_scrollbar-track-inset-block-start);inset-block-end:var(--_scrollbar-track-inset-block-end);inset-inline-start:var(--_scrollbar-track-inset-inline-start);inset-inline-end:var(--_scrollbar-track-inset-inline-end);transition:var(--scrollbar-track-wrapper-transition, width 60ms linear, height 60ms linear);position:absolute;overflow:hidden;display:flex;place-items:center}.track-inner[_ngcontent-%COMP%]{position:absolute;border-radius:var(--scrollbar-track-shape, 0);background:var(--scrollbar-track-color, rgba(128, 128, 128, .5))}","[_nghost-%COMP%]{--_scrollbar-wrapper-height: calc(var(--viewport-height) * 1px);--_scrollbar-wrapper-width: var(--_scrollbar-total-thickness-px);--_scrollbar-track-inset-block-start: var(--_vertical-inset-block-start);--_scrollbar-track-inset-block-end: var(--_vertical-inset-block-end);--_scrollbar-track-inset-inline-end: var(--_vertical-inset-inline-end);--_scrollbar-track-inset-inline-start: var(--_vertical-inset-inline-start);--_button-icon-rotate-top: 0deg;--_button-icon-rotate-bottom: 180deg;grid-area:scrollbar-y;pointer-events:var(--_scrollbar-y-pointer-events);inset-block-start:0;inset-block-end:0;inset-inline-start:var(--_scrollbar-wrapper-y-start);inset-inline-end:var(--_scrollbar-wrapper-y-end)}.ng-scrollbar-hover[_nghost-%COMP%]:hover, .ng-scrollbar-hover[_ngcontent-%COMP%]:hover{--_track-y-thickness-px: var(--_scrollbar-hover-thickness-px)}.ng-scrollbar-hover[_nghost-%COMP%]:active, .ng-scrollbar-hover[_ngcontent-%COMP%]:active{--_track-y-thickness-px: var(--_scrollbar-active-thickness-px)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{width:var(--_track-y-thickness-px);flex-direction:column}.track-inner[_ngcontent-%COMP%]{inset-inline-start:var(--scrollbar-track-offset, 0px);inset-inline-end:var(--scrollbar-track-offset, 0px);inset-block-start:0;inset-block-end:0}"],changeDetection:0})}return e})(),fce=(()=>{class e extends _7{manager=ce(D7);rectOffsetProperty="left";rectSizeProperty="width";sizeProperty="clientWidth";clientProperty="clientX";offsetProperty="offsetX";axis="x";handlePosition;get viewportScrollMax(){return this.cmp.scrollMaxX}get viewportScrollOffset(){return Math.abs(this.cmp.scrollLeft)}constructor(){ht(()=>{this.cmp.direction()==="rtl"?this.handlePosition=(i,n)=>-(n-i):this.handlePosition=i=>i}),super()}scrollTo(i,n){return je(this.cmp.scrollTo({left:i,duration:n}))}instantScrollTo(i,n){this.cmp.scrollXTo(this.handlePosition(i,n))}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["scrollbar-x"]],hostVars:1,hostBindings:function(n,r){n&2&&Es("dir",r.cmp.direction())},features:[it([{provide:BS,useExisting:e}]),fn],decls:5,vars:10,consts:[[1,"ng-scrollbar-track-wrapper"],[1,"track-inner"],["scrollbarButton","start","scrollDirection","backward",3,"disabled"],["scrollbarButton","end","scrollDirection","forward",3,"disabled"]],template:function(n,r){n&1&&(A(0,"div",0)(1,"scrollbar-track-x")(2,"div",1),le(3,"scrollbar-thumb-x"),I()(),Ve(4,$le,2,8),I()),n&2&&(At("ng-scrollbar-hover",!r.cmp.hoverOffset()),L(),Vr(Wr("ng-scrollbar-track ",r.cmp.trackClass())),L(2),Vr(Wr("ng-scrollbar-thumb ",r.cmp.thumbClass())),Es("dir",r.cmp.direction()),L(),Ge(r.cmp.withButtons()?4:-1))},dependencies:[ace,dce,M7],styles:[Kle,"[_nghost-%COMP%]{--_scrollbar-wrapper-height: var(--_scrollbar-total-thickness-px);--_scrollbar-wrapper-width: calc(var(--viewport-width) * 1px);--_scrollbar-track-inset-block-start: var(--_horizontal-block-start);--_scrollbar-track-inset-block-end: var(--_horizontal-block-end);--_scrollbar-track-inset-inline-end: var(--_horizontal-inline-end);--_scrollbar-track-inset-inline-start: var(--_horizontal-inline-start);--_button-icon-rotate-start: -90deg;--_button-icon-rotate-end: 90deg}[dir=rtl][_nghost-%COMP%]{--_button-icon-rotate-start: 90deg;--_button-icon-rotate-end: -90deg}[_nghost-%COMP%]{grid-area:scrollbar-x;pointer-events:var(--_scrollbar-x-pointer-events);inset-block-start:var(--_scrollbar-wrapper-x-top);inset-block-end:var(--_scrollbar-wrapper-x-bottom);inset-inline-start:0;inset-inline-end:0}.ng-scrollbar-hover[_nghost-%COMP%]:hover, .ng-scrollbar-hover[_ngcontent-%COMP%]:hover{--_track-x-thickness-px: var(--_scrollbar-hover-thickness-px)}.ng-scrollbar-hover[_nghost-%COMP%]:active, .ng-scrollbar-hover[_ngcontent-%COMP%]:active{--_track-x-thickness-px: var(--_scrollbar-active-thickness-px)}.ng-scrollbar-track-wrapper[_ngcontent-%COMP%]{height:var(--_track-x-thickness-px);flex-direction:row}.track-inner[_ngcontent-%COMP%]{inset-inline-start:0;inset-inline-end:0;inset-block-start:var(--scrollbar-track-offset, 0px);inset-block-end:var(--scrollbar-track-offset, 0px)}"],changeDetection:0})}return e})(),gce=(()=>{class e{adapter=ce(Sh);static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["scrollbars"]],decls:2,vars:2,template:function(n,r){n&1&&(Ve(0,Yle,1,0,"scrollbar-y"),Ve(1,Xle,1,0,"scrollbar-x")),n&2&&(Ge(r.adapter.verticalUsed()?0:-1),L(),Ge(r.adapter.horizontalUsed()?1:-1))},dependencies:[fce,pce],styles:["[_nghost-%COMP%]{pointer-events:none;position:absolute;inset:0;display:grid;grid-template:var(--_scrollbar-grid-template)}"],changeDetection:0})}return e})(),mce=(()=>{class e{zone=ce(Ni);platform=ce(r3);sharedResizeObserver=ce(P3);adapter=ce(Sh);nativeElement=ce(ci).nativeElement;isMobile=this.platform.IOS||this.platform.ANDROID;constructor(){let i,n;R0({earlyRead:r=>{let o=this.adapter.disableSensor(),s=this.adapter.sensorThrottleTime(),a=this.adapter.initialized();Aa(()=>{a&&(o?requestAnimationFrame(()=>this.update(OS.AfterInit)):this.zone.runOutsideAngular(()=>{i=ece(v2([this.sharedResizeObserver.observe(this.adapter.viewportElement),this.sharedResizeObserver.observe(this.adapter.contentWrapperElement)]),s).subscribe(()=>{this.zone.run(()=>{this.updateDimensions(),n?this.adapter.afterUpdate.emit():this.adapter.afterInit.emit(),n=!0})})})),r(()=>i?.unsubscribe())})}})}update(i){this.updateDimensions(),i===OS.AfterInit?this.adapter.afterInit.emit():this.adapter.afterUpdate.emit()}updateDimensions(){this.adapter.viewportDimension.set({width:this.adapter.clientWidth,height:this.adapter.clientHeight}),this.adapter.contentDimension.set({width:this.adapter.contentWidth,height:this.adapter.contentHeight})}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,hostVars:22,hostBindings:function(n,r){n&2&&(Es("mobile",r.isMobile)("dir",r.adapter.direction())("dragging",r.adapter.dragging())("position",r.adapter.position())("appearance",r.adapter.appearance())("visibility",r.adapter.visibility())("orientation",r.adapter.orientation())("disableInteraction",r.adapter.disableInteraction())("verticalUsed",r.adapter.verticalUsed())("horizontalUsed",r.adapter.horizontalUsed())("isVerticallyScrollable",r.adapter.isVerticallyScrollable())("isHorizontallyScrollable",r.adapter.isHorizontallyScrollable()),zr("--content-height",r.adapter.contentDimension().height)("--content-width",r.adapter.contentDimension().width)("--viewport-height",r.adapter.viewportDimension().height)("--viewport-width",r.adapter.viewportDimension().width),At("ng-scroll-viewport",!0))}})}return e})();var T7=(()=>{class e extends mce{contentWrapper=_2.required(AS,{read:ci});contentWrapperElement=Ie(()=>this.contentWrapper().nativeElement);constructor(){ht(()=>{let i=this.contentWrapperElement();Aa(()=>{this.adapter.init(this.nativeElement,i)})}),super()}scrollTo(i){return this.adapter.scrollTo(i)}scrollToElement(i,n){return this.adapter.scrollToElement(i,n)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["ng-scrollbar",3,"externalViewport",""],["","ngScrollbar",""]],viewQuery:function(n,r){n&1&&R2(r.contentWrapper,AS,5,ci),n&2&&Ic()},hostVars:2,hostBindings:function(n,r){n&2&&At("ng-scrollbar",!0)},exportAs:["ngScrollbar"],features:[x2([{directive:Sh,inputs:["position","position","withButtons","withButtons","appearance","appearance","thumbClass","thumbClass","trackClass","trackClass","buttonClass","buttonClass","visibility","visibility","hoverOffset","hoverOffset","orientation","orientation","disableSensor","disableSensor","sensorThrottleTime","sensorThrottleTime","disableInteraction","disableInteraction","trackScrollDuration","trackScrollDuration"],outputs:["afterInit","afterInit","afterUpdate","afterUpdate"]}]),fn],ngContentSelectors:o0,decls:3,vars:0,template:function(n,r){n&1&&(Eo(),A(0,"ng-scroll-content"),Ro(1),le(2,"scrollbars"),I())},dependencies:[gce,AS],styles:[Jle],changeDetection:0})}return e})();var I7=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=Mc({type:e});static \u0275inj=Dc({})}return e})();function Cce(e,t){if(e&1){let i=Ue();A(0,"button",15),de("click",function(){let r=ue(i).$implicit,o=te().$implicit;return te().onIconClick(r),he(o.close())}),le(1,"ng-icon",16),I()}if(e&2){let i=t.$implicit,n=te(2);ve("variant",n.selectedIcon()===i?"default":"outline")("title",i),L(),ve("name",i)}}function wce(e,t){e&1&&(A(0,"div",13),ge(1),be(2,"transloco"),I()),e&2&&(L(),qe(" ",ye(2,1,"flexibleItems.iconPicker.noResults")," "))}function bce(e,t){if(e&1&&(A(0,"div",14)(1,"span"),ge(2),be(3,"transloco"),I(),A(4,"code",17),ge(5),I()()),e&2){let i=te(2);L(2),qe("",ye(3,2,"flexibleItems.iconPicker.selected"),":"),L(3),Qe(i.selectedIcon())}}function yce(e,t){if(e&1){let i=Ue();A(0,"div",5)(1,"div",6)(2,"div",7)(3,"label",8),ge(4),be(5,"transloco"),I(),A(6,"input",9),be(7,"transloco"),de("input",function(r){ue(i);let o=te();return he(o.onSearchChange(r.target.value))}),I()(),A(8,"ng-scrollbar",10)(9,"div",11),On(10,Cce,2,3,"button",12,E2),Ve(12,wce,3,3,"div",13),I()(),Ve(13,bce,6,4,"div",14),I()()}if(e&2){let i=te();L(4),Qe(ye(5,5,"flexibleItems.iconPicker.searchLabel")),L(2),ve("value",i.searchTerm())("placeholder",ye(7,7,"flexibleItems.iconPicker.searchPlaceholder")),L(4),Ln(i.filteredIcons()),L(2),Ge(i.filteredIcons().length===0?12:-1),L(),Ge(i.selectedIcon()?13:-1)}}var A7=(()=>{class e{selectedIcon=xe("lucideBox");disabled=xe(!1);allIcons=xe(Object.keys(Rs));searchTerm=xe("");filteredIcons=Ie(()=>{let i=this.searchTerm().toLowerCase();return i?this.allIcons().filter(n=>n.toLowerCase().includes(i)):this.allIcons()});onIconClick(i){this.disabled()||(this.selectedIcon.set(i),this.onChange(i),this.onTouched())}onSearchChange(i){this.searchTerm.set(i)}onChange=()=>{};onTouched=()=>{};writeValue(i){i&&this.selectedIcon.set(i)}registerOnChange(i){this.onChange=i}registerOnTouched(i){this.onTouched=i}setDisabledState(i){this.disabled.set(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-icon-picker"]],features:[it([di(Rs),{provide:zh,useExisting:Ih(()=>e),multi:!0}])],decls:5,vars:2,consts:[[3,"closeDelay"],["type","button","hlmPopoverTrigger","","hlmBtn","","variant","outline",1,"h-16","w-16","rounded-full","p-0"],[1,"h-14","w-14","flex","items-center","justify-center"],["hlm","","hlmAvatarFallback","","size","sm",3,"name"],["hlmPopoverContent","","class","w-[400px] p-4",4,"brnPopoverContent"],["hlmPopoverContent","",1,"w-[400px]","p-4"],[1,"space-y-4"],[1,"space-y-2"],["hlmLabel","","for","icon-search"],["hlmInput","","id","icon-search","type","text",3,"input","value","placeholder"],["hlm","",1,"h-[300px]","w-full","rounded-md","border","p-2"],["scrollViewport","",1,"grid","grid-cols-6","gap-2"],["type","button","hlmBtn","","size","icon",1,"h-10","w-10",3,"variant","title"],[1,"col-span-full","text-center","py-4","text-muted-foreground","text-sm"],[1,"flex","items-center","gap-2","text-xs","text-muted-foreground","pt-2","border-t"],["type","button","hlmBtn","","size","icon",1,"h-10","w-10",3,"click","variant","title"],["hlm","","size","sm",3,"name"],[1,"text-xs","font-mono"]],template:function(n,r){n&1&&(A(0,"hlm-popover",0)(1,"button",1)(2,"hlm-avatar",2),le(3,"ng-icon",3),I()(),Qn(4,yce,14,9,"div",4),I()),n&2&&(ve("closeDelay",100),L(3),ve("name",r.selectedIcon()))},dependencies:[Ga,vn,b3,p3,f3,Rt,hi,ui,Cn,wn,y3,S3,x3,IS,I7,T7,mn],encapsulation:2,changeDetection:0})}return e})();function VS(e){let t=e.cloneNode(!0),i=t.querySelectorAll("[id]"),n=e.nodeName.toLowerCase();t.removeAttribute("id");for(let r=0;r<i.length;r++)i[r].removeAttribute("id");return n==="canvas"?N7(e,t):(n==="input"||n==="select"||n==="textarea")&&L7(e,t),O7("canvas",e,t,N7),O7("input, textarea, select",e,t,L7),t}function O7(e,t,i,n){let r=t.querySelectorAll(e);if(r.length){let o=i.querySelectorAll(e);for(let s=0;s<r.length;s++)n(r[s],o[s])}}var Sce=0;function L7(e,t){t.type!=="file"&&(t.value=e.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${Sce++}`)}function N7(e,t){let i=t.getContext("2d");if(i)try{i.drawImage(e,0,0)}catch{}}function $S(e){let t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function GS(e,t,i){let{top:n,bottom:r,left:o,right:s}=e;return i>=n&&i<=r&&t>=o&&t<=s}function xce(e,t){let i=t.left<e.left,n=t.left+t.width>e.right,r=t.top<e.top,o=t.top+t.height>e.bottom;return i||n||r||o}function _h(e,t,i){e.top+=t,e.bottom=e.top+e.height,e.left+=i,e.right=e.left+e.width}function B7(e,t,i,n){let{top:r,right:o,bottom:s,left:a,width:l,height:c}=e,d=l*t,u=c*t;return n>r-u&&n<s+u&&i>a-d&&i<o+d}var s0=class{_document;positions=new Map;constructor(t){this._document=t}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(i=>{this.positions.set(i,{scrollPosition:{top:i.scrollTop,left:i.scrollLeft},clientRect:$S(i)})})}handleScroll(t){let i=Hc(t),n=this.positions.get(i);if(!n)return null;let r=n.scrollPosition,o,s;if(i===this._document){let c=this.getViewportScrollPosition();o=c.top,s=c.left}else o=i.scrollTop,s=i.scrollLeft;let a=r.top-o,l=r.left-s;return this.positions.forEach((c,d)=>{c.clientRect&&i!==d&&i.contains(d)&&_h(c.clientRect,a,l)}),r.top=o,r.left=s,{top:a,left:l}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function J7(e,t){let i=e.rootNodes;if(i.length===1&&i[0].nodeType===t.ELEMENT_NODE)return i[0];let n=t.createElement("div");return i.forEach(r=>n.appendChild(r)),n}function KS(e,t,i){for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];r?e.setProperty(n,r,i?.has(n)?"important":""):e.removeProperty(n)}return e}function wc(e,t){let i=t?"":"none";KS(e.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":i,"-ms-user-select":i,"-webkit-user-select":i,"-moz-user-select":i})}function H7(e,t,i){KS(e.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},i)}function a0(e,t){return t&&t!="none"?e+" "+t:e}function z7(e,t){e.style.width=`${t.width}px`,e.style.height=`${t.height}px`,e.style.transform=Dh(t.left,t.top)}function Dh(e,t){return`translate3d(${Math.round(e)}px, ${Math.round(t)}px, 0)`}function V7(e){let t=e.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(e)*t}function Ece(e){let t=getComputedStyle(e),i=HS(t,"transition-property"),n=i.find(a=>a==="transform"||a==="all");if(!n)return 0;let r=i.indexOf(n),o=HS(t,"transition-duration"),s=HS(t,"transition-delay");return V7(o[r])+V7(s[r])}function HS(e,t){return e.getPropertyValue(t).split(",").map(n=>n.trim())}var Rce=new Set(["position"]),WS=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(t,i,n,r,o,s,a,l,c,d){this._document=t,this._rootElement=i,this._direction=n,this._initialDomRect=r,this._previewTemplate=o,this._previewClass=s,this._pickupPositionOnPage=a,this._initialTransform=l,this._zIndex=c,this._renderer=d}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),G7(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return Ece(this._preview)}addEventListener(t,i){return this._renderer.listen(this._preview,t,i)}_createPreview(){let t=this._previewTemplate,i=this._previewClass,n=t?t.template:null,r;if(n&&t){let o=t.matchSize?this._initialDomRect:null,s=t.viewContainer.createEmbeddedView(n,t.context);s.detectChanges(),r=J7(s,this._document),this._previewEmbeddedView=s,t.matchSize?z7(r,o):r.style.transform=Dh(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=VS(this._rootElement),z7(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return KS(r.style,{"pointer-events":"none",margin:G7(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Rce),wc(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),i&&(Array.isArray(i)?i.forEach(o=>r.classList.add(o)):r.classList.add(i)),r}};function G7(e){return"showPopover"in e}var Pce={passive:!0},W7={passive:!1},kce={passive:!1,capture:!0},_ce=800,U7="cdk-drag-placeholder",j7=new Set(["position"]),US=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=xe(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new yt;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=Ia.EMPTY;_pointerUpSubscription=Ia.EMPTY;_scrollSubscription=Ia.EMPTY;_resizeSubscription=Ia.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(i=>wc(i,t)))}_disabled=!1;beforeStarted=new yt;started=new yt;released=new yt;ended=new yt;entered=new yt;exited=new yt;dropped=new yt;moved=this._moveEvents;data;constrainPosition;constructor(t,i,n,r,o,s,a){this._config=i,this._document=n,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=s,this._renderer=a,this.withRootElement(t).withParent(i.parentDragRef||null),this._parentPositions=new s0(n),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(n=>Hn(n)),this._handles.forEach(n=>wc(n,this.disabled)),this._toggleNativeDragInteractions();let i=new Set;return this._disabledHandles.forEach(n=>{this._handles.indexOf(n)>-1&&i.add(n)}),this._disabledHandles=i,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let i=Hn(t);if(i!==this._rootElement){this._removeRootElementListeners();let n=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[n.listen(i,"mousedown",this._pointerDown,W7),n.listen(i,"touchstart",this._pointerDown,Pce),n.listen(i,"dragstart",this._nativeDragStart,W7)]),this._initialTransform=void 0,this._rootElement=i}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?Hn(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&xce(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let t=this._boundaryElement.getBoundingClientRect(),i=this._rootElement.getBoundingClientRect(),n=0,r=0;i.left<t.left?n=t.left-i.left:i.right>t.right&&(n=t.right-i.right),i.top<t.top?r=t.top-i.top:i.bottom>t.bottom&&(r=t.bottom-i.bottom);let o=this._activeTransform.x,s=this._activeTransform.y,a=o+n,l=s+r;this._rootElement.style.transform=Dh(a,l),this._activeTransform={x:a,y:l},this._passiveTransform={x:a,y:l}}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),wc(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),wc(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){let i=this._getTargetHandle(t);i&&!this._disabledHandles.has(i)&&!this.disabled&&this._initializeDragSequence(i,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)};_pointerMove=t=>{let i=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging()){let r=Math.abs(i.x-this._pickupPositionOnPage.x),o=Math.abs(i.y-this._pickupPositionOnPage.y);if(r+o>=this._config.dragStartThreshold){let a=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),l=this._dropContainer;if(!a){this._endDragSequence(t);return}(!l||!l.isDragging()&&!l.isReceiving())&&(t.cancelable&&t.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(t)))}return}t.cancelable&&t.preventDefault();let n=this._getConstrainedPointerPosition(i);if(this._hasMoved=!0,this._lastKnownPointerPosition=i,this._updatePointerDirectionDelta(n),this._dropContainer)this._updateActiveDropContainer(n,i);else{let r=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=n.x-r.x+this._passiveTransform.x,o.y=n.y-r.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:n,event:t,distance:this._getDragDistance(n),delta:this._pointerDirectionDelta})})};_pointerUp=t=>{this._endDragSequence(t)};_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let i=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(i),dropPoint:i,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){Ph(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let i=this._getShadowRoot(),n=this._dropContainer;if(i&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(i,"selectstart",Dce,kce)}),n){let r=this._rootElement,o=r.parentNode,s=this._placeholder=this._createPlaceholderElement(),a=this._marker=this._marker||this._document.createComment("");o.insertBefore(a,r),this._initialTransform=r.style.transform||"",this._preview=new WS(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(o,i)),H7(r,!1,j7),this._document.body.appendChild(o.replaceChild(s,r)),this.started.next({source:this,event:t}),n.start(),this._initialContainer=n,this._initialIndex=n.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(n?n.getScrollableParents():[])}_initializeDragSequence(t,i){this._parentDragRef&&i.stopPropagation();let n=this.isDragging(),r=Ph(i),o=!r&&i.button!==0,s=this._rootElement,a=Hc(i),l=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+_ce>Date.now(),c=r?h3(i):u3(i);if(a&&a.draggable&&i.type==="mousedown"&&i.preventDefault(),n||o||l||c)return;if(this._handles.length){let h=s.style;this._rootElementTapHighlight=h.webkitTapHighlightColor||"",h.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(h=>this._updateOnScroll(h)),this._boundaryElement&&(this._boundaryRect=$S(this._boundaryElement));let d=this._previewTemplate;this._pickupPositionInElement=d&&d.template&&!d.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,i);let u=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(i);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,i)}_cleanupDragArtifacts(t){H7(this._rootElement,!0,j7),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let i=this._dropContainer,n=i.getItemIndex(this),r=this._getPointerPositionOnPage(t),o=this._getDragDistance(r),s=i._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:o,dropPoint:r,event:t}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:i,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:o,dropPoint:r,event:t}),i.drop(this,n,this._initialIndex,this._initialContainer,s,o,r,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:i},{x:n,y:r}){let o=this._initialContainer._getSiblingContainerFromPosition(this,t,i);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,i)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{let s=this._dropContainer.getItemIndex(this),a=this._dropContainer.getItemAtIndex(s+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(o,this._dropContainer,a),this._dropContainer=o,this._dropContainer.enter(this,t,i,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,r),this._dropContainer._sortItem(this,t,i,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,i):this._applyPreviewTransform(t-this._pickupPositionInElement.x,i-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let i=this._preview.getTransitionDuration();return i===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(n=>{let r=a=>{(!a||this._preview&&Hc(a)===this._preview.element&&a.propertyName==="transform")&&(s(),n(),clearTimeout(o))},o=setTimeout(r,i*1.5),s=this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,i=t?t.template:null,n;return i?(this._placeholderRef=t.viewContainer.createEmbeddedView(i,t.context),this._placeholderRef.detectChanges(),n=J7(this._placeholderRef,this._document)):n=VS(this._rootElement),n.style.pointerEvents="none",n.classList.add(U7),n}_getPointerPositionInElement(t,i,n){let r=i===this._rootElement?null:i,o=r?r.getBoundingClientRect():t,s=Ph(n)?n.targetTouches[0]:n,a=this._getViewportScrollPosition(),l=s.pageX-o.left-a.left,c=s.pageY-o.top-a.top;return{x:o.left-t.left+l,y:o.top-t.top+c}}_getPointerPositionOnPage(t){let i=this._getViewportScrollPosition(),n=Ph(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,r=n.pageX-i.left,o=n.pageY-i.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let a=this._ownerSVGElement.createSVGPoint();return a.x=r,a.y=o,a.matrixTransform(s.inverse())}}return{x:r,y:o}}_getConstrainedPointerPosition(t){let i=this._dropContainer?this._dropContainer.lockAxis:null,{x:n,y:r}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||i==="x"?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||i==="y")&&(n=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:o,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:l,height:c}=this._getPreviewRect(),d=a.top+s,u=a.bottom-(c-s),h=a.left+o,p=a.right-(l-o);n=q7(n,h,p),r=q7(r,d,u)}return{x:n,y:r}}_updatePointerDirectionDelta(t){let{x:i,y:n}=t,r=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,s=Math.abs(i-o.x),a=Math.abs(n-o.y);return s>this._config.pointerDirectionChangeThreshold&&(r.x=i>o.x?1:-1,o.x=i),a>this._config.pointerDirectionChangeThreshold&&(r.y=n>o.y?1:-1,o.y=n),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,wc(this._rootElement,t))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(t=>t()),this._rootElementCleanups=void 0}_applyRootElementTransform(t,i){let n=1/this.scale,r=Dh(t*n,i*n),o=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=o.transform&&o.transform!="none"?o.transform:""),o.transform=a0(r,this._initialTransform)}_applyPreviewTransform(t,i){let n=this._previewTemplate?.template?void 0:this._initialTransform,r=Dh(t,i);this._preview.setTransform(a0(r,n))}_getDragDistance(t){let i=this._pickupPositionOnPage;return i?{x:t.x-i.x,y:t.y-i.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:i}=this._passiveTransform;if(t===0&&i===0||this.isDragging()||!this._boundaryElement)return;let n=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(r.width===0&&r.height===0||n.width===0&&n.height===0)return;let o=r.left-n.left,s=n.right-r.right,a=r.top-n.top,l=n.bottom-r.bottom;r.width>n.width?(o>0&&(t+=o),s>0&&(t-=s)):t=0,r.height>n.height?(a>0&&(i+=a),l>0&&(i-=l)):i=0,(t!==this._passiveTransform.x||i!==this._passiveTransform.y)&&this.setFreeDragPosition({y:i,x:t})}_getDragStartDelay(t){let i=this.dragStartDelay;return typeof i=="number"?i:Ph(t)?i.touch:i?i.mouse:0}_updateOnScroll(t){let i=this._parentPositions.handleScroll(t);if(i){let n=Hc(t);this._boundaryRect&&n!==this._boundaryElement&&n.contains(this._boundaryElement)&&_h(this._boundaryRect,i.top,i.left),this._pickupPositionOnPage.x+=i.left,this._pickupPositionOnPage.y+=i.top,this._dropContainer||(this._activeTransform.x-=i.left,this._activeTransform.y-=i.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=Gh(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,i){let n=this._previewContainer||"global";if(n==="parent")return t;if(n==="global"){let r=this._document;return i||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return Hn(n)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=t=>{if(this._handles.length){let i=this._getTargetHandle(t);i&&!this._disabledHandles.has(i)&&!this.disabled&&t.preventDefault()}else this.disabled||t.preventDefault()};_getTargetHandle(t){return this._handles.find(i=>t.target&&(t.target===i||i.contains(t.target)))}_conditionallyInsertAnchor(t,i,n){if(t===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(i===this._initialContainer&&i.hasAnchor){let r=this._anchor??=VS(this._placeholder);r.classList.remove(U7),r.classList.add("cdk-drag-anchor"),r.style.transform="",n?n.before(r):Hn(i.element).appendChild(r)}}};function q7(e,t,i){return Math.max(t,Math.min(i,e))}function Ph(e){return e.type[0]==="t"}function Dce(e){e.preventDefault()}function c0(e,t,i){let n=$7(t,e.length-1),r=$7(i,e.length-1);if(n===r)return;let o=e[n],s=r<n?-1:1;for(let a=n;a!==r;a+=s)e[a]=e[a+s];e[r]=o}function $7(e,t){return Math.max(0,Math.min(t,e))}var l0=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(t){this._dragDropRegistry=t}_previousSwap={drag:null,delta:0,overlaps:!1};start(t){this.withItems(t)}sort(t,i,n,r){let o=this._itemPositions,s=this._getItemIndexFromPointerPosition(t,i,n,r);if(s===-1&&o.length>0)return null;let a=this.orientation==="horizontal",l=o.findIndex(m=>m.drag===t),c=o[s],d=o[l].clientRect,u=c.clientRect,h=l>s?1:-1,p=this._getItemOffsetPx(d,u,h),f=this._getSiblingOffsetPx(l,o,h),g=o.slice();return c0(o,l,s),o.forEach((m,v)=>{if(g[v]===m)return;let C=m.drag===t,b=C?p:f,S=C?t.getPlaceholderElement():m.drag.getRootElement();m.offset+=b;let E=Math.round(m.offset*(1/m.drag.scale));a?(S.style.transform=a0(`translate3d(${E}px, 0, 0)`,m.initialTransform),_h(m.clientRect,0,b)):(S.style.transform=a0(`translate3d(0, ${E}px, 0)`,m.initialTransform),_h(m.clientRect,b,0))}),this._previousSwap.overlaps=GS(u,i,n),this._previousSwap.drag=c.drag,this._previousSwap.delta=a?r.x:r.y,{previousIndex:l,currentIndex:s}}enter(t,i,n,r){let o=r==null||r<0?this._getItemIndexFromPointerPosition(t,i,n):r,s=this._activeDraggables,a=s.indexOf(t),l=t.getPlaceholderElement(),c=s[o];if(c===t&&(c=s[o+1]),!c&&(o==null||o===-1||o<s.length-1)&&this._shouldEnterAsFirstChild(i,n)&&(c=s[0]),a>-1&&s.splice(a,1),c&&!this._dragDropRegistry.isDragging(c)){let d=c.getRootElement();d.parentElement.insertBefore(l,d),s.splice(o,0,t)}else this._element.appendChild(l),s.push(t);l.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let i=t.getRootElement();if(i){let n=this._itemPositions.find(r=>r.drag===t)?.initialTransform;i.style.transform=n||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return this._getVisualItemPositions().findIndex(i=>i.drag===t)}getItemAtIndex(t){return this._getVisualItemPositions()[t]?.drag||null}updateOnScroll(t,i){this._itemPositions.forEach(({clientRect:n})=>{_h(n,t,i)}),this._itemPositions.forEach(({drag:n})=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(i=>{let n=i.getVisibleElement();return{drag:i,offset:0,initialTransform:n.style.transform||"",clientRect:$S(n)}}).sort((i,n)=>t?i.clientRect.left-n.clientRect.left:i.clientRect.top-n.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(t,i,n){let r=this.orientation==="horizontal",o=r?i.left-t.left:i.top-t.top;return n===-1&&(o+=r?i.width-t.width:i.height-t.height),o}_getSiblingOffsetPx(t,i,n){let r=this.orientation==="horizontal",o=i[t].clientRect,s=i[t+n*-1],a=o[r?"width":"height"]*n;if(s){let l=r?"left":"top",c=r?"right":"bottom";n===-1?a-=s.clientRect[l]-o[c]:a+=o[l]-s.clientRect[c]}return a}_shouldEnterAsFirstChild(t,i){if(!this._activeDraggables.length)return!1;let n=this._itemPositions,r=this.orientation==="horizontal";if(n[0].drag!==this._activeDraggables[0]){let s=n[n.length-1].clientRect;return r?t>=s.right:i>=s.bottom}else{let s=n[0].clientRect;return r?t<=s.left:i<=s.top}}_getItemIndexFromPointerPosition(t,i,n,r){let o=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:a,clientRect:l})=>{if(a===t)return!1;if(r){let c=o?r.x:r.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&c===this._previousSwap.delta)return!1}return o?i>=Math.floor(l.left)&&i<Math.floor(l.right):n>=Math.floor(l.top)&&n<Math.floor(l.bottom)});return s===-1||!this._sortPredicate(s,t)?-1:s}},jS=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(t,i){this._document=t,this._dragDropRegistry=i}start(t){let i=this._element.childNodes;this._relatedNodes=[];for(let n=0;n<i.length;n++){let r=i[n];this._relatedNodes.push([r,r.nextSibling])}this.withItems(t)}sort(t,i,n,r){let o=this._getItemIndexFromPointerPosition(t,i,n),s=this._previousSwap;if(o===-1||this._activeItems[o]===t)return null;let a=this._activeItems[o];if(s.drag===a&&s.overlaps&&s.deltaX===r.x&&s.deltaY===r.y)return null;let l=this.getItemIndex(t),c=t.getPlaceholderElement(),d=a.getRootElement();o>l?d.after(c):d.before(c),c0(this._activeItems,l,o);let u=this._getRootNode().elementFromPoint(i,n);return s.deltaX=r.x,s.deltaY=r.y,s.drag=a,s.overlaps=d===u||d.contains(u),{previousIndex:l,currentIndex:o}}enter(t,i,n,r){let o=this._activeItems.indexOf(t);o>-1&&this._activeItems.splice(o,1);let s=r==null||r<0?this._getItemIndexFromPointerPosition(t,i,n):r;s===-1&&(s=this._getClosestItemIndexToPointer(t,i,n));let a=this._activeItems[s];a&&!this._dragDropRegistry.isDragging(a)?(this._activeItems.splice(s,0,t),a.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,i=this._previousSwap;for(let n=this._relatedNodes.length-1;n>-1;n--){let[r,o]=this._relatedNodes[n];r.parentNode===t&&r.nextSibling!==o&&(o===null?t.appendChild(r):o.parentNode===t&&t.insertBefore(r,o))}this._relatedNodes=[],this._activeItems=[],i.drag=null,i.deltaX=i.deltaY=0,i.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}getItemAtIndex(t){return this._activeItems[t]||null}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,i,n){let r=this._getRootNode().elementFromPoint(Math.floor(i),Math.floor(n)),o=r?this._activeItems.findIndex(s=>{let a=s.getRootElement();return r===a||a.contains(r)}):-1;return o===-1||!this._sortPredicate(o,t)?-1:o}_getRootNode(){return this._rootNode||(this._rootNode=Gh(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,i,n){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let r=1/0,o=-1;for(let s=0;s<this._activeItems.length;s++){let a=this._activeItems[s];if(a!==t){let{x:l,y:c}=a.getRootElement().getBoundingClientRect(),d=Math.hypot(i-l,n-c);d<r&&(r=d,o=s)}}return o}},K7=.05,Q7=.05,An=(function(e){return e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e})(An||{}),Li=(function(e){return e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e})(Li||{}),qS=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new yt;entered=new yt;exited=new yt;dropped=new yt;sorted=new yt;receivingStarted=new yt;receivingStopped=new yt;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Ia.EMPTY;_verticalScrollDirection=An.NONE;_horizontalScrollDirection=Li.NONE;_scrollNode;_stopScrollTimers=new yt;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(t,i,n,r,o){this._dragDropRegistry=i,this._ngZone=r,this._viewportRuler=o;let s=this.element=Hn(t);this._document=n,this.withOrientation("vertical").withElementContainer(s),i.registerDropContainer(this),this._parentPositions=new s0(n)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,i,n,r){this._draggingStarted(),r==null&&this.sortingDisabled&&(r=this._draggables.indexOf(t)),this._sortStrategy.enter(t,i,n,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,i,n,r,o,s,a,l={}){this._reset(),this.dropped.next({item:t,currentIndex:i,previousIndex:n,container:this,previousContainer:r,isPointerOverContainer:o,distance:s,dropPoint:a,event:l})}withItems(t){let i=this._draggables;return this._draggables=t,t.forEach(n=>n._withDropContainer(this)),this.isDragging()&&(i.filter(r=>r.isDragging()).every(r=>t.indexOf(r)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof l0&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new jS(this._document,this._dragDropRegistry);else{let i=new l0(this._dragDropRegistry);i.direction=this._direction,i.orientation=t,this._sortStrategy=i}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((i,n)=>this.sortPredicate(i,n,this)),this}withScrollableParents(t){let i=this._container;return this._scrollableElements=t.indexOf(i)===-1?[i,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let i=Hn(this.element),n=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(t);return n>-1&&this._scrollableElements.splice(n,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}getItemAtIndex(t){return this._isDragging?this._sortStrategy.getItemAtIndex(t):this._draggables[t]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,i,n,r){if(this.sortingDisabled||!this._domRect||!B7(this._domRect,K7,i,n))return;let o=this._sortStrategy.sort(t,i,n,r);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,i){if(this.autoScrollDisabled)return;let n,r=An.NONE,o=Li.NONE;if(this._parentPositions.positions.forEach((s,a)=>{a===this._document||!s.clientRect||n||B7(s.clientRect,K7,t,i)&&([r,o]=Fce(a,s.clientRect,this._direction,t,i),(r||o)&&(n=a))}),!r&&!o){let{width:s,height:a}=this._viewportRuler.getViewportSize(),l={width:s,height:a,top:0,right:s,bottom:a,left:0};r=Z7(l,i),o=eI(l,t),n=window}n&&(r!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=o,this._scrollNode=n,(r||o)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(i=>i._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),Mh(0,Fh).pipe(Qi(this._stopScrollTimers)).subscribe(()=>{let t=this._scrollNode,i=this.autoScrollStep;this._verticalScrollDirection===An.UP?t.scrollBy(0,-i):this._verticalScrollDirection===An.DOWN&&t.scrollBy(0,i),this._horizontalScrollDirection===Li.LEFT?t.scrollBy(-i,0):this._horizontalScrollDirection===Li.RIGHT&&t.scrollBy(i,0)})};_isOverContainer(t,i){return this._domRect!=null&&GS(this._domRect,t,i)}_getSiblingContainerFromPosition(t,i,n){return this._siblings.find(r=>r._canReceive(t,i,n))}_canReceive(t,i,n){if(!this._domRect||!GS(this._domRect,i,n)||!this.enterPredicate(t,this))return!1;let r=this._getShadowRoot().elementFromPoint(i,n);return r?r===this._container||this._container.contains(r):!1}_startReceiving(t,i){let n=this._activeSiblings;!n.has(t)&&i.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(n.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:i}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let i=this._parentPositions.handleScroll(t);i&&this._sortStrategy.updateOnScroll(i.top,i.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=Gh(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(i=>i.isDragging());this._siblings.forEach(i=>i._startReceiving(this,t))}};function Z7(e,t){let{top:i,bottom:n,height:r}=e,o=r*Q7;return t>=i-o&&t<=i+o?An.UP:t>=n-o&&t<=n+o?An.DOWN:An.NONE}function eI(e,t){let{left:i,right:n,width:r}=e,o=r*Q7;return t>=i-o&&t<=i+o?Li.LEFT:t>=n-o&&t<=n+o?Li.RIGHT:Li.NONE}function Fce(e,t,i,n,r){let o=Z7(t,r),s=eI(t,n),a=An.NONE,l=Li.NONE;if(o){let c=e.scrollTop;o===An.UP?c>0&&(a=An.UP):e.scrollHeight-c>e.clientHeight&&(a=An.DOWN)}if(s){let c=e.scrollLeft;i==="rtl"?s===Li.RIGHT?c<0&&(l=Li.RIGHT):e.scrollWidth+c>e.clientWidth&&(l=Li.LEFT):s===Li.LEFT?c>0&&(l=Li.LEFT):e.scrollWidth-c>e.clientWidth&&(l=Li.RIGHT)}return[a,l]}var kh={capture:!0},zS={passive:!1,capture:!0},Mce=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(n,r){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return e})(),tI=(()=>{class e{_ngZone=ce(Ni);_document=ce(So);_styleLoader=ce(o3);_renderer=ce(w0).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new yt;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=xe([]);_globalListeners;_draggingPredicate=i=>i.isDragging();_domNodesToDirectives=null;pointerMove=new yt;pointerUp=new yt;constructor(){}registerDropContainer(i){this._dropInstances.has(i)||this._dropInstances.add(i)}registerDragItem(i){this._dragInstances.add(i),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,zS)})}removeDropContainer(i){this._dropInstances.delete(i)}removeDragItem(i){this._dragInstances.delete(i),this.stopDragging(i),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(i,n){if(!(this._activeDragInstances().indexOf(i)>-1)&&(this._styleLoader.load(Mce),this._activeDragInstances.update(r=>[...r,i]),this._activeDragInstances().length===1)){let r=n.type.startsWith("touch"),o=a=>this.pointerUp.next(a),s=[["scroll",a=>this._scroll.next(a),kh],["selectstart",this._preventDefaultWhileDragging,zS]];r?s.push(["touchend",o,kh],["touchcancel",o,kh]):s.push(["mouseup",o,kh]),r||s.push(["mousemove",a=>this.pointerMove.next(a),zS]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([a,l,c])=>this._renderer.listen(this._document,a,l,c))})}}stopDragging(i){this._activeDragInstances.update(n=>{let r=n.indexOf(i);return r>-1?(n.splice(r,1),[...n]):n}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(i){return this._activeDragInstances().indexOf(i)>-1}scrolled(i){let n=[this._scroll];return i&&i!==this._document&&n.push(new Pc(r=>this._ngZone.runOutsideAngular(()=>{let o=this._renderer.listen(i,"scroll",s=>{this._activeDragInstances().length&&r.next(s)},kh);return()=>{o()}}))),yo(...n)}registerDirectiveNode(i,n){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(i,n)}removeDirectiveNode(i){this._domNodesToDirectives?.delete(i)}getDragDirectiveForNode(i){return this._domNodesToDirectives?.get(i)||null}ngOnDestroy(){this._dragInstances.forEach(i=>this.removeDragItem(i)),this._dropInstances.forEach(i=>this.removeDropContainer(i)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=i=>{this._activeDragInstances().length>0&&i.preventDefault()};_persistentTouchmoveListener=i=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&i.preventDefault(),this.pointerMove.next(i))};_clearGlobalListeners(){this._globalListeners?.forEach(i=>i()),this._globalListeners=void 0}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Jn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Tce={dragStartThreshold:5,pointerDirectionChangeThreshold:5},YS=(()=>{class e{_document=ce(So);_ngZone=ce(Ni);_viewportRuler=ce(l3);_dragDropRegistry=ce(tI);_renderer=ce(w0).createRenderer(null,null);constructor(){}createDrag(i,n=Tce){return new US(i,n,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(i){return new qS(i,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Jn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Y7=new pn("CDK_DRAG_PARENT");var Ice=new pn("CdkDragHandle");var iI=new pn("CDK_DRAG_CONFIG"),nI=new pn("CdkDropList"),rI=(()=>{class e{element=ce(ci);dropContainer=ce(nI,{optional:!0,skipSelf:!0});_ngZone=ce(Ni);_viewContainerRef=ce(Oa);_dir=ce(zc,{optional:!0});_changeDetectorRef=ce(Nc);_selfHandle=ce(Ice,{optional:!0,self:!0});_parentDrag=ce(Y7,{optional:!0,skipSelf:!0});_dragDropRegistry=ce(tI);_destroyed=new yt;_handles=new m2([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(i){this._disabled=i,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new $;released=new $;ended=new $;entered=new $;exited=new $;dropped=new $;moved=new Pc(i=>{let n=this._dragRef.moved.pipe(xs(r=>({source:this,pointerPosition:r.pointerPosition,event:r.event,delta:r.delta,distance:r.distance}))).subscribe(i);return()=>{n.unsubscribe()}});_injector=ce(C0);constructor(){let i=this.dropContainer,n=ce(iI,{optional:!0}),r=ce(YS);this._dragRef=r.createDrag(this.element,{dragStartThreshold:n&&n.dragStartThreshold!=null?n.dragStartThreshold:5,pointerDirectionChangeThreshold:n&&n.pointerDirectionChangeThreshold!=null?n.pointerDirectionChangeThreshold:5,zIndex:n?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),n&&this._assignDefaults(n),i&&(i.addItem(this),i._dropListRef.beforeStarted.pipe(Qi(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(i){this._dragRef.setFreeDragPosition(i)}ngAfterViewInit(){Oh(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(i){let n=i.rootElementSelector,r=i.freeDragPosition;n&&!n.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(i){let n=this._handles.getValue();n.push(i),this._handles.next(n)}_removeHandle(i){let n=this._handles.getValue(),r=n.indexOf(i);r>-1&&(n.splice(r,1),this._handles.next(n))}_setPreviewTemplate(i){this._previewTemplate=i}_resetPreviewTemplate(i){i===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(i){this._placeholderTemplate=i}_resetPlaceholderTemplate(i){i===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let i=this.element.nativeElement,n=i;this.rootElementSelector&&(n=i.closest!==void 0?i.closest(this.rootElementSelector):i.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(n||i)}_getBoundaryElement(){let i=this.boundaryElement;return i?typeof i=="string"?this.element.nativeElement.closest(i):Hn(i):null}_syncInputs(i){i.beforeStarted.subscribe(()=>{if(!i.isDragging()){let n=this._dir,r=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;i.disabled=this.disabled,i.lockAxis=this.lockAxis,i.scale=this.scale,i.dragStartDelay=typeof r=="object"&&r?r:P0(r),i.constrainPosition=this.constrainPosition,i.previewClass=this.previewClass,i.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),n&&i.withDirection(n.value)}}),i.beforeStarted.pipe(Th(1)).subscribe(()=>{if(this._parentDrag){i.withParent(this._parentDrag._dragRef);return}let n=this.element.nativeElement.parentElement;for(;n;){let r=this._dragDropRegistry.getDragDirectiveForNode(n);if(r){i.withParent(r._dragRef);break}n=n.parentElement}})}_handleEvents(i){i.started.subscribe(n=>{this.started.emit({source:this,event:n.event}),this._changeDetectorRef.markForCheck()}),i.released.subscribe(n=>{this.released.emit({source:this,event:n.event})}),i.ended.subscribe(n=>{this.ended.emit({source:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),i.entered.subscribe(n=>{this.entered.emit({container:n.container.data,item:this,currentIndex:n.currentIndex})}),i.exited.subscribe(n=>{this.exited.emit({container:n.container.data,item:this})}),i.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,isPointerOverContainer:n.isPointerOverContainer,item:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event})})}_assignDefaults(i){let{lockAxis:n,dragStartDelay:r,constrainPosition:o,previewClass:s,boundaryElement:a,draggingDisabled:l,rootElementSelector:c,previewContainer:d}=i;this.disabled=l??!1,this.dragStartDelay=r||0,this.lockAxis=n||null,o&&(this.constrainPosition=o),s&&(this.previewClass=s),a&&(this.boundaryElement=a),c&&(this.rootElementSelector=c),d&&(this.previewContainer=d)}_setupHandlesListener(){this._handles.pipe(hn(i=>{let n=i.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&n.push(this.element),this._dragRef.withHandles(n)}),Ji(i=>yo(...i.map(n=>n._stateChanges.pipe(kc(n))))),Qi(this._destroyed)).subscribe(i=>{let n=this._dragRef,r=i.element.nativeElement;i.disabled?n.disableHandle(r):n.enableHandle(r)})}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(n,r){n&2&&At("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",H],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",Bc]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[it([{provide:Y7,useExisting:e}]),Ah]})}return e})(),X7=new pn("CdkDropListGroup");var oI=(()=>{class e{element=ce(ci);_changeDetectorRef=ce(Nc);_scrollDispatcher=ce(a3);_dir=ce(zc,{optional:!0});_group=ce(X7,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new yt;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=ce(d3).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(i){this._dropListRef.disabled=this._disabled=i}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new $;entered=new $;exited=new $;sorted=new $;_unsortedItems=new Set;constructor(){let i=ce(YS),n=ce(iI,{optional:!0});this._dropListRef=i.createDropList(this.element),this._dropListRef.data=this,n&&this._assignDefaults(n),this._dropListRef.enterPredicate=(r,o)=>this.enterPredicate(r.data,o.data),this._dropListRef.sortPredicate=(r,o,s)=>this.sortPredicate(r,o.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(i){this._unsortedItems.add(i),i._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(n=>n._dragRef))}removeItem(i){if(this._unsortedItems.delete(i),this._latestSortedRefs){let n=this._latestSortedRefs.indexOf(i._dragRef);n>-1&&(this._latestSortedRefs.splice(n,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((i,n)=>i._dragRef.getVisibleElement().compareDocumentPosition(n._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let i=e._dropLists.indexOf(this);i>-1&&e._dropLists.splice(i,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(i){this._dir&&this._dir.change.pipe(kc(this._dir.value),Qi(this._destroyed)).subscribe(n=>i.withDirection(n)),i.beforeStarted.subscribe(()=>{let n=s3(this.connectedTo).map(r=>{if(typeof r=="string"){let o=e._dropLists.find(s=>s.id===r);return o}return r});if(this._group&&this._group._items.forEach(r=>{n.indexOf(r)===-1&&n.push(r)}),!this._scrollableParentsResolved){let r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let r=this.element.nativeElement.querySelector(this.elementContainerSelector);i.withElementContainer(r)}i.disabled=this.disabled,i.lockAxis=this.lockAxis,i.sortingDisabled=this.sortingDisabled,i.autoScrollDisabled=this.autoScrollDisabled,i.autoScrollStep=P0(this.autoScrollStep,2),i.hasAnchor=this.hasAnchor,i.connectedTo(n.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(i){i.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(n=>n._dragRef)),this._changeDetectorRef.markForCheck()}),i.entered.subscribe(n=>{this.entered.emit({container:this,item:n.item.data,currentIndex:n.currentIndex})}),i.exited.subscribe(n=>{this.exited.emit({container:this,item:n.item.data}),this._changeDetectorRef.markForCheck()}),i.sorted.subscribe(n=>{this.sorted.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,container:this,item:n.item.data})}),i.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,item:n.item.data,isPointerOverContainer:n.isPointerOverContainer,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),yo(i.receivingStarted,i.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(i){let{lockAxis:n,draggingDisabled:r,sortingDisabled:o,listAutoScrollDisabled:s,listOrientation:a}=i;this.disabled=r??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=s??!1,this.orientation=a||"vertical",this.lockAxis=n||null}_syncItemsWithRef(i){this._latestSortedRefs=i,this._dropListRef.withItems(i)}static \u0275fac=function(n){return new(n||e)};static \u0275dir=Pi({type:e,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(n,r){n&2&&(Es("id",r.id),At("cdk-drop-list-disabled",r.disabled)("cdk-drop-list-dragging",r._dropListRef.isDragging())("cdk-drop-list-receiving",r._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",H],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",H],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",H],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",H]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[it([{provide:X7,useValue:void 0},{provide:nI,useExisting:e}])]})}return e})();var sI=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=Mc({type:e});static \u0275inj=Dc({providers:[YS],imports:[c3]})}return e})();var aI=e=>[e],lI=(e,t)=>t.id;function Oce(e,t){if(e&1){let i=Ue();A(0,"div",7)(1,"div",11)(2,"div",12),ge(3),I(),A(4,"div",13),ge(5),I()(),A(6,"button",14),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.addMaterial(r))}),le(7,"ng-icon",15),I()()}if(e&2){let i=t.$implicit;L(3),Qe(i.name),L(2),qe("",i.thickness," mm")}}function Lce(e,t){e&1&&(A(0,"div",8),ge(1,"Keine Materialien verf\xFCgbar"),I())}function Nce(e,t){if(e&1){let i=Ue();A(0,"div",7)(1,"div",16)(2,"span",17),ge(3),I(),A(4,"div",11)(5,"div",12),ge(6),I(),A(7,"div",13),ge(8),I()()(),A(9,"div",18)(10,"button",19),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.moveUp(r))}),le(11,"ng-icon",20),I(),A(12,"button",19),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.moveDown(r))}),le(13,"ng-icon",21),I(),A(14,"button",22),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.removeMaterial(r))}),le(15,"ng-icon",23),I()()()}if(e&2){let i=t.$implicit,n=te();L(3),Qe(i.position),L(3),Qe(i.material.name),L(2),qe("",i.material.thickness," mm"),L(2),ve("disabled",i.position===1),L(2),ve("disabled",i.position===n.selectedLayers().length)}}function Bce(e,t){e&1&&(A(0,"div",8),ge(1,"Keine Schichten hinzugef\xFCgt"),I())}var cI=(()=>{class e{allMaterials=De.required();initialSelectedLayers=De([]);layersChanged=Ce();selectedLayersSignal=xe([]);selectedLayers=this.selectedLayersSignal.asReadonly();availableMaterials=Ie(()=>{let i=new Set(this.selectedLayers().map(n=>n.materialId));return this.allMaterials().filter(n=>!i.has(n.id))});constructor(){ht(()=>{let i=this.initialSelectedLayers();i.length>0&&this.selectedLayersSignal().length===0&&this.selectedLayersSignal.set([...i])})}totalThickness=Ie(()=>this.selectedLayers().reduce((i,n)=>i+n.material.thickness,0));addMaterial(i){let n=this.selectedLayersSignal(),r=n.length>0?Math.max(...n.map(s=>s.position)):0,o={id:crypto.randomUUID(),materialId:i.id,material:i,position:r+1};this.selectedLayersSignal.update(s=>[...s,o]),this.emitChanges()}removeMaterial(i){this.selectedLayersSignal.update(n=>n.filter(o=>o.id!==i.id).sort((o,s)=>o.position-s.position).map((o,s)=>T(w({},o),{position:s+1}))),this.emitChanges()}moveUp(i){i.position!==1&&(this.selectedLayersSignal.update(n=>{let r=[...n].sort((s,a)=>s.position-a.position),o=r.findIndex(s=>s.id===i.id);return o>0?([r[o-1],r[o]]=[r[o],r[o-1]],r.map((s,a)=>T(w({},s),{position:a+1}))):n}),this.emitChanges())}moveDown(i){let n=this.selectedLayers();i.position!==n.length&&(this.selectedLayersSignal.update(r=>{let o=[...r].sort((a,l)=>a.position-l.position),s=o.findIndex(a=>a.id===i.id);return s<o.length-1?([o[s],o[s+1]]=[o[s+1],o[s]],o.map((a,l)=>T(w({},a),{position:l+1}))):r}),this.emitChanges())}onDropAvailable(i){if(i.previousContainer!==i.container){let n=i.previousContainer.data[i.previousIndex];this.removeMaterial(n)}}onDropSelected(i){if(i.previousContainer===i.container){let n=[...this.selectedLayersSignal()];c0(n,i.previousIndex,i.currentIndex);let r=n.map((o,s)=>T(w({},o),{position:s+1}));this.selectedLayersSignal.set(r),this.emitChanges()}else{let n=i.previousContainer.data[i.previousIndex];this.addMaterial(n)}}emitChanges(){this.layersChanged.emit(this.selectedLayersSignal())}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-material-dual-list"]],inputs:{allMaterials:[1,"allMaterials"],initialSelectedLayers:[1,"initialSelectedLayers"]},outputs:{layersChanged:"layersChanged"},features:[it([di({lucideArrowRight:O2,lucideTrash:tr,lucideChevronUp:H2,lucideChevronDown:B2})])],decls:26,vars:11,consts:[["availableList","cdkDropList"],["selectedList","cdkDropList"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"border","rounded-lg","p-4"],[1,"font-semibold","mb-3"],[1,"h-[400px]","overflow-y-auto"],["cdkDropList","",1,"space-y-2","min-h-[50px]","p-2",3,"cdkDropListDropped","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"flex","items-center","justify-between","p-3","bg-muted","rounded-md","border","cursor-move","hover:bg-accent","transition-colors"],[1,"text-center","text-muted-foreground","p-4"],[1,"text-sm","font-normal","text-muted-foreground","ml-2"],[1,"mt-4","text-sm","text-muted-foreground"],[1,"flex-1","min-w-0"],[1,"font-medium","truncate"],[1,"text-sm","text-muted-foreground"],["hlmBtn","","size","icon-sm","variant","ghost",1,"flex-shrink-0","ml-2",3,"click"],["hlm","","name","lucideArrowRight","size","sm"],[1,"flex","items-center","gap-2","flex-1","min-w-0"],[1,"text-xs","font-semibold","text-muted-foreground","w-6"],[1,"flex","gap-1","flex-shrink-0","ml-2"],["hlmBtn","","size","icon-sm","variant","ghost",3,"click","disabled"],["hlm","","name","lucideChevronUp","size","sm"],["hlm","","name","lucideChevronDown","size","sm"],["hlmBtn","","size","icon-sm","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm"]],template:function(n,r){if(n&1){let o=Ue();A(0,"div",2)(1,"div",3)(2,"h3",4),ge(3,"Verf\xFCgbare Materialien"),I(),A(4,"div",5)(5,"div",6,0),de("cdkDropListDropped",function(a){return ue(o),he(r.onDropAvailable(a))}),On(7,Oce,8,2,"div",7,lI),Ve(9,Lce,2,0,"div",8),I()()(),A(10,"div",3)(11,"h3",4),ge(12," Ausgew\xE4hlte Schichten "),A(13,"span",9),ge(14,"Gesamtdicke: "),A(15,"strong"),ge(16),I()()(),A(17,"div",5)(18,"div",6,1),de("cdkDropListDropped",function(a){return ue(o),he(r.onDropSelected(a))}),On(20,Nce,16,5,"div",7,lI),Ve(22,Bce,2,0,"div",8),I()()()(),A(23,"div",10)(24,"p"),ge(25,"\u{1F4A1} Tipp: Ziehen Sie Materialien per Drag & Drop zwischen den Listen oder verwenden Sie die Buttons. Position 1 = au\xDFen."),I()()}if(n&2){let o=S0(6),s=S0(19);L(5),ve("cdkDropListData",r.availableMaterials())("cdkDropListConnectedTo",Oc(7,aI,s)),L(2),Ln(r.availableMaterials()),L(2),Ge(r.availableMaterials().length===0?9:-1),L(7),qe("",r.totalThickness()," mm"),L(2),ve("cdkDropListData",r.selectedLayers())("cdkDropListConnectedTo",Oc(9,aI,o)),L(2),Ln(r.selectedLayers()),L(2),Ge(r.selectedLayers().length===0?22:-1)}},dependencies:[gn,sI,oI,rI,Rt,hi,ui],encapsulation:2,changeDetection:0})}return e})();function Hce(e,t){e&1&&(A(0,"p",9),ge(1,"Materialname ist erforderlich"),I())}function zce(e,t){e&1&&(A(0,"p",9),ge(1,"Dicke ist erforderlich und muss eine positive Zahl sein"),I())}function Vce(e,t){if(e&1){let i=Ue();A(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),ge(3),I(),A(4,"p",4),ge(5,"Geben Sie die Details f\xFCr das Material ein."),I()(),A(6,"form",5)(7,"div",6)(8,"label",7),ge(9,"Materialname *"),I(),le(10,"input",8),Ve(11,Hce,2,0,"p",9),I(),A(12,"div",6)(13,"label",10),ge(14,"Dicke (mm) *"),I(),le(15,"input",11),Ve(16,zce,2,0,"p",9),I(),A(17,"div",6)(18,"label",12),ge(19,"Beschreibung"),I(),le(20,"input",13),I()(),A(21,"hlm-sheet-footer",14)(22,"button",15),de("click",function(){let r=ue(i).$implicit;return he(r.close())}),ge(23," Abbrechen "),I(),A(24,"button",16),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.save(r))}),ge(25," Speichern "),I()()()}if(e&2){let i=te();L(3),Qe(i.isEdit()?"Material bearbeiten":"Neues Material"),L(3),ve("formGroup",i.form),L(5),Ge(i.form.controls.name.touched&&i.form.controls.name.invalid?11:-1),L(5),Ge(i.form.controls.thickness.touched&&i.form.controls.thickness.invalid?16:-1),L(8),ve("disabled",i.form.invalid)}}var dI=(()=>{class e{material=De(null);state=De("closed");stateChanged=Ce();save$=Ce();isEdit=Ie(()=>!!this.material()?.id);form=new Ba({name:new Bn("",[_o.required]),thickness:new Bn(null,[_o.required,_o.min(0)]),description:new Bn("")});constructor(){ht(()=>{let i=this.material();i?this.form.patchValue({name:i.name||"",thickness:i.thickness||0,description:i.description||""}):this.form.reset()})}save(i){if(this.form.invalid)return;let n=this.form.value;this.save$.emit({name:n.name||"",thickness:n.thickness||0,description:n.description||""}),this.form.reset(),i.close()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-material-edit-sheet"]],inputs:{material:[1,"material"],state:[1,"state"]},outputs:{stateChanged:"stateChanged",save$:"save$"},decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-md",4,"brnSheetContent"],[1,"w-full","sm:max-w-md"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-4","p-4",3,"formGroup"],[1,"space-y-2"],["hlmLabel","","for","name"],["hlmInput","","id","name","formControlName","name","placeholder","z.B. Holz, Ziegel"],[1,"text-sm","text-destructive"],["hlmLabel","","for","thickness"],["hlmInput","","id","thickness","type","number","formControlName","thickness","placeholder","z.B. 20"],["hlmLabel","","for","description"],["hlmInput","","id","description","formControlName","description","placeholder","Optionale Beschreibung"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"]],template:function(n,r){n&1&&(A(0,"hlm-sheet",0),de("stateChanged",function(s){return r.stateChanged.emit(s)}),Qn(1,Vce,26,5,"hlm-sheet-content",1),I()),n&2&&ve("state",r.state())},dependencies:[Wa,Ha,Zn,T2,er,Na,Va,za,Fo,Mo,To,Io,Ao,Oo,Lo,Rt,Cn,wn],encapsulation:2,changeDetection:0})}return e})();var Hr=class{supabaseGlobal=ce(ja);supabase=this.supabaseGlobal.supabase;loadingCount=xe(0);loading=Ie(()=>this.loadingCount()>0);materialLayers=Nn({loader:async()=>{let{data:t,error:i}=await this.supabase.from("material_layers").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});wallStructures=Nn({loader:async()=>{let{data:t,error:i}=await this.supabase.from("wall_structures").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});selectedStructureIdSignal=xe(null);structureLayers=Nn({params:()=>({structureId:this.selectedStructureIdSignal()}),loader:async({params:t})=>{if(!t.structureId)return[];let{data:i,error:n}=await this.supabase.from("wall_structure_layers").select(`
          *,
          material:material_layers(*)
        `).eq("wall_structure_id",t.structureId).order("position",{ascending:!0});if(n)throw n;return i||[]}});selectedStructureId=Ie(()=>this.selectedStructureIdSignal());selectStructure(t){this.selectedStructureIdSignal.set(t)}createMaterialLayer(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("material_layers").insert({name:t.name,thickness:t.thickness,description:t.description||null}).select().single()).pipe(tt(i=>(console.error("Error creating material layer:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}updateMaterialLayer(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("material_layers").update(i).eq("id",t).select().single()).pipe(tt(n=>(console.error("Error updating material layer:",n),Ye({error:n}))),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.materialLayers.reload()})}deleteMaterialLayers(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("material_layers").delete().in("id",t)).pipe(tt(i=>(console.error("Error deleting material layers:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.materialLayers.reload()})}createWallStructure(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("wall_structures").insert({name:t.name}).select().single()).pipe(tt(i=>(console.error("Error creating wall structure:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.wallStructures.reload()})}createWallStructureWithLayers(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("wall_structures").insert({name:t.name}).select().single()).pipe(tt(n=>(console.error("Error creating wall structure:",n),Ye({error:n}))),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;let r=n.data;i.length>0&&this.addLayersToStructureSync(r.id,i),this.wallStructures.reload()})}updateWallStructure(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("wall_structures").update(i).eq("id",t).select().single()).pipe(tt(n=>(console.error("Error updating wall structure:",n),Ye({error:n}))),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error)throw n.error;this.wallStructures.reload()})}updateWallStructureWithLayers(t,i,n){this.loadingCount.update(r=>r+1),je(this.supabase.from("wall_structures").update(i).eq("id",t).select().single()).pipe(tt(r=>(console.error("Error updating wall structure:",r),Ye({error:r}))),Je(()=>this.loadingCount.update(r=>r-1))).subscribe(r=>{if(r?.error)throw r.error;this.replaceStructureLayers(t,n),this.wallStructures.reload()})}deleteWallStructure(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("wall_structures").delete().eq("id",t)).pipe(tt(i=>(console.error("Error deleting wall structure:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.wallStructures.reload(),this.selectedStructureIdSignal()===t&&this.selectedStructureIdSignal.set(null)})}addLayerToStructure(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("wall_structure_layers").insert(t).select().single()).pipe(tt(i=>(console.error("Error adding layer to structure:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}removeLayersFromStructure(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("wall_structure_layers").delete().in("id",t)).pipe(tt(i=>(console.error("Error removing layers from structure:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error)throw i.error;this.structureLayers.reload()})}addLayersToStructureSync(t,i){this.loadingCount.update(r=>r+1);let n=i.map(r=>({wall_structure_id:t,material_layer_id:r.materialId,position:r.position}));je(this.supabase.from("wall_structure_layers").insert(n)).pipe(tt(r=>(console.error("Error adding layers to structure:",r),Ye({error:r}))),Je(()=>this.loadingCount.update(r=>r-1))).subscribe(r=>{if(r?.error)throw r.error;this.structureLayers.reload()})}replaceStructureLayers(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("wall_structure_layers").delete().eq("wall_structure_id",t)).pipe(tt(n=>(console.error("Error removing existing layers:",n),Ye({error:n})))).subscribe(n=>{if(n?.error)throw this.loadingCount.update(r=>r-1),n.error;if(i.length>0){let r=i.map(o=>({wall_structure_id:t,material_layer_id:o.materialId,position:o.position}));je(this.supabase.from("wall_structure_layers").insert(r)).pipe(tt(o=>(console.error("Error adding new layers:",o),Ye({error:o}))),Je(()=>this.loadingCount.update(o=>o-1))).subscribe(o=>{if(o?.error)throw o.error;this.structureLayers.reload()})}else this.loadingCount.update(r=>r-1),this.structureLayers.reload()})}};function Gce(e,t){e&1&&(A(0,"div",5),le(1,"hlm-spinner",10),I())}function Wce(e,t){e&1&&(A(0,"p",15),ge(1,"Name ist erforderlich"),I())}function Uce(e,t){if(e&1){let i=Ue();A(0,"gh-material-dual-list",18),de("layersChanged",function(r){ue(i);let o=te(3);return he(o.onLayersChanged(r))}),I()}if(e&2){let i=te(3);ve("allMaterials",i.allMaterials())("initialSelectedLayers",i.currentLayers())}}function jce(e,t){if(e&1){let i=Ue();A(0,"gh-material-dual-list",19),de("layersChanged",function(r){ue(i);let o=te(3);return he(o.onLayersChanged(r))}),I()}if(e&2){let i=te(3);ve("allMaterials",i.allMaterials())}}function qce(e,t){if(e&1&&(A(0,"div",6)(1,"form",11)(2,"div",12)(3,"label",13),ge(4,"Wandaufbau Name *"),I(),le(5,"input",14),Ve(6,Wce,2,0,"p",15),I()(),Ve(7,Uce,1,2,"gh-material-dual-list",16)(8,jce,1,1,"gh-material-dual-list",17),I()),e&2){let i=te(2);L(),ve("formGroup",i.form),L(5),Ge(i.form.controls.name.touched&&i.form.controls.name.invalid?6:-1),L(),Ge(i.isEdit()?7:8)}}function $ce(e,t){if(e&1){let i=Ue();A(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),ge(3),I(),A(4,"p",4),ge(5,"Geben Sie den Namen ein und w\xE4hlen Sie die Materialien f\xFCr den Aufbau aus."),I()(),Ve(6,Gce,2,0,"div",5)(7,qce,9,3,"div",6),A(8,"hlm-sheet-footer",7)(9,"button",8),de("click",function(){let r=ue(i).$implicit;return he(r.close())}),ge(10," Abbrechen "),I(),A(11,"button",9),de("click",function(){let r=ue(i).$implicit,o=te();return he(o.save(r))}),ge(12," Speichern "),I()()()}if(e&2){let i=te();L(3),Qe(i.isEdit()?"Wandaufbau bearbeiten":"Neuer Wandaufbau"),L(3),Ge(i.loadingLayers()?6:7),L(5),ve("disabled",i.form.invalid||i.service.loading())}}var uI=(()=>{class e{service=ce(Hr);structure=De(null);state=De("closed");stateChanged=Ce();save$=Ce();isEdit=Ie(()=>!!this.structure()?.id);selectedLayersSignal=xe([]);form=new Ba({name:new Bn("",[_o.required])});allMaterials=Ie(()=>this.service.materialLayers.value()||[]);loadingLayers=Ie(()=>this.structure()&&this.service.structureLayers.isLoading());currentLayers=Ie(()=>this.structure()?(this.service.structureLayers.value()||[]).map(r=>({id:r.id,materialId:r.material_layer_id,material:r.material,position:r.position})):[]);constructor(){ht(()=>{let i=this.structure();i?(this.form.patchValue({name:i.name||""}),this.service.selectStructure(i.id)):(this.form.reset(),this.selectedLayersSignal.set([]),this.service.selectStructure(null))})}onLayersChanged(i){this.selectedLayersSignal.set(i)}save(i){if(this.form.invalid)return;let n=this.form.value;this.save$.emit({structure:{name:n.name||""},layers:this.selectedLayersSignal()}),this.form.reset(),this.selectedLayersSignal.set([]),i.close()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-wall-structure-edit-sheet"]],inputs:{structure:[1,"structure"],state:[1,"state"]},outputs:{stateChanged:"stateChanged",save$:"save$"},decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-5xl",4,"brnSheetContent"],[1,"w-full","sm:max-w-5xl"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"flex","justify-center","items-center","h-[500px]"],[1,"space-y-6","p-4","overflow-y-auto","max-h-[calc(100vh-200px)]"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlmBtn","",3,"click","disabled"],["size","large"],[3,"formGroup"],[1,"space-y-2"],["hlmLabel","","for","name"],["hlmInput","","id","name","formControlName","name","placeholder","z.B. Au\xDFenwand mit D\xE4mmung"],[1,"text-sm","text-destructive"],[3,"allMaterials","initialSelectedLayers"],[3,"allMaterials"],[3,"layersChanged","allMaterials","initialSelectedLayers"],[3,"layersChanged","allMaterials"]],template:function(n,r){n&1&&(A(0,"hlm-sheet",0),de("stateChanged",function(s){return r.stateChanged.emit(s)}),Qn(1,$ce,13,3,"hlm-sheet-content",1),I()),n&2&&ve("state",r.state())},dependencies:[Wa,Ha,Zn,er,Na,Va,za,Fo,Mo,To,Io,Ao,Oo,Lo,Rt,Cn,wn,ir,cI],encapsulation:2,changeDetection:0})}return e})();function Kce(e,t){e&1&&(A(0,"p",12),ge(1),be(2,"transloco"),I()),e&2&&(L(),Qe(ye(2,1,"flexibleItems.dialog.nameRequired")))}function Yce(e,t){if(e&1){let i=Ue();A(0,"hlm-sheet-content",2)(1,"hlm-sheet-header")(2,"h3",3),ge(3),be(4,"transloco"),I(),A(5,"p",4),ge(6),be(7,"transloco"),I()(),A(8,"form",5),de("ngSubmit",function(){ue(i);let r=te();return he(r.onSubmit())}),A(9,"div",6),le(10,"gh-icon-picker",7),I(),A(11,"div",8)(12,"div",9)(13,"label",10),ge(14),be(15,"transloco"),I(),le(16,"input",11),be(17,"transloco"),Ve(18,Kce,3,3,"p",12),I()(),A(19,"div",13)(20,"label",14),ge(21),be(22,"transloco"),I(),A(23,"gh-tiptap-editor",15),de("contentChange",function(r){ue(i);let o=te();return o.form.controls.description.setValue(r),o.form.controls.description.markAsDirty(),he(o.form.controls.description.markAsTouched())}),I(),A(24,"p",16),ge(25),be(26,"transloco"),I()(),A(27,"div",13)(28,"gh-property-editor",17),de("valueChange",function(r){ue(i);let o=te();return o.form.controls.userProperties.setValue(r),o.form.controls.userProperties.markAsDirty(),he(o.form.controls.userProperties.markAsTouched())}),I()()(),A(29,"hlm-sheet-footer",18)(30,"button",19),de("click",function(){ue(i);let r=te();return he(r.onCancel())}),ge(31),be(32,"transloco"),I(),A(33,"button",20),de("click",function(){ue(i);let r=te();return he(r.onSubmit())}),ge(34),be(35,"transloco"),I()()()}if(e&2){let i=te();L(3),Qe(ye(4,14,i.dialogTitle())),L(3),qe(" ",ye(7,16,"flexibleItems.dialog.description")," "),L(2),ve("formGroup",i.form),L(6),Qe(ye(15,18,"flexibleItems.dialog.nameLabel")),L(2),ve("placeholder",ye(17,20,"flexibleItems.dialog.namePlaceholder")),L(2),Ge(i.form.controls.name.invalid&&i.form.controls.name.touched?18:-1),L(3),Qe(ye(22,22,"flexibleItems.dialog.descriptionLabel")),L(2),ve("initialContent",i.form.controls.description.value),L(2),Qe(ye(26,24,"flexibleItems.dialog.descriptionHint")),L(3),ve("mode","view")("initialValue",i.form.controls.userProperties.value),L(3),qe(" ",ye(32,26,"common.cancel")," "),L(2),ve("disabled",i.form.invalid),L(),qe(" ",ye(35,28,"common.save")," ")}}var hI=(()=>{class e{service=ce(Ar);state=De.required();item=De(null);stateChanged=Ce();form=new Ba({name:new Bn("",{nonNullable:!0,validators:[_o.required]}),description:new Bn("",{nonNullable:!0}),userProperties:new Bn(null,{nonNullable:!0}),icon:new Bn("lucideBox",{nonNullable:!0})});dialogTitle=Ie(()=>this.item()?"flexibleItems.dialog.editTitle":"flexibleItems.dialog.addTitle");constructor(){ht(()=>{let i=this.item();console.log("Current Item changed:",i),i?this.form.patchValue({name:i.name,description:i.description||"",userProperties:i.user_defined_properties||null,icon:i.icon||"lucideBox"}):this.form.reset({name:"",description:"",userProperties:null,icon:"lucideBox"})})}onSubmit(){if(this.form.invalid)return;let i=this.form.value,n=i.userProperties&&i.userProperties.length>0?i.userProperties:void 0,r=this.item();r?this.service.updateItem(r.id,{name:i.name,description:i.description||void 0,icon:i.icon||void 0,user_defined_properties:n}):this.service.createItem({name:i.name,description:i.description||void 0,icon:i.icon||void 0,user_defined_properties:n}),this.stateChanged.emit("closed")}onCancel(){this.stateChanged.emit("closed")}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-flexible-item-dialog"]],inputs:{state:[1,"state"],item:[1,"item"]},outputs:{stateChanged:"stateChanged"},features:[it([di(Rs)])],decls:2,vars:1,consts:[["side","right",3,"stateChanged","state"],["class","w-full sm:max-w-3xl",4,"brnSheetContent"],[1,"w-full","sm:max-w-3xl"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-6","p-4","overflow-y-auto","max-h-[calc(100vh-200px)]",3,"ngSubmit","formGroup"],[1,"flex","justify-center","items-center"],["formControlName","icon"],[1,"flex","gap-2","items-center","w-full"],[1,"space-y-2","flex-1"],["hlmLabel","","for","name"],["hlmInput","","id","name","type","text","formControlName","name","required","",3,"placeholder"],[1,"text-sm","text-destructive"],[1,"space-y-2"],["hlmLabel",""],["minHeight","200px",3,"contentChange","initialContent"],[1,"text-xs","text-muted-foreground"],[3,"valueChange","mode","initialValue"],[1,"flex","justify-end","gap-2"],["hlmBtn","","variant","outline","type","button",3,"click"],["hlmBtn","","variant","default","type","button",3,"click","disabled"]],template:function(n,r){n&1&&(A(0,"hlm-sheet",0),de("stateChanged",function(s){return r.stateChanged.emit(s)}),Qn(1,Yce,36,30,"hlm-sheet-content",1),I()),n&2&&ve("state",r.state())},dependencies:[Wa,Ha,Zn,er,Na,I2,Va,za,vn,Fo,Mo,To,Io,Ao,Oo,Lo,Rt,Cn,wn,A7,f_,v3,mn],encapsulation:2,changeDetection:0})}return e})();function Xce(e,t){e&1&&(A(0,"div",8),le(1,"hlm-spinner",11),I())}function Jce(e,t){if(e&1){let i=Ue();A(0,"div",9)(1,"ag-grid-angular",12),de("gridReady",function(r){ue(i);let o=te();return he(o.onGridReady(r))}),I()()}if(e&2){let i=te();L(),ve("rowData",i.items())("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.rowSelection)("theme",i.theme)}}vm.registerModules([Mm]);var pI=(()=>{class e{theme=Pm;service=ce(Ar);gridApi=xe(null);sheetState=xe("closed");editingItem=xe(null);items=Ie(()=>this.service.flexibleItems.value()||[]);loading=Ie(()=>this.service.flexibleItems.isLoading()||this.service.loading());columnDefs=[{field:"name",headerName:"Name",flex:1,minWidth:200},{field:"description",headerName:"Beschreibung",flex:2,minWidth:250,valueFormatter:i=>{if(!i.value)return"";let n=document.createElement("div");return n.innerHTML=i.value,n.textContent||n.innerText||""}},{field:"user_defined_properties",headerName:"Eigenschaften",flex:1,minWidth:150,valueFormatter:i=>!i.value||Object.keys(i.value).length===0?"-":`${Object.keys(i.value).length} Eigenschaften`},{field:"created_at",headerName:"Erstellt am",width:180,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString("de-DE"):""},{headerName:"Aktionen",width:100,cellRenderer:Ra,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editItem(i)}]},sortable:!1,filter:!1}];defaultColDef={sortable:!0,filter:!0,resizable:!0};rowSelection={mode:"multiRow"};onGridReady(i){this.gridApi.set(i.api)}addItem(){this.editingItem.set(null),this.sheetState.set("open")}editItem(i){this.editingItem.set(i),this.sheetState.set("open")}deleteSelectedItems(){let i=this.gridApi();if(!i)return;let n=i.getSelectedRows();if(n.length===0){alert("Bitte w\xE4hlen Sie mindestens ein Element aus.");return}if(confirm(`M\xF6chten Sie wirklich ${n.length} Element(e) l\xF6schen?`)){let r=n.map(o=>o.id);this.service.deleteItems(r)}}onSheetStateChanged(i){this.sheetState.set(i),i==="closed"&&this.editingItem.set(null)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-flexible-items"]],features:[it([Ar,di({lucidePlus:Do,lucideTrash:tr,lucidePencil:Ua})])],decls:17,vars:15,consts:[[1,"p-4","md:p-6","space-y-6"],[1,"flex","flex-col","space-y-4"],[3,"title","description"],[1,"flex","flex-wrap","gap-2"],["hlmBtn","","variant","default",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmBtn","","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],[1,"flex","justify-center","p-8"],[1,"h-[600px]","w-full"],[3,"stateChanged","state","item"],["size","large"],[1,"w-full","h-full",3,"gridReady","rowData","columnDefs","defaultColDef","rowSelection","theme"]],template:function(n,r){n&1&&(A(0,"div",0)(1,"div",1),le(2,"gh-section-header",2),be(3,"transloco"),be(4,"transloco"),A(5,"div",3)(6,"button",4),de("click",function(){return r.addItem()}),le(7,"ng-icon",5),ge(8),be(9,"transloco"),I(),A(10,"button",6),de("click",function(){return r.deleteSelectedItems()}),le(11,"ng-icon",7),ge(12),be(13,"transloco"),I()()(),Ve(14,Xce,2,0,"div",8)(15,Jce,2,5,"div",9),I(),A(16,"gh-flexible-item-dialog",10),de("stateChanged",function(s){return r.onSheetStateChanged(s)}),I()),n&2&&(L(2),ve("title",ye(3,7,"flexibleItems.title"))("description",ye(4,9,"flexibleItems.description")),L(6),qe(" ",ye(9,11,"flexibleItems.addNew")," "),L(4),qe(" ",ye(13,13,"flexibleItems.deleteSelected")," "),L(2),Ge(r.loading()?14:15),L(2),ve("state",r.sheetState())("item",r.editingItem()))},dependencies:[gn,cc,Rt,ir,hi,ui,vn,qa,hI,mn],encapsulation:2,changeDetection:0})}return e})();var Ss=class{supabaseGlobal=ce(ja);authService=ce(g3);supabase=this.supabaseGlobal.supabase;loadingCount=xe(0);loading=Ie(()=>this.loadingCount()>0);plans=Nn({loader:async()=>{let{data:t,error:i}=await this.supabase.from("house_plans").select("*").order("created_at",{ascending:!1});if(i)throw i;return t||[]}});planIdSignal=xe(null);currentPlan=Nn({params:()=>({planId:this.planIdSignal()}),loader:async({params:t})=>{if(!t.planId)return null;let{data:i,error:n}=await this.supabase.from("house_plans").select("*").eq("id",t.planId).single();if(n)throw n;return i}});currentPlanWalls=Nn({params:()=>({planId:this.planIdSignal()}),loader:async({params:t})=>{if(!t.planId)return[];let{data:i,error:n}=await this.supabase.from("house_plan_walls").select("*").eq("house_plan_id",t.planId).order("created_at",{ascending:!0});if(n)throw n;return i||[]}});loadPlan(t){this.planIdSignal.set(t)}createPlan(t){this.loadingCount.update(n=>n+1);let i=this.authService.user()?.id;if(!i){console.error("User not authenticated"),this.loadingCount.update(n=>n-1);return}je(this.supabase.from("house_plans").insert({user_id:i,name:t.name,description:t.description||null,scale:t.scale||20}).select().single()).pipe(tt(n=>(console.error("Error creating plan:",n),Ye({error:n}))),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to create plan:",n.error);return}this.plans.reload()})}updatePlan(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("house_plans").update(i).eq("id",t).select().single()).pipe(tt(n=>(console.error("Error updating plan:",n),Ye({error:n}))),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to update plan:",n.error);return}this.plans.reload(),this.planIdSignal()===t&&this.currentPlan.reload()})}deletePlan(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("house_plans").delete().eq("id",t)).pipe(tt(i=>(console.error("Error deleting plan:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete plan:",i.error);return}this.plans.reload()})}clearCurrentPlan(){this.planIdSignal.set(null)}createWall(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("house_plan_walls").insert({house_plan_id:t.house_plan_id,wall_structure_id:t.wall_structure_id||null,name:t.name||null,start_x:t.start_x,start_y:t.start_y,end_x:t.end_x,end_y:t.end_y,color:t.color||"#000000"}).select().single()).pipe(tt(i=>(console.error("Error creating wall:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to create wall:",i.error);return}this.planIdSignal()===t.house_plan_id&&this.currentPlanWalls.reload()})}updateWall(t,i){this.loadingCount.update(n=>n+1),je(this.supabase.from("house_plan_walls").update(i).eq("id",t).select().single()).pipe(tt(n=>(console.error("Error updating wall:",n),Ye({error:n}))),Je(()=>this.loadingCount.update(n=>n-1))).subscribe(n=>{if(n?.error){console.error("Failed to update wall:",n.error);return}this.currentPlanWalls.reload()})}deleteWall(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("house_plan_walls").delete().eq("id",t)).pipe(tt(i=>(console.error("Error deleting wall:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete wall:",i.error);return}this.currentPlanWalls.reload()})}deleteWalls(t){this.loadingCount.update(i=>i+1),je(this.supabase.from("house_plan_walls").delete().in("id",t)).pipe(tt(i=>(console.error("Error deleting walls:",i),Ye({error:i}))),Je(()=>this.loadingCount.update(i=>i-1))).subscribe(i=>{if(i?.error){console.error("Failed to delete walls:",i.error);return}this.currentPlanWalls.reload()})}};var Qce=()=>[];function Zce(e,t){e&1&&(A(0,"div",1),le(1,"hlm-spinner",5),I())}function ede(e,t){if(e&1){let i=Ue();A(0,"div",2)(1,"p"),ge(2),be(3,"transloco"),I(),A(4,"button",6),de("click",function(){ue(i);let r=te();return he(r.goBack())}),le(5,"ng-icon",7),ge(6),be(7,"transloco"),I()()}if(e&2){let i=te();L(2),Ac("",ye(3,3,"common.error"),": ",i.plansService.currentPlan.error()),L(4),qe(" ",ye(7,5,"common.back")," ")}}function tde(e,t){if(e&1){let i=Ue();A(0,"div",35)(1,"span",38),ge(2),I(),A(3,"button",39),be(4,"transloco"),de("click",function(){ue(i);let r=te(2);return r.selectedFlexibleItemId.set(null),he(r.drawingMode.set("select"))}),le(5,"ng-icon",25),I()()}if(e&2){let i=te(2);L(2),Qe(i.selectedFlexibleItemName()),L(),ve("hlmTooltipTrigger",ye(4,2,"housePlan.clearSelection"))}}function ide(e,t){if(e&1){let i=Ue();A(0,"div",8)(1,"div",9)(2,"button",10),de("click",function(){ue(i);let r=te();return he(r.goBack())}),le(3,"ng-icon",11),I(),A(4,"div")(5,"h1",12),ge(6),be(7,"transloco"),I(),A(8,"p",13),ge(9),be(10,"transloco"),I()()(),A(11,"div",14)(12,"button",15),de("click",function(){ue(i);let r=te();return he(r.clearAll())}),le(13,"ng-icon",16),ge(14),be(15,"transloco"),I(),A(16,"button",17),de("click",function(){ue(i);let r=te();return he(r.savePlan())}),le(17,"ng-icon",18),ge(18),be(19,"transloco"),I()()(),A(20,"div",19)(21,"div",20)(22,"button",21),be(23,"transloco"),de("click",function(){ue(i);let r=te();return he(r.setDrawingMode("select"))}),le(24,"ng-icon",22),I(),A(25,"button",21),be(26,"transloco"),de("click",function(){ue(i);let r=te();return he(r.setDrawingMode("draw"))}),le(27,"ng-icon",23),I(),A(28,"button",21),be(29,"transloco"),de("click",function(){ue(i);let r=te();return he(r.setDrawingMode("move"))}),le(30,"ng-icon",24),I(),A(31,"button",21),be(32,"transloco"),de("click",function(){ue(i);let r=te();return he(r.setDrawingMode("delete"))}),le(33,"ng-icon",25),I(),A(34,"button",26),be(35,"transloco"),de("click",function(){ue(i);let r=te();return he(r.setDrawingMode("add-item"))}),le(36,"ng-icon",27),I(),le(37,"div",28),A(38,"button",29),be(39,"transloco"),de("click",function(){ue(i);let r=te();return he(r.zoomIn())}),le(40,"ng-icon",30),I(),A(41,"button",29),be(42,"transloco"),de("click",function(){ue(i);let r=te();return he(r.zoomOut())}),le(43,"ng-icon",31),I(),A(44,"button",29),be(45,"transloco"),de("click",function(){ue(i);let r=te();return he(r.resetZoom())}),le(46,"ng-icon",32),I(),le(47,"div",28),A(48,"div",33)(49,"hlm-autocomplete",34),ko("searchChange",function(r){ue(i);let o=te();return Gr(o.flexibleItemSearch,r)||(o.flexibleItemSearch=r),he(r)}),de("valueChange",function(r){ue(i);let o=te();return he(o.handleFlexibleItemSelection(r))}),I()(),Ve(50,tde,6,4,"div",35),I(),A(51,"div",36)(52,"gh-house-plan-canvas",37),ko("wallsChange",function(r){ue(i);let o=te();return Gr(o.walls,r)||(o.walls=r),he(r)})("itemsChange",function(r){ue(i);let o=te();return Gr(o.planItems,r)||(o.planItems=r),he(r)}),de("wallClicked",function(r){ue(i);let o=te();return he(o.onWallClick(r))})("wallCreated",function(r){ue(i);let o=te();return he(o.onWallCreated(r))})("wallMoved",function(r){ue(i);let o=te();return he(o.onWallMoved(r))})("wallDeleted",function(r){ue(i);let o=te();return he(o.onWallDeleted(r))})("itemMoved",function(r){ue(i);let o=te();return he(o.onItemMoved(r))})("itemDeleted",function(r){ue(i);let o=te();return he(o.onItemDeleted(r))})("itemPlaced",function(r){ue(i);let o=te();return he(o.onFlexibleItemPlaced(r))})("stagePositionChanged",function(r){ue(i);let o=te();return he(o.onStagePositionChanged(r))}),I()()()}if(e&2){let i,n=te();L(6),qe(" ",((i=n.plansService.currentPlan.value())==null?null:i.name)||ye(7,36,"housePlan.title")," "),L(3),Qe(ye(10,38,"housePlan.subtitle")),L(5),qe(" ",ye(15,40,"common.clear")," "),L(2),ve("disabled",n.plansService.loading()),L(2),qe(" ",ye(19,42,"common.save")," "),L(4),ve("variant",n.drawingMode()==="select"?"default":"outline")("hlmTooltipTrigger",ye(23,44,"housePlan.select")),L(3),ve("variant",n.drawingMode()==="draw"?"default":"outline")("hlmTooltipTrigger",ye(26,46,"housePlan.drawWall")),L(3),ve("variant",n.drawingMode()==="move"?"default":"outline")("hlmTooltipTrigger",ye(29,48,"housePlan.move")),L(3),ve("variant",n.drawingMode()==="delete"?"destructive":"outline")("hlmTooltipTrigger",ye(32,50,"housePlan.delete")),L(3),ve("variant",n.drawingMode()==="add-item"?"default":"outline")("hlmTooltipTrigger",ye(35,52,"housePlan.placeFlexibleItem"))("disabled",!n.selectedFlexibleItemId()),L(4),ve("hlmTooltipTrigger",ye(39,54,"housePlan.zoomIn"))("disabled",n.zoom()>=n.maxZoom),L(3),ve("hlmTooltipTrigger",ye(42,56,"housePlan.zoomOut"))("disabled",n.zoom()<=n.minZoom),L(3),ve("hlmTooltipTrigger",ye(45,58,"housePlan.resetZoom"))("disabled",n.zoom()===1&&n.stagePosition().x===0&&n.stagePosition().y===0),L(5),ve("searchPlaceholderText","Select item to place...")("filteredOptions",n.filteredFlexibleItems()),Po("search",n.flexibleItemSearch),ve("autocompleteEmptyClass","p-2 text-sm text-muted-foreground"),L(),Ge(n.selectedFlexibleItem()?50:-1),L(2),ve("canvasWidth",n.canvasWidth)("canvasHeight",n.canvasHeight)("gridSize",n.gridSize)("drawingMode",n.drawingMode())("zoom",n.zoom())("stagePosition",n.stagePosition()),Po("walls",n.walls)("items",n.planItems),ve("activeFlexibleItemId",n.selectedFlexibleItemId())}}function nde(e,t){if(e&1){let i=Ue();A(0,"div",48)(1,"span",38),ge(2),I(),A(3,"button",51),de("click",function(){ue(i);let r=te(2);return he(r.clearWallStructure())}),le(4,"ng-icon",25),I()()}if(e&2){let i=te(2);L(2),Qe(i.selectedWallStructure().name)}}function rde(e,t){e&1&&(A(0,"p",52),ge(1),be(2,"transloco"),I()),e&2&&(L(),qe("",ye(2,1,"common.loading"),"..."))}function ode(e,t){e&1&&(A(0,"p",52),ge(1),be(2,"transloco"),I()),e&2&&(L(),Qe(ye(2,1,"housePlan.noStructuresAvailable")))}function sde(e,t){if(e&1){let i=Ue();A(0,"hlm-autocomplete",34),be(1,"transloco"),ko("searchChange",function(r){ue(i);let o=te(2);return Gr(o.wallStructureSearch,r)||(o.wallStructureSearch=r),he(r)}),de("valueChange",function(r){ue(i);let o=te(2);return he(o.handleWallStructureSelection(r))}),I(),Ve(2,rde,3,3,"p",52)(3,ode,3,3,"p",52)}if(e&2){let i=te(2);ve("searchPlaceholderText",ye(1,5,"housePlan.searchWallStructure"))("filteredOptions",i.filteredWallStructures()),Po("search",i.wallStructureSearch),ve("autocompleteEmptyClass","p-2 text-sm text-muted-foreground"),L(2),Ge(i.wallStructuresService.wallStructures.isLoading()?2:(i.wallStructuresService.wallStructures.value()||Bh(7,Qce)).length===0?3:-1)}}function ade(e,t){if(e&1&&(A(0,"div",49)(1,"p",38),ge(2),be(3,"transloco"),I(),A(4,"p",47),ge(5),be(6,"transloco"),I()()),e&2){let i=te(2);L(2),Qe(ye(3,3,"housePlan.dimensions")),L(3),Ac(" ",ye(6,5,"housePlan.length"),": ",i.calculateWallLength(i.selectedWall()).toFixed(2)," m ")}}function lde(e,t){if(e&1){let i=Ue();A(0,"hlm-sheet-content")(1,"hlm-sheet-header")(2,"h3",40),ge(3),be(4,"transloco"),I(),A(5,"p",41),ge(6),be(7,"transloco"),I()(),A(8,"div",42)(9,"div",43)(10,"label",44),ge(11),be(12,"transloco"),I(),A(13,"input",45),ko("ngModelChange",function(r){ue(i);let o=te();return Gr(o.wallName,r)||(o.wallName=r),he(r)}),I()(),A(14,"div",43)(15,"label",46),ge(16),be(17,"transloco"),I(),A(18,"p",47),ge(19),be(20,"transloco"),I(),Ve(21,nde,5,1,"div",48)(22,sde,4,8),I(),Ve(23,ade,7,7,"div",49),I(),A(24,"hlm-sheet-footer")(25,"button",15),de("click",function(){ue(i);let r=te();return he(r.closeMetadataSheet())}),ge(26),be(27,"transloco"),I(),A(28,"button",50),de("click",function(){ue(i);let r=te();return he(r.saveWallMetadata())}),ge(29),be(30,"transloco"),I()()()}if(e&2){let i=te();L(3),Qe(ye(4,10,"housePlan.wallMetadata")),L(3),Qe(ye(7,12,"housePlan.wallMetadataDesc")),L(5),qe(" ",ye(12,14,"housePlan.wallName")," "),L(2),Po("ngModel",i.wallName),L(3),Qe(ye(17,16,"housePlan.wallStructure")),L(3),Qe(ye(20,18,"housePlan.wallStructureDesc")),L(2),Ge(i.selectedWallStructure()?21:22),L(2),Ge(i.selectedWall()?23:-1),L(3),qe(" ",ye(27,20,"common.cancel")," "),L(3),qe(" ",ye(30,22,"common.save")," ")}}var fI=(()=>{class e{route=ce(D2);router=ce(Hh);plansService=ce(Ss);wallStructuresService=ce(Hr);flexibleItemsService=ce(Ar);planItemsResource=this.createPlanItemsResource();constructor(){ht(()=>{let i=m3(zn.app.homeDocumentation.housePlan,this.route.snapshot.params).id;i&&this.plansService.loadPlan(i)}),ht(()=>{let i=this.plansService.currentPlanWalls.value();i&&this.walls.set(i)}),this.planItemsResource&&ht(()=>{let i=this.planItemsResource.value();i&&this.planItems.set(i)})}canvasWidth=1600;canvasHeight=1200;gridSize=20;zoom=xe(1);minZoom=.1;maxZoom=5;stagePosition=xe({x:0,y:0});drawingMode=xe("select");walls=xe([]);selectedWallId=xe(null);planItems=xe([]);isMetadataSheetOpen=xe(!1);selectedWall=Ie(()=>{let i=this.selectedWallId();return i&&this.walls().find(n=>n.id===i)||null});wallName=xe("");wallStructureId=xe(null);wallStructureSearch=xe("");selectedFlexibleItemId=xe(null);flexibleItemSearch=xe("");filteredWallStructures=Ie(()=>{let i=this.wallStructuresService.wallStructures.value()||[],n=this.wallStructureSearch().toLowerCase();return n?i.filter(r=>r.name.toLowerCase().includes(n)):i});filteredFlexibleItems=Ie(()=>{let i=this.flexibleItemsService.flexibleItems.value()||[],n=this.flexibleItemSearch().toLowerCase();return n?i.filter(r=>{let o=(r.description||"").toLowerCase();return r.name.toLowerCase().includes(n)||o.includes(n)}):i});selectedFlexibleItem=Ie(()=>{let i=this.selectedFlexibleItemId();return i&&(this.flexibleItemsService.flexibleItems.value()||[]).find(n=>n.id===i)||null});selectedFlexibleItemName=Ie(()=>this.selectedFlexibleItem()?.name||"");selectedWallStructure=Ie(()=>{let i=this.wallStructureId();return i&&(this.wallStructuresService.wallStructures.value()||[]).find(r=>r.id===i)||null});setDrawingMode(i){this.drawingMode.set(i),i!=="select"&&this.selectedWallId.set(null)}onWallClick(i){this.selectedWallId.set(i);let n=this.walls().find(r=>r.id===i);n&&(this.wallName.set(n.name||""),this.wallStructureId.set(n.wall_structure_id||null),this.wallStructureSearch.set(""),this.isMetadataSheetOpen.set(!0))}onWallCreated(i){let n=this.route.snapshot.paramMap.get("id");n&&this.plansService.createWall({house_plan_id:n,start_x:i.start_x,start_y:i.start_y,end_x:i.end_x,end_y:i.end_y,color:"#1f2937",name:`Wall ${this.walls().length+1}`})}onWallMoved(i){this.plansService.updateWall(i.id,{start_x:i.start_x,start_y:i.start_y,end_x:i.end_x,end_y:i.end_y})}onWallDeleted(i){this.plansService.deleteWall(i)}handleWallStructureSelection(i){this.wallStructureId.set(i),this.wallStructureSearch.set("")}handleFlexibleItemSelection(i){this.selectedFlexibleItemId.set(i),this.drawingMode.set("add-item")}clearWallStructure(){this.wallStructureId.set(null),this.wallStructureSearch.set("")}saveWallMetadata(){let i=this.selectedWallId();i&&(this.plansService.updateWall(i,{name:this.wallName()||void 0,wall_structure_id:this.wallStructureId()||void 0}),this.isMetadataSheetOpen.set(!1))}closeMetadataSheet(){this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null),this.wallStructureSearch.set("")}deleteSelectedWall(){let i=this.selectedWallId();i&&(this.plansService.deleteWall(i),this.isMetadataSheetOpen.set(!1),this.selectedWallId.set(null))}clearAll(){if(confirm("Are you sure you want to clear all walls?")){let i=this.walls().map(n=>n.id);i.length>0&&this.plansService.deleteWalls(i),this.selectedWallId.set(null)}}savePlan(){}goBack(){this.router.navigate([Uh(zn.app.homeDocumentation.housePlans,{})])}calculateWallLength(i){let n=Math.sqrt(Math.pow(i.end_x-i.start_x,2)+Math.pow(i.end_y-i.start_y,2)),r=this.plansService.currentPlan.value()?.scale||20;return n/r}zoomIn(){let i=this.zoom(),n=Math.min(this.maxZoom,i*1.2),r=this.canvasWidth/2,o=this.canvasHeight/2,s=this.stagePosition(),a={x:(r-s.x)/i,y:(o-s.y)/i},l={x:r-a.x*n,y:o-a.y*n};this.zoom.set(n),this.stagePosition.set(l)}zoomOut(){let i=this.zoom(),n=Math.max(this.minZoom,i/1.2),r=this.canvasWidth/2,o=this.canvasHeight/2,s=this.stagePosition(),a={x:(r-s.x)/i,y:(o-s.y)/i},l={x:r-a.x*n,y:o-a.y*n};this.zoom.set(n),this.stagePosition.set(l)}resetZoom(){this.zoom.set(1),this.stagePosition.set({x:0,y:0})}onStagePositionChanged(i){this.stagePosition.set(i)}onFlexibleItemPlaced(i){let n=this.route.snapshot.paramMap.get("id"),r=this.selectedFlexibleItemId();!n||!r||this.flexibleItemsService.addItemToHousePlan({house_plan_id:n,flexible_item_id:r,position_x:i.x,position_y:i.y},o=>{this.planItems.update(s=>[...s,T(w({},o),{item:this.selectedFlexibleItem()||void 0})]),this.planItemsResource?.reload()})}onItemMoved(i){this.planItems.update(n=>n.map(r=>r.id===i.id?T(w({},r),{position_x:i.position_x,position_y:i.position_y}):r)),this.flexibleItemsService.updateHousePlanItem(i.id,{position_x:i.position_x,position_y:i.position_y})}onItemDeleted(i){this.planItems.update(n=>n.filter(r=>r.id!==i)),this.flexibleItemsService.removeItemFromHousePlan(i)}createPlanItemsResource(){let i=this.route.snapshot.paramMap.get("id");return i?this.flexibleItemsService.getHousePlanItemsResource(i):null}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-house-plan-editor"]],features:[it([Ss,Hr,Ar,di({lucidePointer:X2,lucidePencil:Ua,lucideMove:Y2,lucideTrash:tr,lucideSquare:t3,lucideSave:e3,lucideArrowUpDown:L2,lucideArrowLeft:A2,lucidePlus:Do,lucideMinus:K2,lucideRotateCcw:Z2}),E3({transformOptionToString:i=>("flexible_item_id"in i,i.name),transformOptionToValue:i=>("flexible_item_id"in i,i.id)})])],decls:6,vars:2,consts:[[1,"h-full","flex","flex-col"],[1,"flex","items-center","justify-center","flex-1"],[1,"text-center","py-12","text-destructive","flex-1"],["side","right",3,"stateChanged","state"],[4,"brnSheetContent"],["size","large"],["hlmBtn","","variant","outline",1,"mt-4",3,"click"],["hlm","","name","lucideArrowLeft","size","sm",1,"mr-2"],[1,"flex","items-center","justify-between","p-4","md:p-6","pb-0"],[1,"flex","items-center","gap-4"],["hlmBtn","","variant","ghost","size","icon",3,"click"],["hlm","","name","lucideArrowLeft","size","sm"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"text-muted-foreground","mt-1"],[1,"flex","gap-2"],["hlmBtn","","variant","outline",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],["hlmBtn","",3,"click","disabled"],["hlm","","name","lucideSave","size","sm",1,"mr-2"],[1,"flex-1","flex","flex-col","p-4","md:p-6","pt-4","gap-4","min-h-0"],[1,"flex","items-center","gap-2","flex-wrap","w-full"],["hlmBtn","","size","icon",3,"click","variant","hlmTooltipTrigger"],["hlm","","name","lucidePointer","size","sm"],["hlm","","name","lucidePencil","size","sm"],["hlm","","name","lucideMove","size","sm"],["hlm","","name","lucideTrash","size","sm"],["hlmBtn","","size","icon",3,"click","variant","hlmTooltipTrigger","disabled"],["hlm","","name","lucideSquare","size","sm"],[1,"w-px","h-8","bg-border","mx-1"],["hlmBtn","","variant","outline","size","icon",3,"click","hlmTooltipTrigger","disabled"],["hlm","","name","lucidePlus","size","sm"],["hlm","","name","lucideMinus","size","sm"],["hlm","","name","lucideRotateCcw","size","sm"],[1,"w-64"],[3,"searchChange","valueChange","searchPlaceholderText","filteredOptions","search","autocompleteEmptyClass"],[1,"flex","items-center","gap-2","px-3","py-1","bg-accent","rounded-md"],[1,"flex-1","min-h-0","overflow-auto","border","rounded-md","bg-muted/30"],[3,"wallsChange","itemsChange","wallClicked","wallCreated","wallMoved","wallDeleted","itemMoved","itemDeleted","itemPlaced","stagePositionChanged","canvasWidth","canvasHeight","gridSize","drawingMode","zoom","stagePosition","walls","items","activeFlexibleItemId"],[1,"text-sm","font-medium"],["hlmBtn","","variant","ghost","size","icon",1,"h-6","w-6",3,"click","hlmTooltipTrigger"],["hlmSheetTitle",""],["hlmSheetDescription",""],[1,"space-y-4","px-4"],[1,"space-y-2"],["hlmLabel","","for","wall-name"],["hlmInput","","id","wall-name","type","text",3,"ngModelChange","ngModel"],["hlmLabel",""],[1,"text-sm","text-muted-foreground"],[1,"flex","items-center","justify-between","p-2","bg-accent","rounded-md"],[1,"space-y-2","pt-4","border-t"],["hlmBtn","",3,"click"],["hlmBtn","","variant","ghost","size","icon",1,"h-6","w-6",3,"click"],[1,"text-sm","text-muted-foreground","italic"]],template:function(n,r){n&1&&(A(0,"div",0),Ve(1,Zce,2,0,"div",1)(2,ede,8,7,"div",2)(3,ide,53,60),I(),A(4,"hlm-sheet",3),de("stateChanged",function(s){return r.isMetadataSheetOpen.set(s==="open")}),Qn(5,lde,31,24,"hlm-sheet-content",4),I()),n&2&&(L(),Ge(r.plansService.currentPlan.isLoading()?1:r.plansService.currentPlan.error()?2:3),L(3),ve("state",r.isMetadataSheetOpen()?"open":"closed"))},dependencies:[gn,Ga,Zn,er,Vh,Rt,Cn,wn,hi,ui,ir,Mo,To,Io,Ao,Oo,Lo,R3,w3,Fo,vn,t0,mn],encapsulation:2,changeDetection:0})}return e})();function cde(e,t){e&1&&(A(0,"div",5),le(1,"hlm-spinner",9),I())}function dde(e,t){if(e&1&&(A(0,"div",6)(1,"p"),ge(2),be(3,"transloco"),I()()),e&2){let i=te();L(2),Ac("",ye(3,2,"common.error"),": ",i.plansService.plans.error())}}function ude(e,t){if(e&1){let i=Ue();A(0,"div",7)(1,"p",10),ge(2),be(3,"transloco"),I(),A(4,"button",3),de("click",function(){ue(i);let r=te();return he(r.openCreateDialog())}),le(5,"ng-icon",4),ge(6),be(7,"transloco"),I()()}e&2&&(L(2),Qe(ye(3,2,"housePlans.noPlans")),L(4),qe(" ",ye(7,4,"housePlans.createFirst")," "))}function hde(e,t){if(e&1&&le(0,"ag-grid-angular",8),e&2){let i=te();ve("rowData",i.plansService.plans.value())("columnDefs",i.columnDefs)("defaultColDef",i.defaultColDef)("gridOptions",i.gridOptions)}}function pde(e,t){if(e&1){let i=Ue();A(0,"div",11),de("click",function(){ue(i);let r=te();return he(r.closeCreateDialog())}),I(),A(1,"div",12)(2,"div",13)(3,"div")(4,"h3",14),ge(5),be(6,"transloco"),I(),A(7,"p",15),ge(8),be(9,"transloco"),I()(),A(10,"div",16)(11,"label",17),ge(12),be(13,"transloco"),I(),A(14,"input",18),be(15,"transloco"),ko("ngModelChange",function(r){ue(i);let o=te();return Gr(o.newPlanName,r)||(o.newPlanName=r),he(r)}),I()(),A(16,"div",16)(17,"label",19),ge(18),be(19,"transloco"),I(),A(20,"textarea",20),be(21,"transloco"),ko("ngModelChange",function(r){ue(i);let o=te();return Gr(o.newPlanDescription,r)||(o.newPlanDescription=r),he(r)}),I()(),A(22,"div",21)(23,"button",22),de("click",function(){ue(i);let r=te();return he(r.closeCreateDialog())}),ge(24),be(25,"transloco"),I(),A(26,"button",23),de("click",function(){ue(i);let r=te();return he(r.createPlan())}),ge(27),be(28,"transloco"),I()()()()}if(e&2){let i=te();L(5),Qe(ye(6,11,"housePlans.createNewPlan")),L(3),Qe(ye(9,13,"housePlans.createNewPlanDesc")),L(4),qe(" ",ye(13,15,"housePlans.planName")," "),L(2),Po("ngModel",i.newPlanName),ve("placeholder",ye(15,17,"housePlans.planNamePlaceholder")),L(4),qe(" ",ye(19,19,"housePlans.planDescription")," "),L(2),Po("ngModel",i.newPlanDescription),ve("placeholder",ye(21,21,"housePlans.planDescriptionPlaceholder")),L(4),qe(" ",ye(25,23,"common.cancel")," "),L(2),ve("disabled",!i.newPlanName.trim()),L(),qe(" ",ye(28,25,"common.create")," ")}}var gI=(()=>{class e{router=ce(Hh);plansService=ce(Ss);columnDefs=[{headerName:"Name",field:"name",flex:2,sortable:!0,filter:!0},{headerName:"Description",field:"description",flex:3,sortable:!0,filter:!0},{headerName:"Created",field:"created_at",flex:2,sortable:!0,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString():""},{headerName:"Actions",cellRenderer:Ra,cellRendererParams:{actions:[{icon:"lucideEye",variant:"ghost",action:i=>this.viewPlan(i.id)},{icon:"lucideTrash",variant:"ghost",action:i=>this.deletePlan(i.id)}]},flex:1,sortable:!1,filter:!1}];defaultColDef={resizable:!0,sortable:!0};gridOptions={rowHeight:48,headerHeight:48,pagination:!0,paginationPageSize:20,paginationPageSizeSelector:[10,20,50,100]};showCreateDialog=!1;newPlanName="";newPlanDescription="";openCreateDialog(){this.showCreateDialog=!0,this.newPlanName="",this.newPlanDescription=""}closeCreateDialog(){this.showCreateDialog=!1}createPlan(){this.newPlanName.trim()&&(this.plansService.createPlan({name:this.newPlanName,description:this.newPlanDescription||void 0}),this.closeCreateDialog())}viewPlan(i){this.router.navigate([C3(zn.app.homeDocumentation.housePlan,{path:{id:i},query:{}}).path])}deletePlan(i){confirm("Are you sure you want to delete this plan?")&&this.plansService.deletePlan(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-house-plans-list"]],features:[it([Ss,di({lucidePlus:Do,lucideEye:V2,lucideTrash:tr})])],decls:15,vars:11,consts:[[1,"p-4","md:p-6","space-y-4"],[1,"flex","items-center","justify-between"],[3,"title","description"],["hlmBtn","",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12","text-destructive"],[1,"text-center","py-12"],[1,"ag-theme-alpine",2,"width","100%","height","600px",3,"rowData","columnDefs","defaultColDef","gridOptions"],["size","large"],[1,"text-muted-foreground","mb-4"],[1,"fixed","inset-0","z-50","bg-black/50",3,"click"],[1,"fixed","left-1/2","top-1/2","z-50","w-full","max-w-lg","-translate-x-1/2","-translate-y-1/2","bg-background","shadow-lg","rounded-lg","p-6"],[1,"space-y-4"],[1,"text-lg","font-semibold"],[1,"text-sm","text-muted-foreground"],[1,"space-y-2"],["hlmLabel","","for","plan-name"],["hlmInput","","id","plan-name","type","text",3,"ngModelChange","ngModel","placeholder"],["hlmLabel","","for","plan-description"],["hlmInput","","id","plan-description","rows","3",3,"ngModelChange","ngModel","placeholder"],[1,"flex","gap-2","pt-4"],["hlmBtn","","variant","outline",1,"flex-1",3,"click"],["hlmBtn","",1,"flex-1",3,"click","disabled"]],template:function(n,r){n&1&&(A(0,"div",0)(1,"div",1),le(2,"gh-section-header",2),be(3,"transloco"),be(4,"transloco"),A(5,"button",3),de("click",function(){return r.openCreateDialog()}),le(6,"ng-icon",4),ge(7),be(8,"transloco"),I()(),A(9,"div"),Ve(10,cde,2,0,"div",5)(11,dde,4,4,"div",6)(12,ude,8,6,"div",7)(13,hde,1,4,"ag-grid-angular",8),I()(),Ve(14,pde,29,27)),n&2&&(L(2),ve("title",ye(3,5,"housePlans.title"))("description",ye(4,7,"housePlans.subtitle")),L(5),qe(" ",ye(8,9,"housePlans.createNew")," "),L(3),Ge(r.plansService.plans.isLoading()?10:r.plansService.plans.error()?11:!r.plansService.plans.value()||r.plansService.plans.value().length===0?12:13),L(4),Ge(r.showCreateDialog?14:-1))},dependencies:[gn,Ga,Zn,er,Vh,cc,Rt,Cn,wn,hi,ui,ir,vn,qa,mn],encapsulation:2,changeDetection:0})}return e})();function fde(e,t){e&1&&(A(0,"div",10),le(1,"hlm-spinner",16),I())}function gde(e,t){if(e&1){let i=Ue();A(0,"div",11)(1,"ag-grid-angular",17),de("gridReady",function(r){ue(i);let o=te();return he(o.onMaterialsGridReady(r))}),I()()}if(e&2){let i=te();L(),ve("rowData",i.materialLayers())("columnDefs",i.materialColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.materialRowSelection)("theme",i.theme)}}function mde(e,t){e&1&&(A(0,"div",10),le(1,"hlm-spinner",16),I())}function vde(e,t){if(e&1){let i=Ue();A(0,"div",13)(1,"ag-grid-angular",17),de("gridReady",function(r){ue(i);let o=te();return he(o.onStructuresGridReady(r))}),I()()}if(e&2){let i=te();L(),ve("rowData",i.wallStructures())("columnDefs",i.structureColumnDefs)("defaultColDef",i.defaultColDef)("rowSelection",i.rowSelection)("theme",i.theme)}}vm.registerModules([Mm]);var mI=(()=>{class e{theme=Pm;service=ce(Hr);materialsGridApi=xe(null);structuresGridApi=xe(null);editingMaterial=xe(null);editingStructure=xe(null);isMaterialSheetOpen=xe(!1);isStructureSheetOpen=xe(!1);materialLayers=Ie(()=>this.service.materialLayers.value()||[]);wallStructures=Ie(()=>this.service.wallStructures.value()||[]);materialColumnDefs=[{field:"name",headerName:"Materialname",flex:1},{field:"thickness",headerName:"Dicke (mm)",width:150,valueFormatter:i=>i.value?`${i.value} mm`:"0 mm"},{field:"description",headerName:"Beschreibung",flex:2},{headerName:"Aktionen",width:100,cellRenderer:Ra,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editMaterial(i)}]},sortable:!1,filter:!1}];structureColumnDefs=[{field:"name",headerName:"Wandaufbau Name",flex:1},{field:"created_at",headerName:"Erstellt am",width:180,valueFormatter:i=>i.value?new Date(i.value).toLocaleDateString("de-DE"):""},{headerName:"Aktionen",width:100,cellRenderer:Ra,cellRendererParams:{actions:[{icon:"lucidePencil",variant:"ghost",action:i=>this.editStructure(i)}]},sortable:!1,filter:!1}];defaultColDef={sortable:!0,filter:!0,resizable:!0};rowSelection={mode:"singleRow"};materialRowSelection={mode:"multiRow"};onMaterialsGridReady(i){this.materialsGridApi.set(i.api)}onStructuresGridReady(i){this.structuresGridApi.set(i.api)}editMaterial(i){this.editingMaterial.set(i),this.isMaterialSheetOpen.set(!0)}editStructure(i){this.editingStructure.set(i),this.isStructureSheetOpen.set(!0)}onMaterialSave(i){let n=this.editingMaterial();if(n){let r={name:i.name,thickness:i.thickness,description:i.description===null?void 0:i.description};this.service.updateMaterialLayer(n.id,r)}else{if(!i.name||i.thickness===void 0)return;let r={name:i.name,thickness:i.thickness,description:i.description===null?void 0:i.description};this.service.createMaterialLayer(r)}this.editingMaterial.set(null),this.isMaterialSheetOpen.set(!1)}onStructureSave(i){let n=this.editingStructure();if(n){let r={name:i.structure.name};this.service.updateWallStructureWithLayers(n.id,r,i.layers)}else{if(!i.structure.name)return;let r={name:i.structure.name};this.service.createWallStructureWithLayers(r,i.layers)}this.editingStructure.set(null),this.isStructureSheetOpen.set(!1)}addMaterial(){this.editingMaterial.set(null),this.isMaterialSheetOpen.set(!0)}deleteSelectedMaterials(){let i=this.materialsGridApi();if(!i)return;let n=i.getSelectedRows();if(n.length>0){let r=n.map(o=>o.id);this.service.deleteMaterialLayers(r)}}addWallStructure(){this.editingStructure.set(null),this.isStructureSheetOpen.set(!0)}deleteSelectedStructure(){let i=this.structuresGridApi();if(!i)return;let n=i.getSelectedRows();n.length>0&&this.service.deleteWallStructure(n[0].id)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ae({type:e,selectors:[["gh-wall-structures"]],features:[it([Hr,di({lucidePlus:Do,lucideTrash:tr,lucidePencil:Ua})])],decls:36,vars:30,consts:[["materialSheet",""],["structureSheet",""],[1,"p-4","md:p-6","space-y-6"],[1,"flex","flex-col","space-y-4"],[3,"title","description"],[1,"flex","flex-wrap","gap-2"],["hlmBtn","","variant","default",3,"click"],["hlm","","name","lucidePlus","size","sm",1,"mr-2"],["hlmBtn","","variant","destructive",3,"click"],["hlm","","name","lucideTrash","size","sm",1,"mr-2"],[1,"flex","justify-center","p-8"],[1,"h-[300px]","w-full"],["hlmSeparator","",1,"my-6"],[1,"h-[400px]","w-full"],[3,"stateChanged","save$","material","state"],[3,"stateChanged","save$","structure","state"],["size","large"],[1,"w-full","h-full",3,"gridReady","rowData","columnDefs","defaultColDef","rowSelection","theme"]],template:function(n,r){if(n&1){let o=Ue();A(0,"div",2)(1,"div",3),le(2,"gh-section-header",4),be(3,"transloco"),be(4,"transloco"),A(5,"div",5)(6,"button",6),de("click",function(){return ue(o),he(r.addMaterial())}),le(7,"ng-icon",7),ge(8),be(9,"transloco"),I(),A(10,"button",8),de("click",function(){return ue(o),he(r.deleteSelectedMaterials())}),le(11,"ng-icon",9),ge(12),be(13,"transloco"),I()()(),Ve(14,fde,2,0,"div",10)(15,gde,2,5,"div",11),le(16,"div",12),A(17,"div",3),le(18,"gh-section-header",4),be(19,"transloco"),be(20,"transloco"),A(21,"div",5)(22,"button",6),de("click",function(){return ue(o),he(r.addWallStructure())}),le(23,"ng-icon",7),ge(24),be(25,"transloco"),I(),A(26,"button",8),de("click",function(){return ue(o),he(r.deleteSelectedStructure())}),le(27,"ng-icon",9),ge(28),be(29,"transloco"),I()()(),Ve(30,mde,2,0,"div",10)(31,vde,2,5,"div",13),I(),A(32,"gh-material-edit-sheet",14,0),de("stateChanged",function(a){return ue(o),he(r.isMaterialSheetOpen.set(a==="open"))})("save$",function(a){return ue(o),he(r.onMaterialSave(a))}),I(),A(34,"gh-wall-structure-edit-sheet",15,1),de("stateChanged",function(a){return ue(o),he(r.isStructureSheetOpen.set(a==="open"))})("save$",function(a){return ue(o),he(r.onStructureSave(a))}),I()}n&2&&(L(2),ve("title",ye(3,14,"wallStructures.materialLibrary.title"))("description",ye(4,16,"wallStructures.materialLibrary.description")),L(6),qe(" ",ye(9,18,"wallStructures.materialLibrary.addNew")," "),L(4),qe(" ",ye(13,20,"wallStructures.materialLibrary.deleteSelected")," "),L(2),Ge(r.service.materialLayers.isLoading()?14:15),L(4),ve("title",ye(19,22,"wallStructures.structures.title"))("description",ye(20,24,"wallStructures.structures.description")),L(6),qe(" ",ye(25,26,"wallStructures.structures.addNew")," "),L(4),qe(" ",ye(29,28,"wallStructures.structures.deleteSelected")," "),L(2),Ge(r.service.wallStructures.isLoading()?30:31),L(2),ve("material",r.editingMaterial())("state",r.isMaterialSheetOpen()?"open":"closed"),L(2),ve("structure",r.editingStructure())("state",r.isStructureSheetOpen()?"open":"closed"))},dependencies:[gn,cc,Rt,ir,Wh,vn,hi,ui,qa,dI,uI,mn],encapsulation:2,changeDetection:0})}return e})();var gTe=[{path:Vc(zn.app.homeDocumentation._.wallStructures),component:mI},{path:Vc(zn.app.homeDocumentation._.flexibleItems),component:pI},{path:Vc(zn.app.homeDocumentation._.housePlans),component:gI},{path:Uh(zn.app.homeDocumentation._.housePlan,{id:":id"}),component:fI},{path:"",redirectTo:Vc(zn.app.homeDocumentation._.wallStructures),pathMatch:"full"}];export{qve as FileUploadComponent,fI as HousePlanEditorComponent,f_ as TiptapEditorComponent,mI as WallStructuresComponent,gTe as homeDocumentationRoutes};
